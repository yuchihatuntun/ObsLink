/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AstroComposerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian12 = require("obsidian");

// src/types.ts
var KNOWN_ARRAY_KEYS = ["tags", "aliases", "cssclasses"];
var CONSTANTS = {
  DEBOUNCE_MS: 500,
  STAT_MTIME_THRESHOLD: 1e3,
  EDITOR_STABILIZE_DELAY: 100,
  FILE_EXPLORER_REVEAL_DELAY: 200
};

// src/settings.ts
var DEFAULT_SETTINGS = {
  defaultTemplate: '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
  autoInsertProperties: true,
  dateFormat: "YYYY-MM-DD",
  enableCopyHeadingLink: true,
  copyHeadingLinkFormat: "obsidian",
  addTrailingSlashToLinks: false,
  enableOpenTerminalCommand: false,
  terminalProjectRootPath: "",
  enableTerminalRibbonIcon: false,
  enableOpenConfigFileCommand: false,
  configFilePath: "",
  enableConfigRibbonIcon: false,
  contentTypes: [],
  migrationCompleted: false,
  helpButtonReplacement: {
    enabled: false,
    commandId: "edit-astro-config",
    iconId: "wrench"
  }
};

// src/commands/index.ts
var import_obsidian5 = require("obsidian");

// src/utils/file-operations.ts
var import_obsidian = require("obsidian");

// src/utils/path-matching.ts
function matchesFolderPattern(filePath, folderPattern) {
  if (!folderPattern || folderPattern.trim() === "") {
    return !filePath.includes("/") || filePath.split("/").length === 1;
  }
  if (!folderPattern.includes("*")) {
    return filePath === folderPattern || filePath.startsWith(folderPattern + "/");
  }
  const escapedPattern = folderPattern.replace(/[.+?^${}()|[\]\\]/g, "\\$&").replace(/\*/g, "[^/]+");
  const regexPattern = `^${escapedPattern}(?:/|$)`;
  const regex = new RegExp(regexPattern);
  return regex.test(filePath);
}
function getPatternDepth(folderPattern) {
  if (!folderPattern || folderPattern.trim() === "")
    return 0;
  return folderPattern.split("/").length;
}
function sortByPatternSpecificity(types) {
  return [...types].sort((a, b) => {
    const depthA = getPatternDepth(a.folder);
    const depthB = getPatternDepth(b.folder);
    return depthB - depthA;
  });
}

// src/utils/file-operations.ts
var FileOperations = class {
  constructor(app, settings, plugin) {
    this.app = app;
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  toKebabCase(str) {
    return str.toLowerCase().replace(/[<>:"/\\|?*]/g, "").replace(/['"]/g, "").replace(/[^\w\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  generateFilename(title, enableUnderscorePrefix = false) {
    const kebabTitle = this.toKebabCase(title);
    const safeKebabTitle = kebabTitle || "untitled";
    const prefix = enableUnderscorePrefix ? "_" : "";
    return `${prefix}${safeKebabTitle}`;
  }
  determineType(file) {
    const filePath = file.path;
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled)
        continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return contentType.id;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return contentType.id;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return contentType.id;
            }
          }
        } else {
          return contentType.id;
        }
      }
    }
    return "note";
  }
  getContentType(typeId) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    return contentTypes.find((ct) => ct.id === typeId) || null;
  }
  getTitleKey(type) {
    if (type === "note")
      return "title";
    const contentType = this.getContentType(type);
    if (!contentType)
      return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  async createFile(options) {
    var _a;
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to create a ${type}.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = this.toKebabCase(title);
    const enableUnderscorePrefix = (contentType == null ? void 0 : contentType.enableUnderscorePrefix) || false;
    const prefix = enableUnderscorePrefix ? "_" : "";
    let targetFolder = "";
    if (type === "note") {
      targetFolder = "";
    } else if (contentType) {
      const originalDir = ((_a = file.parent) == null ? void 0 : _a.path) || "";
      if (originalDir === "" || originalDir === "/") {
        targetFolder = contentType.folder || "";
      } else {
        targetFolder = originalDir;
      }
    }
    if (targetFolder) {
      const folder = this.app.vault.getAbstractFileByPath(targetFolder);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(targetFolder);
      }
    }
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType);
    } else {
      return this.createFileStructure(file, kebabTitle, prefix, targetFolder);
    }
  }
  async createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType) {
    var _a;
    const folderName = `${prefix}${kebabTitle}`;
    let folderPath;
    if (targetFolder) {
      folderPath = `${targetFolder}/${folderName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        folderPath = `${currentDir}/${folderName}`;
      } else {
        folderPath = folderName;
      }
    }
    try {
      const folder = this.app.vault.getAbstractFileByPath(folderPath);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(folderPath);
      }
    } catch (e) {
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const fileName = `${indexFileName}.md`;
    const newPath = `${folderPath}/${fileName}`;
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    if (this.plugin && "pluginCreatedFiles" in this.plugin) {
      const pluginWithFiles = this.plugin;
      (_a = pluginWithFiles.pluginCreatedFiles) == null ? void 0 : _a.add(newPath);
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        return null;
      }
      setTimeout(() => {
        const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
        if (fileExplorer && fileExplorer.view) {
          const view = fileExplorer.view;
          if (view && typeof view === "object" && "tree" in view) {
            const fileTree = view.tree;
            if (fileTree && newFile instanceof import_obsidian.TFile && typeof fileTree.revealFile === "function") {
              fileTree.revealFile(newFile);
            }
          }
        }
      }, 200);
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to create folder structure: ${errorMessage}.`);
      return null;
    }
  }
  async createFileStructure(file, kebabTitle, prefix, targetFolder) {
    var _a;
    const newName = `${prefix}${kebabTitle}.md`;
    let newPath;
    if (targetFolder) {
      newPath = `${targetFolder}/${newName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        newPath = `${currentDir}/${newName}`;
      } else {
        newPath = newName;
      }
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File with name "${newName}" already exists.`);
      return null;
    }
    if (this.plugin && "pluginCreatedFiles" in this.plugin) {
      const pluginWithFiles = this.plugin;
      (_a = pluginWithFiles.pluginCreatedFiles) == null ? void 0 : _a.add(newPath);
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
  }
  async renameFile(options) {
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to rename the content.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = this.toKebabCase(title);
    const prefix = "";
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.renameFolderStructure(file, kebabTitle, prefix, type, contentType);
    } else {
      return this.renameFileStructure(file, kebabTitle, prefix, contentType);
    }
  }
  async renameFolderStructure(file, kebabTitle, prefix, type, contentType) {
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const isIndex = file.basename === indexFileName;
    if (isIndex) {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      const newFile = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    } else {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.basename.startsWith("_") ? "_" : "";
      const newName = `${prefix}${kebabTitle}.md`;
      const newPath = `${file.parent.path}/${newName}`;
      const existingFile = this.app.vault.getAbstractFileByPath(newPath);
      if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
        new import_obsidian.Notice(`File already exists at ${newPath}.`);
        return null;
      }
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    }
  }
  async renameFileStructure(file, kebabTitle, prefix, contentType) {
    if (!file.parent) {
      new import_obsidian.Notice("Cannot rename: file has no parent folder.");
      return null;
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
    const isIndex = indexFileName && indexFileName.trim() !== "" && file.basename === indexFileName;
    if (isIndex) {
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        console.error("FileOperations: Folder rename failed:", error);
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      const newFile2 = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile2 instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile2;
    }
    prefix = file.basename.startsWith("_") ? "_" : "";
    const newName = `${prefix}${kebabTitle}.md`;
    let newPath;
    if (file.parent.path === "" || file.parent.path === "/") {
      newPath = newName;
    } else {
      newPath = `${file.parent.path}/${newName}`;
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
    } catch (error) {
      console.error("FileOperations: File rename failed:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
    const newFile = this.app.vault.getAbstractFileByPath(newPath);
    if (!(newFile instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Failed to locate renamed file.");
      return null;
    }
    return newFile;
  }
};

// src/utils/template-parsing.ts
var import_obsidian2 = require("obsidian");
var TemplateParser = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
  }
  parseFrontmatter(content) {
    let propertiesEnd = 0;
    let propertiesText = "";
    const existingProperties = {};
    if (content.startsWith("---")) {
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
      try {
        let currentKey = null;
        const arrayKeys = /* @__PURE__ */ new Set();
        propertiesText.split("\n").forEach((line) => {
          const trimmedLine = line.trim();
          const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
          if (match) {
            const [, key, value] = match;
            currentKey = key;
            const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
            const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
            const isArrayProperty = isKnownArrayKey || isEmptyArray;
            if (isArrayProperty) {
              existingProperties[key] = [];
              arrayKeys.add(key);
            } else {
              existingProperties[key] = [value ? value.trim() : ""];
            }
          } else if (currentKey && trimmedLine.startsWith("- ")) {
            const isArrayProperty = arrayKeys.has(currentKey);
            if (isArrayProperty) {
              const item = trimmedLine.replace(/^-\s*/, "");
              if (item)
                existingProperties[currentKey].push(item);
            }
          } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
            const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
            if (keyMatch) {
              const [, key, value] = keyMatch;
              if (!existingProperties[key]) {
                existingProperties[key] = [value ? value.trim() : ""];
              }
            }
          }
        });
        KNOWN_ARRAY_KEYS.forEach((key) => {
          if (propertiesText.includes(key + ":") && !existingProperties[key]) {
            existingProperties[key] = [];
          }
        });
      } catch (e) {
        new import_obsidian2.Notice("Falling back to template due to parsing error.");
      }
    }
    const bodyContent = content.slice(propertiesEnd);
    return {
      properties: existingProperties,
      propertiesText,
      propertiesEnd,
      bodyContent
    };
  }
  parseTemplate(templateString, title) {
    const templateLines = templateString.split("\n");
    const templateProps = [];
    const templateValues = {};
    let inProperties = false;
    for (let i = 0; i < templateLines.length; i++) {
      const line = templateLines[i].trim();
      if (line === "---") {
        inProperties = !inProperties;
        if (!inProperties) {
          break;
        }
        continue;
      }
      if (inProperties) {
        const match = line.match(/^(\w+):\s*(.*)$/);
        if (match) {
          const [, key, value] = match;
          templateProps.push(key);
          const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
          const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
          const isArrayProperty = isKnownArrayKey || isEmptyArray;
          if (isArrayProperty) {
            if (value && value.startsWith("[")) {
              const items = value.replace(/[[\]]/g, "").split(",").map((t) => t.trim()).filter((t) => t);
              templateValues[key] = items;
            } else {
              templateValues[key] = [];
              for (let j = i + 1; j < templateLines.length; j++) {
                const nextLine = templateLines[j].trim();
                if (nextLine.startsWith("- ")) {
                  const item = nextLine.replace(/^-\s*/, "").trim();
                  if (item) {
                    const arrayValue = templateValues[key];
                    if (Array.isArray(arrayValue)) {
                      arrayValue.push(item);
                    }
                  }
                } else if (nextLine === "---" || nextLine && !nextLine.startsWith("- ") && nextLine.includes(":")) {
                  break;
                }
              }
            }
          } else {
            const stringValue = (value || "").replace(/\{\{title\}\}/g, title).replace(/\{\{date\}\}/g, window.moment(new Date()).format(this.settings.dateFormat));
            templateValues[key] = stringValue;
          }
        }
      }
    }
    return { templateProps, templateValues };
  }
  buildFrontmatterContent(finalProps, arrayKeys) {
    let newContent = "---\n";
    for (const key in finalProps) {
      const isArrayProperty = KNOWN_ARRAY_KEYS.includes(key) || arrayKeys && arrayKeys.has(key);
      if (isArrayProperty) {
        newContent += `${key}:
`;
        if (finalProps[key].length > 0) {
          finalProps[key].forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${finalProps[key][0] || ""}
`;
      }
    }
    newContent += "---";
    return newContent;
  }
  async updateTitleInFrontmatter(file, newTitle, type) {
    const titleKey = this.getTitleKey(type);
    const hasTitleInTemplate = this.templateHasTitle(type);
    if (!hasTitleInTemplate) {
      return;
    }
    const content = await this.app.vault.read(file);
    let propertiesEnd = 0;
    let propertiesText = "";
    let hasFrontmatter = false;
    if (content.startsWith("---")) {
      hasFrontmatter = true;
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
    }
    const propOrder = [];
    const existing = {};
    let currentKey = null;
    let titleKeyPosition = -1;
    const arrayKeys = /* @__PURE__ */ new Set();
    propertiesText.split("\n").forEach((line, index) => {
      const trimmedLine = line.trim();
      const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
      if (match) {
        const [, key, value] = match;
        propOrder.push(key);
        currentKey = key;
        if (key === titleKey) {
          titleKeyPosition = index;
        }
        const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
        const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
        const isArrayProperty = isKnownArrayKey || isEmptyArray;
        if (isArrayProperty) {
          existing[key] = [];
          arrayKeys.add(key);
        } else {
          existing[key] = value ? value.trim() : "";
        }
      } else if (currentKey && arrayKeys.has(currentKey) && trimmedLine.startsWith("- ")) {
        const item = trimmedLine.replace(/^-\s*/, "");
        if (item)
          existing[currentKey].push(item);
      } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
        const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
        if (keyMatch) {
          const [, key, value] = keyMatch;
          if (!propOrder.includes(key)) {
            propOrder.push(key);
            existing[key] = value ? value.trim() : "";
          }
        }
      }
    });
    let titleVal;
    if (newTitle.includes('"') || newTitle.includes("'") || newTitle.includes("\n") || newTitle.includes("\\")) {
      titleVal = `'${newTitle.replace(/'/g, "''")}'`;
    } else if (newTitle.includes(" ") || newTitle.includes(":") || newTitle.includes("#") || newTitle.includes("@")) {
      titleVal = `"${newTitle.replace(/"/g, '\\"')}"`;
    } else {
      titleVal = newTitle;
    }
    existing[titleKey] = titleVal;
    if (titleKeyPosition === -1) {
      propOrder.push(titleKey);
    }
    if (!hasFrontmatter) {
      return;
    }
    let newContent = "---\n";
    for (const key of propOrder) {
      const val = existing[key];
      if (Array.isArray(val)) {
        newContent += `${key}:
`;
        if (val.length > 0) {
          val.forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${val || ""}
`;
      }
    }
    newContent += "---\n";
    const bodyContent = content.slice(propertiesEnd);
    newContent += bodyContent;
    await this.app.vault.modify(file, newContent);
  }
  getTitleKey(type) {
    if (type === "note")
      return "title";
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType)
      return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  // Check if the template for this content type has {{title}}
  templateHasTitle(type) {
    if (type === "note")
      return true;
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType)
      return true;
    const template = contentType.template;
    return template.includes("{{title}}");
  }
};

// src/utils/link-conversion.ts
var import_obsidian3 = require("obsidian");
var LinkConverter = class {
  constructor(settings, plugin) {
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.md$/, "");
    const contentTypeInfo = this.getContentTypeForPath(path + ".md");
    let basePath = contentTypeInfo.basePath || "";
    let contentFolder = contentTypeInfo.contentFolder || "";
    let indexFileName = contentTypeInfo.indexFileName || "";
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => this.toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  getAstroUrlFromInternalLinkWithContext(link, currentFilePath, currentFileContentType) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let indexFileName = "";
    const targetContentType = this.getContentTypeForPath(path + ".md");
    if (!targetContentType.basePath && currentFileContentType.basePath) {
      basePath = currentFileContentType.basePath;
      indexFileName = currentFileContentType.indexFileName;
      contentFolder = currentFileContentType.contentFolder;
    } else {
      basePath = targetContentType.basePath;
      indexFileName = targetContentType.indexFileName;
      contentFolder = targetContentType.contentFolder;
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => this.toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  isInConfiguredContentDirectory(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled)
        continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return true;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return true;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return true;
            }
          }
        } else {
          return true;
        }
      }
    }
    return false;
  }
  getContentTypeForPath(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled)
        continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: ""
          };
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          } else {
            if (pathDepth === expectedDepth) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          }
        } else {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: contentType.folder
          };
        }
      }
    }
    return {
      basePath: "",
      creationMode: "file",
      indexFileName: "",
      contentFolder: ""
    };
  }
  convertWikilinksForAstro(editor, file) {
    if (!(file instanceof import_obsidian3.TFile)) {
      new import_obsidian3.Notice("No active file.");
      return;
    }
    const content = editor.getValue();
    let newContent = content;
    let convertedCount = 0;
    let skippedCount = 0;
    const skippedLinks = [];
    const currentFileContentType = this.getContentTypeForPath(file.path);
    const imageExtensions = /\.(png|jpg|jpeg|gif|svg)$/i;
    const canConvertLink = (linkText) => {
      if (imageExtensions.test(linkText)) {
        return false;
      }
      if (linkText.match(/^https?:\/\//)) {
        return false;
      }
      if (!linkText.includes(".md") && !linkText.match(/^[a-zA-Z0-9_-]+(\/[a-zA-Z0-9_-]+)*$/)) {
        return false;
      }
      const targetPath = linkText.endsWith(".md") ? linkText : linkText + ".md";
      const isInConfiguredDirectory = this.isInConfiguredContentDirectory(targetPath);
      const isSimpleFilename = !targetPath.includes("/");
      const hasCurrentContentType = currentFileContentType.basePath !== "" || currentFileContentType.creationMode !== "file" || currentFileContentType.indexFileName !== "";
      return isInConfiguredDirectory || isSimpleFilename && hasCurrentContentType;
    };
    newContent = newContent.replace(
      /\[\[([^\]|]+)(\|([^\]]+))?\]\]/g,
      (match, linkText, _pipe, displayText) => {
        if (imageExtensions.test(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        if (!canConvertLink(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        const display = displayText || linkText.replace(/\.md$/, "");
        const url = this.getAstroUrlFromInternalLinkWithContext(linkText, file.path, currentFileContentType);
        convertedCount++;
        return `[${display}](${url})`;
      }
    );
    newContent = newContent.replace(
      /\[([^\]]+)\]\(([^)]+\.md[^)]*)\)/g,
      (match, displayText, link) => {
        if (link.match(/^https?:\/\//) || imageExtensions.test(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        if (!canConvertLink(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        const url = this.getAstroUrlFromInternalLinkWithContext(link, file.path, currentFileContentType);
        convertedCount++;
        return `[${displayText}](${url})`;
      }
    );
    newContent = newContent.replace(
      /!\[(.*?)\]\(([^)]+)\)/g,
      (match) => {
        skippedCount++;
        return match;
      }
    );
    newContent = newContent.replace(/\{\{([^}]+)\}\}/g, (match, fileName) => {
      if (imageExtensions.test(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      if (!canConvertLink(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      const url = this.getAstroUrlFromInternalLinkWithContext(fileName, file.path, currentFileContentType);
      convertedCount++;
      return `[Embedded: ${fileName}](${url})`;
    });
    editor.setValue(newContent);
    if (convertedCount > 0 && skippedCount === 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} internal link${convertedCount > 1 ? "s" : ""} for Astro.`);
    } else if (convertedCount > 0 && skippedCount > 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} link${convertedCount > 1 ? "s" : ""} for Astro. Skipped ${skippedCount} link${skippedCount > 1 ? "s" : ""} outside configured content directories.`);
    } else if (skippedCount > 0) {
      new import_obsidian3.Notice(`No links converted. All ${skippedCount} link${skippedCount > 1 ? "s" : ""} are outside configured content directories or are images/external links.`);
    } else {
      new import_obsidian3.Notice("No internal links found to convert.");
    }
  }
};

// src/ui/title-modal.ts
var import_obsidian4 = require("obsidian");
var TitleModal = class extends import_obsidian4.Modal {
  constructor(app, file, plugin, type, isRename = false, isNewNote = false) {
    super(app);
    this.file = file;
    this.plugin = plugin;
    this.type = type;
    this.isRename = isRename;
    this.isNewNote = isNewNote;
    const settings = plugin.settings;
    this.fileOps = new FileOperations(app, settings, plugin);
    this.templateParser = new TemplateParser(app, settings);
  }
  getCurrentTitle() {
    if (!this.file) {
      return "";
    }
    const titleKey = this.fileOps.getTitleKey(this.type);
    const cache = this.app.metadataCache.getFileCache(this.file);
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    const fallbackTitle = basename.replace(/-/g, " ").split(" ").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
    if ((cache == null ? void 0 : cache.frontmatter) && titleKey in cache.frontmatter) {
      const titleValue = cache.frontmatter[titleKey];
      if (typeof titleValue === "string") {
        return titleValue;
      }
      if (Array.isArray(titleValue) && titleValue.length > 0) {
        const firstValue = titleValue[0];
        if (typeof firstValue === "string") {
          return firstValue;
        }
        if (firstValue != null) {
          if (typeof firstValue === "number" || typeof firstValue === "boolean") {
            return String(firstValue);
          }
          if (typeof firstValue === "string") {
            return firstValue;
          }
        }
      }
      if (titleValue == null) {
        return "";
      }
      if (typeof titleValue === "number" || typeof titleValue === "boolean") {
        return String(titleValue);
      }
      if (typeof titleValue === "string") {
        return titleValue;
      }
      return "";
    }
    return fallbackTitle;
  }
  /**
   * Extracts a suggested title from the file basename for newly created files.
   * This is used when a file is created from a link (e.g., [[sEfsleif]]).
   * Preserves the original text as much as possible.
   */
  getSuggestedTitleFromBasename() {
    if (!this.file) {
      return "";
    }
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    return basename;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const isMobile = window.innerWidth <= 768 || import_obsidian4.Platform.isMobile;
    if (isMobile) {
      this.modalEl.addClass("astro-composer-mobile-modal");
    }
    if (this.isRename) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "Rename content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Rename ${typeName} content` });
        contentEl.createEl("p", { text: `Enter new title for your ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      this.titleInput.value = this.getCurrentTitle();
    } else if (this.isNewNote) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
    } else {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      if (this.file) {
        const suggestedTitle = this.getSuggestedTitleFromBasename();
        if (suggestedTitle) {
          this.titleInput.value = suggestedTitle;
        }
      }
    }
    this.titleInput.focus();
    if (this.isNewNote) {
      setTimeout(() => {
        this.titleInput.setSelectionRange(0, 0);
      }, 0);
    }
    const buttonContainer = contentEl.createDiv({ cls: "astro-composer-button-container" });
    const cancelButton = buttonContainer.createEl("button", { text: "Cancel", cls: "astro-composer-cancel-button" });
    cancelButton.onclick = () => this.close();
    const submitButton = buttonContainer.createEl("button", { text: this.isRename ? "Rename" : "Create", cls: ["astro-composer-create-button", "mod-cta"] });
    submitButton.onclick = () => this.submit();
    this.titleInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter")
        void this.submit();
    });
  }
  async submit() {
    const title = this.titleInput.value.trim();
    if (!title) {
      new import_obsidian4.Notice("Please enter a title.");
      return;
    }
    try {
      let newFile = null;
      if (this.isRename) {
        newFile = await this.fileOps.renameFile({ file: this.file, title, type: this.type });
        if (newFile) {
          await this.templateParser.updateTitleInFrontmatter(newFile, title, this.type);
        } else {
          this.close();
          return;
        }
      } else if (this.isNewNote) {
        if (this.file) {
          newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
          const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
          if (newFile && shouldInsertProperties) {
            await this.addPropertiesToFile(newFile, title, this.type);
          }
        }
      } else if (this.file) {
        newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
        const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
        if (newFile && shouldInsertProperties) {
          await this.addPropertiesToFile(newFile, title, this.type);
        }
      } else {
        newFile = await this.createNewFile(title);
      }
      if (!newFile) {
        new import_obsidian4.Notice(`Failed to ${this.isRename ? "rename" : "create"} ${this.type}.`);
        this.close();
        return;
      }
    } catch (error) {
      console.error("TitleModal: Error during process:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian4.Notice(`Error ${this.isRename ? "renaming" : "creating"} ${this.type}: ${errorMessage}.`);
      this.close();
      return;
    }
    this.close();
  }
  getTypeDisplayName() {
    if (this.type === "note") {
      return "Content";
    }
    const contentType = this.fileOps.getContentType(this.type);
    return contentType ? contentType.name : "Content";
  }
  async createNewFile(title) {
    var _a, _b, _c;
    let targetFolder;
    const originalDir = ((_b = (_a = this.file) == null ? void 0 : _a.parent) == null ? void 0 : _b.path) || "";
    if (this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      if (originalDir === "" || originalDir === "/") {
        targetFolder = (contentType == null ? void 0 : contentType.folder) || "";
      } else {
        targetFolder = originalDir;
      }
    } else {
      targetFolder = originalDir;
    }
    const filename = this.fileOps.generateFilename(title);
    const filePath = targetFolder ? `${targetFolder}/${filename}.md` : `${filename}.md`;
    if (this.plugin && "pluginCreatedFiles" in this.plugin) {
      (_c = this.plugin.pluginCreatedFiles) == null ? void 0 : _c.add(filePath);
    }
    let initialContent = "";
    if (this.plugin.settings.autoInsertProperties) {
      initialContent = this.generateInitialContent(title);
    }
    try {
      const newFile = await this.app.vault.create(filePath, initialContent);
      await this.app.workspace.getLeaf().openFile(newFile);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      throw new Error(`Failed to create file: ${errorMessage}`);
    }
  }
  generateInitialContent(title) {
    const now = new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    let template;
    if (this.type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(this.type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    return template;
  }
  async addPropertiesToFile(file, title, type) {
    const now = new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    let template;
    if (type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    await this.app.vault.modify(file, template);
  }
  escapeYamlString(str) {
    if (str.includes('"') || str.includes("'") || str.includes("\n") || str.includes("\\")) {
      return `'${str.replace(/'/g, "''")}'`;
    } else if (str.includes(" ") || str.includes(":") || str.includes("#") || str.includes("@")) {
      return `"${str.replace(/"/g, '\\"')}"`;
    } else {
      return str;
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/commands/index.ts
function registerCommands(plugin, settings) {
  const isMobile = import_obsidian5.Platform.isMobile;
  if (isMobile) {
    let hasMatchingContentType2 = function(file, settings2) {
      const type = fileOps.determineType(file);
      if (type === "note") {
        return false;
      }
      const contentType = fileOps.getContentType(type);
      return contentType !== null && contentType.enabled;
    };
    var hasMatchingContentType = hasMatchingContentType2;
    const pluginInterface2 = plugin;
    const fileOps = new FileOperations(plugin.app, settings, pluginInterface2);
    const linkConverter = new LinkConverter(settings, pluginInterface2);
    plugin.addCommand({
      id: "standardize-properties",
      name: "Standardize properties",
      icon: "file-check",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          const currentSettings = pluginInterface2.settings || settings;
          void standardizeProperties(plugin.app, currentSettings, file, pluginInterface2);
        }
      }
    });
    plugin.addCommand({
      id: "convert-wikilinks-astro",
      name: "Convert internal links for astro",
      icon: "link-2",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          linkConverter.convertWikilinksForAstro(editor, file);
        }
      }
    });
    plugin.addCommand({
      id: "rename-content",
      name: "Rename current content",
      icon: "pencil",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          if (!hasMatchingContentType2(file, settings)) {
            new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
            return;
          }
          const type = fileOps.determineType(file);
          const cache = plugin.app.metadataCache.getFileCache(file);
          const titleKey = fileOps.getTitleKey(type);
          if (!(cache == null ? void 0 : cache.frontmatter) || !(titleKey in cache.frontmatter)) {
            new import_obsidian5.Notice(`Cannot rename: No ${titleKey} found in properties`);
            return;
          }
          new TitleModal(plugin.app, file, plugin, type, true).open();
        }
      }
    });
    return;
  }
  const pluginInterface = plugin;
  function hasMatchingContentType(file, settings2) {
    const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings2;
    const tempFileOps = new FileOperations(plugin.app, currentSettings, plugin);
    const type = tempFileOps.determineType(file);
    if (type === "note") {
      return false;
    }
    const contentType = tempFileOps.getContentType(type);
    return contentType !== null && contentType.enabled;
  }
  plugin.addCommand({
    id: "standardize-properties",
    name: "Standardize properties",
    icon: "file-check",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        void standardizeProperties(plugin.app, settings, file, plugin);
      }
    }
  });
  plugin.addCommand({
    id: "convert-wikilinks-astro",
    name: "Convert internal links for astro",
    icon: "link-2",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentLinkConverter = new LinkConverter(currentSettings, pluginInterface);
        currentLinkConverter.convertWikilinksForAstro(editor, file);
      }
    }
  });
  plugin.addCommand({
    id: "rename-content",
    name: "Rename current content",
    icon: "pencil",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentFileOps = new FileOperations(plugin.app, currentSettings, pluginInterface);
        if (!hasMatchingContentType(file, currentSettings)) {
          new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
          return;
        }
        const type = currentFileOps.determineType(file);
        new TitleModal(plugin.app, file, pluginInterface, type, true).open();
      }
    }
  });
  if (!isMobile) {
    plugin.addCommand({
      id: "open-project-terminal",
      name: "Open project terminal",
      icon: "terminal-square",
      callback: async () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenTerminalCommand) {
          new import_obsidian5.Notice("Open terminal command is disabled. Enable it in settings to use this command.");
          return;
        }
        await openTerminalInProjectRoot(plugin.app, currentSettings);
      }
    });
  }
  if (!isMobile) {
    plugin.addCommand({
      id: "edit-astro-config",
      name: "Edit astro config",
      icon: "wrench",
      callback: async () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenConfigFileCommand) {
          new import_obsidian5.Notice("Edit config file command is disabled. Enable it in settings to use this command.");
          return;
        }
        await openConfigFile(plugin.app, currentSettings);
      }
    });
  }
}
async function standardizeProperties(app, settings, file, plugin) {
  const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings;
  const templateParser = new TemplateParser(app, currentSettings);
  const fileOps = new FileOperations(app, currentSettings, plugin);
  const type = fileOps.determineType(file);
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  let templateString;
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  const contentType = fileOps.getContentType(type);
  if (!contentType) {
    new import_obsidian5.Notice("Content type not found.");
    return;
  }
  templateString = contentType.template;
  await new Promise((resolve) => setTimeout(resolve, 100));
  const content = await app.vault.read(file);
  const title = file.basename.replace(/^_/, "");
  const parsed = templateParser.parseFrontmatter(content);
  const { templateProps, templateValues } = templateParser.parseTemplate(templateString, title);
  const finalProps = { ...parsed.properties };
  const arrayKeys = /* @__PURE__ */ new Set();
  for (const key of templateProps) {
    if (!(key in parsed.properties)) {
      const templateValue = templateValues[key];
      if (Array.isArray(templateValue)) {
        finalProps[key] = templateValue;
        arrayKeys.add(key);
      } else {
        finalProps[key] = [templateValue || ""];
      }
    } else {
      const templateValue = templateValues[key];
      const isArrayValue = Array.isArray(templateValue);
      if (isArrayValue) {
        const existingItems = parsed.properties[key] || [];
        const newItems = templateValue.filter((item) => !existingItems.includes(item));
        finalProps[key] = [...existingItems, ...newItems];
        arrayKeys.add(key);
      }
    }
  }
  for (const key in parsed.properties) {
    if (parsed.properties[key].length > 1) {
      arrayKeys.add(key);
    }
  }
  const newContent = templateParser.buildFrontmatterContent(finalProps, arrayKeys) + parsed.bodyContent;
  await app.vault.modify(file, newContent);
  new import_obsidian5.Notice("Properties standardized using template.");
}
async function renameContentByPath(app, filePath, settings, plugin) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (!(file instanceof import_obsidian5.TFile)) {
    new import_obsidian5.Notice(`File not found: ${filePath}`);
    return;
  }
  const fileOps = new FileOperations(app, settings, plugin);
  function hasMatchingContentType(file2, settings2) {
    const type2 = fileOps.determineType(file2);
    if (type2 === "note") {
      return false;
    }
    const contentType = fileOps.getContentType(type2);
    return contentType !== null && contentType.enabled;
  }
  if (!hasMatchingContentType(file, settings)) {
    new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
    return;
  }
  const type = fileOps.determineType(file);
  new TitleModal(app, file, plugin, type, true).open();
}
async function openTerminalInProjectRoot(app, settings) {
  try {
    const { exec } = require("child_process");
    const path = require("path");
    const fs = require("fs");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    let projectPath;
    if (settings.terminalProjectRootPath && settings.terminalProjectRootPath.trim()) {
      projectPath = path.resolve(vaultPathString, settings.terminalProjectRootPath);
    } else {
      projectPath = vaultPathString;
    }
    if (!fs.existsSync(projectPath)) {
      new import_obsidian5.Notice(`Project root directory not found at: ${projectPath}`);
      return;
    }
    const platform = process.platform;
    let command;
    if (platform === "win32") {
      exec("where wt", (error) => {
        if (!error) {
          exec(`wt -d "${projectPath}"`, (execError) => {
            if (execError) {
              exec(`cmd /k cd /d "${projectPath}"`, (cmdError) => {
                if (cmdError) {
                  new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
                }
              });
            }
          });
        } else {
          exec(`cmd /k cd /d "${projectPath}"`, (cmdError) => {
            if (cmdError) {
              new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
            }
          });
        }
      });
      return;
    } else if (platform === "darwin") {
      command = `osascript -e 'tell application "Terminal" to do script "cd \\"${projectPath}\\" && bash"'`;
    } else {
      const terminals = [
        `gnome-terminal --working-directory="${projectPath}"`,
        `konsole --workdir "${projectPath}"`,
        `xterm -e "cd \\"${projectPath}\\" && bash"`
      ];
      const tryTerminal = (index) => {
        if (index >= terminals.length) {
          new import_obsidian5.Notice("No supported terminal found. Please install gnome-terminal, konsole, or xterm.");
          return;
        }
        exec(`which ${terminals[index].split(" ")[0]}`, (error) => {
          if (!error) {
            exec(terminals[index], (execError) => {
              if (execError && index < terminals.length - 1) {
                tryTerminal(index + 1);
              } else if (execError) {
                new import_obsidian5.Notice(`Error opening terminal: ${execError.message || "Unknown error"}`);
              }
            });
          } else {
            tryTerminal(index + 1);
          }
        });
      };
      tryTerminal(0);
      return;
    }
    if (command) {
      exec(command, (error) => {
        if (error) {
          new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
        }
      });
    }
  } catch (error) {
    new import_obsidian5.Notice(`Error opening terminal: ${error instanceof Error ? error.message : String(error)}`);
  }
}
async function openConfigFile(app, settings) {
  try {
    const fs = require("fs");
    const path = require("path");
    const { shell } = require("electron");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    if (!settings.configFilePath || !settings.configFilePath.trim()) {
      new import_obsidian5.Notice("Please specify a config file path in settings.");
      return;
    }
    const configPath = path.resolve(vaultPathString, settings.configFilePath);
    if (!fs.existsSync(configPath)) {
      new import_obsidian5.Notice(`Config file not found at: ${configPath}`);
      return;
    }
    await shell.openPath(configPath);
  } catch (error) {
    new import_obsidian5.Notice(`Error opening config file: ${error instanceof Error ? error.message : String(error)}`);
  }
}

// src/ui/settings-tab.ts
var import_obsidian10 = require("obsidian");

// src/ui/components/CommandPickerModal.ts
var import_obsidian6 = require("obsidian");
var CommandPickerModal = class extends import_obsidian6.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    const commandRegistry = this.app.commands;
    const commandMap = /* @__PURE__ */ new Map();
    if (commandRegistry && typeof commandRegistry.listCommands === "function") {
      try {
        const commands = commandRegistry.listCommands();
        for (const command of commands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting commands via listCommands():", e);
      }
    }
    try {
      const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
      if (registry && typeof registry === "object") {
        const allCommands = Object.values(registry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via registry:", e);
    }
    try {
      const internalRegistry = commandRegistry == null ? void 0 : commandRegistry.commandRegistry;
      if (internalRegistry && typeof internalRegistry === "object") {
        const allCommands = Object.values(internalRegistry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via internal registry:", e);
    }
    const commandOptions = Array.from(commandMap.values());
    commandOptions.sort((a, b) => a.name.localeCompare(b.name));
    return commandOptions;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    this.onSelect(item.id);
  }
  // Override to show command name only
  renderSuggestion(match, el) {
    const item = match.item;
    el.createDiv({ cls: "suggestion-title", text: item.name });
  }
};

// src/ui/components/IconPickerModal.ts
var import_obsidian7 = require("obsidian");
var getIconList = () => {
  if (import_obsidian7.requireApiVersion && (0, import_obsidian7.requireApiVersion)("1.7.3") && import_obsidian7.getIconIds) {
    try {
      return (0, import_obsidian7.getIconIds)();
    } catch (e) {
      console.warn("[Astro Composer] Error getting icon IDs from Obsidian:", e);
    }
  }
  return [
    "settings-2",
    "settings",
    "help-circle",
    "info",
    "star",
    "heart",
    "bookmark",
    "home",
    "search",
    "bell",
    "mail",
    "user",
    "users",
    "folder",
    "file",
    "file-text",
    "image",
    "video",
    "music",
    "calendar",
    "clock",
    "edit",
    "pencil",
    "trash",
    "copy",
    "cut",
    "paste",
    "download",
    "upload",
    "save",
    "share",
    "link",
    "external-link",
    "lock",
    "unlock",
    "eye",
    "eye-off",
    "key",
    "shield",
    "check",
    "x",
    "plus",
    "minus",
    "arrow-left",
    "arrow-right",
    "arrow-up",
    "arrow-down",
    "chevron-left",
    "chevron-right",
    "chevron-up",
    "chevron-down",
    "menu",
    "more-horizontal",
    "more-vertical",
    "grid",
    "list",
    "layout",
    "columns",
    "rows",
    "maximize",
    "minimize",
    "zoom-in",
    "zoom-out",
    "refresh-cw",
    "play",
    "pause",
    "stop",
    "sun",
    "moon",
    "cloud",
    "zap",
    "wand-2",
    "wand",
    "wand-sparkles",
    "palette",
    "brush",
    "sliders",
    "power",
    "wifi",
    "bluetooth",
    "monitor",
    "laptop",
    "smartphone",
    "camera",
    "mic",
    "headphones",
    "code",
    "terminal",
    "terminal-square",
    "github",
    "gitlab",
    "git-branch",
    "git-commit",
    "database",
    "server",
    "cloud-download",
    "cloud-upload",
    "tag",
    "tags",
    "flag",
    "pin",
    "map-pin",
    "compass",
    "globe",
    "rocket",
    "car",
    "bike",
    "robot",
    "apple",
    "windows",
    "linux",
    "chrome",
    "firefox",
    "safari",
    "credit-card",
    "wallet",
    "coins",
    "book",
    "book-open",
    "award",
    "trophy",
    "badge",
    "wrench",
    "tool",
    "package",
    "box",
    "archive",
    "send",
    "reply",
    "forward",
    "mail-open",
    "tag-plus",
    "tag-minus",
    "flag-off",
    "pin-off",
    "map-pin-off",
    "navigation",
    "map",
    "earth",
    "plane",
    "ship",
    "anchor",
    "helicopter",
    "drone",
    "android",
    "keyhole",
    "keys",
    "fingerprint",
    "scan",
    "qr-code",
    "barcode",
    "receipt",
    "piggy-bank",
    "banknote"
  ];
};
var LUCIDE_ICONS = getIconList().map((id) => ({
  id,
  name: id.replace(/^lucide-/, "").replace(/-/g, " ").replace(/(^\w{1})|(\s+\w{1})/g, (letter) => letter.toUpperCase())
})).sort((a, b) => a.name.localeCompare(b.name));
var IconPickerModal = class extends import_obsidian7.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    return LUCIDE_ICONS;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    this.onSelect(item.id);
  }
  // Override to show icon preview
  renderSuggestion(match, el) {
    const item = match.item;
    el.addClass("mod-complex");
    const content = el.createDiv({ cls: "suggestion-content" });
    content.createDiv({ cls: "suggestion-title", text: item.name });
    const aux = el.createDiv({ cls: "suggestion-aux" });
    (0, import_obsidian7.setIcon)(aux.createSpan({ cls: "suggestion-flair" }), item.id);
  }
};

// src/ui/components/ConfirmModal.ts
var import_obsidian8 = require("obsidian");
var ConfirmModal = class extends import_obsidian8.Modal {
  constructor(app, message, confirmText = "Confirm", cancelText = "Cancel") {
    super(app);
    this.message = message;
    this.confirmText = confirmText;
    this.cancelText = cancelText;
    this.result = false;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-confirm-modal");
    contentEl.createEl("p", { text: this.message });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const cancelButton = buttonContainer.createEl("button", {
      text: this.cancelText
    });
    cancelButton.onclick = () => {
      this.result = false;
      this.close();
    };
    const confirmButton = buttonContainer.createEl("button", {
      text: this.confirmText,
      cls: "mod-cta mod-warning"
    });
    confirmButton.onclick = () => {
      this.result = true;
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/utils/settings-compat.ts
var import_obsidian9 = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"));
function createSettingsGroup(containerEl, heading) {
  if ((0, import_obsidian9.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian9.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/ui/settings-tab.ts
var AstroComposerSettingTab = class extends import_obsidian10.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.autoRenameContainer = null;
    this.postsFolderContainer = null;
    this.onlyAutomateContainer = null;
    this.creationModeContainer = null;
    this.indexFileContainer = null;
    this.excludedDirsContainer = null;
    this.underscorePrefixContainer = null;
    this.autoInsertContainer = null;
    this.pagesFieldsContainer = null;
    this.pagesIndexFileContainer = null;
    this.pagesOnlyAutomateContainer = null;
    this.terminalCommandContainer = null;
    this.configCommandContainer = null;
    this.customContentTypesContainer = null;
    this.terminalRibbonToggle = null;
    this.configRibbonToggle = null;
    this.terminalRibbonToggleComponent = null;
    this.configRibbonToggleComponent = null;
    this.plugin = plugin;
  }
  /**
   * Refresh just the content types section
   * More efficient than refreshing the entire settings tab
   */
  refreshContentTypes() {
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const settings = this.plugin.settings;
    this.renderSettingsTab(containerEl, settings);
  }
  renderSettingsTab(containerEl, settings) {
    var _a;
    const generalGroup = createSettingsGroup(containerEl);
    generalGroup.addSetting((setting) => {
      setting.setName("Date format").setDesc("Format for the date in properties (e.g., yyyy-mm-dd, MMMM D, yyyy, yyyy-mm-dd HH:mm)").addText(
        (text) => text.setPlaceholder("YYYY-MM-DD").setValue(settings.dateFormat).onChange(async (value) => {
          settings.dateFormat = value || "YYYY-MM-DD";
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Enable copy heading links").setDesc("Add right-click context menu option to copy heading links in various formats.").addToggle(
        (toggle) => toggle.setValue(settings.enableCopyHeadingLink).onChange(async (value) => {
          settings.enableCopyHeadingLink = value;
          await this.plugin.saveSettings();
          this.updateCopyHeadingFields();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Default heading link format").setDesc("Choose the default format for copied heading links. Obsidian format respects your Obsidian settings for wikilink vs markdown preference. Astro link uses your link base path from above and converts the heading into kebab-case format as an anchor link").addDropdown(
        (dropdown) => dropdown.addOption("obsidian", "Obsidian link").addOption("astro", "Astro link").setValue(settings.copyHeadingLinkFormat).onChange(async (value) => {
          settings.copyHeadingLinkFormat = value;
          await this.plugin.saveSettings();
        })
      );
      setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableCopyHeadingLink);
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableCopyHeadingLink);
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Add trailing slash to links").setDesc("Add trailing slashes to all converted internal links (e.g., /about/ instead of /about).").addToggle(
        (toggle) => toggle.setValue(settings.addTrailingSlashToLinks).onChange(async (value) => {
          settings.addTrailingSlashToLinks = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Auto-insert properties").setDesc("Automatically insert the properties template when creating new files for any content type.").addToggle(
        (toggle) => toggle.setValue(settings.autoInsertProperties).onChange(async (value) => {
          settings.autoInsertProperties = value;
          await this.plugin.saveSettings();
        })
      );
    });
    const contentTypesGroup = createSettingsGroup(containerEl, "Content types");
    contentTypesGroup.addSetting((setting) => {
      setting.settingEl.addClass("astro-composer-setting-hidden-elements");
      setting.settingEl.addClass("astro-composer-setting-container-full-width");
      this.customContentTypesContainer = setting.settingEl.createDiv({
        cls: "custom-content-types-container astro-composer-custom-types-container-visible"
      });
    });
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
    if (!import_obsidian10.Platform.isMobile) {
      const developerGroup = createSettingsGroup(containerEl, "Developer commands");
      developerGroup.addSetting((setting) => {
        setting.setName("Enable open terminal command").setDesc("Enable command to open terminal in project root directory.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenTerminalCommand).onChange(async (value) => {
            settings.enableOpenTerminalCommand = value;
            await this.plugin.saveSettings();
            this.updateTerminalCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.terminalCommandContainer = containerEl.createDiv({ cls: "terminal-command-fields" });
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path relative to the Obsidian vault root folder. Use ../.. for two levels up. Leave blank to use the vault folder" });
        descFragment.createEl("div", { text: "This is where the terminal will open. Absolute paths work also." });
        setting.setName("Project root directory path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../..").setValue(settings.terminalProjectRootPath).onChange(async (value) => {
            settings.terminalProjectRootPath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open terminal ribbon icon").setDesc("Add a ribbon icon to launch the terminal command.").addToggle((toggle) => {
          this.terminalRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableTerminalRibbonIcon).setDisabled(!settings.enableOpenTerminalCommand).onChange(async (value) => {
            this.plugin.settings.enableTerminalRibbonIcon = value;
            settings.enableTerminalRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
        this.terminalRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Enable edit config file command").setDesc("Enable command to open astro config file in default editor.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenConfigFileCommand).onChange(async (value) => {
            settings.enableOpenConfigFileCommand = value;
            await this.plugin.saveSettings();
            this.updateConfigCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.configCommandContainer = containerEl.createDiv({ cls: "config-command-fields" });
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path to the config file relative to the vault root. Use ../config.ts or ../../astro.config.mjs." });
        descFragment.createEl("div", { text: "Absolute paths work also." });
        setting.setName("Config file path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../config.ts").setValue(settings.configFilePath).onChange(async (value) => {
            settings.configFilePath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open config ribbon icon").setDesc("Add a ribbon icon to launch the config file command.").addToggle((toggle) => {
          this.configRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableConfigRibbonIcon).setDisabled(!settings.enableOpenConfigFileCommand).onChange(async (value) => {
            this.plugin.settings.enableConfigRibbonIcon = value;
            settings.enableConfigRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
        this.configRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Swap out help button for custom action").setDesc("Replace the help button in the vault profile area with a custom action.").addToggle((toggle) => {
          var _a2, _b;
          return toggle.setValue((_b = (_a2 = settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) != null ? _b : false).onChange(async (value) => {
            if (!settings.helpButtonReplacement) {
              settings.helpButtonReplacement = {
                enabled: false,
                commandId: "edit-astro-config",
                iconId: "wrench"
              };
            }
            settings.helpButtonReplacement.enabled = value;
            await this.plugin.saveSettings();
            if (this.plugin.updateHelpButton) {
              await this.plugin.updateHelpButton();
            }
            this.display();
          });
        });
      });
      if ((_a = settings.helpButtonReplacement) == null ? void 0 : _a.enabled) {
        const commandName = this.getCommandName(settings.helpButtonReplacement.commandId);
        developerGroup.addSetting((setting) => {
          setting.setName("Command").setDesc("Select the command to execute when the button is clicked.").addButton((button) => button.setButtonText(commandName || "Select command").onClick(() => {
            const modal = new CommandPickerModal(this.app, (commandId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "wrench"
                  };
                }
                settings.helpButtonReplacement.commandId = commandId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
        const iconName = this.getIconName(settings.helpButtonReplacement.iconId);
        developerGroup.addSetting((setting) => {
          setting.setName("Icon").setDesc("Select the icon to display on the button.").addButton((button) => button.setButtonText(iconName || "Select icon...").onClick(() => {
            const modal = new IconPickerModal(this.app, (iconId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "wrench"
                  };
                }
                settings.helpButtonReplacement.iconId = iconId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
      }
    }
    this.updateCopyHeadingFields();
    if (!import_obsidian10.Platform.isMobile) {
      this.updateTerminalCommandFields();
      this.updateConfigCommandFields();
    }
  }
  updateCopyHeadingFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableCopyHeadingLink;
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl && ((_a = nameEl.textContent) == null ? void 0 : _a.trim()) === "Default heading link format") {
        settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
        settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
      }
    });
  }
  updateTerminalCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenTerminalCommand;
    if (this.terminalCommandContainer) {
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Project root directory path" || name === "Show open terminal ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.terminalRibbonToggleComponent) {
      this.terminalRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenTerminalCommand);
    }
  }
  updateConfigCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenConfigFileCommand;
    if (this.configCommandContainer) {
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Config file path" || name === "Show open config ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.configRibbonToggleComponent) {
      this.configRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenConfigFileCommand);
    }
  }
  checkForFolderConflicts() {
    const settings = this.plugin.settings;
    const blankFolders = [];
    const folderConflicts = {};
    const contentTypes = settings.contentTypes || [];
    for (const contentType of contentTypes) {
      if (contentType.enabled) {
        if (!contentType.folder || contentType.folder.trim() === "") {
          blankFolders.push(contentType.name || "Content");
        } else {
          if (!folderConflicts[contentType.folder]) {
            folderConflicts[contentType.folder] = [];
          }
          folderConflicts[contentType.folder].push(contentType.name || "Content");
        }
      }
    }
  }
  addCustomContentType() {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const newType = {
      id: `content-${Date.now()}`,
      name: `Content ${contentTypes.length + 1}`,
      folder: "",
      linkBasePath: "",
      template: '---\ntitle: "{{title}}"\ndate: {{date}}\n---\n',
      enabled: true,
      creationMode: "file",
      indexFileName: "",
      ignoreSubfolders: false,
      enableUnderscorePrefix: false
    };
    contentTypes.push(newType);
    settings.contentTypes = contentTypes;
    void this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
  }
  renderCustomContentTypes() {
    if (!this.customContentTypesContainer)
      return;
    this.customContentTypesContainer.empty();
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    contentTypes.forEach((customType, index) => {
      var _a, _b;
      if (!this.customContentTypesContainer)
        return;
      const typeContainer = this.customContentTypesContainer.createDiv({
        cls: "custom-content-type-item",
        attr: { "data-type-id": customType.id }
      });
      const header = typeContainer.createDiv({ cls: "custom-content-type-header" });
      header.classList.add("astro-composer-custom-type-header");
      const collapseButton = header.createEl("button", {
        cls: "astro-composer-collapse-button",
        attr: { "aria-label": "Collapse/expand" }
      });
      const isCollapsed = (_a = customType.collapsed) != null ? _a : false;
      (0, import_obsidian10.setIcon)(collapseButton, "chevron-down");
      if (isCollapsed) {
        collapseButton.classList.add("is-collapsed");
      }
      collapseButton.addEventListener("click", () => {
        void this.toggleContentTypeCollapse(customType.id);
        const updatedType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
        if (updatedType) {
          if (updatedType.collapsed) {
            collapseButton.classList.add("is-collapsed");
          } else {
            collapseButton.classList.remove("is-collapsed");
          }
        }
      });
      const headerName = header.createDiv({ cls: "astro-composer-header-name" });
      headerName.createEl("div", { text: customType.name || `Content ${index + 1}`, cls: "setting-item-name" });
      const reorderContainer = header.createDiv({ cls: "astro-composer-reorder-buttons" });
      const upButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move up" }
      });
      (0, import_obsidian10.setIcon)(upButton, "chevron-up");
      upButton.disabled = index === 0;
      upButton.addEventListener("click", () => {
        void this.moveContentTypeUp(customType.id);
      });
      const downButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move down" }
      });
      (0, import_obsidian10.setIcon)(downButton, "chevron-down");
      downButton.disabled = index === contentTypes.length - 1;
      downButton.addEventListener("click", () => {
        void this.moveContentTypeDown(customType.id);
      });
      const toggleContainer = header.createDiv({ cls: "checkbox-container" });
      if (customType.enabled) {
        toggleContainer.classList.add("is-enabled");
      }
      const toggle = toggleContainer.createEl("input", { type: "checkbox", cls: "checkbox-input" });
      toggle.checked = customType.enabled;
      toggleContainer.addEventListener("click", (e) => {
        void (async () => {
          e.preventDefault();
          const newValue = !customType.enabled;
          customType.enabled = newValue;
          toggle.checked = newValue;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (newValue) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, newValue);
        })();
      });
      toggle.addEventListener("change", (e) => {
        void (async () => {
          const value = e.target.checked;
          customType.enabled = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (value) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, value);
        })();
      });
      const settingsContainer = typeContainer.createDiv({
        cls: "custom-content-type-settings",
        attr: { "data-type-id": customType.id }
      });
      const initiallyCollapsed = (_b = customType.collapsed) != null ? _b : false;
      const initiallyVisible = customType.enabled && !initiallyCollapsed;
      if (initiallyVisible) {
        settingsContainer.classList.add("astro-composer-setting-container-visible");
      } else {
        settingsContainer.classList.add("astro-composer-setting-container-hidden");
      }
      const nameContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(nameContainer).setName("Content type name").setDesc("Display name for this content type (e.g., 'projects', 'notes', 'tutorials')").addText((text) => {
        text.setPlaceholder("Enter content type name").setValue(customType.name).onChange(async (value) => {
          customType.name = value;
          await this.plugin.saveSettings();
        });
      });
      const folderContainer = settingsContainer.createDiv();
      const folderSetting = new import_obsidian10.Setting(folderContainer).setName("Folder location").setDesc("Folder path where this content type will be created. Leave blank to use the vault folder. Supports wildcards like directory/* or directory/*/* to match specific folder depths.").addText((text) => {
        text.setPlaceholder("Enter folder path (e.g., 'docs', 'docs/*', 'docs/*/*') or leave blank for vault root").setValue(customType.folder).onChange(async (value) => {
          customType.folder = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          this.updateCustomContentTypeIgnoreSubfoldersField(customType.id);
          const allContentTypes = this.plugin.settings.contentTypes || [];
          for (const ct of allContentTypes) {
            this.updateFolderConflictWarning(ct.id, null);
          }
        });
      });
      folderContainer.createDiv({ cls: "astro-composer-conflict-warning hidden", attr: { "data-type-id": customType.id } });
      this.updateFolderConflictWarning(customType.id, folderSetting);
      const ignoreSubfoldersContainer = settingsContainer.createDiv({ cls: "custom-ignore-subfolders-field" });
      ignoreSubfoldersContainer.setAttribute("data-type-id", customType.id);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder);
      new import_obsidian10.Setting(ignoreSubfoldersContainer).setName("Ignore subfolders").setDesc("When enabled, automation will only trigger for new .md files within this content type's folder and one level down (for folder-based content). Files in deeper subfolders will be ignored.").addToggle(
        (toggle2) => toggle2.setValue(customType.ignoreSubfolders || false).onChange(async (value) => {
          customType.ignoreSubfolders = value;
          await this.plugin.saveSettings();
        })
      );
      const underscorePrefixContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(underscorePrefixContainer).setName("Use underscore prefix for drafts").setDesc("Add an underscore prefix (_content-title) to new notes by default when enabled. This hides them from astro, which can be helpful for drafts").addToggle(
        (toggle2) => toggle2.setValue(customType.enableUnderscorePrefix || false).onChange(async (value) => {
          customType.enableUnderscorePrefix = value;
          await this.plugin.saveSettings();
        })
      );
      const linkContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(linkContainer).setName("Link base path").setDesc("Base path for converted links (e.g., '/projects/', '/notes/tutorials/', leave blank for root /).").addText((text) => {
        text.setPlaceholder("Enter link base path").setValue(customType.linkBasePath || "").onChange(async (value) => {
          customType.linkBasePath = value;
          await this.plugin.saveSettings();
        });
      });
      const creationModeContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(creationModeContainer).setName("Creation mode").setDesc("How to create new entries: file-based or folder-based with an index file.").addDropdown(
        (dropdown) => dropdown.addOption("file", "File-based (content-title.md)").addOption("folder", "Folder-based (content-title/index.md)").setValue(customType.creationMode).onChange(async (value) => {
          customType.creationMode = value;
          await this.plugin.saveSettings();
          this.updateCustomContentTypeIndexFileField(customType.id);
        })
      );
      const indexFileContainer = settingsContainer.createDiv({ cls: "custom-index-file-field" });
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
      new import_obsidian10.Setting(indexFileContainer).setName("Index file name").setDesc("Name for index files in folder-based content (without .md extension). Defaults to 'index' if left blank.").addText(
        (text) => text.setPlaceholder("Index").setValue(customType.indexFileName).onChange(async (value) => {
          customType.indexFileName = value;
          await this.plugin.saveSettings();
        })
      );
      const templateContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(templateContainer).setName("Properties template").addTextArea((text) => {
        text.setPlaceholder('---\ntitle: "{{title}}"\ndate: {{date}}\n---\n').setValue(customType.template).onChange(async (value) => {
          customType.template = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.classList.add("astro-composer-template-textarea");
        return text;
      }).then((setting) => {
        setting.descEl.empty();
        const descDiv = setting.descEl.createEl("div");
        descDiv.createEl("div", { text: "Template for new files of this content type." });
        descDiv.createEl("div", { text: "Variables include {{title}} and {{date}}." });
        descDiv.createEl("div", { text: "Do not wrap {{date}} in quotes as it represents a datetime value, not a string." });
      });
      const removeContainer = settingsContainer.createDiv();
      const removeSetting = new import_obsidian10.Setting(removeContainer).setName("").addButton((button) => {
        button.setButtonText("Remove").setWarning().onClick(async () => {
          const contentType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
          const typeName = (contentType == null ? void 0 : contentType.name) || "content type";
          const modal = new ConfirmModal(
            this.app,
            `Are you sure you want to remove "${typeName}"? This action cannot be undone.`,
            "Remove",
            "Cancel"
          );
          const confirmed = await modal.waitForResult();
          if (confirmed) {
            await this.removeCustomContentType(customType.id);
          }
        });
      });
      removeSetting.settingEl.classList.add("astro-composer-remove-setting");
      this.updateCustomContentTypeVisibility(customType.id, customType.enabled);
    });
    contentTypes.forEach((customType) => {
      this.updateFolderConflictWarning(customType.id, null);
    });
    const addButtonContainer = this.customContentTypesContainer.createDiv({ cls: "astro-composer-add-button-container" });
    const addButton = addButtonContainer.createEl("button", {
      cls: "mod-cta",
      text: "Add content type"
    });
    addButton.addEventListener("click", () => {
      this.addCustomContentType();
    });
  }
  updateCustomContentTypeVisibility(typeId, enabled) {
    var _a, _b;
    const settingsContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-content-type-settings`);
    if (settingsContainer) {
      const contentTypes = this.plugin.settings.contentTypes || [];
      const contentType = contentTypes.find((ct) => ct.id === typeId);
      const isCollapsed = (_b = contentType == null ? void 0 : contentType.collapsed) != null ? _b : false;
      const shouldBeVisible = enabled && !isCollapsed;
      settingsContainer.classList.toggle("astro-composer-setting-container-visible", shouldBeVisible);
      settingsContainer.classList.toggle("astro-composer-setting-container-hidden", !shouldBeVisible);
    }
  }
  updateCustomContentTypeIndexFileField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType)
      return;
    const indexFileContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"] .custom-index-file-field`);
    if (indexFileContainer) {
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
    }
  }
  updateCustomContentTypeIgnoreSubfoldersField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType)
      return;
    const ignoreSubfoldersContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-ignore-subfolders-field`);
    if (ignoreSubfoldersContainer) {
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder && customType.folder.trim() !== "");
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder || customType.folder.trim() === "");
    }
  }
  updateFolderConflictWarning(typeId, setting) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const currentType = contentTypes.find((type) => type.id === typeId);
    if (!currentType)
      return;
    const conflictWarningEl = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].astro-composer-conflict-warning`);
    if (!conflictWarningEl)
      return;
    const currentFolder = (currentType.folder || "").trim();
    const conflictingTypes = [];
    for (const otherType of contentTypes) {
      if (otherType.id === typeId || !otherType.enabled)
        continue;
      const otherFolder = (otherType.folder || "").trim();
      if (currentFolder === "" && otherFolder === "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      } else if (currentFolder === otherFolder && currentFolder !== "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      }
    }
    if (conflictingTypes.length > 0) {
      conflictWarningEl.removeClass("hidden");
      conflictWarningEl.textContent = `Conflict: ${conflictingTypes.join(", ")} also use${conflictingTypes.length === 1 ? "s" : ""} this folder. More specific patterns will take priority.`;
    } else {
      conflictWarningEl.addClass("hidden");
    }
  }
  async moveContentTypeUp(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex <= 0)
      return;
    [contentTypes[currentIndex], contentTypes[currentIndex - 1]] = [contentTypes[currentIndex - 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async moveContentTypeDown(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex < 0 || currentIndex >= contentTypes.length - 1)
      return;
    [contentTypes[currentIndex], contentTypes[currentIndex + 1]] = [contentTypes[currentIndex + 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async toggleContentTypeCollapse(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === typeId);
    if (!contentType)
      return;
    contentType.collapsed = !contentType.collapsed;
    await this.plugin.saveSettings();
    this.updateCustomContentTypeVisibility(typeId, contentType.enabled);
  }
  async removeCustomContentType(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    settings.contentTypes = contentTypes.filter((ct) => ct.id !== typeId);
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
  }
  getCommandName(commandId) {
    if (!commandId)
      return "";
    try {
      const commandRegistry = this.app.commands;
      if (commandRegistry && typeof commandRegistry.listCommands === "function") {
        try {
          const allCommands = commandRegistry.listCommands();
          const command = allCommands.find((cmd) => cmd.id === commandId);
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        } catch (e) {
          console.warn("[Astro Composer] Error getting command name via listCommands():", e);
        }
      }
      try {
        const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
        if (registry && typeof registry === "object") {
          const command = registry[commandId];
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting command name via registry:", e);
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting command name:", e);
    }
    return "";
  }
  getIconName(iconId) {
    if (!iconId)
      return "";
    return iconId.replace(/^lucide-/, "").split("-").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
};

// src/ui/components/MigrationModal.ts
var import_obsidian11 = require("obsidian");
var MigrationModal = class extends import_obsidian11.Modal {
  constructor(app, conflicts) {
    super(app);
    this.result = null;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-migration-modal");
    contentEl.createEl("h2", { text: "Migration conflict detected" });
    contentEl.createEl("p", {
      text: "You have existing content types with names that conflict with posts or pages. How would you like to proceed?"
    });
    const conflictList = contentEl.createEl("ul");
    conflictList.createEl("li", { text: "Skip migration: keep your existing posts/pages settings (they will be ignored)" });
    conflictList.createEl("li", { text: "Migrate with renamed types: create 'posts (migrated)' and 'pages (migrated)' content types" });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const skipButton = buttonContainer.createEl("button", {
      text: "Skip migration",
      cls: "mod-cta"
    });
    skipButton.onclick = () => {
      this.result = { action: "skip" };
      this.close();
    };
    const migrateButton = buttonContainer.createEl("button", {
      text: "Migrate with renamed types",
      cls: "mod-cta"
    });
    migrateButton.onclick = () => {
      this.result = { action: "migrate" };
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise && this.result) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/utils/heading-link-generator.ts
var HeadingLinkGenerator = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Converts text to kebab-case slug for URLs
   */
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  /**
   * Gets the Astro-compatible URL from an internal link (copied from LinkConverter)
   */
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let creationMode = "file";
    let indexFileName = "";
    const contentTypes = this.settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled)
        continue;
      let matches = false;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!path.includes("/") || path.split("/").length === 1) {
          matches = true;
        }
      } else if (matchesFolderPattern(path, contentType.folder)) {
        matches = true;
      }
      if (matches) {
        contentFolder = contentType.folder || "";
        basePath = contentType.linkBasePath || "";
        creationMode = contentType.creationMode;
        indexFileName = contentType.indexFileName || "";
        break;
      }
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    if (indexFileName && indexFileName.trim() !== "") {
      const parts = path.split("/");
      if (parts[parts.length - 1] === indexFileName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    } else if (creationMode === "folder") {
      const defaultIndexName = "index";
      const parts = path.split("/");
      if (parts[parts.length - 1] === defaultIndexName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    }
    const slugParts = path.split("/").map((part) => this.toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/"))
        basePath = "/" + basePath;
      if (!basePath.endsWith("/"))
        basePath += "/";
    }
    const shouldAddTrailingSlash = (this.settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  /**
   * Generates a standard Obsidian link to a heading, respecting user's link format preference
   */
  generateObsidianLink(app, file, heading) {
    const headingText = heading.heading;
    const testLink = app.fileManager.generateMarkdownLink(file, "", "");
    if (testLink.startsWith("[[")) {
      const fileName = file.basename;
      return `[[${fileName}#${headingText}|${headingText}]]`;
    } else {
      const baseLink = app.fileManager.generateMarkdownLink(file, "", "");
      if (baseLink.startsWith("[[")) {
        const fileName = file.basename;
        return `[[${fileName}#${headingText}|${headingText}]]`;
      } else {
        const match = baseLink.match(/\[([^\]]+)\]\(([^)]+)\)/);
        if (match) {
          const [, , path] = match;
          return `[${headingText}](${path}#${encodeURIComponent(headingText)})`;
        } else {
          const encodedFilename = encodeURIComponent(file.name);
          return `[${headingText}](${encodedFilename}#${encodeURIComponent(headingText)})`;
        }
      }
    }
  }
  /**
   * Generates a standard Obsidian wikilink to a heading
   */
  generateObsidianWikilink(file, heading) {
    const headingText = heading.heading;
    const fileName = file.basename;
    return `[[${fileName}#${headingText}|${headingText}]]`;
  }
  /**
   * Generates an Astro-compatible markdown link to a heading
   */
  generateAstroLink(file, heading) {
    const headingText = heading.heading;
    const anchor = this.toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[${headingText}](${astroUrl})`;
  }
  /**
   * Generates an Astro-compatible wikilink to a heading
   */
  generateAstroWikilink(file, heading) {
    const headingText = heading.heading;
    const anchor = this.toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[[${headingText}|${astroUrl}]]`;
  }
  /**
   * Extracts the URL from a markdown link or wikilink
   */
  extractUrl(link) {
    const markdownMatch = link.match(/\[([^\]]+)\]\(([^)]+)\)/);
    if (markdownMatch) {
      return markdownMatch[2];
    }
    const wikilinkMatch = link.match(/\[\[([^\]]+)\]\]/);
    if (wikilinkMatch) {
      const content = wikilinkMatch[1];
      const pathPart = content.split("|")[0];
      return pathPart;
    }
    return link;
  }
  /**
   * Generates the appropriate link format based on settings
   */
  generateLink(app, file, heading) {
    if (this.settings.copyHeadingLinkFormat === "astro") {
      return this.generateAstroLink(file, heading);
    } else {
      return this.generateObsidianLink(app, file, heading);
    }
  }
  /**
   * Finds the heading at a specific line in a file
   */
  findHeadingAtLine(app, file, line) {
    const cache = app.metadataCache.getFileCache(file);
    if (!cache || !cache.headings) {
      return null;
    }
    for (let i = cache.headings.length - 1; i >= 0; i--) {
      const heading = cache.headings[i];
      if (heading.position.start.line <= line) {
        return heading;
      }
    }
    return null;
  }
};

// src/main.ts
var AstroComposerPlugin = class extends import_obsidian12.Plugin {
  constructor() {
    super(...arguments);
    this.pluginCreatedFiles = /* @__PURE__ */ new Set();
    this.terminalRibbonIcon = null;
    this.configRibbonIcon = null;
  }
  /**
   * Migrate old posts/pages settings to unified content types
   */
  async migrateSettingsIfNeeded() {
    if (this.settings.migrationCompleted) {
      return;
    }
    const hasPostsSettings = this.settings.automatePostCreation !== void 0 && this.settings.automatePostCreation;
    const hasPagesSettings = this.settings.enablePages !== void 0 && this.settings.enablePages;
    if (!hasPostsSettings && !hasPagesSettings) {
      this.settings.migrationCompleted = true;
      await this.saveSettings();
      return;
    }
    const legacyContentTypes = this.settings.customContentTypes;
    const existingContentTypes = this.settings.contentTypes || legacyContentTypes || [];
    const conflicts = [];
    if (existingContentTypes.some((ct) => ct.name === "Posts")) {
      conflicts.push("Posts");
    }
    if (existingContentTypes.some((ct) => ct.name === "Pages")) {
      conflicts.push("Pages");
    }
    let shouldMigrate = true;
    if (conflicts.length > 0) {
      await new Promise((resolve) => {
        setTimeout(() => {
          void (async () => {
            try {
              const modal = new MigrationModal(this.app, conflicts);
              const timeoutPromise = new Promise((timeoutResolve) => {
                setTimeout(() => {
                  timeoutResolve({ action: "skip" });
                }, 3e4);
              });
              const result = await Promise.race([
                modal.waitForResult(),
                timeoutPromise
              ]);
              if (result.action === "skip") {
                shouldMigrate = false;
                new import_obsidian12.Notice("Migration skipped. Old posts/pages settings will be ignored.");
              }
            } catch (error) {
              console.warn("Migration modal error:", error);
              shouldMigrate = false;
              new import_obsidian12.Notice("Migration skipped due to error. You can migrate manually in settings.");
            }
            resolve();
          })();
        }, 500);
      });
    }
    if (!shouldMigrate) {
      this.settings.migrationCompleted = true;
      await this.saveSettings();
      return;
    }
    const migratedTypes = [];
    if (hasPostsSettings && !conflicts.includes("Posts")) {
      const postsType = {
        id: `posts-${Date.now()}`,
        name: "Posts",
        folder: this.settings.postsFolder || "",
        linkBasePath: this.settings.postsLinkBasePath || "",
        template: this.settings.defaultTemplate || '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
        enabled: this.settings.automatePostCreation || false,
        creationMode: this.settings.creationMode || "file",
        indexFileName: this.settings.indexFileName || "",
        ignoreSubfolders: this.settings.onlyAutomateInPostsFolder || false,
        enableUnderscorePrefix: this.settings.enableUnderscorePrefix || false
      };
      migratedTypes.push(postsType);
    }
    if (hasPagesSettings && !conflicts.includes("Pages")) {
      const pagesType = {
        id: `pages-${Date.now()}`,
        name: "Pages",
        folder: this.settings.pagesFolder || "",
        linkBasePath: this.settings.pagesLinkBasePath || "",
        template: this.settings.pageTemplate || '---\ntitle: "{{title}}"\ndescription: ""\n---\n',
        enabled: this.settings.enablePages || false,
        creationMode: this.settings.pagesCreationMode || "file",
        indexFileName: this.settings.pagesIndexFileName || "",
        ignoreSubfolders: this.settings.onlyAutomateInPagesFolder || false,
        enableUnderscorePrefix: false
        // Pages didn't have this option before
      };
      migratedTypes.push(pagesType);
    }
    const existingFromNew = this.settings.contentTypes && Array.isArray(this.settings.contentTypes) ? this.settings.contentTypes : [];
    const legacySettings = this.settings;
    const existingFromLegacy = legacySettings.customContentTypes && Array.isArray(legacySettings.customContentTypes) ? legacySettings.customContentTypes : [];
    let existingTypes = [];
    if (existingFromNew.length > 0) {
      existingTypes = existingFromNew;
    } else if (existingFromLegacy.length > 0) {
      existingTypes = existingFromLegacy;
    }
    let finalTypes = [...existingTypes];
    if (migratedTypes.length > 0) {
      const existingNames = new Set(existingTypes.map((ct) => ct.name));
      const newMigratedTypes = migratedTypes.filter((mt) => !existingNames.has(mt.name));
      if (newMigratedTypes.length > 0) {
        finalTypes = [...existingTypes, ...newMigratedTypes];
      }
    }
    this.settings.contentTypes = finalTypes;
    const legacyFields = [
      "customContentTypes",
      // Old name for contentTypes - must be removed
      "enableUnderscorePrefix",
      "postsFolder",
      "postsLinkBasePath",
      "automatePostCreation",
      "creationMode",
      "indexFileName",
      "excludedDirectories",
      "onlyAutomateInPostsFolder",
      "enablePages",
      "pagesFolder",
      "pagesLinkBasePath",
      "pagesCreationMode",
      "pagesIndexFileName",
      "pageTemplate",
      "onlyAutomateInPagesFolder"
    ];
    const settingsRecord = this.settings;
    for (const field of legacyFields) {
      if (settingsRecord[field] !== void 0) {
        delete settingsRecord[field];
      }
    }
    this.settings.migrationCompleted = true;
    await this.saveSettings();
    await this.loadSettings();
    if (migratedTypes.length > 0) {
      new import_obsidian12.Notice(`Migration completed: ${migratedTypes.length} content type(s) migrated.`);
      setTimeout(() => {
        if (this.settingsTab) {
          try {
            if (this.settingsTab.customContentTypesContainer || this.settingsTab.containerEl) {
              this.settingsTab.display();
            }
          } catch (e) {
            console.warn("Could not refresh settings tab after migration:", e);
          }
        }
      }, 300);
    }
  }
  async onload() {
    await this.loadSettings();
    this.fileOps = new FileOperations(this.app, this.settings, this);
    this.templateParser = new TemplateParser(this.app, this.settings);
    this.headingLinkGenerator = new HeadingLinkGenerator(this.settings);
    this.app.workspace.onLayoutReady(() => {
      this.registerCreateEvent();
      if (!import_obsidian12.Platform.isMobile) {
        void this.updateHelpButton();
      }
      void this.migrateSettingsIfNeeded();
    });
    registerCommands(this, this.settings);
    this.settingsTab = new AstroComposerSettingTab(this.app, this);
    this.addSettingTab(this.settingsTab);
    this.registerContextMenu();
    this.registerRibbonIcons();
    this.setupRibbonContextMenuHandling();
  }
  registerCreateEvent() {
    let lastProcessedTime = 0;
    this.createEvent = (file) => {
      void (async () => {
        const now = Date.now();
        if (now - lastProcessedTime < CONSTANTS.DEBOUNCE_MS) {
          return;
        }
        lastProcessedTime = now;
        if (file instanceof import_obsidian12.TFile && file.extension === "md") {
          const filePath = file.path;
          if (this.pluginCreatedFiles.has(filePath)) {
            this.pluginCreatedFiles.delete(filePath);
            return;
          }
          await this.loadSettings();
          const contentTypes = this.settings.contentTypes || [];
          const hasEnabledContentTypes = contentTypes.some((ct) => ct.enabled);
          if (!hasEnabledContentTypes) {
            return;
          }
          const sortedContentTypes = sortByPatternSpecificity(contentTypes);
          let matchedContentTypeId = null;
          const matchingTypes = [];
          for (const contentType of sortedContentTypes) {
            if (!contentType.enabled)
              continue;
            let matches = false;
            if (!contentType.folder || contentType.folder.trim() === "") {
              if (!filePath.includes("/") || filePath.split("/").length === 1) {
                matches = true;
              }
            } else if (matchesFolderPattern(filePath, contentType.folder)) {
              if (contentType.ignoreSubfolders) {
                const pathSegments = filePath.split("/");
                const pathDepth = pathSegments.length;
                const patternSegments = contentType.folder.split("/");
                const expectedDepth = patternSegments.length;
                if (contentType.creationMode === "folder") {
                  const folderDepth = pathDepth - 1;
                  if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
                    matches = true;
                  }
                } else {
                  if (pathDepth === expectedDepth) {
                    matches = true;
                  }
                }
              } else {
                matches = true;
              }
            }
            if (matches) {
              matchingTypes.push(contentType);
              if (!matchedContentTypeId) {
                matchedContentTypeId = contentType.id;
              }
            }
          }
          if (matchingTypes.length > 1) {
            const typeNames = matchingTypes.map((ct) => ct.name || "Unnamed").join(", ");
            new import_obsidian12.Notice(`Multiple content types (${typeNames}) match this file. Using most specific: ${matchingTypes[0].name || "Unnamed"}`);
          }
          if (!matchedContentTypeId) {
            return;
          }
          const stat = await this.app.vault.adapter.stat(file.path);
          const isNewNote = (stat == null ? void 0 : stat.mtime) && now - stat.mtime < CONSTANTS.STAT_MTIME_THRESHOLD;
          if (!isNewNote) {
            return;
          }
          const cache = this.app.metadataCache.getFileCache(file);
          if (cache == null ? void 0 : cache.frontmatter) {
            const frontmatterKeys = Object.keys(cache.frontmatter);
            if (frontmatterKeys.length > 1 || !frontmatterKeys.includes("title")) {
              return;
            }
          }
          this.pluginCreatedFiles.add(file.path);
          new TitleModal(this.app, file, this, matchedContentTypeId, false, true).open();
        }
      })();
    };
    this.registerEvent(this.app.vault.on("create", (file) => {
      if (file instanceof import_obsidian12.TFile) {
        this.createEvent(file);
      }
    }));
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData);
    if (!this.settings.contentTypes || !Array.isArray(this.settings.contentTypes)) {
      this.settings.contentTypes = [];
    }
    if (!this.settings.migrationCompleted) {
      const legacySettings = this.settings;
      const hasLegacyTypes = legacySettings.customContentTypes && Array.isArray(legacySettings.customContentTypes) && legacySettings.customContentTypes.length > 0;
      const hasNewTypes = this.settings.contentTypes && Array.isArray(this.settings.contentTypes) && this.settings.contentTypes.length > 0;
      if (hasLegacyTypes && !hasNewTypes) {
        this.settings.contentTypes = legacySettings.customContentTypes || [];
      }
    } else {
      const legacyFields = [
        "customContentTypes",
        // Old name for contentTypes - MUST be removed to prevent restoring deleted types
        "enableUnderscorePrefix",
        "postsFolder",
        "postsLinkBasePath",
        "automatePostCreation",
        "creationMode",
        "indexFileName",
        "excludedDirectories",
        "onlyAutomateInPostsFolder",
        "enablePages",
        "pagesFolder",
        "pagesLinkBasePath",
        "pagesCreationMode",
        "pagesIndexFileName",
        "pageTemplate",
        "onlyAutomateInPagesFolder"
      ];
      const settingsRecord = this.settings;
      for (const field of legacyFields) {
        if (settingsRecord[field] !== void 0) {
          delete settingsRecord[field];
        }
      }
      await this.saveSettings();
    }
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  registerContextMenu() {
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        if (!this.settings.enableCopyHeadingLink) {
          return;
        }
        const cursor = editor.getCursor();
        const file = view.file;
        if (!(file instanceof import_obsidian12.TFile)) {
          return;
        }
        const heading = this.headingLinkGenerator.findHeadingAtLine(this.app, file, cursor.line);
        if (heading) {
          const fullLink = this.headingLinkGenerator.generateLink(this.app, file, heading);
          const urlOnly = this.headingLinkGenerator.extractUrl(fullLink);
          menu.addItem((item) => {
            item.setTitle("Copy heading link").setIcon("link-2").onClick(async () => {
              await navigator.clipboard.writeText(urlOnly);
              new import_obsidian12.Notice("Heading link copied to clipboard");
            });
          });
          menu.addItem((item) => {
            item.setTitle("Copy heading link with text").setIcon("heading").onClick(async () => {
              await navigator.clipboard.writeText(fullLink);
              new import_obsidian12.Notice("Heading link with text copied to clipboard");
            });
          });
        }
      })
    );
  }
  /**
   * Rename a file by path (for programmatic use, e.g., from other plugins)
   * This allows the rename modal to appear without opening the file first
   */
  async renameContentByPath(filePath) {
    await renameContentByPath(this.app, filePath, this.settings, this);
  }
  registerRibbonIcons() {
    if (import_obsidian12.Platform.isMobile) {
      if (this.terminalRibbonIcon) {
        try {
          if (this.terminalRibbonIcon.parentNode) {
            this.terminalRibbonIcon.remove();
          }
        } catch (e) {
        }
        this.terminalRibbonIcon = null;
      }
      if (this.configRibbonIcon) {
        try {
          if (this.configRibbonIcon.parentNode) {
            this.configRibbonIcon.remove();
          }
        } catch (e) {
        }
        this.configRibbonIcon = null;
      }
      try {
        const terminalIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]');
        terminalIcons.forEach((icon) => icon.remove());
        const configIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]');
        configIcons.forEach((icon) => icon.remove());
      } catch (e) {
      }
      return;
    }
    const terminalRibbonEnabled = this.settings.enableTerminalRibbonIcon === true;
    const terminalCommandEnabled = this.settings.enableOpenTerminalCommand === true;
    const terminalShouldExist = terminalRibbonEnabled && terminalCommandEnabled;
    const configRibbonEnabled = this.settings.enableConfigRibbonIcon === true;
    const configCommandEnabled = this.settings.enableOpenConfigFileCommand === true;
    const configShouldExist = configRibbonEnabled && configCommandEnabled;
    if (this.terminalRibbonIcon) {
      try {
        if (this.terminalRibbonIcon.parentNode) {
          this.terminalRibbonIcon.remove();
        }
      } catch (e) {
      }
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      try {
        if (this.configRibbonIcon.parentNode) {
          this.configRibbonIcon.remove();
        }
      } catch (e) {
      }
      this.configRibbonIcon = null;
    }
    try {
      const terminalIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]');
      terminalIcons.forEach((icon) => icon.remove());
      const configIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]');
      configIcons.forEach((icon) => icon.remove());
    } catch (e) {
    }
    if (terminalShouldExist) {
      const existingTerminal = document.querySelector('.side-dock-ribbon-action[aria-label="Open project terminal"]');
      if (!existingTerminal) {
        this.terminalRibbonIcon = this.addRibbonIcon("terminal-square", "Open project terminal", async () => {
          if (!this.settings.enableOpenTerminalCommand) {
            new import_obsidian12.Notice("Open terminal command is disabled. Enable it in settings to use this command.");
            return;
          }
          await openTerminalInProjectRoot(this.app, this.settings);
        });
        if (this.terminalRibbonIcon) {
          this.terminalRibbonIcon.setAttribute("data-astro-composer-terminal-ribbon", "true");
        }
      } else {
        this.terminalRibbonIcon = existingTerminal;
      }
      if (!configShouldExist) {
        const configIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]');
        if (configIcons.length > 0) {
          configIcons.forEach((icon) => icon.remove());
          this.configRibbonIcon = null;
        }
      }
    } else {
      this.terminalRibbonIcon = null;
    }
    if (configShouldExist) {
      const existingConfig = document.querySelector('.side-dock-ribbon-action[aria-label="Edit astro config"]');
      if (!existingConfig) {
        this.configRibbonIcon = this.addRibbonIcon("wrench", "Edit astro config", async () => {
          if (!this.settings.enableOpenConfigFileCommand) {
            new import_obsidian12.Notice("Edit config file command is disabled. Enable it in settings to use this command.");
            return;
          }
          await openConfigFile(this.app, this.settings);
        });
        if (this.configRibbonIcon) {
          this.configRibbonIcon.setAttribute("data-astro-composer-config-ribbon", "true");
        }
      } else {
        this.configRibbonIcon = existingConfig;
      }
      if (!terminalShouldExist) {
        const terminalIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]');
        if (terminalIcons.length > 0) {
          terminalIcons.forEach((icon) => icon.remove());
          this.terminalRibbonIcon = null;
        }
      }
    } else {
      this.configRibbonIcon = null;
    }
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
    setTimeout(() => {
      if (!terminalShouldExist) {
        const terminalIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]');
        terminalIcons.forEach((icon) => icon.remove());
        this.terminalRibbonIcon = null;
      }
      if (!configShouldExist) {
        const configIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]');
        configIcons.forEach((icon) => icon.remove());
        this.configRibbonIcon = null;
      }
    }, 100);
  }
  onunload() {
    if (this.terminalRibbonIcon) {
      this.terminalRibbonIcon.remove();
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      this.configRibbonIcon.remove();
      this.configRibbonIcon = null;
    }
    if (this.ribbonContextMenuObserver) {
      this.ribbonContextMenuObserver.disconnect();
      this.ribbonContextMenuObserver = void 0;
    }
    document.body.removeClass("astro-composer-hide-terminal-icon");
    document.body.removeClass("astro-composer-hide-config-icon");
    if (this.helpButtonObserver) {
      this.helpButtonObserver.disconnect();
      this.helpButtonObserver = void 0;
    }
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  // Ribbon context menu handling - based on Astro Modular Settings approach
  setupRibbonContextMenuHandling() {
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
  }
  updateRibbonContextMenuCSS() {
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (terminalShouldBeHidden) {
      document.body.addClass("astro-composer-hide-terminal-icon");
    } else {
      document.body.removeClass("astro-composer-hide-terminal-icon");
    }
    if (configShouldBeHidden) {
      document.body.addClass("astro-composer-hide-config-icon");
    } else {
      document.body.removeClass("astro-composer-hide-config-icon");
    }
  }
  setupRibbonContextMenuObserver() {
    if (this.ribbonContextMenuObserver) {
      this.ribbonContextMenuObserver.disconnect();
    }
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (!terminalShouldBeHidden && !configShouldBeHidden) {
      return;
    }
    this.ribbonContextMenuObserver = new MutationObserver((mutations) => {
      for (const mutation of mutations) {
        if (mutation.addedNodes.length > 0) {
          for (const node of Array.from(mutation.addedNodes)) {
            if (node instanceof HTMLElement) {
              if (node.classList.contains("menu") || node.querySelector(".menu")) {
                this.removeRibbonIconsFromContextMenu(node);
              }
            }
          }
        }
      }
    });
    this.ribbonContextMenuObserver.observe(document.body, {
      childList: true,
      subtree: true
    });
  }
  updateHelpButtonCSS() {
    var _a;
    if ((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled) {
      document.body.addClass("astro-composer-hide-help-button");
    } else {
      document.body.removeClass("astro-composer-hide-help-button");
    }
  }
  async updateHelpButton() {
    var _a, _b, _c;
    if (import_obsidian12.Platform.isMobile) {
      this.restoreHelpButton();
      return;
    }
    if (this.helpButtonObserver) {
      this.helpButtonObserver.disconnect();
    }
    await this.loadSettings();
    this.updateHelpButtonCSS();
    if (!((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled)) {
      this.restoreHelpButton();
      this.setupHelpButtonObserver();
      return;
    }
    const vaultActions = document.querySelector(".workspace-drawer-vault-actions");
    if (!vaultActions) {
      this.setupHelpButtonObserver();
      setTimeout(() => {
        var _a2;
        if ((_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) {
          void this.updateHelpButton();
        }
      }, 500);
      return;
    }
    const clickableIcons = Array.from(vaultActions.querySelectorAll(".clickable-icon"));
    let helpButton = null;
    for (const icon of clickableIcons) {
      const svg = icon.querySelector("svg.help");
      if (svg) {
        helpButton = icon;
        break;
      }
    }
    if (!helpButton) {
      this.setupHelpButtonObserver();
      setTimeout(() => {
        var _a2;
        if ((_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) {
          void this.updateHelpButton();
        }
      }, 500);
      return;
    }
    this.helpButtonElement = helpButton;
    if (this.customHelpButton && this.customHelpButton.parentElement && document.body.contains(this.customHelpButton) && this.customHelpButton.hasAttribute("data-astro-composer-help-replacement")) {
      this.customHelpButton.remove();
    }
    this.customHelpButton = void 0;
    const customButton = helpButton.cloneNode(true);
    customButton.addClass("astro-composer-help-replacement");
    customButton.removeAttribute("aria-label");
    customButton.setAttribute("data-astro-composer-help-replacement", "true");
    customButton.classList.add("astro-composer-help-replacement");
    customButton.onclick = null;
    const iconContainer = ((_b = customButton.querySelector("svg")) == null ? void 0 : _b.parentElement) || customButton;
    try {
      if (iconContainer instanceof HTMLElement) {
        (0, import_obsidian12.setIcon)(iconContainer, this.settings.helpButtonReplacement.iconId);
      }
    } catch (error) {
      console.warn("[Astro Composer] Error setting icon:", error);
    }
    customButton.addEventListener("click", (evt) => {
      var _a2;
      evt.preventDefault();
      evt.stopPropagation();
      const commandId = (_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.commandId;
      if (commandId) {
        void (async () => {
          var _a3;
          try {
            const appWithCommands = this.app;
            if ((_a3 = appWithCommands.commands) == null ? void 0 : _a3.executeCommandById) {
              await appWithCommands.commands.executeCommandById(commandId);
            }
          } catch (error) {
            console.warn("[Astro Composer] Error executing command:", error);
            new import_obsidian12.Notice(`Failed to execute command: ${commandId}`);
          }
        })();
      }
    }, true);
    (_c = helpButton.parentElement) == null ? void 0 : _c.insertBefore(customButton, helpButton);
    this.customHelpButton = customButton;
    setTimeout(() => {
      var _a2;
      if ((_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) {
        this.setupHelpButtonObserver();
      }
    }, 1e3);
  }
  setupHelpButtonObserver() {
    var _a;
    if (this.helpButtonObserver) {
      this.helpButtonObserver.disconnect();
    }
    if (!((_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled)) {
      return;
    }
    let updateTimeout = null;
    this.helpButtonObserver = new MutationObserver(() => {
      if (updateTimeout) {
        clearTimeout(updateTimeout);
      }
      updateTimeout = window.setTimeout(() => {
        const vaultActions2 = document.querySelector(".workspace-drawer-vault-actions");
        if (!vaultActions2)
          return;
        const customButtonExists = this.customHelpButton && this.customHelpButton.parentElement && document.body.contains(this.customHelpButton) && this.customHelpButton.hasAttribute("data-astro-composer-help-replacement");
        if (!customButtonExists) {
          if (this.customHelpButton && (!document.body.contains(this.customHelpButton) || !this.customHelpButton.hasAttribute("data-astro-composer-help-replacement"))) {
            this.customHelpButton = void 0;
          }
          void this.updateHelpButton();
        }
      }, 100);
    });
    const vaultActions = document.querySelector(".workspace-drawer-vault-actions");
    if (vaultActions) {
      this.helpButtonObserver.observe(vaultActions, {
        childList: true,
        subtree: true
        // Watch subtree to catch when buttons are recreated
      });
    }
    const vaultProfile = document.querySelector(".workspace-sidedock-vault-profile");
    if (vaultProfile) {
      this.helpButtonObserver.observe(vaultProfile, {
        childList: true,
        subtree: true
        // Watch subtree to catch when vault actions are added
      });
    }
    if (!vaultActions && !vaultProfile) {
      const workspace = document.querySelector(".workspace-split");
      if (workspace) {
        this.helpButtonObserver.observe(workspace, {
          childList: true,
          subtree: true
        });
      } else {
        this.helpButtonObserver.observe(document.body, {
          childList: true,
          subtree: true
        });
      }
    }
  }
  restoreHelpButton() {
    document.body.removeClass("astro-composer-hide-help-button");
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  removeRibbonIconsFromContextMenu(menuElement) {
    var _a, _b;
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    const menuItems = menuElement.querySelectorAll(".menu-item");
    for (const item of Array.from(menuItems)) {
      const svg = item.querySelector("svg");
      if (svg) {
        const iconName = svg.getAttribute("data-lucide") || svg.getAttribute("xmlns:lucide") || (svg.classList.contains("lucide-terminal-square") ? "terminal-square" : null) || (svg.classList.contains("lucide-wrench") ? "wrench" : null);
        if (terminalShouldBeHidden && iconName === "terminal-square") {
          const itemText = ((_a = item.textContent) == null ? void 0 : _a.toLowerCase()) || "";
          if (itemText.includes("terminal") || itemText.includes("project terminal")) {
            item.remove();
          }
        }
        if (configShouldBeHidden && iconName === "wrench") {
          const itemText = ((_b = item.textContent) == null ? void 0 : _b.toLowerCase()) || "";
          if (itemText.includes("config") || itemText.includes("astro config")) {
            item.remove();
          }
        }
      }
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvY29tbWFuZHMvaW5kZXgudHMiLCAic3JjL3V0aWxzL2ZpbGUtb3BlcmF0aW9ucy50cyIsICJzcmMvdXRpbHMvcGF0aC1tYXRjaGluZy50cyIsICJzcmMvdXRpbHMvdGVtcGxhdGUtcGFyc2luZy50cyIsICJzcmMvdXRpbHMvbGluay1jb252ZXJzaW9uLnRzIiwgInNyYy91aS90aXRsZS1tb2RhbC50cyIsICJzcmMvdWkvc2V0dGluZ3MtdGFiLnRzIiwgInNyYy91aS9jb21wb25lbnRzL0NvbW1hbmRQaWNrZXJNb2RhbC50cyIsICJzcmMvdWkvY29tcG9uZW50cy9JY29uUGlja2VyTW9kYWwudHMiLCAic3JjL3VpL2NvbXBvbmVudHMvQ29uZmlybU1vZGFsLnRzIiwgInNyYy91dGlscy9zZXR0aW5ncy1jb21wYXQudHMiLCAic3JjL3VpL2NvbXBvbmVudHMvTWlncmF0aW9uTW9kYWwudHMiLCAic3JjL3V0aWxzL2hlYWRpbmctbGluay1nZW5lcmF0b3IudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7XG5cdFBsdWdpbixcblx0VEZpbGUsXG5cdE5vdGljZSxcblx0c2V0SWNvbixcblx0UGxhdGZvcm0sXG59IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MsIENPTlNUQU5UUyB9IGZyb20gXCIuL3NldHRpbmdzXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBDb250ZW50VHlwZSB9IGZyb20gXCIuL3R5cGVzXCI7XG5pbXBvcnQgeyByZWdpc3RlckNvbW1hbmRzLCByZW5hbWVDb250ZW50QnlQYXRoIGFzIHJlbmFtZUNvbnRlbnRCeVBhdGhGdW5jdGlvbiwgb3BlblRlcm1pbmFsSW5Qcm9qZWN0Um9vdCwgb3BlbkNvbmZpZ0ZpbGUgfSBmcm9tIFwiLi9jb21tYW5kc1wiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdUYWIgfSBmcm9tIFwiLi91aS9zZXR0aW5ncy10YWJcIjtcbmltcG9ydCB7IFRpdGxlTW9kYWwgfSBmcm9tIFwiLi91aS90aXRsZS1tb2RhbFwiO1xuaW1wb3J0IHsgTWlncmF0aW9uTW9kYWwsIE1pZ3JhdGlvbkNvbmZsaWN0UmVzdWx0IH0gZnJvbSBcIi4vdWkvY29tcG9uZW50cy9NaWdyYXRpb25Nb2RhbFwiO1xuaW1wb3J0IHsgRmlsZU9wZXJhdGlvbnMgfSBmcm9tIFwiLi91dGlscy9maWxlLW9wZXJhdGlvbnNcIjtcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSBcIi4vdXRpbHMvdGVtcGxhdGUtcGFyc2luZ1wiO1xuaW1wb3J0IHsgSGVhZGluZ0xpbmtHZW5lcmF0b3IgfSBmcm9tIFwiLi91dGlscy9oZWFkaW5nLWxpbmstZ2VuZXJhdG9yXCI7XG5pbXBvcnQgeyBtYXRjaGVzRm9sZGVyUGF0dGVybiwgc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5IH0gZnJvbSBcIi4vdXRpbHMvcGF0aC1tYXRjaGluZ1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBc3Ryb0NvbXBvc2VyUGx1Z2luIGV4dGVuZHMgUGx1Z2luIGltcGxlbWVudHMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB7XG5cdHNldHRpbmdzITogQXN0cm9Db21wb3NlclNldHRpbmdzO1xuXHRwcml2YXRlIGNyZWF0ZUV2ZW50ITogKGZpbGU6IFRGaWxlKSA9PiB2b2lkO1xuXHRwcml2YXRlIGZpbGVPcHMhOiBGaWxlT3BlcmF0aW9ucztcblx0cHJpdmF0ZSB0ZW1wbGF0ZVBhcnNlciE6IFRlbXBsYXRlUGFyc2VyO1xuXHRwcml2YXRlIGhlYWRpbmdMaW5rR2VuZXJhdG9yITogSGVhZGluZ0xpbmtHZW5lcmF0b3I7XG5cdHByaXZhdGUgcGx1Z2luQ3JlYXRlZEZpbGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcblx0cHJpdmF0ZSB0ZXJtaW5hbFJpYmJvbkljb246IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdHByaXZhdGUgY29uZmlnUmliYm9uSWNvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSByaWJib25Db250ZXh0TWVudU9ic2VydmVyPzogTXV0YXRpb25PYnNlcnZlcjtcblx0cHJpdmF0ZSBoZWxwQnV0dG9uT2JzZXJ2ZXI/OiBNdXRhdGlvbk9ic2VydmVyO1xuXHRwcml2YXRlIGhlbHBCdXR0b25FbGVtZW50PzogSFRNTEVsZW1lbnQ7XG5cdHByaXZhdGUgY3VzdG9tSGVscEJ1dHRvbj86IEhUTUxFbGVtZW50O1xuXHRwcml2YXRlIHNldHRpbmdzVGFiPzogQXN0cm9Db21wb3NlclNldHRpbmdUYWI7XG5cblx0LyoqXG5cdCAqIE1pZ3JhdGUgb2xkIHBvc3RzL3BhZ2VzIHNldHRpbmdzIHRvIHVuaWZpZWQgY29udGVudCB0eXBlc1xuXHQgKi9cblx0cHJpdmF0ZSBhc3luYyBtaWdyYXRlU2V0dGluZ3NJZk5lZWRlZCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHQvLyBDaGVjayBpZiBtaWdyYXRpb24gaXMgYWxyZWFkeSBjb21wbGV0ZWRcblx0XHQvLyBJZiB0cnVlLCByZXR1cm4gaW1tZWRpYXRlbHkgLSBubyByZWxvYWQvcmVmcmVzaCBuZWVkZWQsIHRoaXMgb25seSBydW5zIG9uY2UgcGVyIHVzZXJcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5taWdyYXRpb25Db21wbGV0ZWQpIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBDaGVjayBpZiB0aGVyZSBhcmUgb2xkIHNldHRpbmdzIHRvIG1pZ3JhdGVcblx0XHRjb25zdCBoYXNQb3N0c1NldHRpbmdzID0gdGhpcy5zZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbiAhPT0gdW5kZWZpbmVkICYmIHRoaXMuc2V0dGluZ3MuYXV0b21hdGVQb3N0Q3JlYXRpb247XG5cdFx0Y29uc3QgaGFzUGFnZXNTZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3MuZW5hYmxlUGFnZXMgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnNldHRpbmdzLmVuYWJsZVBhZ2VzO1xuXG5cdFx0aWYgKCFoYXNQb3N0c1NldHRpbmdzICYmICFoYXNQYWdlc1NldHRpbmdzKSB7XG5cdFx0XHQvLyBObyBvbGQgc2V0dGluZ3MgdG8gbWlncmF0ZSwgbWFyayBhcyBjb21wbGV0ZWRcblx0XHRcdHRoaXMuc2V0dGluZ3MubWlncmF0aW9uQ29tcGxldGVkID0gdHJ1ZTtcblx0XHRcdGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgZm9yIG5hbWluZyBjb25mbGljdHNcblx0XHQvLyBIYW5kbGUgYm90aCBuZXcgY29udGVudFR5cGVzIGFuZCBsZWdhY3kgY3VzdG9tQ29udGVudFR5cGVzXG5cdFx0Y29uc3QgbGVnYWN5Q29udGVudFR5cGVzID0gKHRoaXMuc2V0dGluZ3MgYXMgdW5rbm93biBhcyB7IGN1c3RvbUNvbnRlbnRUeXBlcz86IENvbnRlbnRUeXBlW10gfSkuY3VzdG9tQ29udGVudFR5cGVzO1xuXHRcdGNvbnN0IGV4aXN0aW5nQ29udGVudFR5cGVzID0gdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgbGVnYWN5Q29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IGNvbmZsaWN0czogc3RyaW5nW10gPSBbXTtcblx0XHRpZiAoZXhpc3RpbmdDb250ZW50VHlwZXMuc29tZSgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5uYW1lID09PSBcIlBvc3RzXCIpKSB7XG5cdFx0XHRjb25mbGljdHMucHVzaChcIlBvc3RzXCIpO1xuXHRcdH1cblx0XHRpZiAoZXhpc3RpbmdDb250ZW50VHlwZXMuc29tZSgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5uYW1lID09PSBcIlBhZ2VzXCIpKSB7XG5cdFx0XHRjb25mbGljdHMucHVzaChcIlBhZ2VzXCIpO1xuXHRcdH1cblxuXHRcdGxldCBzaG91bGRNaWdyYXRlID0gdHJ1ZTtcblxuXHRcdC8vIElmIGNvbmZsaWN0cyBleGlzdCwgcHJvbXB0IHVzZXIgKGJ1dCBkb24ndCBibG9jayAtIHVzZSBzZXRUaW1lb3V0IHRvIHNob3cgbW9kYWwgYWZ0ZXIgVUkgaXMgcmVhZHkpXG5cdFx0aWYgKGNvbmZsaWN0cy5sZW5ndGggPiAwKSB7XG5cdFx0XHQvLyBTaG93IG1vZGFsIGFzeW5jaHJvbm91c2x5IHRvIGF2b2lkIGJsb2NraW5nIHBsdWdpbiBsb2FkXG5cdFx0XHRhd2FpdCBuZXcgUHJvbWlzZTx2b2lkPigocmVzb2x2ZSkgPT4ge1xuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHR2b2lkIChhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBNaWdyYXRpb25Nb2RhbCh0aGlzLmFwcCwgY29uZmxpY3RzKTtcblx0XHRcdFx0XHRcdFx0Ly8gQWRkIHRpbWVvdXQgZmFsbGJhY2sgLSBpZiB1c2VyIGRvZXNuJ3QgcmVzcG9uZCBpbiAzMCBzZWNvbmRzLCBkZWZhdWx0IHRvIHNraXBcblx0XHRcdFx0XHRcdFx0Y29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZTxNaWdyYXRpb25Db25mbGljdFJlc3VsdD4oKHRpbWVvdXRSZXNvbHZlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0XHR0aW1lb3V0UmVzb2x2ZSh7IGFjdGlvbjogXCJza2lwXCIgfSk7XG5cdFx0XHRcdFx0XHRcdFx0fSwgMzAwMDApOyAvLyAzMCBzZWNvbmQgdGltZW91dFxuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XG5cdFx0XHRcdFx0XHRcdGNvbnN0IHJlc3VsdCA9IGF3YWl0IFByb21pc2UucmFjZShbXG5cdFx0XHRcdFx0XHRcdFx0bW9kYWwud2FpdEZvclJlc3VsdCgpLFxuXHRcdFx0XHRcdFx0XHRcdHRpbWVvdXRQcm9taXNlXG5cdFx0XHRcdFx0XHRcdF0pO1xuXHRcdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdFx0aWYgKHJlc3VsdC5hY3Rpb24gPT09IFwic2tpcFwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0c2hvdWxkTWlncmF0ZSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJNaWdyYXRpb24gc2tpcHBlZC4gT2xkIHBvc3RzL3BhZ2VzIHNldHRpbmdzIHdpbGwgYmUgaWdub3JlZC5cIik7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdFx0XHRcdC8vIElmIG1vZGFsIGZhaWxzIGZvciBhbnkgcmVhc29uLCBkZWZhdWx0IHRvIHNraXAgdG8gcHJldmVudCBibG9ja2luZ1xuXHRcdFx0XHRcdFx0XHRjb25zb2xlLndhcm4oXCJNaWdyYXRpb24gbW9kYWwgZXJyb3I6XCIsIGVycm9yKTtcblx0XHRcdFx0XHRcdFx0c2hvdWxkTWlncmF0ZSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKFwiTWlncmF0aW9uIHNraXBwZWQgZHVlIHRvIGVycm9yLiBZb3UgY2FuIG1pZ3JhdGUgbWFudWFsbHkgaW4gc2V0dGluZ3MuXCIpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0cmVzb2x2ZSgpO1xuXHRcdFx0XHRcdH0pKCk7XG5cdFx0XHRcdH0sIDUwMCk7IC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBVSSBpcyByZWFkeVxuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0aWYgKCFzaG91bGRNaWdyYXRlKSB7XG5cdFx0XHR0aGlzLnNldHRpbmdzLm1pZ3JhdGlvbkNvbXBsZXRlZCA9IHRydWU7XG5cdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFBlcmZvcm0gbWlncmF0aW9uXG5cdFx0Y29uc3QgbWlncmF0ZWRUeXBlczogQ29udGVudFR5cGVbXSA9IFtdO1xuXG5cdFx0Ly8gTWlncmF0ZSBQb3N0cyAtIHNraXAgaWYgaXQgYWxyZWFkeSBleGlzdHMgKGRvbid0IG92ZXJ3cml0ZSB1c2VyJ3MgZXhpc3RpbmcgY29uZmlnKVxuXHRcdGlmIChoYXNQb3N0c1NldHRpbmdzICYmICFjb25mbGljdHMuaW5jbHVkZXMoXCJQb3N0c1wiKSkge1xuXHRcdFx0Y29uc3QgcG9zdHNUeXBlOiBDb250ZW50VHlwZSA9IHtcblx0XHRcdFx0aWQ6IGBwb3N0cy0ke0RhdGUubm93KCl9YCxcblx0XHRcdFx0bmFtZTogXCJQb3N0c1wiLFxuXHRcdFx0XHRmb2xkZXI6IHRoaXMuc2V0dGluZ3MucG9zdHNGb2xkZXIgfHwgXCJcIixcblx0XHRcdFx0bGlua0Jhc2VQYXRoOiB0aGlzLnNldHRpbmdzLnBvc3RzTGlua0Jhc2VQYXRoIHx8IFwiXCIsXG5cdFx0XHRcdHRlbXBsYXRlOiB0aGlzLnNldHRpbmdzLmRlZmF1bHRUZW1wbGF0ZSB8fCAnLS0tXFxudGl0bGU6IFwie3t0aXRsZX19XCJcXG5kYXRlOiB7e2RhdGV9fVxcbnRhZ3M6IFtdXFxuLS0tXFxuJyxcblx0XHRcdFx0ZW5hYmxlZDogdGhpcy5zZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbiB8fCBmYWxzZSxcblx0XHRcdFx0Y3JlYXRpb25Nb2RlOiB0aGlzLnNldHRpbmdzLmNyZWF0aW9uTW9kZSB8fCBcImZpbGVcIixcblx0XHRcdFx0aW5kZXhGaWxlTmFtZTogdGhpcy5zZXR0aW5ncy5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdGlnbm9yZVN1YmZvbGRlcnM6IHRoaXMuc2V0dGluZ3Mub25seUF1dG9tYXRlSW5Qb3N0c0ZvbGRlciB8fCBmYWxzZSxcblx0XHRcdFx0ZW5hYmxlVW5kZXJzY29yZVByZWZpeDogdGhpcy5zZXR0aW5ncy5lbmFibGVVbmRlcnNjb3JlUHJlZml4IHx8IGZhbHNlLFxuXHRcdFx0fTtcblx0XHRcdG1pZ3JhdGVkVHlwZXMucHVzaChwb3N0c1R5cGUpO1xuXHRcdH1cblxuXHRcdC8vIE1pZ3JhdGUgUGFnZXMgLSBza2lwIGlmIGl0IGFscmVhZHkgZXhpc3RzIChkb24ndCBvdmVyd3JpdGUgdXNlcidzIGV4aXN0aW5nIGNvbmZpZylcblx0XHRpZiAoaGFzUGFnZXNTZXR0aW5ncyAmJiAhY29uZmxpY3RzLmluY2x1ZGVzKFwiUGFnZXNcIikpIHtcblx0XHRcdGNvbnN0IHBhZ2VzVHlwZTogQ29udGVudFR5cGUgPSB7XG5cdFx0XHRcdGlkOiBgcGFnZXMtJHtEYXRlLm5vdygpfWAsXG5cdFx0XHRcdG5hbWU6IFwiUGFnZXNcIixcblx0XHRcdFx0Zm9sZGVyOiB0aGlzLnNldHRpbmdzLnBhZ2VzRm9sZGVyIHx8IFwiXCIsXG5cdFx0XHRcdGxpbmtCYXNlUGF0aDogdGhpcy5zZXR0aW5ncy5wYWdlc0xpbmtCYXNlUGF0aCB8fCBcIlwiLFxuXHRcdFx0XHR0ZW1wbGF0ZTogdGhpcy5zZXR0aW5ncy5wYWdlVGVtcGxhdGUgfHwgJy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGVzY3JpcHRpb246IFwiXCJcXG4tLS1cXG4nLFxuXHRcdFx0XHRlbmFibGVkOiB0aGlzLnNldHRpbmdzLmVuYWJsZVBhZ2VzIHx8IGZhbHNlLFxuXHRcdFx0XHRjcmVhdGlvbk1vZGU6IHRoaXMuc2V0dGluZ3MucGFnZXNDcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCIsXG5cdFx0XHRcdGluZGV4RmlsZU5hbWU6IHRoaXMuc2V0dGluZ3MucGFnZXNJbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdGlnbm9yZVN1YmZvbGRlcnM6IHRoaXMuc2V0dGluZ3Mub25seUF1dG9tYXRlSW5QYWdlc0ZvbGRlciB8fCBmYWxzZSxcblx0XHRcdFx0ZW5hYmxlVW5kZXJzY29yZVByZWZpeDogZmFsc2UsIC8vIFBhZ2VzIGRpZG4ndCBoYXZlIHRoaXMgb3B0aW9uIGJlZm9yZVxuXHRcdFx0fTtcblx0XHRcdG1pZ3JhdGVkVHlwZXMucHVzaChwYWdlc1R5cGUpO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBtaWdyYXRlZCB0eXBlcyB0byBjb250ZW50IHR5cGVzIGFycmF5XG5cdFx0Ly8gQ1JJVElDQUw6IFByZXNlcnZlIEFMTCBleGlzdGluZyBjb250ZW50IHR5cGVzLCBkb24ndCBvdmVyd3JpdGUgdGhlbVxuXHRcdC8vIEdldCBleGlzdGluZyB0eXBlcyBmcm9tIGJvdGggcG9zc2libGUgc291cmNlc1xuXHRcdGNvbnN0IGV4aXN0aW5nRnJvbU5ldyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzICYmIEFycmF5LmlzQXJyYXkodGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMpIFxuXHRcdFx0PyB0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyBcblx0XHRcdDogW107XG5cdFx0Y29uc3QgbGVnYWN5U2V0dGluZ3MgPSB0aGlzLnNldHRpbmdzIGFzIHVua25vd24gYXMgeyBjdXN0b21Db250ZW50VHlwZXM/OiBDb250ZW50VHlwZVtdIH07XG5cdFx0Y29uc3QgZXhpc3RpbmdGcm9tTGVnYWN5ID0gbGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzICYmIEFycmF5LmlzQXJyYXkobGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzKVxuXHRcdFx0PyBsZWdhY3lTZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXNcblx0XHRcdDogW107XG5cdFx0XG5cdFx0Ly8gTWVyZ2UgZXhpc3RpbmcgdHlwZXMsIHByaW9yaXRpemluZyBuZXcgZm9ybWF0IGJ1dCBpbmNsdWRpbmcgbGVnYWN5IGlmIG5ldyBpcyBlbXB0eVxuXHRcdC8vIElmIGJvdGggZXhpc3QsIHVzZSBuZXcgZm9ybWF0IChpdCdzIG1vcmUgcmVjZW50KVxuXHRcdGxldCBleGlzdGluZ1R5cGVzOiBDb250ZW50VHlwZVtdID0gW107XG5cdFx0aWYgKGV4aXN0aW5nRnJvbU5ldy5sZW5ndGggPiAwKSB7XG5cdFx0XHRleGlzdGluZ1R5cGVzID0gZXhpc3RpbmdGcm9tTmV3O1xuXHRcdH0gZWxzZSBpZiAoZXhpc3RpbmdGcm9tTGVnYWN5Lmxlbmd0aCA+IDApIHtcblx0XHRcdGV4aXN0aW5nVHlwZXMgPSBleGlzdGluZ0Zyb21MZWdhY3k7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIE9ubHkgYWRkIG1pZ3JhdGVkIHR5cGVzIGlmIHdlIGhhdmUgYW55XG5cdFx0Ly8gQ1JJVElDQUw6IENoZWNrIGlmIG1pZ3JhdGVkIHR5cGVzIGFscmVhZHkgZXhpc3QgYnkgbmFtZSBiZWZvcmUgYWRkaW5nIHRoZW1cblx0XHQvLyBUaGlzIHByZXZlbnRzIHJlLWFkZGluZyBjb250ZW50IHR5cGVzIHRoYXQgd2VyZSBkZWxldGVkIGJ5IHRoZSB1c2VyXG5cdFx0bGV0IGZpbmFsVHlwZXM6IENvbnRlbnRUeXBlW10gPSBbLi4uZXhpc3RpbmdUeXBlc107XG5cdFx0aWYgKG1pZ3JhdGVkVHlwZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0Ly8gRmlsdGVyIG91dCBhbnkgbWlncmF0ZWQgdHlwZXMgdGhhdCBhbHJlYWR5IGV4aXN0IGJ5IG5hbWVcblx0XHRcdGNvbnN0IGV4aXN0aW5nTmFtZXMgPSBuZXcgU2V0KGV4aXN0aW5nVHlwZXMubWFwKGN0ID0+IGN0Lm5hbWUpKTtcblx0XHRcdGNvbnN0IG5ld01pZ3JhdGVkVHlwZXMgPSBtaWdyYXRlZFR5cGVzLmZpbHRlcihtdCA9PiAhZXhpc3RpbmdOYW1lcy5oYXMobXQubmFtZSkpO1xuXHRcdFx0XG5cdFx0XHQvLyBPbmx5IGFkZCBtaWdyYXRlZCB0eXBlcyB0aGF0IGRvbid0IGFscmVhZHkgZXhpc3Rcblx0XHRcdGlmIChuZXdNaWdyYXRlZFR5cGVzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0ZmluYWxUeXBlcyA9IFsuLi5leGlzdGluZ1R5cGVzLCAuLi5uZXdNaWdyYXRlZFR5cGVzXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gU2V0IHRoZSBmaW5hbCBjb250ZW50IHR5cGVzIGFycmF5XG5cdFx0dGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgPSBmaW5hbFR5cGVzO1xuXHRcdFxuXHRcdC8vIENSSVRJQ0FMOiBDbGVhbiB1cCBhbGwgb2xkIGxlZ2FjeSBmaWVsZHMgYWZ0ZXIgbWlncmF0aW9uIHRvIHByZXZlbnQgdGhlbSBmcm9tIGNhdXNpbmcgaXNzdWVzXG5cdFx0Ly8gVGhlc2UgZmllbGRzIGFyZSBubyBsb25nZXIgbmVlZGVkIGFuZCBjb3VsZCBjYXVzZSBjb250ZW50IHR5cGVzIHRvIGJlIHJlY3JlYXRlZFxuXHRcdGNvbnN0IGxlZ2FjeUZpZWxkcyA9IFtcblx0XHRcdCdjdXN0b21Db250ZW50VHlwZXMnLCAvLyBPbGQgbmFtZSBmb3IgY29udGVudFR5cGVzIC0gbXVzdCBiZSByZW1vdmVkXG5cdFx0XHQnZW5hYmxlVW5kZXJzY29yZVByZWZpeCcsXG5cdFx0XHQncG9zdHNGb2xkZXInLFxuXHRcdFx0J3Bvc3RzTGlua0Jhc2VQYXRoJyxcblx0XHRcdCdhdXRvbWF0ZVBvc3RDcmVhdGlvbicsXG5cdFx0XHQnY3JlYXRpb25Nb2RlJyxcblx0XHRcdCdpbmRleEZpbGVOYW1lJyxcblx0XHRcdCdleGNsdWRlZERpcmVjdG9yaWVzJyxcblx0XHRcdCdvbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyJyxcblx0XHRcdCdlbmFibGVQYWdlcycsXG5cdFx0XHQncGFnZXNGb2xkZXInLFxuXHRcdFx0J3BhZ2VzTGlua0Jhc2VQYXRoJyxcblx0XHRcdCdwYWdlc0NyZWF0aW9uTW9kZScsXG5cdFx0XHQncGFnZXNJbmRleEZpbGVOYW1lJyxcblx0XHRcdCdwYWdlVGVtcGxhdGUnLFxuXHRcdFx0J29ubHlBdXRvbWF0ZUluUGFnZXNGb2xkZXInLFxuXHRcdF07XG5cdFx0Y29uc3Qgc2V0dGluZ3NSZWNvcmQgPSB0aGlzLnNldHRpbmdzIGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG5cdFx0Zm9yIChjb25zdCBmaWVsZCBvZiBsZWdhY3lGaWVsZHMpIHtcblx0XHRcdGlmIChzZXR0aW5nc1JlY29yZFtmaWVsZF0gIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRkZWxldGUgc2V0dGluZ3NSZWNvcmRbZmllbGRdO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIE1hcmsgbWlncmF0aW9uIGFzIGNvbXBsZXRlZFxuXHRcdHRoaXMuc2V0dGluZ3MubWlncmF0aW9uQ29tcGxldGVkID0gdHJ1ZTtcblx0XHQvLyBTYXZlIHNldHRpbmdzIHRvIGVuc3VyZSBhbGwgbGVnYWN5IGZpZWxkcyBhcmUgcGVybWFuZW50bHkgcmVtb3ZlZCBmcm9tIGRpc2tcblx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdFxuXHRcdC8vIE5PVEU6IFRoZSByZWxvYWQgYW5kIHJlZnJlc2ggYmVsb3cgT05MWSBoYXBwZW4gd2hlbiBtaWdyYXRpb24gYWN0dWFsbHkgcnVuc1xuXHRcdC8vIElmIG1pZ3JhdGlvbkNvbXBsZXRlZCB3YXMgYWxyZWFkeSB0cnVlLCB0aGlzIGZ1bmN0aW9uIHJldHVybnMgZWFybHkgKGxpbmUgNDMpXG5cdFx0Ly8gU28gdGhpcyBjb2RlIHBhdGggb25seSBleGVjdXRlcyBvbmNlIHBlciB1c2VyIGR1cmluZyB0aGVpciBmaXJzdCBtaWdyYXRpb25cblx0XHRcblx0XHQvLyBSZWxvYWQgc2V0dGluZ3MgdG8gZW5zdXJlIGV2ZXJ5dGhpbmcgaXMgaW4gc3luY1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cblx0XHRpZiAobWlncmF0ZWRUeXBlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBNaWdyYXRpb24gY29tcGxldGVkOiAke21pZ3JhdGVkVHlwZXMubGVuZ3RofSBjb250ZW50IHR5cGUocykgbWlncmF0ZWQuYCk7XG5cdFx0XHRcblx0XHRcdC8vIFJlZnJlc2ggc2V0dGluZ3MgdGFiIGlmIGl0IGV4aXN0cyAtIG9ubHkgcnVucyB3aGVuIG1pZ3JhdGlvbiBhY3R1YWxseSBoYXBwZW5lZFxuXHRcdFx0Ly8gVXNlIGEgZGVsYXkgdG8gZW5zdXJlIGV2ZXJ5dGhpbmcgaXMgc3luY2VkIGFuZCBVSSBpcyByZWFkeVxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzVGFiKSB7XG5cdFx0XHRcdFx0Ly8gQWx3YXlzIHRyeSB0byByZWZyZXNoIHRoZSBzZXR0aW5ncyB0YWIgaWYgaXQgZXhpc3RzXG5cdFx0XHRcdFx0Ly8gSWYgaXQncyBjdXJyZW50bHkgZGlzcGxheWVkLCB0aGlzIHdpbGwgdXBkYXRlIGl0IGltbWVkaWF0ZWx5XG5cdFx0XHRcdFx0Ly8gSWYgaXQncyBub3QgZGlzcGxheWVkIHlldCwgdGhpcyBpcyBzYWZlIGFuZCB3b24ndCBjYXVzZSBpc3N1ZXNcblx0XHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgc2V0dGluZ3MgdGFiIGNvbnRhaW5lciBleGlzdHMgKG1lYW5zIGl0J3MgYmVlbiBkaXNwbGF5ZWQgYXQgbGVhc3Qgb25jZSlcblx0XHRcdFx0XHRcdGlmICh0aGlzLnNldHRpbmdzVGFiLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lciB8fCB0aGlzLnNldHRpbmdzVGFiLmNvbnRhaW5lckVsKSB7XG5cdFx0XHRcdFx0XHRcdC8vIFNldHRpbmdzIHRhYiBoYXMgYmVlbiBkaXNwbGF5ZWQgLSByZWZyZXNoIGl0IHRvIHNob3cgbWlncmF0ZWQgdHlwZXNcblx0XHRcdFx0XHRcdFx0dGhpcy5zZXR0aW5nc1RhYi5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHQvLyBJZiBjb250YWluZXIgZG9lc24ndCBleGlzdCwgc2V0dGluZ3MgdGFiIGhhc24ndCBiZWVuIG9wZW5lZCB5ZXRcblx0XHRcdFx0XHRcdC8vIEl0IHdpbGwgc2hvdyBtaWdyYXRlZCB0eXBlcyB3aGVuIHVzZXIgb3BlbnMgaXQgKGRpc3BsYXkoKSByZWFkcyBmcmVzaCBzZXR0aW5ncylcblx0XHRcdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdFx0XHQvLyBJZiByZWZyZXNoIGZhaWxzLCB0aGF0J3Mgb2theSAtIHNldHRpbmdzIHdpbGwgc2hvdyB3aGVuIHVzZXIgb3BlbnMgdGhlbVxuXHRcdFx0XHRcdFx0Y29uc29sZS53YXJuKFwiQ291bGQgbm90IHJlZnJlc2ggc2V0dGluZ3MgdGFiIGFmdGVyIG1pZ3JhdGlvbjpcIiwgZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9LCAzMDApO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0Ly8gSW5pdGlhbGl6ZSB1dGlsaXRpZXMgZmlyc3QgKGRvbid0IGJsb2NrIG9uIG1pZ3JhdGlvbilcblx0XHR0aGlzLmZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnModGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIHRoaXMgYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlICYgeyBwbHVnaW5DcmVhdGVkRmlsZXM/OiBTZXQ8c3RyaW5nPiB9KTtcblx0XHR0aGlzLnRlbXBsYXRlUGFyc2VyID0gbmV3IFRlbXBsYXRlUGFyc2VyKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcblx0XHR0aGlzLmhlYWRpbmdMaW5rR2VuZXJhdG9yID0gbmV3IEhlYWRpbmdMaW5rR2VuZXJhdG9yKHRoaXMuc2V0dGluZ3MpO1xuXG5cdFx0Ly8gV2FpdCBmb3IgdGhlIHZhdWx0IHRvIGJlIGZ1bGx5IGxvYWRlZCBiZWZvcmUgcmVnaXN0ZXJpbmcgdGhlIGNyZWF0ZSBldmVudFxuXHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbkxheW91dFJlYWR5KCgpID0+IHtcblx0XHRcdHRoaXMucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xuXHRcdFx0Ly8gSW5pdGlhbGl6ZSBoZWxwIGJ1dHRvbiByZXBsYWNlbWVudCAoZGVza3RvcCBvbmx5KVxuXHRcdFx0aWYgKCFQbGF0Zm9ybS5pc01vYmlsZSkge1xuXHRcdFx0XHR2b2lkIHRoaXMudXBkYXRlSGVscEJ1dHRvbigpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHQvLyBSdW4gbWlncmF0aW9uIGFmdGVyIHBsdWdpbiBpcyBmdWxseSBsb2FkZWQgKG5vbi1ibG9ja2luZylcblx0XHRcdC8vIFRoaXMgcHJldmVudHMgdGhlIG1vZGFsIGZyb20gYmxvY2tpbmcgcGx1Z2luIGluaXRpYWxpemF0aW9uXG5cdFx0XHR2b2lkIHRoaXMubWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTtcblx0XHR9KTtcblxuXHRcdC8vIFJlZ2lzdGVyIGNvbW1hbmRzXG5cdFx0cmVnaXN0ZXJDb21tYW5kcyh0aGlzLCB0aGlzLnNldHRpbmdzKTtcblxuXHRcdC8vIEFkZCBzZXR0aW5ncyB0YWIgYW5kIHN0b3JlIHJlZmVyZW5jZSBmb3IgcmVmcmVzaCBhZnRlciBtaWdyYXRpb25cblx0XHR0aGlzLnNldHRpbmdzVGFiID0gbmV3IEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKTtcblx0XHR0aGlzLmFkZFNldHRpbmdUYWIodGhpcy5zZXR0aW5nc1RhYik7XG5cblx0XHQvLyBSZWdpc3RlciBjb250ZXh0IG1lbnUgZm9yIGNvcHkgaGVhZGluZyBsaW5rc1xuXHRcdHRoaXMucmVnaXN0ZXJDb250ZXh0TWVudSgpO1xuXG5cdFx0Ly8gUmVnaXN0ZXIgcmliYm9uIGljb25zIGlmIGVuYWJsZWRcblx0XHR0aGlzLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcblx0XHRcblx0XHQvLyBTZXR1cCByaWJib24gY29udGV4dCBtZW51IGhhbmRsaW5nXG5cdFx0dGhpcy5zZXR1cFJpYmJvbkNvbnRleHRNZW51SGFuZGxpbmcoKTtcblx0fVxuXG5cblx0cHVibGljIHJlZ2lzdGVyQ3JlYXRlRXZlbnQoKSB7XG5cdFx0Ly8gQWx3YXlzIHJlZ2lzdGVyIHRoZSBldmVudCBsaXN0ZW5lciwgYnV0IGNoZWNrIGVuYWJsZWQgY29udGVudCB0eXBlcyBkeW5hbWljYWxseVxuXHRcdC8vIFRoaXMgZW5zdXJlcyBhdXRvbWF0aW9uIHdvcmtzIGV2ZW4gaWYgY29udGVudCB0eXBlcyBhcmUgZW5hYmxlZCBhZnRlciBwbHVnaW4gbG9hZFxuXHRcdFxuXHRcdC8vIERlYm91bmNlIHRvIHByZXZlbnQgbXVsdGlwbGUgbW9kYWxzIGZyb20gcmFwaWQgZmlsZSBjcmVhdGlvbnNcblx0XHRsZXQgbGFzdFByb2Nlc3NlZFRpbWUgPSAwO1xuXG5cdFx0dGhpcy5jcmVhdGVFdmVudCA9IChmaWxlOiBURmlsZSkgPT4ge1xuXHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xuXHRcdFx0Y29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcblx0XHRcdGlmIChub3cgLSBsYXN0UHJvY2Vzc2VkVGltZSA8IENPTlNUQU5UUy5ERUJPVU5DRV9NUykge1xuXHRcdFx0XHRyZXR1cm47IC8vIFNraXAgaWYgd2l0aGluIGRlYm91bmNlIHBlcmlvZFxuXHRcdFx0fVxuXHRcdFx0bGFzdFByb2Nlc3NlZFRpbWUgPSBub3c7XG5cblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09IFwibWRcIikge1xuXHRcdFx0XHRjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcblxuXHRcdFx0XHQvLyBTa2lwIGlmIHRoaXMgZmlsZSB3YXMgY3JlYXRlZCBieSB0aGUgcGx1Z2luIGl0c2VsZlxuXHRcdFx0XHRpZiAodGhpcy5wbHVnaW5DcmVhdGVkRmlsZXMuaGFzKGZpbGVQYXRoKSkge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luQ3JlYXRlZEZpbGVzLmRlbGV0ZShmaWxlUGF0aCk7IC8vIENsZWFuIHVwXG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ1JJVElDQUw6IFJlbG9hZCBzZXR0aW5ncyBmcm9tIGRpc2sgdG8gZW5zdXJlIHdlIGhhdmUgdGhlIGxhdGVzdCBkYXRhXG5cdFx0XHRcdC8vIFRoaXMgaXMgbmVjZXNzYXJ5IGJlY2F1c2Ugb3RoZXIgcGx1Z2lucyBtaWdodCBoYXZlIG1vZGlmaWVkIGRhdGEuanNvblxuXHRcdFx0XHRhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuXG5cdFx0XHRcdC8vIENSSVRJQ0FMOiBDaGVjayBpZiBhbnkgY29udGVudCB0eXBlcyBhcmUgZW5hYmxlZCBBRlRFUiByZWxvYWRpbmcgc2V0dGluZ3Ncblx0XHRcdFx0Ly8gVGhpcyBlbnN1cmVzIGF1dG9tYXRpb24gd29ya3Mgd2hlbiBjb250ZW50IHR5cGVzIGFyZSBlbmFibGVkIGJ5IGFub3RoZXIgcGx1Z2luXG5cdFx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdFx0XHRjb25zdCBoYXNFbmFibGVkQ29udGVudFR5cGVzID0gY29udGVudFR5cGVzLnNvbWUoY3QgPT4gY3QuZW5hYmxlZCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBJZiBubyBjb250ZW50IHR5cGVzIGFyZSBlbmFibGVkLCBza2lwIHByb2Nlc3Npbmdcblx0XHRcdFx0aWYgKCFoYXNFbmFibGVkQ29udGVudFR5cGVzKSB7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gRmluZCBtYXRjaGluZyBjb250ZW50IHR5cGUgdXNpbmcgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9zdCBzcGVjaWZpYyB3aW5zKVxuXHRcdFx0XHRcdC8vIFNvcnQgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSBzbyBtb3JlIHNwZWNpZmljIHBhdHRlcm5zIGFyZSBjaGVja2VkIGZpcnN0XG5cdFx0XHRcdFx0Y29uc3Qgc29ydGVkQ29udGVudFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XG5cdFx0XHRcdFx0bGV0IG1hdGNoZWRDb250ZW50VHlwZUlkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcblx0XHRcdFx0XHRjb25zdCBtYXRjaGluZ1R5cGVzOiBDb250ZW50VHlwZVtdID0gW107IC8vIFRyYWNrIGFsbCBtYXRjaGluZyB0eXBlcyBmb3IgY29uZmxpY3QgZGV0ZWN0aW9uXG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRDb250ZW50VHlwZXMpIHtcblx0XHRcdFx0XHRcdGlmICghY29udGVudFR5cGUuZW5hYmxlZCkgY29udGludWU7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGxldCBtYXRjaGVzID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdC8vIEhhbmRsZSBibGFuayBmb2xkZXIgKHJvb3QpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcblx0XHRcdFx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcblx0XHRcdFx0XHRcdFx0aWYgKCFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgZmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdFx0XHRcdG1hdGNoZXMgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XG5cdFx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIGlnbm9yZSBzdWJmb2xkZXJzIGlzIGVuYWJsZWRcblx0XHRcdFx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlLmlnbm9yZVN1YmZvbGRlcnMpIHtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBwYXRoU2VnbWVudHMgPSBmaWxlUGF0aC5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgcGF0aERlcHRoID0gcGF0aFNlZ21lbnRzLmxlbmd0aDtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBwYXR0ZXJuU2VnbWVudHMgPSBjb250ZW50VHlwZS5mb2xkZXIuc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGV4cGVjdGVkRGVwdGggPSBwYXR0ZXJuU2VnbWVudHMubGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRcdFxuXHRcdFx0XHRcdFx0XHRcdGlmIChjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEZvciBmb2xkZXItYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBvbmUgbGV2ZWwgZGVlcGVyIChlLmcuLCB0ZXN0L215LWZpbGUvaW5kZXgubWQpXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTbyB3ZSBuZWVkIHRvIGFsbG93IG9uZSBleHRyYSBsZXZlbCBiZXlvbmQgdGhlIHBhdHRlcm4gZGVwdGhcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGZvbGRlckRlcHRoID0gcGF0aERlcHRoIC0gMTsgLy8gU3VidHJhY3QgMSBmb3IgdGhlIGluZGV4Lm1kIGZpbGVcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCB8fCBmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCArIDEpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bWF0Y2hlcyA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIEZvciBmaWxlLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgYXQgdGhlIHNhbWUgZGVwdGggYXMgdGhlIHBhdHRlcm5cblx0XHRcdFx0XHRcdFx0XHRcdGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bWF0Y2hlcyA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdG1hdGNoZXMgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcblx0XHRcdFx0XHRcdGlmIChtYXRjaGVzKSB7XG5cdFx0XHRcdFx0XHRcdG1hdGNoaW5nVHlwZXMucHVzaChjb250ZW50VHlwZSk7XG5cdFx0XHRcdFx0XHRcdC8vIFVzZSB0aGUgZmlyc3QgbWF0Y2hpbmcgdHlwZSAobW9zdCBzcGVjaWZpYyBkdWUgdG8gc29ydGluZylcblx0XHRcdFx0XHRcdFx0aWYgKCFtYXRjaGVkQ29udGVudFR5cGVJZCkge1xuXHRcdFx0XHRcdFx0XHRcdG1hdGNoZWRDb250ZW50VHlwZUlkID0gY29udGVudFR5cGUuaWQ7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gU2hvdyBjb25mbGljdCB3YXJuaW5nIGlmIG11bHRpcGxlIGNvbnRlbnQgdHlwZXMgbWF0Y2hcblx0XHRcdFx0XHRpZiAobWF0Y2hpbmdUeXBlcy5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdFx0XHRjb25zdCB0eXBlTmFtZXMgPSBtYXRjaGluZ1R5cGVzLm1hcChjdCA9PiBjdC5uYW1lIHx8IFwiVW5uYW1lZFwiKS5qb2luKFwiLCBcIik7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBNdWx0aXBsZSBjb250ZW50IHR5cGVzICgke3R5cGVOYW1lc30pIG1hdGNoIHRoaXMgZmlsZS4gVXNpbmcgbW9zdCBzcGVjaWZpYzogJHttYXRjaGluZ1R5cGVzWzBdLm5hbWUgfHwgXCJVbm5hbWVkXCJ9YCk7XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gSWYgbm8gY29udGVudCB0eXBlIG1hdGNoZXMsIHNraXAgZW50aXJlbHlcblx0XHRcdFx0XHRpZiAoIW1hdGNoZWRDb250ZW50VHlwZUlkKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgZmlsZSBpcyBuZXdseSBjcmVhdGVkIGJ5IHVzZXIgKHJlY2VudCBjcmVhdGlvbiB0aW1lKVxuXHRcdFx0XHRcdGNvbnN0IHN0YXQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLnN0YXQoZmlsZS5wYXRoKTtcblx0XHRcdFx0XHRjb25zdCBpc05ld05vdGUgPSBzdGF0Py5tdGltZSAmJiAobm93IC0gc3RhdC5tdGltZSA8IENPTlNUQU5UUy5TVEFUX01USU1FX1RIUkVTSE9MRCk7XG5cblx0XHRcdFx0XHQvLyBTa2lwIGlmIG5vdCBhIHVzZXItaW5pdGlhdGVkIG5ldyBub3RlXG5cdFx0XHRcdFx0aWYgKCFpc05ld05vdGUpIHtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBDaGVjayBpZiBmaWxlIGFscmVhZHkgaGFzIHByb3BlcnRpZXMgdGhhdCBsb29rIGxpa2UgdGhleSB3ZXJlIGNyZWF0ZWQgYnkgYW5vdGhlciBwbHVnaW5cblx0XHRcdFx0XHRjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdFx0XHRcdGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIpIHtcblx0XHRcdFx0XHRcdC8vIElmIGl0IGFscmVhZHkgaGFzIHByb3BlcnRpZXMsIGl0IG1pZ2h0IGhhdmUgYmVlbiBjcmVhdGVkIGJ5IGFub3RoZXIgcGx1Z2luXG5cdFx0XHRcdFx0XHQvLyBPbmx5IHByb2NlZWQgaWYgaXQncyB2ZXJ5IGJhc2ljIHByb3BlcnRpZXMgKGxpa2UganVzdCBhIHRpdGxlKVxuXHRcdFx0XHRcdFx0Y29uc3QgZnJvbnRtYXR0ZXJLZXlzID0gT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpO1xuXHRcdFx0XHRcdFx0aWYgKGZyb250bWF0dGVyS2V5cy5sZW5ndGggPiAxIHx8ICFmcm9udG1hdHRlcktleXMuaW5jbHVkZXMoJ3RpdGxlJykpIHtcblx0XHRcdFx0XHRcdFx0Ly8gVGhpcyBsb29rcyBsaWtlIGl0IHdhcyBjcmVhdGVkIGJ5IGFub3RoZXIgcGx1Z2luIHdpdGggYSBmdWxsIHRlbXBsYXRlXG5cdFx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBNYXJrIHRoZSBvcmlnaW5hbCBmaWxlIGFzIGhhbmRsZWQgdG8gcHJldmVudCBpdCBmcm9tIHRyaWdnZXJpbmcgdGhlIGNyZWF0ZSBldmVudCBhZ2FpblxuXHRcdFx0XHRcdHRoaXMucGx1Z2luQ3JlYXRlZEZpbGVzLmFkZChmaWxlLnBhdGgpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIFNob3cgdGhlIG1vZGFsIHdpdGggdGhlIG1hdGNoZWQgY29udGVudCB0eXBlXG5cdFx0XHRcdFx0bmV3IFRpdGxlTW9kYWwodGhpcy5hcHAsIGZpbGUsIHRoaXMsIG1hdGNoZWRDb250ZW50VHlwZUlkLCBmYWxzZSwgdHJ1ZSkub3BlbigpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdH0pKCk7XG5cdFx0XHR9O1xuXHRcdFxuXHRcdC8vIEFsd2F5cyByZWdpc3RlciB0aGUgZXZlbnQgbGlzdGVuZXIgLSBpdCB3aWxsIGNoZWNrIGVuYWJsZWQgY29udGVudCB0eXBlcyBkeW5hbWljYWxseVxuXHRcdC8vIFVzZSB2YXVsdC5jcmVhdGUgZXZlbnQgdG8gZGV0ZWN0IG5ldyBmaWxlIGNyZWF0aW9uXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KHRoaXMuYXBwLnZhdWx0Lm9uKFwiY3JlYXRlXCIsIChmaWxlKSA9PiB7XG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRcdC8vIEFsd2F5cyBjYWxsIGNyZWF0ZUV2ZW50IC0gaXQgd2lsbCBjaGVjayBmb3IgZW5hYmxlZCBjb250ZW50IHR5cGVzIGFmdGVyIHJlbG9hZGluZyBzZXR0aW5nc1xuXHRcdFx0XHR0aGlzLmNyZWF0ZUV2ZW50KGZpbGUpO1xuXHRcdFx0fVxuXHRcdH0pKTtcblx0fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHRjb25zdCBsb2FkZWREYXRhID0gKGF3YWl0IHRoaXMubG9hZERhdGEoKSkgYXMgdW5rbm93bjtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgbG9hZGVkRGF0YSBhcyBQYXJ0aWFsPEFzdHJvQ29tcG9zZXJTZXR0aW5ncz4gfCBudWxsIHwgdW5kZWZpbmVkKTtcblx0XHRcblx0XHQvLyBFbnN1cmUgY29udGVudFR5cGVzIGlzIGFsd2F5cyBhbiBhcnJheSAobmV2ZXIgdW5kZWZpbmVkIG9yIG51bGwpXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCAhQXJyYXkuaXNBcnJheSh0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcykpIHtcblx0XHRcdHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzID0gW107XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENSSVRJQ0FMOiBPbmx5IG1pZ3JhdGUgbGVnYWN5IGN1c3RvbUNvbnRlbnRUeXBlcyB0byBjb250ZW50VHlwZXMgaWYgbWlncmF0aW9uIGhhc24ndCBjb21wbGV0ZWQgeWV0XG5cdFx0Ly8gQWZ0ZXIgbWlncmF0aW9uLCBhbGwgbGVnYWN5IGZpZWxkcyBzaG91bGQgYmUgZGVsZXRlZCBhbmQgd2Ugc2hvdWxkIG5ldmVyIHJlc3RvcmUgdGhlbVxuXHRcdGlmICghdGhpcy5zZXR0aW5ncy5taWdyYXRpb25Db21wbGV0ZWQpIHtcblx0XHRcdC8vIE1pZ3JhdGUgbGVnYWN5IGN1c3RvbUNvbnRlbnRUeXBlcyB0byBjb250ZW50VHlwZXMgaWYgbmVlZGVkIChiZWZvcmUgbWlncmF0aW9uIHJ1bnMpXG5cdFx0XHQvLyBDaGVjayBpZiBjb250ZW50VHlwZXMgaXMgZW1wdHkvdW5kZWZpbmVkIGFuZCBjdXN0b21Db250ZW50VHlwZXMgZXhpc3RzXG5cdFx0XHRjb25zdCBsZWdhY3lTZXR0aW5ncyA9IHRoaXMuc2V0dGluZ3MgYXMgdW5rbm93biBhcyB7IGN1c3RvbUNvbnRlbnRUeXBlcz86IENvbnRlbnRUeXBlW10gfTtcblx0XHRcdGNvbnN0IGhhc0xlZ2FjeVR5cGVzID0gbGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzICYmIEFycmF5LmlzQXJyYXkobGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzKSAmJiBsZWdhY3lTZXR0aW5ncy5jdXN0b21Db250ZW50VHlwZXMubGVuZ3RoID4gMDtcblx0XHRcdGNvbnN0IGhhc05ld1R5cGVzID0gdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcykgJiYgdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMubGVuZ3RoID4gMDtcblx0XHRcdFxuXHRcdFx0aWYgKGhhc0xlZ2FjeVR5cGVzICYmICFoYXNOZXdUeXBlcykge1xuXHRcdFx0XHQvLyBQcmVzZXJ2ZSBleGlzdGluZyBjdXN0b20gY29udGVudCB0eXBlc1xuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyA9IGxlZ2FjeVNldHRpbmdzLmN1c3RvbUNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gQWZ0ZXIgbWlncmF0aW9uLCBjbGVhbiB1cCBBTEwgbGVnYWN5IGZpZWxkcyBpZiB0aGV5IHN0aWxsIGV4aXN0XG5cdFx0XHQvLyBUaGlzIGlzIGEgb25lLXRpbWUgY2xlYW51cCB0byByZW1vdmUgYW55IGxpbmdlcmluZyBsZWdhY3kgZGF0YSBmcm9tIGRpc2tcblx0XHRcdC8vIENSSVRJQ0FMOiBBbHdheXMgZGVsZXRlIGN1c3RvbUNvbnRlbnRUeXBlcyBhZnRlciBtaWdyYXRpb24gdG8gcHJldmVudCBkZWxldGVkIGNvbnRlbnQgdHlwZXMgZnJvbSBiZWluZyByZXN0b3JlZFxuXHRcdFx0Y29uc3QgbGVnYWN5RmllbGRzID0gW1xuXHRcdFx0XHQnY3VzdG9tQ29udGVudFR5cGVzJywgLy8gT2xkIG5hbWUgZm9yIGNvbnRlbnRUeXBlcyAtIE1VU1QgYmUgcmVtb3ZlZCB0byBwcmV2ZW50IHJlc3RvcmluZyBkZWxldGVkIHR5cGVzXG5cdFx0XHRcdCdlbmFibGVVbmRlcnNjb3JlUHJlZml4Jyxcblx0XHRcdFx0J3Bvc3RzRm9sZGVyJyxcblx0XHRcdFx0J3Bvc3RzTGlua0Jhc2VQYXRoJyxcblx0XHRcdFx0J2F1dG9tYXRlUG9zdENyZWF0aW9uJyxcblx0XHRcdFx0J2NyZWF0aW9uTW9kZScsXG5cdFx0XHRcdCdpbmRleEZpbGVOYW1lJyxcblx0XHRcdFx0J2V4Y2x1ZGVkRGlyZWN0b3JpZXMnLFxuXHRcdFx0XHQnb25seUF1dG9tYXRlSW5Qb3N0c0ZvbGRlcicsXG5cdFx0XHRcdCdlbmFibGVQYWdlcycsXG5cdFx0XHRcdCdwYWdlc0ZvbGRlcicsXG5cdFx0XHRcdCdwYWdlc0xpbmtCYXNlUGF0aCcsXG5cdFx0XHRcdCdwYWdlc0NyZWF0aW9uTW9kZScsXG5cdFx0XHRcdCdwYWdlc0luZGV4RmlsZU5hbWUnLFxuXHRcdFx0XHQncGFnZVRlbXBsYXRlJyxcblx0XHRcdFx0J29ubHlBdXRvbWF0ZUluUGFnZXNGb2xkZXInLFxuXHRcdFx0XTtcblx0XHRcdFxuXHRcdFx0Y29uc3Qgc2V0dGluZ3NSZWNvcmQgPSB0aGlzLnNldHRpbmdzIGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG5cdFx0XHRmb3IgKGNvbnN0IGZpZWxkIG9mIGxlZ2FjeUZpZWxkcykge1xuXHRcdFx0XHRpZiAoc2V0dGluZ3NSZWNvcmRbZmllbGRdICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRkZWxldGUgc2V0dGluZ3NSZWNvcmRbZmllbGRdO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIFNhdmUgaW1tZWRpYXRlbHkgdG8gcmVtb3ZlIGFueSBsZWdhY3kgZmllbGRzIGZyb20gZGlza1xuXHRcdFx0Ly8gVGhpcyBlbnN1cmVzIGRlbGV0ZWQgY29udGVudCB0eXBlcyBkb24ndCBjb21lIGJhY2sgZnJvbSBsZWdhY3kgZmllbGRzXG5cdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xuXHRcdH1cblx0fVxuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuXHR9XG5cblx0cHJpdmF0ZSByZWdpc3RlckNvbnRleHRNZW51KCkge1xuXHRcdHRoaXMucmVnaXN0ZXJFdmVudChcblx0XHRcdHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLW1lbnUnLCAobWVudSwgZWRpdG9yLCB2aWV3KSA9PiB7XG5cdFx0XHRcdC8vIE9ubHkgc2hvdyBtZW51IGlmIHRoZSBmZWF0dXJlIGlzIGVuYWJsZWRcblx0XHRcdFx0aWYgKCF0aGlzLnNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluaykge1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRcdFx0Y29uc3QgZmlsZSA9IHZpZXcuZmlsZTtcblx0XHRcdFx0XG5cdFx0XHRcdGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblxuXHRcdFx0XHQvLyBGaW5kIHRoZSBoZWFkaW5nIGF0IHRoZSBjdXJyZW50IGN1cnNvciBwb3NpdGlvblxuXHRcdFx0XHRjb25zdCBoZWFkaW5nID0gdGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvci5maW5kSGVhZGluZ0F0TGluZSh0aGlzLmFwcCwgZmlsZSwgY3Vyc29yLmxpbmUpO1xuXHRcdFx0XHRcblx0XHRcdFx0aWYgKGhlYWRpbmcpIHtcblx0XHRcdFx0XHRjb25zdCBmdWxsTGluayA9IHRoaXMuaGVhZGluZ0xpbmtHZW5lcmF0b3IuZ2VuZXJhdGVMaW5rKHRoaXMuYXBwLCBmaWxlLCBoZWFkaW5nKTtcblx0XHRcdFx0XHRjb25zdCB1cmxPbmx5ID0gdGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvci5leHRyYWN0VXJsKGZ1bGxMaW5rKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBPcHRpb24gMTogQ29weSBVUkwgb25seSAoZm9yIENUUkwrSyB3b3JrZmxvdylcblx0XHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdGl0ZW1cblx0XHRcdFx0XHRcdFx0LnNldFRpdGxlKCdDb3B5IGhlYWRpbmcgbGluaycpXG5cdFx0XHRcdFx0XHRcdC5zZXRJY29uKCdsaW5rLTInKVxuXHRcdFx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQodXJsT25seSk7XG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnSGVhZGluZyBsaW5rIGNvcGllZCB0byBjbGlwYm9hcmQnKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gT3B0aW9uIDI6IENvcHkgZnVsbCBsaW5rIHdpdGggdGV4dCAoZm9yIHN0YW5kYWxvbmUgcGFzdGluZylcblx0XHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdGl0ZW1cblx0XHRcdFx0XHRcdFx0LnNldFRpdGxlKCdDb3B5IGhlYWRpbmcgbGluayB3aXRoIHRleHQnKVxuXHRcdFx0XHRcdFx0XHQuc2V0SWNvbignaGVhZGluZycpXG5cdFx0XHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChmdWxsTGluayk7XG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnSGVhZGluZyBsaW5rIHdpdGggdGV4dCBjb3BpZWQgdG8gY2xpcGJvYXJkJyk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9KVxuXHRcdCk7XG5cdH1cblxuXHQvKipcblx0ICogUmVuYW1lIGEgZmlsZSBieSBwYXRoIChmb3IgcHJvZ3JhbW1hdGljIHVzZSwgZS5nLiwgZnJvbSBvdGhlciBwbHVnaW5zKVxuXHQgKiBUaGlzIGFsbG93cyB0aGUgcmVuYW1lIG1vZGFsIHRvIGFwcGVhciB3aXRob3V0IG9wZW5pbmcgdGhlIGZpbGUgZmlyc3Rcblx0ICovXG5cdGFzeW5jIHJlbmFtZUNvbnRlbnRCeVBhdGgoZmlsZVBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGF3YWl0IHJlbmFtZUNvbnRlbnRCeVBhdGhGdW5jdGlvbih0aGlzLmFwcCwgZmlsZVBhdGgsIHRoaXMuc2V0dGluZ3MsIHRoaXMpO1xuXHR9XG5cblx0cHVibGljIHJlZ2lzdGVyUmliYm9uSWNvbnMoKSB7XG5cdFx0Ly8gVGVybWluYWwgYW5kIGNvbmZpZyBmZWF0dXJlcyBhcmUgZGVza3RvcC1vbmx5IChub3QgYXZhaWxhYmxlIG9uIG1vYmlsZSlcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdC8vIFJlbW92ZSBhbnkgZXhpc3RpbmcgaWNvbnMgb24gbW9iaWxlXG5cdFx0XHRpZiAodGhpcy50ZXJtaW5hbFJpYmJvbkljb24pIHtcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRpZiAodGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucmVtb3ZlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGNhdGNoIHtcblx0XHRcdFx0XHQvLyBTaWxlbnRseSBoYW5kbGUgZXJyb3JzXG5cdFx0XHRcdH1cblx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSBudWxsO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uSWNvbikge1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24ucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRcdFx0dGhpcy5jb25maWdSaWJib25JY29uLnJlbW92ZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBjYXRjaCB7XG5cdFx0XHRcdFx0Ly8gU2lsZW50bHkgaGFuZGxlIGVycm9yc1xuXHRcdFx0XHR9XG5cdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0XHR9XG5cdFx0XHQvLyBSZW1vdmUgZnJvbSBET01cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGNvbnN0IHRlcm1pbmFsSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIk9wZW4gcHJvamVjdCB0ZXJtaW5hbFwiXScpO1xuXHRcdFx0XHR0ZXJtaW5hbEljb25zLmZvckVhY2goKGljb246IEVsZW1lbnQpID0+IGljb24ucmVtb3ZlKCkpO1xuXHRcdFx0XHRjb25zdCBjb25maWdJY29ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaWRlLWRvY2stcmliYm9uLWFjdGlvblthcmlhLWxhYmVsPVwiRWRpdCBhc3RybyBjb25maWdcIl0nKTtcblx0XHRcdFx0Y29uZmlnSWNvbnMuZm9yRWFjaCgoaWNvbjogRWxlbWVudCkgPT4gaWNvbi5yZW1vdmUoKSk7XG5cdFx0XHR9IGNhdGNoIHtcblx0XHRcdFx0Ly8gU2lsZW50bHkgaGFuZGxlIGVycm9yc1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuOyAvLyBEb24ndCByZWdpc3RlciBpY29ucyBvbiBtb2JpbGVcblx0XHR9XG5cblx0XHQvLyBDYWxjdWxhdGUgd2hhdCBzaG91bGQgZXhpc3QgRklSU1QgKGJlZm9yZSBET00gc2VhcmNoKVxuXHRcdGNvbnN0IHRlcm1pbmFsUmliYm9uRW5hYmxlZCA9IHRoaXMuc2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uID09PSB0cnVlO1xuXHRcdGNvbnN0IHRlcm1pbmFsQ29tbWFuZEVuYWJsZWQgPSB0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQgPT09IHRydWU7XG5cdFx0Y29uc3QgdGVybWluYWxTaG91bGRFeGlzdCA9IHRlcm1pbmFsUmliYm9uRW5hYmxlZCAmJiB0ZXJtaW5hbENvbW1hbmRFbmFibGVkO1xuXG5cdFx0Y29uc3QgY29uZmlnUmliYm9uRW5hYmxlZCA9IHRoaXMuc2V0dGluZ3MuZW5hYmxlQ29uZmlnUmliYm9uSWNvbiA9PT0gdHJ1ZTtcblx0XHRjb25zdCBjb25maWdDb21tYW5kRW5hYmxlZCA9IHRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kID09PSB0cnVlO1xuXHRcdGNvbnN0IGNvbmZpZ1Nob3VsZEV4aXN0ID0gY29uZmlnUmliYm9uRW5hYmxlZCAmJiBjb25maWdDb21tYW5kRW5hYmxlZDtcblxuXHRcdC8vIEFMV0FZUyByZW1vdmUgYWxsIGljb25zIGZpcnN0LCByZWdhcmRsZXNzIG9mIHN0YXRlIC0gdGhpcyBlbnN1cmVzIGNsZWFuIHNsYXRlXG5cdFx0Ly8gUmVtb3ZlIGZyb20gb3VyIHJlZmVyZW5jZXMgZmlyc3Rcblx0XHRpZiAodGhpcy50ZXJtaW5hbFJpYmJvbkljb24pIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5wYXJlbnROb2RlKSB7XG5cdFx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucmVtb3ZlKCk7XG5cdFx0XHRcdH1cblx0XHRcdH0gY2F0Y2gge1xuXHRcdFx0XHQvLyBTaWxlbnRseSBoYW5kbGUgZXJyb3JzXG5cdFx0XHR9XG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24pIHtcblx0XHRcdHRyeSB7XG5cdFx0XHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24ucGFyZW50Tm9kZSkge1xuXHRcdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbi5yZW1vdmUoKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCB7XG5cdFx0XHRcdC8vIFNpbGVudGx5IGhhbmRsZSBlcnJvcnNcblx0XHRcdH1cblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFNlYXJjaCBET00gYW5kIHJlbW92ZSBBTEwgaW5zdGFuY2VzIG9mIG91ciBpY29ucyAoYnkgYXJpYS1sYWJlbClcblx0XHQvLyBUaGlzIGNhdGNoZXMgYW55IGljb25zIHRoYXQgbWlnaHQgZXhpc3QgYnV0IGFyZW4ndCB0cmFja2VkXG5cdFx0dHJ5IHtcblx0XHRcdC8vIEFMV0FZUyByZW1vdmUgQUxMIHRlcm1pbmFsIGljb25zLCByZWdhcmRsZXNzIG9mIHNldHRpbmdzXG5cdFx0XHRjb25zdCB0ZXJtaW5hbEljb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtZG9jay1yaWJib24tYWN0aW9uW2FyaWEtbGFiZWw9XCJPcGVuIHByb2plY3QgdGVybWluYWxcIl0nKTtcblx0XHRcdHRlcm1pbmFsSWNvbnMuZm9yRWFjaCgoaWNvbjogRWxlbWVudCkgPT4gaWNvbi5yZW1vdmUoKSk7XG5cdFx0XHRcblx0XHRcdC8vIEFMV0FZUyByZW1vdmUgQUxMIGNvbmZpZyBpY29ucywgcmVnYXJkbGVzcyBvZiBzZXR0aW5nc1xuXHRcdFx0Y29uc3QgY29uZmlnSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIkVkaXQgYXN0cm8gY29uZmlnXCJdJyk7XG5cdFx0XHRjb25maWdJY29ucy5mb3JFYWNoKChpY29uOiBFbGVtZW50KSA9PiBpY29uLnJlbW92ZSgpKTtcblx0XHR9IGNhdGNoIHtcblx0XHRcdC8vIFNpbGVudGx5IGhhbmRsZSBlcnJvcnNcblx0XHR9XG5cblx0XHQvLyBOb3cgYWRkIG9ubHkgdGhlIGljb25zIHRoYXQgc2hvdWxkIGV4aXN0XG5cdFx0aWYgKHRlcm1pbmFsU2hvdWxkRXhpc3QpIHtcblx0XHRcdC8vIE9ubHkgYWRkIGlmIGljb24gZG9lc24ndCBleGlzdCBpbiBET01cblx0XHRcdGNvbnN0IGV4aXN0aW5nVGVybWluYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIk9wZW4gcHJvamVjdCB0ZXJtaW5hbFwiXScpO1xuXHRcdFx0aWYgKCFleGlzdGluZ1Rlcm1pbmFsKSB7XG5cdFx0XHRcdHRoaXMudGVybWluYWxSaWJib25JY29uID0gdGhpcy5hZGRSaWJib25JY29uKCd0ZXJtaW5hbC1zcXVhcmUnLCAnT3BlbiBwcm9qZWN0IHRlcm1pbmFsJywgYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKSB7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKFwiT3BlbiB0ZXJtaW5hbCBjb21tYW5kIGlzIGRpc2FibGVkLiBFbmFibGUgaXQgaW4gc2V0dGluZ3MgdG8gdXNlIHRoaXMgY29tbWFuZC5cIik7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGF3YWl0IG9wZW5UZXJtaW5hbEluUHJvamVjdFJvb3QodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gQWRkIGRhdGEgYXR0cmlidXRlIHRvIGlkZW50aWZ5IG91ciBpY29uXG5cdFx0XHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xuXHRcdFx0XHRcdHRoaXMudGVybWluYWxSaWJib25JY29uLnNldEF0dHJpYnV0ZSgnZGF0YS1hc3Ryby1jb21wb3Nlci10ZXJtaW5hbC1yaWJib24nLCAndHJ1ZScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IGV4aXN0aW5nVGVybWluYWwgYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIEltbWVkaWF0ZWx5IGNoZWNrIGFuZCByZW1vdmUgY29uZmlnIGljb24gaWYgaXQgd2FzIHJlLWFkZGVkXG5cdFx0XHRpZiAoIWNvbmZpZ1Nob3VsZEV4aXN0KSB7XG5cdFx0XHRcdGNvbnN0IGNvbmZpZ0ljb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtZG9jay1yaWJib24tYWN0aW9uW2FyaWEtbGFiZWw9XCJFZGl0IGFzdHJvIGNvbmZpZ1wiXScpO1xuXHRcdFx0XHRpZiAoY29uZmlnSWNvbnMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdGNvbmZpZ0ljb25zLmZvckVhY2goKGljb246IEVsZW1lbnQpID0+IGljb24ucmVtb3ZlKCkpO1xuXHRcdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSBudWxsO1xuXHRcdH1cblxuXHRcdGlmIChjb25maWdTaG91bGRFeGlzdCkge1xuXHRcdFx0Ly8gT25seSBhZGQgaWYgaWNvbiBkb2Vzbid0IGV4aXN0IGluIERPTVxuXHRcdFx0Y29uc3QgZXhpc3RpbmdDb25maWcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIkVkaXQgYXN0cm8gY29uZmlnXCJdJyk7XG5cdFx0XHRpZiAoIWV4aXN0aW5nQ29uZmlnKSB7XG5cdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbignd3JlbmNoJywgJ0VkaXQgYXN0cm8gY29uZmlnJywgYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpIHtcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJFZGl0IGNvbmZpZyBmaWxlIGNvbW1hbmQgaXMgZGlzYWJsZWQuIEVuYWJsZSBpdCBpbiBzZXR0aW5ncyB0byB1c2UgdGhpcyBjb21tYW5kLlwiKTtcblx0XHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YXdhaXQgb3BlbkNvbmZpZ0ZpbGUodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gQWRkIGRhdGEgYXR0cmlidXRlIHRvIGlkZW50aWZ5IG91ciBpY29uXG5cdFx0XHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24pIHtcblx0XHRcdFx0XHR0aGlzLmNvbmZpZ1JpYmJvbkljb24uc2V0QXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLWNvbmZpZy1yaWJib24nLCAndHJ1ZScpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmNvbmZpZ1JpYmJvbkljb24gPSBleGlzdGluZ0NvbmZpZyBhcyBIVE1MRWxlbWVudDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Ly8gSW1tZWRpYXRlbHkgY2hlY2sgYW5kIHJlbW92ZSB0ZXJtaW5hbCBpY29uIGlmIGl0IHdhcyByZS1hZGRlZFxuXHRcdFx0aWYgKCF0ZXJtaW5hbFNob3VsZEV4aXN0KSB7XG5cdFx0XHRcdGNvbnN0IHRlcm1pbmFsSWNvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIk9wZW4gcHJvamVjdCB0ZXJtaW5hbFwiXScpO1xuXHRcdFx0XHRpZiAodGVybWluYWxJY29ucy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0dGVybWluYWxJY29ucy5mb3JFYWNoKChpY29uOiBFbGVtZW50KSA9PiBpY29uLnJlbW92ZSgpKTtcblx0XHRcdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5jb25maWdSaWJib25JY29uID0gbnVsbDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIGNvbnRleHQgbWVudSBoYW5kbGluZyBhZnRlciBpY29ucyBhcmUgcmVnaXN0ZXJlZFxuXHRcdHRoaXMudXBkYXRlUmliYm9uQ29udGV4dE1lbnVDU1MoKTtcblx0XHR0aGlzLnNldHVwUmliYm9uQ29udGV4dE1lbnVPYnNlcnZlcigpO1xuXHRcdFxuXHRcdC8vIEZpbmFsIGNsZWFudXAgcGFzcyAtIGVuc3VyZSBubyB1bndhbnRlZCBpY29ucyBleGlzdCBpbiBET01cblx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdGlmICghdGVybWluYWxTaG91bGRFeGlzdCkge1xuXHRcdFx0XHRjb25zdCB0ZXJtaW5hbEljb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNpZGUtZG9jay1yaWJib24tYWN0aW9uW2FyaWEtbGFiZWw9XCJPcGVuIHByb2plY3QgdGVybWluYWxcIl0nKTtcblx0XHRcdFx0dGVybWluYWxJY29ucy5mb3JFYWNoKChpY29uOiBFbGVtZW50KSA9PiBpY29uLnJlbW92ZSgpKTtcblx0XHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24gPSBudWxsO1xuXHRcdFx0fVxuXHRcdFx0aWYgKCFjb25maWdTaG91bGRFeGlzdCkge1xuXHRcdFx0XHRjb25zdCBjb25maWdJY29ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaWRlLWRvY2stcmliYm9uLWFjdGlvblthcmlhLWxhYmVsPVwiRWRpdCBhc3RybyBjb25maWdcIl0nKTtcblx0XHRcdFx0Y29uZmlnSWNvbnMuZm9yRWFjaCgoaWNvbjogRWxlbWVudCkgPT4gaWNvbi5yZW1vdmUoKSk7XG5cdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0XHR9XG5cdFx0fSwgMTAwKTtcblx0fVxuXG5cdG9udW5sb2FkKCkge1xuXHRcdC8vIENsZWFuIHVwIHJpYmJvbiBpY29uc1xuXHRcdGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbikge1xuXHRcdFx0dGhpcy50ZXJtaW5hbFJpYmJvbkljb24ucmVtb3ZlKCk7XG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0fVxuXHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24pIHtcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbi5yZW1vdmUoKTtcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbiA9IG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENsZWFudXAgcmliYm9uIGNvbnRleHQgbWVudSBoYW5kbGluZ1xuXHRcdGlmICh0aGlzLnJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIpIHtcblx0XHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0XHR0aGlzLnJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIgPSB1bmRlZmluZWQ7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFJlbW92ZSBDU1MgY2xhc3Nlc1xuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtdGVybWluYWwtaWNvbicpO1xuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtY29uZmlnLWljb24nKTtcblxuXHRcdC8vIENsZWFudXAgaGVscCBidXR0b24gcmVwbGFjZW1lbnRcblx0XHRpZiAodGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIpIHtcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyID0gdW5kZWZpbmVkO1xuXHRcdH1cblxuXG5cdFx0aWYgKHRoaXMuY3VzdG9tSGVscEJ1dHRvbikge1xuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uLnJlbW92ZSgpO1xuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHRcdHRoaXMuaGVscEJ1dHRvbkVsZW1lbnQgPSB1bmRlZmluZWQ7XG5cdH1cblxuXHQvLyBSaWJib24gY29udGV4dCBtZW51IGhhbmRsaW5nIC0gYmFzZWQgb24gQXN0cm8gTW9kdWxhciBTZXR0aW5ncyBhcHByb2FjaFxuXHRwcml2YXRlIHNldHVwUmliYm9uQ29udGV4dE1lbnVIYW5kbGluZygpIHtcblx0XHR0aGlzLnVwZGF0ZVJpYmJvbkNvbnRleHRNZW51Q1NTKCk7XG5cdFx0dGhpcy5zZXR1cFJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIoKTtcblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlUmliYm9uQ29udGV4dE1lbnVDU1MoKSB7XG5cdFx0Ly8gQ2hlY2sgaWYgZWl0aGVyIGljb24gc2hvdWxkIGJlIGhpZGRlblxuXHRcdGNvbnN0IHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4gPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xuXG5cdFx0Ly8gVXNlIENTUyBjbGFzc2VzIG9uIGRvY3VtZW50IGJvZHkgdG8gY29udHJvbCB2aXNpYmlsaXR5XG5cdFx0aWYgKHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4pIHtcblx0XHRcdGRvY3VtZW50LmJvZHkuYWRkQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtdGVybWluYWwtaWNvbicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLXRlcm1pbmFsLWljb24nKTtcblx0XHR9XG5cdFx0XG5cdFx0aWYgKGNvbmZpZ1Nob3VsZEJlSGlkZGVuKSB7XG5cdFx0XHRkb2N1bWVudC5ib2R5LmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWNvbmZpZy1pY29uJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtY29uZmlnLWljb24nKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHNldHVwUmliYm9uQ29udGV4dE1lbnVPYnNlcnZlcigpIHtcblx0XHQvLyBEaXNjb25uZWN0IGV4aXN0aW5nIG9ic2VydmVyIGlmIGFueVxuXHRcdGlmICh0aGlzLnJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIpIHtcblx0XHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlci5kaXNjb25uZWN0KCk7XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgd2UgbmVlZCB0byBoaWRlIGFueSBpY29uc1xuXHRcdGNvbnN0IHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4gPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xuXG5cdFx0Ly8gT25seSBzZXQgdXAgb2JzZXJ2ZXIgaWYgYW55IGljb24gc2hvdWxkIGJlIGhpZGRlblxuXHRcdGlmICghdGVybWluYWxTaG91bGRCZUhpZGRlbiAmJiAhY29uZmlnU2hvdWxkQmVIaWRkZW4pIHtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBXYXRjaCBmb3IgY29udGV4dCBtZW51IGNyZWF0aW9uIGFuZCByZW1vdmUgb3VyIGl0ZW1zXG5cdFx0dGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xuXHRcdFx0Zm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHtcblx0XHRcdFx0aWYgKG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdC8vIENoZWNrIGlmIGEgbWVudSB3YXMgYWRkZWRcblx0XHRcdFx0XHRmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbShtdXRhdGlvbi5hZGRlZE5vZGVzKSkge1xuXHRcdFx0XHRcdFx0aWYgKG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuXHRcdFx0XHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgbWVudVxuXHRcdFx0XHRcdFx0XHRpZiAobm9kZS5jbGFzc0xpc3QuY29udGFpbnMoJ21lbnUnKSB8fCBub2RlLnF1ZXJ5U2VsZWN0b3IoJy5tZW51JykpIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnJlbW92ZVJpYmJvbkljb25zRnJvbUNvbnRleHRNZW51KG5vZGUpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHQvLyBPYnNlcnZlIHRoZSBkb2N1bWVudCBib2R5IGZvciBtZW51IGFkZGl0aW9uc1xuXHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcblx0XHRcdGNoaWxkTGlzdDogdHJ1ZSxcblx0XHRcdHN1YnRyZWU6IHRydWUsXG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUhlbHBCdXR0b25DU1MoKSB7XG5cdFx0Ly8gVXNlIENTUyBjbGFzcyBvbiBkb2N1bWVudCBib2R5IHRvIGNvbnRyb2wgdmlzaWJpbGl0eVxuXHRcdGlmICh0aGlzLnNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudD8uZW5hYmxlZCkge1xuXHRcdFx0ZG9jdW1lbnQuYm9keS5hZGRDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS1oZWxwLWJ1dHRvbicpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWhlbHAtYnV0dG9uJyk7XG5cdFx0fVxuXHR9XG5cblx0cHVibGljIGFzeW5jIHVwZGF0ZUhlbHBCdXR0b24oKSB7XG5cdFx0Ly8gSGVscCBidXR0b24gcmVwbGFjZW1lbnQgaXMgZGVza3RvcC1vbmx5IChub3QgYXZhaWxhYmxlIG9uIG1vYmlsZSlcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdC8vIENsZWFuIHVwIGFueSBleGlzdGluZyBoZWxwIGJ1dHRvbiByZXBsYWNlbWVudCBvbiBtb2JpbGVcblx0XHRcdHRoaXMucmVzdG9yZUhlbHBCdXR0b24oKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBUZW1wb3JhcmlseSBkaXNjb25uZWN0IG9ic2VydmVyIHRvIHByZXZlbnQgaW5maW5pdGUgbG9vcHNcblx0XHRpZiAodGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIpIHtcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcblx0XHR9XG5cblx0XHQvLyBFbnN1cmUgd2UgaGF2ZSB0aGUgbGF0ZXN0IHNldHRpbmdzXG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdC8vIFVwZGF0ZSBDU1MgZmlyc3QgKHRoaXMgd2lsbCBoaWRlIHRoZSBoZWxwIGJ1dHRvbiBnbG9iYWxseSlcblx0XHR0aGlzLnVwZGF0ZUhlbHBCdXR0b25DU1MoKTtcblxuXHRcdC8vIENoZWNrIGlmIHJlcGxhY2VtZW50IGlzIGVuYWJsZWRcblx0XHRpZiAoIXRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSB7XG5cdFx0XHR0aGlzLnJlc3RvcmVIZWxwQnV0dG9uKCk7XG5cdFx0XHQvLyBTdGlsbCBzZXQgdXAgb2JzZXJ2ZXIgaW4gY2FzZSB1c2VyIGVuYWJsZXMgaXQgbGF0ZXJcblx0XHRcdHRoaXMuc2V0dXBIZWxwQnV0dG9uT2JzZXJ2ZXIoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBGaW5kIHRoZSBoZWxwIGJ1dHRvblxuXHRcdGNvbnN0IHZhdWx0QWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53b3Jrc3BhY2UtZHJhd2VyLXZhdWx0LWFjdGlvbnMnKTtcblx0XHRpZiAoIXZhdWx0QWN0aW9ucykge1xuXHRcdFx0Ly8gVmF1bHQgYWN0aW9ucyBub3QgZm91bmQgeWV0IC0gc2V0IHVwIG9ic2VydmVyIHRvIGNhdGNoIGl0IHdoZW4gaXQgYXBwZWFyc1xuXHRcdFx0dGhpcy5zZXR1cEhlbHBCdXR0b25PYnNlcnZlcigpO1xuXHRcdFx0Ly8gQWxzbyByZXRyeSBhZnRlciBhIHNob3J0IGRlbGF5XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSB7XG5cdFx0XHRcdFx0dm9pZCB0aGlzLnVwZGF0ZUhlbHBCdXR0b24oKTtcblx0XHRcdFx0fVxuXHRcdFx0fSwgNTAwKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHQvLyBGaW5kIHRoZSBoZWxwIGJ1dHRvbiAtIGl0J3MgdGhlIGZpcnN0IGNsaWNrYWJsZS1pY29uIHRoYXQgY29udGFpbnMgYW4gU1ZHIHdpdGggY2xhc3MgXCJoZWxwXCJcblx0XHRjb25zdCBjbGlja2FibGVJY29ucyA9IEFycmF5LmZyb20odmF1bHRBY3Rpb25zLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jbGlja2FibGUtaWNvbicpKTtcblx0XHRsZXQgaGVscEJ1dHRvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0XHRcblx0XHRmb3IgKGNvbnN0IGljb24gb2YgY2xpY2thYmxlSWNvbnMpIHtcblx0XHRcdGNvbnN0IHN2ZyA9IGljb24ucXVlcnlTZWxlY3Rvcignc3ZnLmhlbHAnKTtcblx0XHRcdGlmIChzdmcpIHtcblx0XHRcdFx0aGVscEJ1dHRvbiA9IGljb24gYXMgSFRNTEVsZW1lbnQ7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHRpZiAoIWhlbHBCdXR0b24pIHtcblx0XHRcdC8vIEhlbHAgYnV0dG9uIG5vdCBmb3VuZCB5ZXQgLSBzZXQgdXAgb2JzZXJ2ZXIgdG8gY2F0Y2ggaXQgd2hlbiBpdCBhcHBlYXJzXG5cdFx0XHR0aGlzLnNldHVwSGVscEJ1dHRvbk9ic2VydmVyKCk7XG5cdFx0XHQvLyBBbHNvIHJldHJ5IGFmdGVyIGEgc2hvcnQgZGVsYXlcblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRpZiAodGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQpIHtcblx0XHRcdFx0XHR2b2lkIHRoaXMudXBkYXRlSGVscEJ1dHRvbigpO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCA1MDApO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFN0b3JlIHJlZmVyZW5jZSB0byB0aGUgYnV0dG9uXG5cdFx0dGhpcy5oZWxwQnV0dG9uRWxlbWVudCA9IGhlbHBCdXR0b247XG5cblx0XHQvLyBSZW1vdmUgZXhpc3RpbmcgY3VzdG9tIGJ1dHRvbiBpZiBpdCBleGlzdHMgKGFsd2F5cyByZWNyZWF0ZSB0byB1cGRhdGUgaWNvbi9jb21tYW5kKVxuXHRcdC8vIENoZWNrIGlmIGl0J3MgYWN0dWFsbHkgaW4gdGhlIERPTSBhbmQgaGFzIG91ciBpZGVudGlmaWVyIGJlZm9yZSB0cnlpbmcgdG8gcmVtb3ZlIGl0XG5cdFx0aWYgKHRoaXMuY3VzdG9tSGVscEJ1dHRvbiAmJiBcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5wYXJlbnRFbGVtZW50ICYmIFxuXHRcdFx0ZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmN1c3RvbUhlbHBCdXR0b24pICYmXG5cdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24uaGFzQXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnQnKSkge1xuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uLnJlbW92ZSgpO1xuXHRcdH1cblx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24gPSB1bmRlZmluZWQ7XG5cblx0XHQvLyBDcmVhdGUgYSBuZXcgY3VzdG9tIGJ1dHRvblxuXHRcdGNvbnN0IGN1c3RvbUJ1dHRvbiA9IGhlbHBCdXR0b24uY2xvbmVOb2RlKHRydWUpIGFzIEhUTUxFbGVtZW50O1xuXHRcdGN1c3RvbUJ1dHRvbi5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnRcIik7XG5cdFx0Y3VzdG9tQnV0dG9uLnJlbW92ZUF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcpOyAvLyBSZW1vdmUgYW55IGV4aXN0aW5nIGFyaWEtbGFiZWxcblx0XHRcblx0XHQvLyBBZGQgdW5pcXVlIGlkZW50aWZpZXIgdG8gYXZvaWQgY29uZmxpY3RzIHdpdGggb3RoZXIgcGx1Z2luc1xuXHRcdGN1c3RvbUJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtYXN0cm8tY29tcG9zZXItaGVscC1yZXBsYWNlbWVudCcsICd0cnVlJyk7XG5cdFx0Y3VzdG9tQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2FzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnQnKTtcblx0XHRcblx0XHQvLyBDbGVhciBhbnkgZXhpc3RpbmcgY2xpY2sgaGFuZGxlcnNcblx0XHRjdXN0b21CdXR0b24ub25jbGljayA9IG51bGw7XG5cdFx0XG5cdFx0Ly8gUmVwbGFjZSB0aGUgaWNvbiB1c2luZyBPYnNpZGlhbidzIHNldEljb24gZnVuY3Rpb25cblx0XHRjb25zdCBpY29uQ29udGFpbmVyID0gY3VzdG9tQnV0dG9uLnF1ZXJ5U2VsZWN0b3IoJ3N2ZycpPy5wYXJlbnRFbGVtZW50IHx8IGN1c3RvbUJ1dHRvbjtcblx0XHR0cnkge1xuXHRcdFx0aWYgKGljb25Db250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xuXHRcdFx0XHRzZXRJY29uKGljb25Db250YWluZXIsIHRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Lmljb25JZCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBzZXR0aW5nIGljb246JywgZXJyb3IpO1xuXHRcdH1cblxuXHRcdC8vIEFkZCBvdXIgY3VzdG9tIGNsaWNrIGhhbmRsZXJcblx0XHRjdXN0b21CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRldnQucHJldmVudERlZmF1bHQoKTtcblx0XHRcdGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcblx0XHRcdFxuXHRcdFx0Y29uc3QgY29tbWFuZElkID0gdGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmNvbW1hbmRJZDtcblx0XHRcdGlmIChjb21tYW5kSWQpIHtcblx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0XHRjb25zdCBhcHBXaXRoQ29tbWFuZHMgPSB0aGlzLmFwcCBhcyB1bmtub3duIGFzIHsgY29tbWFuZHM/OiB7IGV4ZWN1dGVDb21tYW5kQnlJZD86IChpZDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+IH0gfTtcblx0XHRcdFx0XHRcdGlmIChhcHBXaXRoQ29tbWFuZHMuY29tbWFuZHM/LmV4ZWN1dGVDb21tYW5kQnlJZCkge1xuXHRcdFx0XHRcdFx0XHRhd2FpdCBhcHBXaXRoQ29tbWFuZHMuY29tbWFuZHMuZXhlY3V0ZUNvbW1hbmRCeUlkKGNvbW1hbmRJZCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBleGVjdXRpbmcgY29tbWFuZDonLCBlcnJvcik7XG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gZXhlY3V0ZSBjb21tYW5kOiAke2NvbW1hbmRJZH1gKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0pKCk7XG5cdFx0XHR9XG5cdFx0fSwgdHJ1ZSk7IC8vIFVzZSBjYXB0dXJlIHBoYXNlIHRvIGVuc3VyZSB3ZSBoYW5kbGUgaXQgZmlyc3RcblxuXHRcdC8vIEluc2VydCB0aGUgY3VzdG9tIGJ1dHRvbiBpbiB0aGUgc2FtZSBwb3NpdGlvbiBhcyB0aGUgaGVscCBidXR0b24gKGJlZm9yZSBpdClcblx0XHQvLyBUaGlzIGVuc3VyZXMgaXQgdGFrZXMgdGhlIGhlbHAgYnV0dG9uJ3MgcG9zaXRpb24gd2l0aG91dCBhZmZlY3Rpbmcgb3RoZXIgYnV0dG9uc1xuXHRcdGhlbHBCdXR0b24ucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKGN1c3RvbUJ1dHRvbiwgaGVscEJ1dHRvbik7XG5cdFx0XG5cdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIHRvIGN1c3RvbSBidXR0b25cblx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24gPSBjdXN0b21CdXR0b247XG5cblx0XHQvLyBTZXQgdXAgb2JzZXJ2ZXIgYWZ0ZXIgYSBkZWxheSB0byB3YXRjaCBmb3IgY2hhbmdlc1xuXHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSB7XG5cdFx0XHRcdHRoaXMuc2V0dXBIZWxwQnV0dG9uT2JzZXJ2ZXIoKTtcblx0XHRcdH1cblx0XHR9LCAxMDAwKTtcblx0fVxuXG5cdHByaXZhdGUgc2V0dXBIZWxwQnV0dG9uT2JzZXJ2ZXIoKSB7XG5cdFx0Ly8gRGlzY29ubmVjdCBleGlzdGluZyBvYnNlcnZlciBpZiBhbnlcblx0XHRpZiAodGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIpIHtcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcblx0XHR9XG5cblx0XHQvLyBPbmx5IHNldCB1cCBvYnNlcnZlciBpZiByZXBsYWNlbWVudCBpcyBlbmFibGVkXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudD8uZW5hYmxlZCkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdC8vIFdhdGNoIGZvciBjaGFuZ2VzIHRvIHRoZSB2YXVsdCBwcm9maWxlIGFyZWEgb25seSAobW9yZSB0YXJnZXRlZClcblx0XHRsZXQgdXBkYXRlVGltZW91dDogbnVtYmVyIHwgbnVsbCA9IG51bGw7XG5cdFx0dGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIgPSBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG5cdFx0XHQvLyBEZWJvdW5jZSB1cGRhdGVzIHRvIHByZXZlbnQgaW5maW5pdGUgbG9vcHNcblx0XHRcdGlmICh1cGRhdGVUaW1lb3V0KSB7XG5cdFx0XHRcdGNsZWFyVGltZW91dCh1cGRhdGVUaW1lb3V0KTtcblx0XHRcdH1cblx0XHRcdHVwZGF0ZVRpbWVvdXQgPSB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIGhlbHAgYnV0dG9uIHdhcyByZWNyZWF0ZWQgKENTUyB3aWxsIGhpZGUgaXQsIGJ1dCB3ZSBuZWVkIHRvIGluamVjdCBvdXIgY3VzdG9tIGJ1dHRvbilcblx0XHRcdFx0Y29uc3QgdmF1bHRBY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1kcmF3ZXItdmF1bHQtYWN0aW9ucycpO1xuXHRcdFx0XHRpZiAoIXZhdWx0QWN0aW9ucykgcmV0dXJuO1xuXHRcdFx0XHRcblx0XHRcdC8vIENoZWNrIGlmIHdlIGhhdmUgYSBjdXN0b20gYnV0dG9uIEFORCBpdCdzIHN0aWxsIGluIHRoZSBET01cblx0XHRcdC8vIFRoZSByZWZlcmVuY2UgbWlnaHQgZXhpc3QgYnV0IHRoZSBidXR0b24gY291bGQgaGF2ZSBiZWVuIHJlbW92ZWRcblx0XHRcdC8vIEFsc28gdmVyaWZ5IGl0IGhhcyBvdXIgdW5pcXVlIGlkZW50aWZpZXIgdG8gYXZvaWQgY29uZmxpY3RzIHdpdGggb3RoZXIgcGx1Z2luc1xuXHRcdFx0Y29uc3QgY3VzdG9tQnV0dG9uRXhpc3RzID0gdGhpcy5jdXN0b21IZWxwQnV0dG9uICYmIFxuXHRcdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24ucGFyZW50RWxlbWVudCAmJiBcblx0XHRcdFx0ZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmN1c3RvbUhlbHBCdXR0b24pICYmXG5cdFx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5oYXNBdHRyaWJ1dGUoJ2RhdGEtYXN0cm8tY29tcG9zZXItaGVscC1yZXBsYWNlbWVudCcpO1xuXHRcdFx0XG5cdFx0XHRpZiAoIWN1c3RvbUJ1dHRvbkV4aXN0cykge1xuXHRcdFx0XHQvLyBDbGVhciBzdGFsZSByZWZlcmVuY2UgaWYgYnV0dG9uIHdhcyByZW1vdmVkIG9yIGRvZXNuJ3QgaGF2ZSBvdXIgaWRlbnRpZmllclxuXHRcdFx0XHRpZiAodGhpcy5jdXN0b21IZWxwQnV0dG9uICYmICghZG9jdW1lbnQuYm9keS5jb250YWlucyh0aGlzLmN1c3RvbUhlbHBCdXR0b24pIHx8IFxuXHRcdFx0XHRcdCF0aGlzLmN1c3RvbUhlbHBCdXR0b24uaGFzQXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnQnKSkpIHtcblx0XHRcdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0dm9pZCB0aGlzLnVwZGF0ZUhlbHBCdXR0b24oKTtcblx0XHRcdH1cblx0XHRcdH0sIDEwMCk7IC8vIFNob3J0ZXIgZGVib3VuY2UgZm9yIGJldHRlciByZXNwb25zaXZlbmVzc1xuXHRcdH0pO1xuXG5cdFx0Ly8gT2JzZXJ2ZSB0aGUgdmF1bHQgYWN0aW9ucyBhcmVhIG1vcmUgc3BlY2lmaWNhbGx5XG5cdFx0Y29uc3QgdmF1bHRBY3Rpb25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLndvcmtzcGFjZS1kcmF3ZXItdmF1bHQtYWN0aW9ucycpO1xuXHRcdGlmICh2YXVsdEFjdGlvbnMpIHtcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLm9ic2VydmUodmF1bHRBY3Rpb25zLCB7XG5cdFx0XHRcdGNoaWxkTGlzdDogdHJ1ZSxcblx0XHRcdFx0c3VidHJlZTogdHJ1ZSwgLy8gV2F0Y2ggc3VidHJlZSB0byBjYXRjaCB3aGVuIGJ1dHRvbnMgYXJlIHJlY3JlYXRlZFxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIEFsc28gb2JzZXJ2ZSB0aGUgcGFyZW50IHZhdWx0IHByb2ZpbGUgYXJlYVxuXHRcdGNvbnN0IHZhdWx0UHJvZmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy53b3Jrc3BhY2Utc2lkZWRvY2stdmF1bHQtcHJvZmlsZScpO1xuXHRcdGlmICh2YXVsdFByb2ZpbGUpIHtcblx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLm9ic2VydmUodmF1bHRQcm9maWxlLCB7XG5cdFx0XHRcdGNoaWxkTGlzdDogdHJ1ZSxcblx0XHRcdFx0c3VidHJlZTogdHJ1ZSwgLy8gV2F0Y2ggc3VidHJlZSB0byBjYXRjaCB3aGVuIHZhdWx0IGFjdGlvbnMgYXJlIGFkZGVkXG5cdFx0XHR9KTtcblx0XHR9XG5cblx0XHQvLyBGYWxsYmFjazogb2JzZXJ2ZSB0aGUgd29ya3NwYWNlIGNvbnRhaW5lciBpZiBzcGVjaWZpYyBlbGVtZW50cyBkb24ndCBleGlzdCB5ZXRcblx0XHQvLyBUaGlzIGVuc3VyZXMgd2UgY2F0Y2ggdGhlIGJ1dHRvbiB3aGVuIGl0IGZpcnN0IGFwcGVhcnNcblx0XHRpZiAoIXZhdWx0QWN0aW9ucyAmJiAhdmF1bHRQcm9maWxlKSB7XG5cdFx0XHRjb25zdCB3b3Jrc3BhY2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXNwbGl0Jyk7XG5cdFx0XHRpZiAod29ya3NwYWNlKSB7XG5cdFx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLm9ic2VydmUod29ya3NwYWNlLCB7XG5cdFx0XHRcdFx0Y2hpbGRMaXN0OiB0cnVlLFxuXHRcdFx0XHRcdHN1YnRyZWU6IHRydWUsXG5cdFx0XHRcdH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gTGFzdCByZXNvcnQ6IG9ic2VydmUgZG9jdW1lbnQgYm9keSAoYnV0IHdpdGggbW9yZSBzcGVjaWZpYyBjaGVja3MpXG5cdFx0XHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xuXHRcdFx0XHRcdGNoaWxkTGlzdDogdHJ1ZSxcblx0XHRcdFx0XHRzdWJ0cmVlOiB0cnVlLFxuXHRcdFx0XHR9KTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHJlc3RvcmVIZWxwQnV0dG9uKCkge1xuXHRcdC8vIFJlbW92ZSBDU1MgY2xhc3MgdGhhdCBoaWRlcyBoZWxwIGJ1dHRvblxuXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtaGVscC1idXR0b24nKTtcblxuXHRcdC8vIFJlbW92ZSB0aGUgY3VzdG9tIGJ1dHRvblxuXHRcdGlmICh0aGlzLmN1c3RvbUhlbHBCdXR0b24pIHtcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbi5yZW1vdmUoKTtcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbiA9IHVuZGVmaW5lZDtcblx0XHR9XG5cblx0XHQvLyBDbGVhciBzdG9yZWQgcmVmZXJlbmNlc1xuXHRcdHRoaXMuaGVscEJ1dHRvbkVsZW1lbnQgPSB1bmRlZmluZWQ7XG5cdH1cblxuXHRwcml2YXRlIHJlbW92ZVJpYmJvbkljb25zRnJvbUNvbnRleHRNZW51KG1lbnVFbGVtZW50OiBIVE1MRWxlbWVudCkge1xuXHRcdGNvbnN0IHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4gPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcblx0XHRjb25zdCBjb25maWdTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xuXG5cdFx0Ly8gRmluZCBhbGwgbWVudSBpdGVtc1xuXHRcdGNvbnN0IG1lbnVJdGVtcyA9IG1lbnVFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51LWl0ZW0nKTtcblx0XHRmb3IgKGNvbnN0IGl0ZW0gb2YgQXJyYXkuZnJvbShtZW51SXRlbXMpKSB7XG5cdFx0XHQvLyBDaGVjayBpZiB0aGlzIG1lbnUgaXRlbSBjb250YWlucyBvdXIgaWNvbnNcblx0XHRcdGNvbnN0IHN2ZyA9IGl0ZW0ucXVlcnlTZWxlY3Rvcignc3ZnJyk7XG5cdFx0XHRpZiAoc3ZnKSB7XG5cdFx0XHRcdGNvbnN0IGljb25OYW1lID0gc3ZnLmdldEF0dHJpYnV0ZSgnZGF0YS1sdWNpZGUnKSB8fCBcblx0XHRcdFx0XHRzdmcuZ2V0QXR0cmlidXRlKCd4bWxuczpsdWNpZGUnKSB8fFxuXHRcdFx0XHRcdChzdmcuY2xhc3NMaXN0LmNvbnRhaW5zKCdsdWNpZGUtdGVybWluYWwtc3F1YXJlJykgPyAndGVybWluYWwtc3F1YXJlJyA6IG51bGwpIHx8XG5cdFx0XHRcdFx0KHN2Zy5jbGFzc0xpc3QuY29udGFpbnMoJ2x1Y2lkZS13cmVuY2gnKSA/ICd3cmVuY2gnIDogbnVsbCk7XG5cdFx0XHRcdFxuXHRcdFx0XHQvLyBSZW1vdmUgdGVybWluYWwgaWNvbiBpZiBpdCBzaG91bGQgYmUgaGlkZGVuXG5cdFx0XHRcdGlmICh0ZXJtaW5hbFNob3VsZEJlSGlkZGVuICYmIGljb25OYW1lID09PSAndGVybWluYWwtc3F1YXJlJykge1xuXHRcdFx0XHRcdGNvbnN0IGl0ZW1UZXh0ID0gaXRlbS50ZXh0Q29udGVudD8udG9Mb3dlckNhc2UoKSB8fCAnJztcblx0XHRcdFx0XHRpZiAoaXRlbVRleHQuaW5jbHVkZXMoJ3Rlcm1pbmFsJykgfHwgaXRlbVRleHQuaW5jbHVkZXMoJ3Byb2plY3QgdGVybWluYWwnKSkge1xuXHRcdFx0XHRcdFx0aXRlbS5yZW1vdmUoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0XG5cdFx0XHRcdC8vIFJlbW92ZSBjb25maWcgaWNvbiBpZiBpdCBzaG91bGQgYmUgaGlkZGVuXG5cdFx0XHRcdGlmIChjb25maWdTaG91bGRCZUhpZGRlbiAmJiBpY29uTmFtZSA9PT0gJ3dyZW5jaCcpIHtcblx0XHRcdFx0XHRjb25zdCBpdGVtVGV4dCA9IGl0ZW0udGV4dENvbnRlbnQ/LnRvTG93ZXJDYXNlKCkgfHwgJyc7XG5cdFx0XHRcdFx0aWYgKGl0ZW1UZXh0LmluY2x1ZGVzKCdjb25maWcnKSB8fCBpdGVtVGV4dC5pbmNsdWRlcygnYXN0cm8gY29uZmlnJykpIHtcblx0XHRcdFx0XHRcdGl0ZW0ucmVtb3ZlKCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG59XG4iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGludGVyZmFjZSBBc3Ryb0NvbXBvc2VyU2V0dGluZ3Mge1xuXHRkZWZhdWx0VGVtcGxhdGU6IHN0cmluZzsgLy8gS2VwdCB0ZW1wb3JhcmlseSBmb3IgbWlncmF0aW9uXG5cdGF1dG9JbnNlcnRQcm9wZXJ0aWVzOiBib29sZWFuO1xuXHRkYXRlRm9ybWF0OiBzdHJpbmc7XG5cdGVuYWJsZUNvcHlIZWFkaW5nTGluazogYm9vbGVhbjtcblx0Y29weUhlYWRpbmdMaW5rRm9ybWF0OiBcIm9ic2lkaWFuXCIgfCBcImFzdHJvXCI7XG5cdGFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzOiBib29sZWFuO1xuXHRlbmFibGVPcGVuVGVybWluYWxDb21tYW5kOiBib29sZWFuO1xuXHR0ZXJtaW5hbFByb2plY3RSb290UGF0aDogc3RyaW5nO1xuXHRlbmFibGVUZXJtaW5hbFJpYmJvbkljb246IGJvb2xlYW47XG5cdGVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZDogYm9vbGVhbjtcblx0Y29uZmlnRmlsZVBhdGg6IHN0cmluZztcblx0ZW5hYmxlQ29uZmlnUmliYm9uSWNvbjogYm9vbGVhbjtcblx0Y29udGVudFR5cGVzOiBDb250ZW50VHlwZVtdO1xuXHRoZWxwQnV0dG9uUmVwbGFjZW1lbnQ6IEhlbHBCdXR0b25SZXBsYWNlbWVudFNldHRpbmdzO1xuXHRtaWdyYXRpb25Db21wbGV0ZWQ6IGJvb2xlYW47XG5cdC8vIExlZ2FjeSBmaWVsZHMgKGtlcHQgZm9yIG1pZ3JhdGlvbiwgaWdub3JlZCBhZnRlciBtaWdyYXRpb24pXG5cdGVuYWJsZVVuZGVyc2NvcmVQcmVmaXg/OiBib29sZWFuO1xuXHRwb3N0c0ZvbGRlcj86IHN0cmluZztcblx0cG9zdHNMaW5rQmFzZVBhdGg/OiBzdHJpbmc7XG5cdGF1dG9tYXRlUG9zdENyZWF0aW9uPzogYm9vbGVhbjtcblx0Y3JlYXRpb25Nb2RlPzogXCJmaWxlXCIgfCBcImZvbGRlclwiO1xuXHRpbmRleEZpbGVOYW1lPzogc3RyaW5nO1xuXHRleGNsdWRlZERpcmVjdG9yaWVzPzogc3RyaW5nO1xuXHRvbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyPzogYm9vbGVhbjtcblx0ZW5hYmxlUGFnZXM/OiBib29sZWFuO1xuXHRwYWdlc0ZvbGRlcj86IHN0cmluZztcblx0cGFnZXNMaW5rQmFzZVBhdGg/OiBzdHJpbmc7XG5cdHBhZ2VzQ3JlYXRpb25Nb2RlPzogXCJmaWxlXCIgfCBcImZvbGRlclwiO1xuXHRwYWdlc0luZGV4RmlsZU5hbWU/OiBzdHJpbmc7XG5cdHBhZ2VUZW1wbGF0ZT86IHN0cmluZztcblx0b25seUF1dG9tYXRlSW5QYWdlc0ZvbGRlcj86IGJvb2xlYW47XG5cdGN1c3RvbUNvbnRlbnRUeXBlcz86IENvbnRlbnRUeXBlW107IC8vIExlZ2FjeSBuYW1lXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgSGVscEJ1dHRvblJlcGxhY2VtZW50U2V0dGluZ3Mge1xuXHRlbmFibGVkOiBib29sZWFuO1xuXHRjb21tYW5kSWQ6IHN0cmluZztcblx0aWNvbklkOiBzdHJpbmc7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUGFyc2VkRnJvbnRtYXR0ZXIge1xuXHRwcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47XG5cdHByb3BlcnRpZXNUZXh0OiBzdHJpbmc7XG5cdHByb3BlcnRpZXNFbmQ6IG51bWJlcjtcblx0Ym9keUNvbnRlbnQ6IHN0cmluZztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZVZhbHVlcyB7XG5cdFtrZXk6IHN0cmluZ106IHN0cmluZ1tdIHwgc3RyaW5nO1xufVxuXG4vLyBDb250ZW50VHlwZSBpcyBub3cganVzdCBhIHN0cmluZyBJRCAtIG5vIGRpc3RpbmN0aW9uIGJldHdlZW4gYnVpbHQtaW4gYW5kIGN1c3RvbSB0eXBlc1xuZXhwb3J0IHR5cGUgQ29udGVudFR5cGVJZCA9IHN0cmluZztcblxuZXhwb3J0IGludGVyZmFjZSBDb250ZW50VHlwZSB7XG5cdGlkOiBzdHJpbmc7XG5cdG5hbWU6IHN0cmluZztcblx0Zm9sZGVyOiBzdHJpbmc7XG5cdGxpbmtCYXNlUGF0aDogc3RyaW5nO1xuXHR0ZW1wbGF0ZTogc3RyaW5nO1xuXHRlbmFibGVkOiBib29sZWFuO1xuXHRjcmVhdGlvbk1vZGU6IFwiZmlsZVwiIHwgXCJmb2xkZXJcIjtcblx0aW5kZXhGaWxlTmFtZTogc3RyaW5nO1xuXHRpZ25vcmVTdWJmb2xkZXJzOiBib29sZWFuO1xuXHRlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBib29sZWFuO1xuXHRjb2xsYXBzZWQ/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZpbGVDcmVhdGlvbk9wdGlvbnMge1xuXHRmaWxlOiBURmlsZTtcblx0dGl0bGU6IHN0cmluZztcblx0dHlwZTogQ29udGVudFR5cGVJZDsgLy8gQ29udGVudCB0eXBlIElEIChzdHJpbmcpXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVuYW1lT3B0aW9ucyB7XG5cdGZpbGU6IFRGaWxlO1xuXHR0aXRsZTogc3RyaW5nO1xuXHR0eXBlOiBDb250ZW50VHlwZUlkOyAvLyBDb250ZW50IHR5cGUgSUQgKHN0cmluZylcbn1cblxuZXhwb3J0IGNvbnN0IEtOT1dOX0FSUkFZX0tFWVMgPSBbJ3RhZ3MnLCAnYWxpYXNlcycsICdjc3NjbGFzc2VzJ10gYXMgY29uc3Q7XG5cbmV4cG9ydCBjb25zdCBDT05TVEFOVFMgPSB7XG5cdERFQk9VTkNFX01TOiA1MDAsXG5cdFNUQVRfTVRJTUVfVEhSRVNIT0xEOiAxMDAwLFxuXHRFRElUT1JfU1RBQklMSVpFX0RFTEFZOiAxMDAsXG5cdEZJTEVfRVhQTE9SRVJfUkVWRUFMX0RFTEFZOiAyMDAsXG59IGFzIGNvbnN0O1xuXG5leHBvcnQgaW50ZXJmYWNlIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2Uge1xuXHRzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzO1xuXHRzYXZlU2V0dGluZ3MoKTogUHJvbWlzZTx2b2lkPjtcblx0cmVnaXN0ZXJDcmVhdGVFdmVudCgpOiB2b2lkO1xuXHRyZWdpc3RlclJpYmJvbkljb25zPygpOiB2b2lkO1xuXHR1cGRhdGVIZWxwQnV0dG9uPygpOiBQcm9taXNlPHZvaWQ+O1xufSIsICJpbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5leHBvcnQgdHlwZSB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB9IGZyb20gXCIuL3R5cGVzXCI7XG5leHBvcnQgeyBDT05TVEFOVFMgfSBmcm9tIFwiLi90eXBlc1wiO1xuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogQXN0cm9Db21wb3NlclNldHRpbmdzID0ge1xuXHRkZWZhdWx0VGVtcGxhdGU6XG5cdFx0Jy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGF0ZToge3tkYXRlfX1cXG50YWdzOiBbXVxcbi0tLVxcbicsXG5cdGF1dG9JbnNlcnRQcm9wZXJ0aWVzOiB0cnVlLFxuXHRkYXRlRm9ybWF0OiBcIllZWVktTU0tRERcIixcblx0ZW5hYmxlQ29weUhlYWRpbmdMaW5rOiB0cnVlLFxuXHRjb3B5SGVhZGluZ0xpbmtGb3JtYXQ6IFwib2JzaWRpYW5cIixcblx0YWRkVHJhaWxpbmdTbGFzaFRvTGlua3M6IGZhbHNlLFxuXHRlbmFibGVPcGVuVGVybWluYWxDb21tYW5kOiBmYWxzZSxcblx0dGVybWluYWxQcm9qZWN0Um9vdFBhdGg6IFwiXCIsXG5cdGVuYWJsZVRlcm1pbmFsUmliYm9uSWNvbjogZmFsc2UsXG5cdGVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZDogZmFsc2UsXG5cdGNvbmZpZ0ZpbGVQYXRoOiBcIlwiLFxuXHRlbmFibGVDb25maWdSaWJib25JY29uOiBmYWxzZSxcblx0Y29udGVudFR5cGVzOiBbXSxcblx0bWlncmF0aW9uQ29tcGxldGVkOiBmYWxzZSxcblx0aGVscEJ1dHRvblJlcGxhY2VtZW50OiB7XG5cdFx0ZW5hYmxlZDogZmFsc2UsXG5cdFx0Y29tbWFuZElkOiAnZWRpdC1hc3Ryby1jb25maWcnLFxuXHRcdGljb25JZDogJ3dyZW5jaCcsXG5cdH0sXG59O1xuIiwgImltcG9ydCB7IFBsdWdpbiwgRWRpdG9yLCBNYXJrZG93blZpZXcsIFRGaWxlLCBOb3RpY2UsIEFwcCwgTWFya2Rvd25GaWxlSW5mbywgUGxhdGZvcm0gfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IEZpbGVPcGVyYXRpb25zIH0gZnJvbSBcIi4uL3V0aWxzL2ZpbGUtb3BlcmF0aW9uc1wiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZVBhcnNlciB9IGZyb20gXCIuLi91dGlscy90ZW1wbGF0ZS1wYXJzaW5nXCI7XHJcbmltcG9ydCB7IExpbmtDb252ZXJ0ZXIgfSBmcm9tIFwiLi4vdXRpbHMvbGluay1jb252ZXJzaW9uXCI7XHJcbmltcG9ydCB7IFRpdGxlTW9kYWwgfSBmcm9tIFwiLi4vdWkvdGl0bGUtbW9kYWxcIjtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiByZWdpc3RlckNvbW1hbmRzKHBsdWdpbjogUGx1Z2luLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogdm9pZCB7XHJcblx0Ly8gVGVybWluYWwgYW5kIGNvbmZpZyBjb21tYW5kcyBhcmUgZGVza3RvcC1vbmx5IC0gTkVWRVIgcmVnaXN0ZXIgb24gbW9iaWxlXHJcblx0Ly8gQ2hlY2sgUGxhdGZvcm0uaXNNb2JpbGUgLSBpZiB0cnVlLCB0aGVzZSBjb21tYW5kcyBtdXN0IE5FVkVSIGJlIHJlZ2lzdGVyZWRcclxuXHRjb25zdCBpc01vYmlsZSA9IFBsYXRmb3JtLmlzTW9iaWxlO1xyXG5cdFxyXG5cdC8vIElmIG9uIG1vYmlsZSwgYWJzb2x1dGVseSBkbyBub3QgcmVnaXN0ZXIgdGVybWluYWwvY29uZmlnIGNvbW1hbmRzXHJcblx0Ly8gVGhleSB1c2UgTm9kZS5qcy9FbGVjdHJvbiBBUElzIHRoYXQgZG9uJ3QgZXhpc3Qgb24gbW9iaWxlXHJcblx0aWYgKGlzTW9iaWxlKSB7XHJcblx0XHQvLyBPbiBtb2JpbGUsIG9ubHkgcmVnaXN0ZXIgdGhlIHNhZmUgY29tbWFuZHMgdGhhdCB3b3JrIG9uIG1vYmlsZVxyXG5cdFx0Y29uc3QgcGx1Z2luSW50ZXJmYWNlID0gcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHRcdGNvbnN0IGZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMocGx1Z2luLmFwcCwgc2V0dGluZ3MsIHBsdWdpbkludGVyZmFjZSBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlICYgeyBwbHVnaW5DcmVhdGVkRmlsZXM/OiBTZXQ8c3RyaW5nPiB9KTtcclxuXHRcdGNvbnN0IGxpbmtDb252ZXJ0ZXIgPSBuZXcgTGlua0NvbnZlcnRlcihzZXR0aW5ncywgcGx1Z2luSW50ZXJmYWNlKTtcclxuXHRcdFxyXG5cdFx0Ly8gUmVnaXN0ZXIgb25seSBtb2JpbGUtc2FmZSBjb21tYW5kc1xyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJzdGFuZGFyZGl6ZS1wcm9wZXJ0aWVzXCIsXHJcblx0XHRcdG5hbWU6IFwiU3RhbmRhcmRpemUgcHJvcGVydGllc1wiLFxyXG5cdFx0XHRpY29uOiBcImZpbGUtY2hlY2tcIixcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdFx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luXHJcblx0XHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSBwbHVnaW5JbnRlcmZhY2Uuc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHRcdFx0XHR2b2lkIHN0YW5kYXJkaXplUHJvcGVydGllcyhwbHVnaW4uYXBwLCBjdXJyZW50U2V0dGluZ3MsIGZpbGUsIHBsdWdpbkludGVyZmFjZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJjb252ZXJ0LXdpa2lsaW5rcy1hc3Ryb1wiLFxyXG5cdFx0XHRuYW1lOiBcIkNvbnZlcnQgaW50ZXJuYWwgbGlua3MgZm9yIGFzdHJvXCIsXHJcblx0XHRcdGljb246IFwibGluay0yXCIsXHJcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHRcdGxpbmtDb252ZXJ0ZXIuY29udmVydFdpa2lsaW5rc0ZvckFzdHJvKGVkaXRvciwgZmlsZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gSGVscGVyIGZ1bmN0aW9uIGZvciByZW5hbWUgY29tbWFuZCAobW9iaWxlIHZlcnNpb24pXHJcblx0XHQvLyBVc2VzIHRoZSBzYW1lIGxvZ2ljIGFzIEZpbGVPcGVyYXRpb25zLmRldGVybWluZVR5cGUoKSB0byBlbnN1cmUgY29uc2lzdGVuY3lcclxuXHRcdGZ1bmN0aW9uIGhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZTogVEZpbGUsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiBib29sZWFuIHtcclxuXHRcdFx0Y29uc3QgdHlwZSA9IGZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHRcdFx0Ly8gSWYgZGV0ZXJtaW5lVHlwZSByZXR1cm5zIFwibm90ZVwiLCBpdCBtZWFucyBubyBjb250ZW50IHR5cGUgbWF0Y2hlZFxyXG5cdFx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gQ2hlY2sgaWYgdGhlIG1hdGNoZWQgY29udGVudCB0eXBlIGlzIGVuYWJsZWRcclxuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSBmaWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0XHRyZXR1cm4gY29udGVudFR5cGUgIT09IG51bGwgJiYgY29udGVudFR5cGUuZW5hYmxlZDtcclxuXHRcdH1cclxuXHJcblx0XHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcInJlbmFtZS1jb250ZW50XCIsXHJcblx0XHRcdG5hbWU6IFwiUmVuYW1lIGN1cnJlbnQgY29udGVudFwiLFxyXG5cdFx0XHRpY29uOiBcInBlbmNpbFwiLFxyXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0XHRjb25zdCBmaWxlID0gY3R4IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ID8gY3R4LmZpbGUgOiBjdHguZmlsZTtcclxuXHRcdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0XHRpZiAoIWhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZSwgc2V0dGluZ3MpKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiB0aGlzIGZpbGUgaXMgbm90IHBhcnQgb2YgYSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXIuXCIpO1xyXG5cdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0XHRcdFx0XHRjb25zdCBjYWNoZSA9IHBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcblx0XHRcdFx0XHRjb25zdCB0aXRsZUtleSA9IGZpbGVPcHMuZ2V0VGl0bGVLZXkodHlwZSk7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdGlmICghY2FjaGU/LmZyb250bWF0dGVyIHx8ICEodGl0bGVLZXkgaW4gY2FjaGUuZnJvbnRtYXR0ZXIpKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYENhbm5vdCByZW5hbWU6IE5vICR7dGl0bGVLZXl9IGZvdW5kIGluIHByb3BlcnRpZXNgKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRuZXcgVGl0bGVNb2RhbChwbHVnaW4uYXBwLCBmaWxlLCBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCB0eXBlLCB0cnVlKS5vcGVuKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gRE8gTk9UIHJlZ2lzdGVyIHRlcm1pbmFsIG9yIGNvbmZpZyBjb21tYW5kcyBvbiBtb2JpbGUgLSByZXR1cm4gZWFybHlcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0XHJcblx0Ly8gRGVza3RvcDogcmVnaXN0ZXIgYWxsIGNvbW1hbmRzIGluY2x1ZGluZyB0ZXJtaW5hbCBhbmQgY29uZmlnXHJcblx0Y29uc3QgcGx1Z2luSW50ZXJmYWNlID0gcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHJcblxyXG5cdC8vIEhlbHBlciBmdW5jdGlvbiB0byBjaGVjayBpZiBhIGZpbGUgbWF0Y2hlcyBhbnkgY29uZmlndXJlZCBjb250ZW50IHR5cGVcclxuXHQvLyBVc2VzIHRoZSBzYW1lIGxvZ2ljIGFzIEZpbGVPcGVyYXRpb25zLmRldGVybWluZVR5cGUoKSB0byBlbnN1cmUgY29uc2lzdGVuY3lcclxuXHQvLyBHZXRzIGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIHRvIGVuc3VyZSB3ZSBjaGVjayBhZ2FpbnN0IGN1cnJlbnQgY29udGVudCB0eXBlc1xyXG5cdGZ1bmN0aW9uIGhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZTogVEZpbGUsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiBib29sZWFuIHtcclxuXHRcdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBpZiBhdmFpbGFibGVcclxuXHRcdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IChwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKT8uc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHQvLyBDcmVhdGUgYSB0ZW1wb3JhcnkgRmlsZU9wZXJhdGlvbnMgd2l0aCBmcmVzaCBzZXR0aW5nc1xyXG5cdFx0Y29uc3QgdGVtcEZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMocGx1Z2luLmFwcCwgY3VycmVudFNldHRpbmdzLCBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlICYgeyBwbHVnaW5DcmVhdGVkRmlsZXM/OiBTZXQ8c3RyaW5nPiB9KTtcclxuXHRcdGNvbnN0IHR5cGUgPSB0ZW1wRmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFx0Ly8gSWYgZGV0ZXJtaW5lVHlwZSByZXR1cm5zIFwibm90ZVwiLCBpdCBtZWFucyBubyBjb250ZW50IHR5cGUgbWF0Y2hlZFxyXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHRcdC8vIENoZWNrIGlmIHRoZSBtYXRjaGVkIGNvbnRlbnQgdHlwZSBpcyBlbmFibGVkXHJcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRlbXBGaWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0cmV0dXJuIGNvbnRlbnRUeXBlICE9PSBudWxsICYmIGNvbnRlbnRUeXBlLmVuYWJsZWQ7XHJcblx0fVxyXG5cclxuXHQvLyBTdGFuZGFyZGl6ZSBQcm9wZXJ0aWVzIGNvbW1hbmRcclxuXHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRpZDogXCJzdGFuZGFyZGl6ZS1wcm9wZXJ0aWVzXCIsXHJcblx0XHRuYW1lOiBcIlN0YW5kYXJkaXplIHByb3BlcnRpZXNcIixcclxuXHRcdGljb246IFwiZmlsZS1jaGVja1wiLFxyXG5cdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0dm9pZCBzdGFuZGFyZGl6ZVByb3BlcnRpZXMocGx1Z2luLmFwcCwgc2V0dGluZ3MsIGZpbGUsIHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpO1xyXG5cdFx0XHR9XHJcblx0XHR9LFxyXG5cdH0pO1xyXG5cclxuXHQvLyBDb252ZXJ0IFdpa2lsaW5rcyBjb21tYW5kXHJcblx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0aWQ6IFwiY29udmVydC13aWtpbGlua3MtYXN0cm9cIixcclxuXHRcdG5hbWU6IFwiQ29udmVydCBpbnRlcm5hbCBsaW5rcyBmb3IgYXN0cm9cIixcclxuXHRcdGljb246IFwibGluay0yXCIsXHJcblx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHQvLyBHZXQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gYW5kIGNyZWF0ZSBMaW5rQ29udmVydGVyIHdpdGggaXRcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSBwbHVnaW5JbnRlcmZhY2Uuc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHRcdFx0Y29uc3QgY3VycmVudExpbmtDb252ZXJ0ZXIgPSBuZXcgTGlua0NvbnZlcnRlcihjdXJyZW50U2V0dGluZ3MsIHBsdWdpbkludGVyZmFjZSk7XHJcblx0XHRcdFx0Y3VycmVudExpbmtDb252ZXJ0ZXIuY29udmVydFdpa2lsaW5rc0ZvckFzdHJvKGVkaXRvciwgZmlsZSk7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0fSk7XHJcblxyXG5cdFx0Ly8gUmVuYW1lIENvbnRlbnQgY29tbWFuZFxyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJyZW5hbWUtY29udGVudFwiLFxyXG5cdFx0XHRuYW1lOiBcIlJlbmFtZSBjdXJyZW50IGNvbnRlbnRcIixcclxuXHRcdFx0aWNvbjogXCJwZW5jaWxcIixcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdFx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luXHJcblx0XHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSBwbHVnaW5JbnRlcmZhY2Uuc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHRcdFx0XHQvLyBDcmVhdGUgRmlsZU9wZXJhdGlvbnMgd2l0aCBmcmVzaCBzZXR0aW5nc1xyXG5cdFx0XHRcdFx0Y29uc3QgY3VycmVudEZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMocGx1Z2luLmFwcCwgY3VycmVudFNldHRpbmdzLCBwbHVnaW5JbnRlcmZhY2UgYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSAmIHsgcGx1Z2luQ3JlYXRlZEZpbGVzPzogU2V0PHN0cmluZz4gfSk7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIHRoaXMgZmlsZSBtYXRjaGVzIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZVxyXG5cdFx0XHRcdFx0aWYgKCFoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGUsIGN1cnJlbnRTZXR0aW5ncykpIHtcclxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHRoaXMgZmlsZSBpcyBub3QgcGFydCBvZiBhIGNvbmZpZ3VyZWQgY29udGVudCB0eXBlIGZvbGRlci5cIik7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZSBmcm9tIGZvbGRlciBzdHJ1Y3R1cmVcclxuXHRcdFx0XHRcdGNvbnN0IHR5cGUgPSBjdXJyZW50RmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBBbHdheXMgb3BlbiB0aGUgbW9kYWwgLSBpdCB3aWxsIGhhbmRsZSBmaWxlcyB3aXRob3V0IGZyb250bWF0dGVyIG9yIHRpdGxlIGtleVxyXG5cdFx0XHRcdFx0Ly8gSWYgdGhlcmUncyBubyB0aXRsZSBpbiBmcm9udG1hdHRlciwgdGhlIG1vZGFsIHdpbGwgdXNlIHRoZSBmaWxlbmFtZSBhcyBmYWxsYmFja1xyXG5cdFx0XHRcdFx0Ly8gYW5kIHRoZSByZW5hbWUgd2lsbCBwcm9jZWVkIHdpdGgga2ViYWItY2FzZSB2ZXJzaW9uIG9mIHdoYXQgdXNlciB0eXBlc1xyXG5cdFx0XHRcdFx0bmV3IFRpdGxlTW9kYWwocGx1Z2luLmFwcCwgZmlsZSwgcGx1Z2luSW50ZXJmYWNlLCB0eXBlLCB0cnVlKS5vcGVuKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblxyXG5cdC8vIE9wZW4gVGVybWluYWwgY29tbWFuZCAoZGVza3RvcCBvbmx5IC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGUpXHJcblx0aWYgKCFpc01vYmlsZSkge1xyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJvcGVuLXByb2plY3QtdGVybWluYWxcIixcclxuXHRcdFx0bmFtZTogXCJPcGVuIHByb2plY3QgdGVybWluYWxcIixcclxuXHRcdFx0aWNvbjogXCJ0ZXJtaW5hbC1zcXVhcmVcIixcclxuXHRcdFx0Y2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSAocGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSkuc2V0dGluZ3M7XHJcblx0XHRcdFx0aWYgKCFjdXJyZW50U2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIk9wZW4gdGVybWluYWwgY29tbWFuZCBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHNldHRpbmdzIHRvIHVzZSB0aGlzIGNvbW1hbmQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhd2FpdCBvcGVuVGVybWluYWxJblByb2plY3RSb290KHBsdWdpbi5hcHAsIGN1cnJlbnRTZXR0aW5ncyk7XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdC8vIEVkaXQgQ29uZmlnIEZpbGUgY29tbWFuZCAoZGVza3RvcCBvbmx5IC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGUpXHJcblx0aWYgKCFpc01vYmlsZSkge1xyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJlZGl0LWFzdHJvLWNvbmZpZ1wiLFxyXG5cdFx0XHRuYW1lOiBcIkVkaXQgYXN0cm8gY29uZmlnXCIsXHJcblx0XHRcdGljb246IFwid3JlbmNoXCIsXHJcblx0XHRcdGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgY3VycmVudFNldHRpbmdzID0gKHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpLnNldHRpbmdzO1xyXG5cdFx0XHRcdGlmICghY3VycmVudFNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIkVkaXQgY29uZmlnIGZpbGUgY29tbWFuZCBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHNldHRpbmdzIHRvIHVzZSB0aGlzIGNvbW1hbmQuXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRhd2FpdCBvcGVuQ29uZmlnRmlsZShwbHVnaW4uYXBwLCBjdXJyZW50U2V0dGluZ3MpO1xyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblx0fVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBzdGFuZGFyZGl6ZVByb3BlcnRpZXMoYXBwOiBBcHAsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIGZpbGU6IFRGaWxlLCBwbHVnaW4/OiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGlmIGF2YWlsYWJsZVxyXG5cdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IHBsdWdpbj8uc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0Y29uc3QgdGVtcGxhdGVQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIoYXBwLCBjdXJyZW50U2V0dGluZ3MpO1xyXG5cdGNvbnN0IGZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMoYXBwLCBjdXJyZW50U2V0dGluZ3MsIHBsdWdpbik7XHJcblx0XHJcblx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZSB1c2luZyB0aGUgZXhpc3RpbmcgbG9naWNcclxuXHRjb25zdCB0eXBlID0gZmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFxyXG5cdC8vIENoZWNrIGlmIHRoaXMgZmlsZSBoYXMgYSB2YWxpZCBjb250ZW50IHR5cGUgKG5vdCBqdXN0IFwibm90ZVwiKVxyXG5cdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0bmV3IE5vdGljZShcIk5vIHByb3BlcnRpZXMgdGVtcGxhdGUgc3BlY2lmaWVkIGZvciB0aGlzIGNvbnRlbnQuIFRoaXMgZmlsZSBkb2Vzbid0IG1hdGNoIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXJzLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0XHJcblx0bGV0IHRlbXBsYXRlU3RyaW5nOiBzdHJpbmc7XHJcblx0XHJcblx0Ly8gRGV0ZXJtaW5lIHRlbXBsYXRlIGJhc2VkIG9uIGNvbnRlbnQgdHlwZVxyXG5cdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0bmV3IE5vdGljZShcIk5vIHByb3BlcnRpZXMgdGVtcGxhdGUgc3BlY2lmaWVkIGZvciB0aGlzIGNvbnRlbnQuIFRoaXMgZmlsZSBkb2Vzbid0IG1hdGNoIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXJzLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0XHJcblx0Y29uc3QgY29udGVudFR5cGUgPSBmaWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdGlmICghY29udGVudFR5cGUpIHtcclxuXHRcdG5ldyBOb3RpY2UoXCJDb250ZW50IHR5cGUgbm90IGZvdW5kLlwiKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblx0XHJcblx0dGVtcGxhdGVTdHJpbmcgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcclxuXHJcblx0Ly8gV2FpdCBicmllZmx5IHRvIGFsbG93IGVkaXRvciBzdGF0ZSB0byBzdGFiaWxpemVcclxuXHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7XHJcblxyXG5cdC8vIFJlLXJlYWQgY29udGVudCB0byBlbnN1cmUgbGF0ZXN0IHN0YXRlIGFmdGVyIGVkaXRvciBjaGFuZ2VzXHJcblx0Y29uc3QgY29udGVudCA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG5cdGNvbnN0IHRpdGxlID0gZmlsZS5iYXNlbmFtZS5yZXBsYWNlKC9eXy8sIFwiXCIpO1xyXG5cdFxyXG5cdGNvbnN0IHBhcnNlZCA9IHRlbXBsYXRlUGFyc2VyLnBhcnNlRnJvbnRtYXR0ZXIoY29udGVudCk7XHJcblx0Y29uc3QgeyB0ZW1wbGF0ZVByb3BzLCB0ZW1wbGF0ZVZhbHVlcyB9ID0gdGVtcGxhdGVQYXJzZXIucGFyc2VUZW1wbGF0ZSh0ZW1wbGF0ZVN0cmluZywgdGl0bGUpO1xyXG5cclxuXHQvLyBNZXJnZSB0ZW1wbGF0ZSBwcm9wZXJ0aWVzIHdpdGggZXhpc3Rpbmcgb25lcywgcHJlc2VydmluZyBhbGwgZXhpc3RpbmdcclxuXHRjb25zdCBmaW5hbFByb3BzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7IC4uLnBhcnNlZC5wcm9wZXJ0aWVzIH07XHJcblx0Y29uc3QgYXJyYXlLZXlzID0gbmV3IFNldDxzdHJpbmc+KCk7IC8vIFRyYWNrIHdoaWNoIGtleXMgYXJlIGFycmF5c1xyXG5cdFxyXG5cdGZvciAoY29uc3Qga2V5IG9mIHRlbXBsYXRlUHJvcHMpIHtcclxuXHRcdGlmICghKGtleSBpbiBwYXJzZWQucHJvcGVydGllcykpIHtcclxuXHRcdFx0Ly8gUHJvcGVydHkgZG9lc24ndCBleGlzdCwgYWRkIGl0IGZyb20gdGVtcGxhdGVcclxuXHRcdFx0Y29uc3QgdGVtcGxhdGVWYWx1ZSA9IHRlbXBsYXRlVmFsdWVzW2tleV07XHJcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHRlbXBsYXRlVmFsdWUpKSB7XHJcblx0XHRcdFx0ZmluYWxQcm9wc1trZXldID0gdGVtcGxhdGVWYWx1ZTtcclxuXHRcdFx0XHRhcnJheUtleXMuYWRkKGtleSk7IC8vIE1hcmsgYXMgYXJyYXlcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRmaW5hbFByb3BzW2tleV0gPSBbdGVtcGxhdGVWYWx1ZSB8fCBcIlwiXTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gUHJvcGVydHkgZXhpc3RzLCBjaGVjayBpZiBpdCdzIGFuIGFycmF5IHR5cGVcclxuXHRcdFx0Y29uc3QgdGVtcGxhdGVWYWx1ZSA9IHRlbXBsYXRlVmFsdWVzW2tleV07XHJcblx0XHRcdGNvbnN0IGlzQXJyYXlWYWx1ZSA9IEFycmF5LmlzQXJyYXkodGVtcGxhdGVWYWx1ZSk7XHJcblx0XHRcdFxyXG5cdFx0XHRpZiAoaXNBcnJheVZhbHVlKSB7XHJcblx0XHRcdFx0Ly8gVGhpcyBpcyBhbiBhcnJheSBwcm9wZXJ0eSAtIHByZXNlcnZlIGV4aXN0aW5nIHZhbHVlcyBhbmQgbWVyZ2Ugd2l0aCB0ZW1wbGF0ZVxyXG5cdFx0XHRcdGNvbnN0IGV4aXN0aW5nSXRlbXMgPSBwYXJzZWQucHJvcGVydGllc1trZXldIHx8IFtdO1xyXG5cdFx0XHRcdGNvbnN0IG5ld0l0ZW1zID0gdGVtcGxhdGVWYWx1ZS5maWx0ZXIoaXRlbSA9PiAhZXhpc3RpbmdJdGVtcy5pbmNsdWRlcyhpdGVtKSk7XHJcblx0XHRcdFx0ZmluYWxQcm9wc1trZXldID0gWy4uLmV4aXN0aW5nSXRlbXMsIC4uLm5ld0l0ZW1zXTtcclxuXHRcdFx0XHRhcnJheUtleXMuYWRkKGtleSk7IC8vIE1hcmsgYXMgYXJyYXlcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBGb3Igbm9uLWFycmF5IHZhbHVlcywga2VlcCBleGlzdGluZyB2YWx1ZSAoZG9uJ3Qgb3ZlcndyaXRlKVxyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0Ly8gQWxzbyBhZGQgYW55IGV4aXN0aW5nIGFycmF5IGtleXMgdGhhdCB3ZXJlbid0IGluIHRoZSB0ZW1wbGF0ZVxyXG5cdGZvciAoY29uc3Qga2V5IGluIHBhcnNlZC5wcm9wZXJ0aWVzKSB7XHJcblx0XHRpZiAocGFyc2VkLnByb3BlcnRpZXNba2V5XS5sZW5ndGggPiAxKSB7XHJcblx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNvbnN0IG5ld0NvbnRlbnQgPSB0ZW1wbGF0ZVBhcnNlci5idWlsZEZyb250bWF0dGVyQ29udGVudChmaW5hbFByb3BzLCBhcnJheUtleXMpICsgcGFyc2VkLmJvZHlDb250ZW50O1xyXG5cclxuXHRhd2FpdCBhcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQpO1xyXG5cdG5ldyBOb3RpY2UoXCJQcm9wZXJ0aWVzIHN0YW5kYXJkaXplZCB1c2luZyB0ZW1wbGF0ZS5cIik7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZW5hbWUgYSBmaWxlIGJ5IHBhdGggKGZvciBwcm9ncmFtbWF0aWMgdXNlLCBlLmcuLCBmcm9tIG90aGVyIHBsdWdpbnMpXHJcbiAqIFRoaXMgYWxsb3dzIHRoZSByZW5hbWUgbW9kYWwgdG8gYXBwZWFyIHdpdGhvdXQgb3BlbmluZyB0aGUgZmlsZSBmaXJzdFxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlbmFtZUNvbnRlbnRCeVBhdGgoXHJcblx0YXBwOiBBcHAsXHJcblx0ZmlsZVBhdGg6IHN0cmluZyxcclxuXHRzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzLFxyXG5cdHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZVxyXG4pOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlUGF0aCk7XHJcblx0aWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xyXG5cdFx0bmV3IE5vdGljZShgRmlsZSBub3QgZm91bmQ6ICR7ZmlsZVBhdGh9YCk7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRjb25zdCBmaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKGFwcCwgc2V0dGluZ3MsIHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UgJiB7IHBsdWdpbkNyZWF0ZWRGaWxlcz86IFNldDxzdHJpbmc+IH0pO1xyXG5cclxuXHQvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgaWYgZmlsZSBtYXRjaGVzIGNvbnRlbnQgdHlwZVxyXG5cdC8vIFVzZXMgdGhlIHNhbWUgbG9naWMgYXMgRmlsZU9wZXJhdGlvbnMuZGV0ZXJtaW5lVHlwZSgpIHRvIGVuc3VyZSBjb25zaXN0ZW5jeVxyXG5cdGZ1bmN0aW9uIGhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZTogVEZpbGUsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiBib29sZWFuIHtcclxuXHRcdGNvbnN0IHR5cGUgPSBmaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblx0XHQvLyBJZiBkZXRlcm1pbmVUeXBlIHJldHVybnMgXCJub3RlXCIsIGl0IG1lYW5zIG5vIGNvbnRlbnQgdHlwZSBtYXRjaGVkXHJcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdFx0cmV0dXJuIGZhbHNlO1xyXG5cdFx0fVxyXG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIG1hdGNoZWQgY29udGVudCB0eXBlIGlzIGVuYWJsZWRcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcclxuXHRcdHJldHVybiBjb250ZW50VHlwZSAhPT0gbnVsbCAmJiBjb250ZW50VHlwZS5lbmFibGVkO1xyXG5cdH1cclxuXHJcblx0aWYgKCFoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGUsIHNldHRpbmdzKSkge1xyXG5cdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHRoaXMgZmlsZSBpcyBub3QgcGFydCBvZiBhIGNvbmZpZ3VyZWQgY29udGVudCB0eXBlIGZvbGRlci5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRjb25zdCB0eXBlID0gZmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFxyXG5cdC8vIEFsd2F5cyBvcGVuIHRoZSBtb2RhbCAtIGl0IHdpbGwgaGFuZGxlIGZpbGVzIHdpdGhvdXQgZnJvbnRtYXR0ZXIgb3IgdGl0bGUga2V5XHJcblx0Ly8gSWYgdGhlcmUncyBubyB0aXRsZSBpbiBmcm9udG1hdHRlciwgdGhlIG1vZGFsIHdpbGwgdXNlIHRoZSBmaWxlbmFtZSBhcyBmYWxsYmFja1xyXG5cdC8vIGFuZCB0aGUgcmVuYW1lIHdpbGwgcHJvY2VlZCB3aXRoIGtlYmFiLWNhc2UgdmVyc2lvbiBvZiB3aGF0IHVzZXIgdHlwZXNcclxuXHRuZXcgVGl0bGVNb2RhbChhcHAsIGZpbGUsIHBsdWdpbiwgdHlwZSwgdHJ1ZSkub3BlbigpO1xyXG59XHJcblxyXG4vKipcclxuICogT3BlbiB0ZXJtaW5hbCBpbiBwcm9qZWN0IHJvb3QgZGlyZWN0b3J5XHJcbiAqIEV4cG9ydGVkIGZvciB1c2UgYnkgcmliYm9uIGljb25zXHJcbiAqL1xyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gb3BlblRlcm1pbmFsSW5Qcm9qZWN0Um9vdChhcHA6IEFwcCwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IFByb21pc2U8dm9pZD4ge1xyXG5cdHRyeSB7XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZlxyXG5cdFx0Y29uc3QgeyBleGVjIH0gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJykgYXMgeyBleGVjOiAoY29tbWFuZDogc3RyaW5nLCBjYWxsYmFjazogKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHZvaWQpID0+IHZvaWQgfTtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmXHJcblx0XHRjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpIGFzIHsgcmVzb2x2ZTogKC4uLmFyZ3M6IHN0cmluZ1tdKSA9PiBzdHJpbmcgfTtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmXHJcblx0XHRjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJykgYXMgeyBleGlzdHNTeW5jOiAocGF0aDogc3RyaW5nKSA9PiBib29sZWFuIH07XHJcblxyXG5cdFx0Ly8gR2V0IHRoZSBhY3R1YWwgdmF1bHQgcGF0aCBzdHJpbmcgZnJvbSB0aGUgYWRhcHRlclxyXG5cdFx0Y29uc3QgYWRhcHRlciA9IGFwcC52YXVsdC5hZGFwdGVyIGFzIHVua25vd24gYXMgeyBiYXNlUGF0aD86IHN0cmluZzsgcGF0aD86IHN0cmluZyB9O1xyXG5cdFx0Y29uc3QgdmF1bHRQYXRoID0gYWRhcHRlci5iYXNlUGF0aCB8fCBhZGFwdGVyLnBhdGg7XHJcblx0XHRjb25zdCB2YXVsdFBhdGhTdHJpbmcgPSB0eXBlb2YgdmF1bHRQYXRoID09PSAnc3RyaW5nJyA/IHZhdWx0UGF0aCA6IFN0cmluZyh2YXVsdFBhdGgpO1xyXG5cclxuXHRcdC8vIFJlc29sdmUgcHJvamVjdCByb290IHBhdGhcclxuXHRcdGxldCBwcm9qZWN0UGF0aDogc3RyaW5nO1xyXG5cdFx0aWYgKHNldHRpbmdzLnRlcm1pbmFsUHJvamVjdFJvb3RQYXRoICYmIHNldHRpbmdzLnRlcm1pbmFsUHJvamVjdFJvb3RQYXRoLnRyaW0oKSkge1xyXG5cdFx0XHQvLyBVc2UgY3VzdG9tIHBhdGggcmVsYXRpdmUgdG8gdmF1bHRcclxuXHRcdFx0cHJvamVjdFBhdGggPSBwYXRoLnJlc29sdmUodmF1bHRQYXRoU3RyaW5nLCBzZXR0aW5ncy50ZXJtaW5hbFByb2plY3RSb290UGF0aCk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBEZWZhdWx0OiB2YXVsdCBmb2xkZXIgaXRzZWxmXHJcblx0XHRcdHByb2plY3RQYXRoID0gdmF1bHRQYXRoU3RyaW5nO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFZlcmlmeSB0aGUgcGF0aCBleGlzdHNcclxuXHRcdGlmICghZnMuZXhpc3RzU3luYyhwcm9qZWN0UGF0aCkpIHtcclxuXHRcdFx0bmV3IE5vdGljZShgUHJvamVjdCByb290IGRpcmVjdG9yeSBub3QgZm91bmQgYXQ6ICR7cHJvamVjdFBhdGh9YCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWZcclxuXHRcdGNvbnN0IHBsYXRmb3JtID0gcHJvY2Vzcy5wbGF0Zm9ybTtcclxuXHRcdGxldCBjb21tYW5kOiBzdHJpbmc7XHJcblxyXG5cdFx0aWYgKHBsYXRmb3JtID09PSAnd2luMzInKSB7XHJcblx0XHRcdC8vIFdpbmRvd3M6IFRyeSBXaW5kb3dzIFRlcm1pbmFsIGZpcnN0LCBmYWxsYmFjayB0byBjbWRcclxuXHRcdFx0ZXhlYygnd2hlcmUgd3QnLCAoZXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdGlmICghZXJyb3IpIHtcclxuXHRcdFx0XHRcdC8vIFdpbmRvd3MgVGVybWluYWwgaXMgYXZhaWxhYmxlXHJcblx0XHRcdFx0XHRleGVjKGB3dCAtZCBcIiR7cHJvamVjdFBhdGh9XCJgLCAoZXhlY0Vycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0aWYgKGV4ZWNFcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdC8vIEZhbGxiYWNrIHRvIGNtZFxyXG5cdFx0XHRcdFx0XHRcdGV4ZWMoYGNtZCAvayBjZCAvZCBcIiR7cHJvamVjdFBhdGh9XCJgLCAoY21kRXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNtZEVycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7Y21kRXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHQvLyBGYWxsYmFjayB0byBjbWRcclxuXHRcdFx0XHRcdGV4ZWMoYGNtZCAvayBjZCAvZCBcIiR7cHJvamVjdFBhdGh9XCJgLCAoY21kRXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRpZiAoY21kRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2NtZEVycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRyZXR1cm47IC8vIEVhcmx5IHJldHVybiBzaW5jZSB3ZSBoYW5kbGUgV2luZG93cyBhc3luY2hyb25vdXNseVxyXG5cdFx0fSBlbHNlIGlmIChwbGF0Zm9ybSA9PT0gJ2RhcndpbicpIHtcclxuXHRcdFx0Ly8gbWFjT1M6IFVzZSBvc2FzY3JpcHQgdG8gb3BlbiBUZXJtaW5hbC5hcHBcclxuXHRcdFx0Y29tbWFuZCA9IGBvc2FzY3JpcHQgLWUgJ3RlbGwgYXBwbGljYXRpb24gXCJUZXJtaW5hbFwiIHRvIGRvIHNjcmlwdCBcImNkIFxcXFxcIiR7cHJvamVjdFBhdGh9XFxcXFwiICYmIGJhc2hcIidgO1xyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gTGludXg6IFRyeSBjb21tb24gdGVybWluYWxzXHJcblx0XHRcdGNvbnN0IHRlcm1pbmFscyA9IFtcclxuXHRcdFx0XHRgZ25vbWUtdGVybWluYWwgLS13b3JraW5nLWRpcmVjdG9yeT1cIiR7cHJvamVjdFBhdGh9XCJgLFxyXG5cdFx0XHRcdGBrb25zb2xlIC0td29ya2RpciBcIiR7cHJvamVjdFBhdGh9XCJgLFxyXG5cdFx0XHRcdGB4dGVybSAtZSBcImNkIFxcXFxcIiR7cHJvamVjdFBhdGh9XFxcXFwiICYmIGJhc2hcImBcclxuXHRcdFx0XTtcclxuXHJcblx0XHRcdC8vIFRyeSBlYWNoIHRlcm1pbmFsIHVudGlsIG9uZSB3b3Jrc1xyXG5cdFx0XHRjb25zdCB0cnlUZXJtaW5hbCA9IChpbmRleDogbnVtYmVyKSA9PiB7XHJcblx0XHRcdFx0aWYgKGluZGV4ID49IHRlcm1pbmFscy5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoJ05vIHN1cHBvcnRlZCB0ZXJtaW5hbCBmb3VuZC4gUGxlYXNlIGluc3RhbGwgZ25vbWUtdGVybWluYWwsIGtvbnNvbGUsIG9yIHh0ZXJtLicpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0ZXhlYyhgd2hpY2ggJHt0ZXJtaW5hbHNbaW5kZXhdLnNwbGl0KCcgJylbMF19YCwgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdGlmICghZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0ZXhlYyh0ZXJtaW5hbHNbaW5kZXhdLCAoZXhlY0Vycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoZXhlY0Vycm9yICYmIGluZGV4IDwgdGVybWluYWxzLmxlbmd0aCAtIDEpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRyeVRlcm1pbmFsKGluZGV4ICsgMSk7XHJcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChleGVjRXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7ZXhlY0Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHR0cnlUZXJtaW5hbChpbmRleCArIDEpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9O1xyXG5cclxuXHRcdFx0dHJ5VGVybWluYWwoMCk7XHJcblx0XHRcdHJldHVybjsgLy8gRWFybHkgcmV0dXJuIHNpbmNlIHdlIGhhbmRsZSBMaW51eCBhc3luY2hyb25vdXNseVxyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEV4ZWN1dGUgY29tbWFuZCBmb3IgbWFjT1NcclxuXHRcdGlmIChjb21tYW5kKSB7XHJcblx0XHRcdGV4ZWMoY29tbWFuZCwgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoYEVycm9yIG9wZW5pbmcgdGVybWluYWw6ICR7ZXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogT3BlbiBjb25maWcgZmlsZSBpbiBkZWZhdWx0IGVkaXRvclxyXG4gKiBFeHBvcnRlZCBmb3IgdXNlIGJ5IHJpYmJvbiBpY29uc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5Db25maWdGaWxlKGFwcDogQXBwLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0dHJ5IHtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmXHJcblx0XHRjb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJykgYXMgeyBleGlzdHNTeW5jOiAocGF0aDogc3RyaW5nKSA9PiBib29sZWFuIH07XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZlxyXG5cdFx0Y29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKSBhcyB7IHJlc29sdmU6ICguLi5hcmdzOiBzdHJpbmdbXSkgPT4gc3RyaW5nIH07XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXJlcXVpcmUtaW1wb3J0cywgbm8tdW5kZWZcclxuXHRcdGNvbnN0IHsgc2hlbGwgfSA9IHJlcXVpcmUoJ2VsZWN0cm9uJykgYXMgeyBzaGVsbDogeyBvcGVuUGF0aDogKHBhdGg6IHN0cmluZykgPT4gUHJvbWlzZTxzdHJpbmc+IH0gfTtcclxuXHJcblx0XHQvLyBHZXQgdGhlIGFjdHVhbCB2YXVsdCBwYXRoIHN0cmluZyBmcm9tIHRoZSBhZGFwdGVyXHJcblx0XHRjb25zdCBhZGFwdGVyID0gYXBwLnZhdWx0LmFkYXB0ZXIgYXMgdW5rbm93biBhcyB7IGJhc2VQYXRoPzogc3RyaW5nOyBwYXRoPzogc3RyaW5nIH07XHJcblx0XHRjb25zdCB2YXVsdFBhdGggPSBhZGFwdGVyLmJhc2VQYXRoIHx8IGFkYXB0ZXIucGF0aDtcclxuXHRcdGNvbnN0IHZhdWx0UGF0aFN0cmluZyA9IHR5cGVvZiB2YXVsdFBhdGggPT09ICdzdHJpbmcnID8gdmF1bHRQYXRoIDogU3RyaW5nKHZhdWx0UGF0aCk7XHJcblxyXG5cdFx0Ly8gUmVzb2x2ZSBjb25maWcgZmlsZSBwYXRoXHJcblx0XHRpZiAoIXNldHRpbmdzLmNvbmZpZ0ZpbGVQYXRoIHx8ICFzZXR0aW5ncy5jb25maWdGaWxlUGF0aC50cmltKCkpIHtcclxuXHRcdFx0bmV3IE5vdGljZShcIlBsZWFzZSBzcGVjaWZ5IGEgY29uZmlnIGZpbGUgcGF0aCBpbiBzZXR0aW5ncy5cIik7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBVc2UgY3VzdG9tIHBhdGggcmVsYXRpdmUgdG8gdmF1bHRcclxuXHRcdGNvbnN0IGNvbmZpZ1BhdGggPSBwYXRoLnJlc29sdmUodmF1bHRQYXRoU3RyaW5nLCBzZXR0aW5ncy5jb25maWdGaWxlUGF0aCk7XHJcblxyXG5cdFx0Ly8gQ2hlY2sgaWYgZmlsZSBleGlzdHNcclxuXHRcdGlmICghZnMuZXhpc3RzU3luYyhjb25maWdQYXRoKSkge1xyXG5cdFx0XHRuZXcgTm90aWNlKGBDb25maWcgZmlsZSBub3QgZm91bmQgYXQ6ICR7Y29uZmlnUGF0aH1gKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFVzZSBFbGVjdHJvbidzIHNoZWxsIHRvIG9wZW4gdGhlIGZpbGUgd2l0aCB0aGUgZGVmYXVsdCBlZGl0b3JcclxuXHRcdGF3YWl0IHNoZWxsLm9wZW5QYXRoKGNvbmZpZ1BhdGgpO1xyXG5cdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIGNvbmZpZyBmaWxlOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKX1gKTtcclxuXHR9XHJcbn0iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgVEZvbGRlciwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIEZpbGVDcmVhdGlvbk9wdGlvbnMsIFJlbmFtZU9wdGlvbnMsIENvbnRlbnRUeXBlLCBDb250ZW50VHlwZUlkLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBtYXRjaGVzRm9sZGVyUGF0dGVybiwgc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5IH0gZnJvbSBcIi4vcGF0aC1tYXRjaGluZ1wiO1xuXG5leHBvcnQgY2xhc3MgRmlsZU9wZXJhdGlvbnMge1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBwcml2YXRlIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIHByaXZhdGUgcGx1Z2luPzogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSAmIHsgcGx1Z2luQ3JlYXRlZEZpbGVzPzogU2V0PHN0cmluZz4gfSkge31cblx0XG5cdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSB1c2Ugc3RvcmVkIHNldHRpbmdzXG5cdHByaXZhdGUgZ2V0U2V0dGluZ3MoKTogQXN0cm9Db21wb3NlclNldHRpbmdzIHtcblx0XHQvLyBBbHdheXMgcHJlZmVyIHBsdWdpbiBzZXR0aW5ncyAodGhleSdyZSBrZXB0IHVwIHRvIGRhdGUpXG5cdFx0aWYgKHRoaXMucGx1Z2luPy5zZXR0aW5ncykge1xuXHRcdFx0cmV0dXJuIHRoaXMucGx1Z2luLnNldHRpbmdzO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5zZXR0aW5ncztcblx0fVxuXG5cdHRvS2ViYWJDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gc3RyXG5cdFx0XHQudG9Mb3dlckNhc2UoKVxuXHRcdFx0Ly8gUmVtb3ZlIG9yIHJlcGxhY2UgcHJvYmxlbWF0aWMgY2hhcmFjdGVycyBmb3IgZmlsZW5hbWVzXG5cdFx0XHQucmVwbGFjZSgvWzw+OlwiL1xcXFx8PypdL2csIFwiXCIpIC8vIFJlbW92ZSBXaW5kb3dzL1VuaXggaW52YWxpZCBmaWxlbmFtZSBjaGFyYWN0ZXJzXG5cdFx0XHQucmVwbGFjZSgvWydcIl0vZywgXCJcIikgLy8gUmVtb3ZlIHF1b3Rlc1xuXHRcdFx0LnJlcGxhY2UoL1teXFx3XFxzLV0vZywgXCJcIikgLy8gUmVtb3ZlIG90aGVyIHNwZWNpYWwgY2hhcmFjdGVycyBidXQga2VlcCBsZXR0ZXJzLCBudW1iZXJzLCBzcGFjZXMsIGh5cGhlbnNcblx0XHRcdC50cmltKClcblx0XHRcdC5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKVxuXHRcdFx0LnJlcGxhY2UoLy0rL2csIFwiLVwiKVxuXHRcdFx0LnJlcGxhY2UoL14tfC0kL2csIFwiXCIpO1xuXHR9XG5cblx0Z2VuZXJhdGVGaWxlbmFtZSh0aXRsZTogc3RyaW5nLCBlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBib29sZWFuID0gZmFsc2UpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGtlYmFiVGl0bGUgPSB0aGlzLnRvS2ViYWJDYXNlKHRpdGxlKTtcblx0XHQvLyBJZiBrZWJhYiBjYXNlIHJlc3VsdHMgaW4gZW1wdHkgc3RyaW5nLCB1c2UgYSBmYWxsYmFja1xuXHRcdGNvbnN0IHNhZmVLZWJhYlRpdGxlID0ga2ViYWJUaXRsZSB8fCBcInVudGl0bGVkXCI7XG5cdFx0Y29uc3QgcHJlZml4ID0gZW5hYmxlVW5kZXJzY29yZVByZWZpeCA/IFwiX1wiIDogXCJcIjtcblx0XHRyZXR1cm4gYCR7cHJlZml4fSR7c2FmZUtlYmFiVGl0bGV9YDtcblx0fVxuXG5cdGRldGVybWluZVR5cGUoZmlsZTogVEZpbGUpOiBDb250ZW50VHlwZUlkIHtcblx0XHRjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRcblx0XHQvLyBDaGVjayBhbGwgY29udGVudCB0eXBlcywgc29ydGVkIGJ5IHBhdHRlcm4gc3BlY2lmaWNpdHkgKG1vcmUgc3BlY2lmaWMgZmlyc3QpXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IHNvcnRlZFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRUeXBlcykge1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcblx0XHRcdFxuXHRcdFx0Ly8gSGFuZGxlIGJsYW5rIGZvbGRlciAocm9vdCkgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xuXHRcdFx0XHRpZiAoIWZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCBmaWxlUGF0aC5zcGxpdChcIi9cIikubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGNvbnRlbnRUeXBlLmlkO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlnbm9yZVN1YmZvbGRlcnMgaWYgZm9sZGVyIGlzIHNwZWNpZmllZFxuXHRcdFx0XHRpZiAoY29udGVudFR5cGUuaWdub3JlU3ViZm9sZGVycykge1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhTZWdtZW50cyA9IGZpbGVQYXRoLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBwYXRoRGVwdGggPSBwYXRoU2VnbWVudHMubGVuZ3RoO1xuXHRcdFx0XHRcdGNvbnN0IHBhdHRlcm5TZWdtZW50cyA9IGNvbnRlbnRUeXBlLmZvbGRlci5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgZXhwZWN0ZWREZXB0aCA9IHBhdHRlcm5TZWdtZW50cy5sZW5ndGg7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0XHRcdFx0Ly8gRm9yIGZvbGRlci1iYXNlZCBjcmVhdGlvbiwgZmlsZXMgYXJlIG9uZSBsZXZlbCBkZWVwZXIgKGUuZy4sIHRlc3QvbXktZmlsZS9pbmRleC5tZClcblx0XHRcdFx0XHRcdC8vIFNvIHdlIG5lZWQgdG8gYWxsb3cgb25lIGV4dHJhIGxldmVsIGJleW9uZCB0aGUgcGF0dGVybiBkZXB0aFxuXHRcdFx0XHRcdFx0Y29uc3QgZm9sZGVyRGVwdGggPSBwYXRoRGVwdGggLSAxOyAvLyBTdWJ0cmFjdCAxIGZvciB0aGUgaW5kZXgubWQgZmlsZVxuXHRcdFx0XHRcdFx0aWYgKGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoIHx8IGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoICsgMSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY29udGVudFR5cGUuaWQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmaWxlLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgYXQgdGhlIHNhbWUgZGVwdGggYXMgdGhlIHBhdHRlcm5cblx0XHRcdFx0XHRcdGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbnRlbnRUeXBlLmlkO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gY29udGVudFR5cGUuaWQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgbm8gY29udGVudCB0eXBlIG1hdGNoZXMsIHJldHVybiBcIm5vdGVcIiBhcyBmYWxsYmFja1xuXHRcdHJldHVybiBcIm5vdGVcIjtcblx0fVxuXG5cdGdldENvbnRlbnRUeXBlKHR5cGVJZDogQ29udGVudFR5cGVJZCk6IENvbnRlbnRUeXBlIHwgbnVsbCB7XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdHJldHVybiBjb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gdHlwZUlkKSB8fCBudWxsO1xuXHR9XG5cblx0Z2V0VGl0bGVLZXkodHlwZTogQ29udGVudFR5cGVJZCk6IHN0cmluZyB7XG5cdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIGFsd2F5cyB1c2UgXCJ0aXRsZVwiXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gXCJ0aXRsZVwiO1xuXHRcdFxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm4gXCJ0aXRsZVwiO1xuXHRcdFxuXHRcdGNvbnN0IHRlbXBsYXRlID0gY29udGVudFR5cGUudGVtcGxhdGU7XG5cdFx0Y29uc3QgbGluZXMgPSB0ZW1wbGF0ZS5zcGxpdChcIlxcblwiKTtcblx0XHRsZXQgaW5Qcm9wZXJ0aWVzID0gZmFsc2U7XG5cdFx0Zm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG5cdFx0XHRjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7XG5cdFx0XHRpZiAodHJpbW1lZCA9PT0gXCItLS1cIikge1xuXHRcdFx0XHRpblByb3BlcnRpZXMgPSAhaW5Qcm9wZXJ0aWVzO1xuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdH1cblx0XHRcdGlmIChpblByb3BlcnRpZXMpIHtcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSB0cmltbWVkLm1hdGNoKC9eKFxcdyspOlxccyooLispJC8pO1xuXHRcdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0XHRjb25zdCBrZXkgPSBtYXRjaFsxXTtcblx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IG1hdGNoWzJdO1xuXHRcdFx0XHRcdGlmICh2YWx1ZS5pbmNsdWRlcyhcInt7dGl0bGV9fVwiKSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGtleTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIFwidGl0bGVcIjtcblx0fVxuXG5cdGFzeW5jIGNyZWF0ZUZpbGUob3B0aW9uczogRmlsZUNyZWF0aW9uT3B0aW9ucyk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0Y29uc3QgeyBmaWxlLCB0aXRsZSwgdHlwZSB9ID0gb3B0aW9ucztcblx0XHRcblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBUaXRsZSBpcyByZXF1aXJlZCB0byBjcmVhdGUgYSAke3R5cGV9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gR2V0IGNvbnRlbnQgdHlwZSBzZXR0aW5nc1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRpZiAoIWNvbnRlbnRUeXBlICYmIHR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb250ZW50IHR5cGUgJHt0eXBlfSBub3QgZm91bmQuYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBrZWJhYlRpdGxlID0gdGhpcy50b0tlYmFiQ2FzZSh0aXRsZSk7XG5cdFx0Y29uc3QgZW5hYmxlVW5kZXJzY29yZVByZWZpeCA9IGNvbnRlbnRUeXBlPy5lbmFibGVVbmRlcnNjb3JlUHJlZml4IHx8IGZhbHNlO1xuXHRcdGNvbnN0IHByZWZpeCA9IGVuYWJsZVVuZGVyc2NvcmVQcmVmaXggPyBcIl9cIiA6IFwiXCI7XG5cblx0XHRsZXQgdGFyZ2V0Rm9sZGVyID0gXCJcIjtcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdC8vIEZvciBnZW5lcmljIG5vdGVzLCBrZWVwIHRoZW0gaW4gdGhlaXIgY3VycmVudCBsb2NhdGlvblxuXHRcdFx0dGFyZ2V0Rm9sZGVyID0gXCJcIjtcblx0XHR9IGVsc2UgaWYgKGNvbnRlbnRUeXBlKSB7XG5cdFx0XHQvLyBHZXQgdGhlIGRpcmVjdG9yeSB3aGVyZSB0aGUgdXNlciBjcmVhdGVkIHRoZSBmaWxlXG5cdFx0XHRjb25zdCBvcmlnaW5hbERpciA9IGZpbGUucGFyZW50Py5wYXRoIHx8IFwiXCI7XG5cdFx0XHRcblx0XHRcdC8vIFJlc3BlY3QgdGhlIHVzZXIncyBjaG9zZW4gbG9jYXRpb24gKHN1YmZvbGRlcilcblx0XHRcdC8vIE9ubHkgdXNlIHRoZSBjb25maWd1cmVkIGZvbGRlciBpZiB0aGUgdXNlciBjcmVhdGVkIHRoZSBmaWxlIGluIHRoZSB2YXVsdCByb290XG5cdFx0XHRpZiAob3JpZ2luYWxEaXIgPT09IFwiXCIgfHwgb3JpZ2luYWxEaXIgPT09IFwiL1wiKSB7XG5cdFx0XHRcdHRhcmdldEZvbGRlciA9IGNvbnRlbnRUeXBlLmZvbGRlciB8fCBcIlwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFyZ2V0Rm9sZGVyID0gb3JpZ2luYWxEaXI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdGlmICh0YXJnZXRGb2xkZXIpIHtcblx0XHRcdGNvbnN0IGZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aCh0YXJnZXRGb2xkZXIpO1xuXHRcdFx0aWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcblx0XHRcdFx0YXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKHRhcmdldEZvbGRlcik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y29uc3QgY3JlYXRpb25Nb2RlID0gY29udGVudFR5cGU/LmNyZWF0aW9uTW9kZSB8fCBcImZpbGVcIjtcblx0XHRpZiAoY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5jcmVhdGVGb2xkZXJTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCB0YXJnZXRGb2xkZXIsIHR5cGUsIGNvbnRlbnRUeXBlKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRmlsZVN0cnVjdHVyZShmaWxlLCBrZWJhYlRpdGxlLCBwcmVmaXgsIHRhcmdldEZvbGRlcik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjcmVhdGVGb2xkZXJTdHJ1Y3R1cmUoZmlsZTogVEZpbGUsIGtlYmFiVGl0bGU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcsIHRhcmdldEZvbGRlcjogc3RyaW5nLCB0eXBlOiBDb250ZW50VHlwZUlkLCBjb250ZW50VHlwZTogQ29udGVudFR5cGUgfCBudWxsKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHRjb25zdCBmb2xkZXJOYW1lID0gYCR7cHJlZml4fSR7a2ViYWJUaXRsZX1gO1xuXHRcdGxldCBmb2xkZXJQYXRoOiBzdHJpbmc7XG5cdFx0XG5cdFx0aWYgKHRhcmdldEZvbGRlcikge1xuXHRcdFx0Ly8gTW92ZSB0byB0YXJnZXQgZm9sZGVyXG5cdFx0XHRmb2xkZXJQYXRoID0gYCR7dGFyZ2V0Rm9sZGVyfS8ke2ZvbGRlck5hbWV9YDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gS2VlcCBpbiBjdXJyZW50IGxvY2F0aW9uXG5cdFx0XHRjb25zdCBjdXJyZW50RGlyID0gZmlsZS5wYXJlbnQgPyBmaWxlLnBhcmVudC5wYXRoIDogXCJcIjtcblx0XHRcdGlmIChjdXJyZW50RGlyICYmIGN1cnJlbnREaXIgIT09IFwiL1wiKSB7XG5cdFx0XHRcdGZvbGRlclBhdGggPSBgJHtjdXJyZW50RGlyfS8ke2ZvbGRlck5hbWV9YDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbGUgaXMgaW4gdmF1bHQgcm9vdCwganVzdCB1c2UgZm9sZGVyIG5hbWVcblx0XHRcdFx0Zm9sZGVyUGF0aCA9IGZvbGRlck5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGNvbnN0IGZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmb2xkZXJQYXRoKTtcblx0XHRcdGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcblx0XHRcdH1cblx0XHR9IGNhdGNoIHtcblx0XHRcdC8vIEZvbGRlciBtaWdodCBhbHJlYWR5IGV4aXN0LCBwcm9jZWVkXG5cdFx0fVxuXG5cdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiaW5kZXhcIjtcblx0XHRjb25zdCBmaWxlTmFtZSA9IGAke2luZGV4RmlsZU5hbWV9Lm1kYDtcblx0XHRjb25zdCBuZXdQYXRoID0gYCR7Zm9sZGVyUGF0aH0vJHtmaWxlTmFtZX1gO1xuXG5cdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0bmV3IE5vdGljZShgRmlsZSBhbHJlYWR5IGV4aXN0cyBhdCAke25ld1BhdGh9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gVHJhY2sgdGhhdCB0aGlzIGZpbGUgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBwbHVnaW4gQkVGT1JFIHJlbmFtaW5nXG5cdFx0Ly8gVGhpcyBwcmV2ZW50cyB0aGUgY3JlYXRlIGV2ZW50IGZyb20gdHJpZ2dlcmluZyBhbm90aGVyIG1vZGFsXG5cdFx0aWYgKHRoaXMucGx1Z2luICYmICdwbHVnaW5DcmVhdGVkRmlsZXMnIGluIHRoaXMucGx1Z2luKSB7XG5cdFx0XHRjb25zdCBwbHVnaW5XaXRoRmlsZXMgPSB0aGlzLnBsdWdpbiBhcyB7IHBsdWdpbkNyZWF0ZWRGaWxlcz86IFNldDxzdHJpbmc+IH07XG5cdFx0XHRwbHVnaW5XaXRoRmlsZXMucGx1Z2luQ3JlYXRlZEZpbGVzPy5hZGQobmV3UGF0aCk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGZpbGVFeHBsb3JlciA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoXCJmaWxlLWV4cGxvcmVyXCIpWzBdO1xuXHRcdFx0XHRpZiAoZmlsZUV4cGxvcmVyICYmIGZpbGVFeHBsb3Jlci52aWV3KSB7XG5cdFx0XHRcdFx0Y29uc3QgdmlldyA9IGZpbGVFeHBsb3Jlci52aWV3O1xuXHRcdFx0XHRcdGlmICh2aWV3ICYmIHR5cGVvZiB2aWV3ID09PSAnb2JqZWN0JyAmJiAndHJlZScgaW4gdmlldykge1xuXHRcdFx0XHRcdFx0Y29uc3QgZmlsZVRyZWUgPSAodmlldyBhcyB7IHRyZWU/OiB7IHJldmVhbEZpbGU/OiAoZmlsZTogVEZpbGUpID0+IHZvaWQgfSB9KS50cmVlO1xuXHRcdFx0XHRcdFx0aWYgKGZpbGVUcmVlICYmIG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiB0eXBlb2YgZmlsZVRyZWUucmV2ZWFsRmlsZSA9PT0gJ2Z1bmN0aW9uJykge1xuXHRcdFx0XHRcdFx0XHRmaWxlVHJlZS5yZXZlYWxGaWxlKG5ld0ZpbGUpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSwgMjAwKTtcblxuXHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUobmV3RmlsZSk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gY3JlYXRlIGZvbGRlciBzdHJ1Y3R1cmU6ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRmlsZVN0cnVjdHVyZShmaWxlOiBURmlsZSwga2ViYWJUaXRsZTogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgdGFyZ2V0Rm9sZGVyOiBzdHJpbmcpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS5tZGA7XG5cdFx0bGV0IG5ld1BhdGg6IHN0cmluZztcblx0XHRcblx0XHRpZiAodGFyZ2V0Rm9sZGVyKSB7XG5cdFx0XHQvLyBNb3ZlIHRvIHRhcmdldCBmb2xkZXJcblx0XHRcdG5ld1BhdGggPSBgJHt0YXJnZXRGb2xkZXJ9LyR7bmV3TmFtZX1gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBLZWVwIGluIGN1cnJlbnQgbG9jYXRpb24sIGp1c3QgcmVuYW1lIHRoZSBmaWxlXG5cdFx0XHRjb25zdCBjdXJyZW50RGlyID0gZmlsZS5wYXJlbnQgPyBmaWxlLnBhcmVudC5wYXRoIDogXCJcIjtcblx0XHRcdGlmIChjdXJyZW50RGlyICYmIGN1cnJlbnREaXIgIT09IFwiL1wiKSB7XG5cdFx0XHRcdG5ld1BhdGggPSBgJHtjdXJyZW50RGlyfS8ke25ld05hbWV9YDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZpbGUgaXMgaW4gdmF1bHQgcm9vdCwganVzdCB1c2UgbmV3IG5hbWVcblx0XHRcdFx0bmV3UGF0aCA9IG5ld05hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBleGlzdGluZ0ZpbGUgIT09IGZpbGUpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEZpbGUgd2l0aCBuYW1lIFwiJHtuZXdOYW1lfVwiIGFscmVhZHkgZXhpc3RzLmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gVHJhY2sgdGhhdCB0aGlzIGZpbGUgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBwbHVnaW4gQkVGT1JFIHJlbmFtaW5nXG5cdFx0Ly8gVGhpcyBwcmV2ZW50cyB0aGUgY3JlYXRlIGV2ZW50IGZyb20gdHJpZ2dlcmluZyBhbm90aGVyIG1vZGFsXG5cdFx0aWYgKHRoaXMucGx1Z2luICYmICdwbHVnaW5DcmVhdGVkRmlsZXMnIGluIHRoaXMucGx1Z2luKSB7XG5cdFx0XHRjb25zdCBwbHVnaW5XaXRoRmlsZXMgPSB0aGlzLnBsdWdpbiBhcyB7IHBsdWdpbkNyZWF0ZWRGaWxlcz86IFNldDxzdHJpbmc+IH07XG5cdFx0XHRwbHVnaW5XaXRoRmlsZXMucGx1Z2luQ3JlYXRlZEZpbGVzPy5hZGQobmV3UGF0aCk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIFVzZSBmaWxlTWFuYWdlci5yZW5hbWVGaWxlKCkgd2hpY2ggcmVzcGVjdHMgdXNlciBzZXR0aW5ncyBhbmQgaGFuZGxlcyBhbGwgbGluayBmb3JtYXRzXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xuXHRcdFx0XG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGxvY2F0ZSByZW5hbWVkIGZpbGUuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUobmV3RmlsZSk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmVuYW1lIGZpbGU6ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cblx0YXN5bmMgcmVuYW1lRmlsZShvcHRpb25zOiBSZW5hbWVPcHRpb25zKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHRjb25zdCB7IGZpbGUsIHRpdGxlLCB0eXBlIH0gPSBvcHRpb25zO1xuXHRcdFxuXHRcdGlmICghdGl0bGUpIHtcblx0XHRcdG5ldyBOb3RpY2UoYFRpdGxlIGlzIHJlcXVpcmVkIHRvIHJlbmFtZSB0aGUgY29udGVudC5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRpZiAoIWNvbnRlbnRUeXBlICYmIHR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBDb250ZW50IHR5cGUgJHt0eXBlfSBub3QgZm91bmQuYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRjb25zdCBrZWJhYlRpdGxlID0gdGhpcy50b0tlYmFiQ2FzZSh0aXRsZSk7XG5cdFx0Y29uc3QgcHJlZml4ID0gXCJcIjtcblxuXHRcdGNvbnN0IGNyZWF0aW9uTW9kZSA9IGNvbnRlbnRUeXBlPy5jcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCI7XG5cdFx0aWYgKGNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVuYW1lRm9sZGVyU3RydWN0dXJlKGZpbGUsIGtlYmFiVGl0bGUsIHByZWZpeCwgdHlwZSwgY29udGVudFR5cGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yZW5hbWVGaWxlU3RydWN0dXJlKGZpbGUsIGtlYmFiVGl0bGUsIHByZWZpeCwgY29udGVudFR5cGUpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgcmVuYW1lRm9sZGVyU3RydWN0dXJlKGZpbGU6IFRGaWxlLCBrZWJhYlRpdGxlOiBzdHJpbmcsIHByZWZpeDogc3RyaW5nLCB0eXBlOiBDb250ZW50VHlwZUlkLCBjb250ZW50VHlwZTogQ29udGVudFR5cGUgfCBudWxsKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IHRyZWF0IGFzIGluZGV4IGlmIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZVxuXHRcdC8vIERlZmF1bHQgdG8gXCJpbmRleFwiIHdoZW4gaW5kZXhGaWxlTmFtZSBpcyBibGFua1xuXHRcdGNvbnN0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZT8uaW5kZXhGaWxlTmFtZSB8fCBcImluZGV4XCI7XG5cdFx0Y29uc3QgaXNJbmRleCA9IGZpbGUuYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWU7XG5cdFx0aWYgKGlzSW5kZXgpIHtcblx0XHRcdGlmICghZmlsZS5wYXJlbnQpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IGZpbGUgaGFzIG5vIHBhcmVudCBmb2xkZXIuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHRcdHByZWZpeCA9IGZpbGUucGFyZW50Lm5hbWUuc3RhcnRzV2l0aChcIl9cIikgPyBcIl9cIiA6IFwiXCI7XG5cdFx0XHRjb25zdCBuZXdGb2xkZXJOYW1lID0gYCR7cHJlZml4fSR7a2ViYWJUaXRsZX1gO1xuXHRcdFx0Y29uc3QgcGFyZW50Rm9sZGVyID0gZmlsZS5wYXJlbnQucGFyZW50O1xuXHRcdFx0aWYgKCFwYXJlbnRGb2xkZXIpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHBhcmVudCBmb2xkZXIgaGFzIG5vIHBhcmVudC5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0Ly8gRml4IHBhdGggY29uc3RydWN0aW9uIHRvIGF2b2lkIGRvdWJsZSBzbGFzaGVzXG5cdFx0XHRsZXQgbmV3Rm9sZGVyUGF0aDogc3RyaW5nO1xuXHRcdFx0aWYgKHBhcmVudEZvbGRlci5wYXRoID09PSBcIlwiIHx8IHBhcmVudEZvbGRlci5wYXRoID09PSBcIi9cIikge1xuXHRcdFx0XHQvLyBQYXJlbnQgaXMgdmF1bHQgcm9vdFxuXHRcdFx0XHRuZXdGb2xkZXJQYXRoID0gbmV3Rm9sZGVyTmFtZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyBpbiBhIHN1YmZvbGRlclxuXHRcdFx0XHRuZXdGb2xkZXJQYXRoID0gYCR7cGFyZW50Rm9sZGVyLnBhdGh9LyR7bmV3Rm9sZGVyTmFtZX1gO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBleGlzdGluZ0ZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGb2xkZXJQYXRoKTtcblx0XHRcdGlmIChleGlzdGluZ0ZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRm9sZGVyIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3Rm9sZGVyUGF0aH0uYCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUucGFyZW50LCBuZXdGb2xkZXJQYXRoKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIHJlbmFtZSBmb2xkZXI6ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGNvbnN0IG5ld0ZpbGVQYXRoID0gYCR7bmV3Rm9sZGVyUGF0aH0vJHtmaWxlLm5hbWV9YDtcblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3RmlsZVBhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGxvY2F0ZSByZW5hbWVkIGZpbGUuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCFmaWxlLnBhcmVudCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogZmlsZSBoYXMgbm8gcGFyZW50IGZvbGRlci5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0cHJlZml4ID0gZmlsZS5iYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfS5tZGA7XG5cdFx0XHRjb25zdCBuZXdQYXRoID0gYCR7ZmlsZS5wYXJlbnQucGF0aH0vJHtuZXdOYW1lfWA7XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBleGlzdGluZ0ZpbGUgIT09IGZpbGUpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmlsZSBhbHJlYWR5IGV4aXN0cyBhdCAke25ld1BhdGh9LmApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Ly8gVXNlIGZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoKSB3aGljaCBhdXRvbWF0aWNhbGx5IHVwZGF0ZXMgbGlua3Ncblx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGxvY2F0ZSByZW5hbWVkIGZpbGUuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlbmFtZUZpbGVTdHJ1Y3R1cmUoZmlsZTogVEZpbGUsIGtlYmFiVGl0bGU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcsIGNvbnRlbnRUeXBlOiBDb250ZW50VHlwZSB8IG51bGwpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGlmICghZmlsZS5wYXJlbnQpIHtcblx0XHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiBmaWxlIGhhcyBubyBwYXJlbnQgZm9sZGVyLlwiKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGlzIGlzIGFuIGluZGV4IGZpbGUgLSBpZiBzbywgcmVuYW1lIHRoZSBwYXJlbnQgZm9sZGVyIGluc3RlYWRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IG9ubHkgdHJlYXQgYXMgaW5kZXggaWYgaW5kZXhGaWxlTmFtZSBpcyBzcGVjaWZpZWQgYW5kIG1hdGNoZXNcblx0XHRjb25zdCBpbmRleEZpbGVOYW1lID0gY29udGVudFR5cGU/LmluZGV4RmlsZU5hbWUgfHwgXCJcIjtcblx0XHRjb25zdCBpc0luZGV4ID0gaW5kZXhGaWxlTmFtZSAmJiBcblx0XHRcdGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmIFxuXHRcdFx0ZmlsZS5iYXNlbmFtZSA9PT0gaW5kZXhGaWxlTmFtZTtcblx0XHRcblx0XHRpZiAoaXNJbmRleCkge1xuXHRcdFx0cHJlZml4ID0gZmlsZS5wYXJlbnQubmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdGNvbnN0IG5ld0ZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0XHRjb25zdCBwYXJlbnRGb2xkZXIgPSBmaWxlLnBhcmVudC5wYXJlbnQ7XG5cdFx0XHRpZiAoIXBhcmVudEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogcGFyZW50IGZvbGRlciBoYXMgbm8gcGFyZW50LlwiKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cdFx0XHQvLyBGaXggcGF0aCBjb25zdHJ1Y3Rpb24gdG8gYXZvaWQgZG91YmxlIHNsYXNoZXNcblx0XHRcdGxldCBuZXdGb2xkZXJQYXRoOiBzdHJpbmc7XG5cdFx0XHRpZiAocGFyZW50Rm9sZGVyLnBhdGggPT09IFwiXCIgfHwgcGFyZW50Rm9sZGVyLnBhdGggPT09IFwiL1wiKSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyB2YXVsdCByb290XG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBuZXdGb2xkZXJOYW1lO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gUGFyZW50IGlzIGluIGEgc3ViZm9sZGVyXG5cdFx0XHRcdG5ld0ZvbGRlclBhdGggPSBgJHtwYXJlbnRGb2xkZXIucGF0aH0vJHtuZXdGb2xkZXJOYW1lfWA7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IGV4aXN0aW5nRm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0aWYgKGV4aXN0aW5nRm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGb2xkZXIgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdGb2xkZXJQYXRofS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZS5wYXJlbnQsIG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignRmlsZU9wZXJhdGlvbnM6IEZvbGRlciByZW5hbWUgZmFpbGVkOicsIGVycm9yKTtcblx0XHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmVuYW1lIGZvbGRlcjogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHRcdFxuXHRcdFx0Y29uc3QgbmV3RmlsZVBhdGggPSBgJHtuZXdGb2xkZXJQYXRofS8ke2ZpbGUubmFtZX1gO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGaWxlUGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gRm9yIG5vbi1pbmRleCBmaWxlcywgcmVuYW1lIHRoZSBmaWxlIGl0c2VsZlxuXHRcdHByZWZpeCA9IGZpbGUuYmFzZW5hbWUuc3RhcnRzV2l0aChcIl9cIikgPyBcIl9cIiA6IFwiXCI7XG5cdFx0Y29uc3QgbmV3TmFtZSA9IGAke3ByZWZpeH0ke2tlYmFiVGl0bGV9Lm1kYDtcblx0XHRcblx0XHQvLyBGaXggcGF0aCBjb25zdHJ1Y3Rpb24gdG8gYXZvaWQgZG91YmxlIHNsYXNoZXNcblx0XHRsZXQgbmV3UGF0aDogc3RyaW5nO1xuXHRcdGlmIChmaWxlLnBhcmVudC5wYXRoID09PSBcIlwiIHx8IGZpbGUucGFyZW50LnBhdGggPT09IFwiL1wiKSB7XG5cdFx0XHQvLyBGaWxlIGlzIGluIHZhdWx0IHJvb3Rcblx0XHRcdG5ld1BhdGggPSBuZXdOYW1lO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBGaWxlIGlzIGluIGEgc3ViZm9sZGVyXG5cdFx0XHRuZXdQYXRoID0gYCR7ZmlsZS5wYXJlbnQucGF0aH0vJHtuZXdOYW1lfWA7XG5cdFx0fVxuXG5cdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBleGlzdGluZ0ZpbGUgIT09IGZpbGUpIHtcblx0XHRcdG5ldyBOb3RpY2UoYEZpbGUgYWxyZWFkeSBleGlzdHMgYXQgJHtuZXdQYXRofS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdGaWxlT3BlcmF0aW9uczogRmlsZSByZW5hbWUgZmFpbGVkOicsIGVycm9yKTtcblx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcblx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZW5hbWUgZmlsZTogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0bmV3IE5vdGljZShcIkZhaWxlZCB0byBsb2NhdGUgcmVuYW1lZCBmaWxlLlwiKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRcblx0XHRyZXR1cm4gbmV3RmlsZTtcblx0fVxufVxuIiwgIi8qKlxyXG4gKiBVdGlsaXR5IGZ1bmN0aW9ucyBmb3IgbWF0Y2hpbmcgZmlsZSBwYXRocyBhZ2FpbnN0IGZvbGRlciBwYXR0ZXJucyB3aXRoIHdpbGRjYXJkIHN1cHBvcnQuXHJcbiAqIFxyXG4gKiBXaWxkY2FyZCBwYXR0ZXJuczpcclxuICogLSBgZG9jc2AgbWF0Y2hlcyBgZG9jcy9gIGFuZCBhbnl0aGluZyB1bmRlciBpdFxyXG4gKiAtIGBkb2NzL3thc3Rlcmlza31gIG1hdGNoZXMgYGRvY3MvYW55dGhpbmcvYCBhbmQgYW55dGhpbmcgdW5kZXIgaXQgKG9uZSBsZXZlbCBkZWVwKVxyXG4gKiAtIGBkb2NzL3thc3Rlcmlza30ve2FzdGVyaXNrfWAgbWF0Y2hlcyBgZG9jcy9hbnl0aGluZy9hbnl0aGluZy9gIGFuZCBhbnl0aGluZyB1bmRlciBpdCAodHdvIGxldmVscyBkZWVwKVxyXG4gKiAtIGV0Yy5cclxuICogXHJcbiAqIE5vdGU6IHthc3Rlcmlza30gcmVwcmVzZW50cyB0aGUgd2lsZGNhcmQgY2hhcmFjdGVyICpcclxuICovXHJcblxyXG4vKipcclxuICogQ2hlY2tzIGlmIGEgZmlsZSBwYXRoIG1hdGNoZXMgYSBmb2xkZXIgcGF0dGVybiAoc3VwcG9ydHMgd2lsZGNhcmRzKVxyXG4gKiBAcGFyYW0gZmlsZVBhdGggVGhlIGZpbGUgcGF0aCB0byBjaGVjayAoZS5nLiwgXCJkb2NzL2V4YW1wbGUtYS9nZXR0aW5nLXN0YXJ0ZWQubWRcIilcclxuICogQHBhcmFtIGZvbGRlclBhdHRlcm4gVGhlIGZvbGRlciBwYXR0ZXJuIC0gdXNlIGFzdGVyaXNrIGZvciB3aWxkY2FyZHMgKGUuZy4sIFwiZG9jc1wiLCBcImRvY3MvYXN0ZXJpc2tcIiwgXCJkb2NzL2FzdGVyaXNrL2FzdGVyaXNrXCIpXHJcbiAqIEByZXR1cm5zIHRydWUgaWYgdGhlIGZpbGUgcGF0aCBtYXRjaGVzIHRoZSBwYXR0ZXJuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gbWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGg6IHN0cmluZywgZm9sZGVyUGF0dGVybjogc3RyaW5nKTogYm9vbGVhbiB7XHJcblx0Ly8gSGFuZGxlIGVtcHR5IGZvbGRlciBwYXR0ZXJuIChyb290IGZvbGRlcikgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxyXG5cdGlmICghZm9sZGVyUGF0dGVybiB8fCBmb2xkZXJQYXR0ZXJuLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0Ly8gUm9vdCBmb2xkZXIgbWF0Y2hlcyBmaWxlcyB0aGF0IGRvbid0IGhhdmUgYW55IHBhdGggc2VwYXJhdG9yc1xyXG5cdFx0Ly8gb3IgYXJlIGluIHZhdWx0IHJvb3QgKG5vIGxlYWRpbmcgc2xhc2gsIHNpbmdsZSBzZWdtZW50KVxyXG5cdFx0cmV0dXJuICFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgKGZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDEpO1xyXG5cdH1cclxuXHJcblx0Ly8gSWYgcGF0dGVybiBkb2Vzbid0IGNvbnRhaW4gd2lsZGNhcmRzLCB1c2Ugc2ltcGxlIHByZWZpeCBtYXRjaGluZ1xyXG5cdGlmICghZm9sZGVyUGF0dGVybi5pbmNsdWRlcyhcIipcIikpIHtcclxuXHRcdHJldHVybiBmaWxlUGF0aCA9PT0gZm9sZGVyUGF0dGVybiB8fCBmaWxlUGF0aC5zdGFydHNXaXRoKGZvbGRlclBhdHRlcm4gKyBcIi9cIik7XHJcblx0fVxyXG5cclxuXHQvLyBDb252ZXJ0IHdpbGRjYXJkIHBhdHRlcm4gdG8gcmVnZXhcclxuXHQvLyBFc2NhcGUgc3BlY2lhbCByZWdleCBjaGFyYWN0ZXJzIGV4Y2VwdCAqXHJcblx0Y29uc3QgZXNjYXBlZFBhdHRlcm4gPSBmb2xkZXJQYXR0ZXJuXHJcblx0XHQucmVwbGFjZSgvWy4rP14ke30oKXxbXFxdXFxcXF0vZywgXCJcXFxcJCZcIilcclxuXHRcdC5yZXBsYWNlKC9cXCovZywgXCJbXi9dK1wiKTsgLy8gV2lsZGNhcmQgbWF0Y2hlcyBhbnkgcGF0aCBzZWdtZW50IChub24tc2xhc2ggY2hhcmFjdGVycylcclxuXHJcblx0Ly8gQ3JlYXRlIHJlZ2V4IHRoYXQgbWF0Y2hlcyB0aGUgcGF0dGVybiBhbmQgYW55dGhpbmcgYWZ0ZXIgaXRcclxuXHRjb25zdCByZWdleFBhdHRlcm4gPSBgXiR7ZXNjYXBlZFBhdHRlcm59KD86L3wkKWA7XHJcblx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHJlZ2V4UGF0dGVybik7XHJcblx0cmV0dXJuIHJlZ2V4LnRlc3QoZmlsZVBhdGgpO1xyXG59XHJcblxyXG4vKipcclxuICogR2V0cyB0aGUgZGVwdGggb2YgYSBmb2xkZXIgcGF0dGVybiAobnVtYmVyIG9mIHNlZ21lbnRzKVxyXG4gKiBVc2VkIGZvciBwcmlvcml0aXppbmcgbW9yZSBzcGVjaWZpYyBwYXR0ZXJuc1xyXG4gKiBCbGFuay9yb290IGZvbGRlciBoYXMgZGVwdGggMCAobGVhc3Qgc3BlY2lmaWMpXHJcbiAqIEBwYXJhbSBmb2xkZXJQYXR0ZXJuIFRoZSBmb2xkZXIgcGF0dGVyblxyXG4gKiBAcmV0dXJucyBUaGUgbnVtYmVyIG9mIHBhdGggc2VnbWVudHMgaW4gdGhlIHBhdHRlcm4gKDAgZm9yIHJvb3QvYmxhbmspXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2V0UGF0dGVybkRlcHRoKGZvbGRlclBhdHRlcm46IHN0cmluZyk6IG51bWJlciB7XHJcblx0aWYgKCFmb2xkZXJQYXR0ZXJuIHx8IGZvbGRlclBhdHRlcm4udHJpbSgpID09PSBcIlwiKSByZXR1cm4gMDtcclxuXHRyZXR1cm4gZm9sZGVyUGF0dGVybi5zcGxpdChcIi9cIikubGVuZ3RoO1xyXG59XHJcblxyXG4vKipcclxuICogU29ydHMgY29udGVudCB0eXBlcyBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIHBhdHRlcm5zIGZpcnN0KVxyXG4gKiBUaGlzIGVuc3VyZXMgdGhhdCBtb3JlIHNwZWNpZmljIHBhdHRlcm5zIGFyZSBjaGVja2VkIGJlZm9yZSBsZXNzIHNwZWNpZmljIG9uZXNcclxuICogQmxhbmsvcm9vdCBmb2xkZXIgcGF0dGVybnMgKGRlcHRoIDApIGFyZSBzb3J0ZWQgbGFzdCAobGVhc3Qgc3BlY2lmaWMpXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5PFQgZXh0ZW5kcyB7IGZvbGRlcjogc3RyaW5nIH0+KHR5cGVzOiBUW10pOiBUW10ge1xyXG5cdHJldHVybiBbLi4udHlwZXNdLnNvcnQoKGEsIGIpID0+IHtcclxuXHRcdGNvbnN0IGRlcHRoQSA9IGdldFBhdHRlcm5EZXB0aChhLmZvbGRlcik7XHJcblx0XHRjb25zdCBkZXB0aEIgPSBnZXRQYXR0ZXJuRGVwdGgoYi5mb2xkZXIpO1xyXG5cdFx0Ly8gTW9yZSBzcGVjaWZpYyAoZGVlcGVyKSBwYXR0ZXJucyBmaXJzdFxyXG5cdFx0Ly8gQmxhbmsgcGF0dGVybnMgKGRlcHRoIDApIHdpbGwgYmUgc29ydGVkIGxhc3RcclxuXHRcdHJldHVybiBkZXB0aEIgLSBkZXB0aEE7XHJcblx0fSk7XHJcbn1cclxuXHJcbiIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzLCBQYXJzZWRGcm9udG1hdHRlciwgVGVtcGxhdGVWYWx1ZXMsIEtOT1dOX0FSUkFZX0tFWVMsIENvbnRlbnRUeXBlSWQgfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBUZW1wbGF0ZVBhcnNlciB7XHJcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCwgcHJpdmF0ZSBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKSB7fVxyXG5cclxuXHRwYXJzZUZyb250bWF0dGVyKGNvbnRlbnQ6IHN0cmluZyk6IFBhcnNlZEZyb250bWF0dGVyIHtcclxuXHRcdGxldCBwcm9wZXJ0aWVzRW5kID0gMDtcclxuXHRcdGxldCBwcm9wZXJ0aWVzVGV4dCA9IFwiXCI7XHJcblx0XHRjb25zdCBleGlzdGluZ1Byb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZ1tdPiA9IHt9O1xyXG5cclxuXHRcdC8vIFBhcnNlIGV4aXN0aW5nIHByb3BlcnRpZXMgd2l0aCBmYWxsYmFjayBmb3IgbWlzc2luZyBzZWNvbmQgLS0tXHJcblx0XHRpZiAoY29udGVudC5zdGFydHNXaXRoKFwiLS0tXCIpKSB7XHJcblx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50LmluZGV4T2YoXCJcXG4tLS1cIiwgMyk7XHJcblx0XHRcdGlmIChwcm9wZXJ0aWVzRW5kID09PSAtMSkge1xyXG5cdFx0XHRcdHByb3BlcnRpZXNFbmQgPSBjb250ZW50Lmxlbmd0aDsgLy8gVHJlYXQgZW50aXJlIGNvbnRlbnQgYXMgcHJvcGVydGllcyBpZiBubyBzZWNvbmQgLS0tXHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCArPSA0OyAvLyBNb3ZlIHBhc3QgdGhlIHNlY29uZCAtLS1cclxuXHRcdFx0fVxyXG5cdFx0XHRwcm9wZXJ0aWVzVGV4dCA9IGNvbnRlbnQuc2xpY2UoNCwgcHJvcGVydGllc0VuZCAtIDQpLnRyaW0oKTtcclxuXHRcdFx0XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0bGV0IGN1cnJlbnRLZXk6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cdFx0XHRcdGNvbnN0IGFycmF5S2V5cyA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBUcmFjayB3aGljaCBrZXlzIGFyZSBhcnJheXNcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRwcm9wZXJ0aWVzVGV4dC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lKSA9PiB7XHJcblx0XHRcdFx0XHRjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHQvLyBNYXRjaCBwcm9wZXJ0eSBsaW5lcyAtIG1vcmUgZmxleGlibGUgcmVnZXggdG8gaGFuZGxlIHZhcmlvdXMgcHJvcGVydHkgbmFtZXNcclxuXHRcdFx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW2EtekEtWl9dW2EtekEtWjAtOV8tXSopOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0XHRcdGN1cnJlbnRLZXkgPSBrZXk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGlzS25vd25BcnJheUtleSA9IEtOT1dOX0FSUkFZX0tFWVMuaW5jbHVkZXMoa2V5IGFzIHR5cGVvZiBLTk9XTl9BUlJBWV9LRVlTW251bWJlcl0pO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBpc0VtcHR5QXJyYXkgPSAhdmFsdWUgfHwgdmFsdWUudHJpbSgpID09PSBcIlwiIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJbXVwiO1xyXG5cdFx0XHRcdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBpc0tub3duQXJyYXlLZXkgfHwgaXNFbXB0eUFycmF5O1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW107XHJcblx0XHRcdFx0XHRcdFx0YXJyYXlLZXlzLmFkZChrZXkpOyAvLyBNYXJrIHRoaXMga2V5IGFzIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0gPSBbdmFsdWUgPyB2YWx1ZS50cmltKCkgOiBcIlwiXTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmIChjdXJyZW50S2V5ICYmIHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSkge1xyXG5cdFx0XHRcdFx0XHQvLyBDaGVjayBpZiBjdXJyZW50IGtleSBpcyBhbiBhcnJheSBwcm9wZXJ0eVxyXG5cdFx0XHRcdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBhcnJheUtleXMuaGFzKGN1cnJlbnRLZXkpO1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGl0ZW0gPSB0cmltbWVkTGluZS5yZXBsYWNlKC9eLVxccyovLCBcIlwiKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAoaXRlbSkgZXhpc3RpbmdQcm9wZXJ0aWVzW2N1cnJlbnRLZXldLnB1c2goaXRlbSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSBpZiAodHJpbW1lZExpbmUgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSAmJiAhdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIiNcIikpIHtcclxuXHRcdFx0XHRcdFx0Ly8gSGFuZGxlIHVucmVjb2duaXplZCBwcm9wZXJ0aWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIHN0YW5kYXJkIGZvcm1hdFxyXG5cdFx0XHRcdFx0XHQvLyBUaGlzIGlzIGEgZmFsbGJhY2sgdG8gcHJlc2VydmUgcHJvcGVydGllcyB0aGF0IG1pZ2h0IGhhdmUgc3BlY2lhbCBmb3JtYXR0aW5nXHJcblx0XHRcdFx0XHRcdGNvbnN0IGtleU1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW146XSspOlxccyooLiopJC8pO1xyXG5cdFx0XHRcdFx0XHRpZiAoa2V5TWF0Y2gpIHtcclxuXHRcdFx0XHRcdFx0XHRjb25zdCBbLCBrZXksIHZhbHVlXSA9IGtleU1hdGNoO1xyXG5cdFx0XHRcdFx0XHRcdGlmICghZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0pIHtcclxuXHRcdFx0XHRcdFx0XHRcdGV4aXN0aW5nUHJvcGVydGllc1trZXldID0gW3ZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIl07XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Ly8gUHJlc2VydmUgYXJyYXkga2V5cyBpZiB0aGV5IGV4aXN0IHdpdGhvdXQgdmFsdWVzXHJcblx0XHRcdFx0S05PV05fQVJSQVlfS0VZUy5mb3JFYWNoKGtleSA9PiB7XHJcblx0XHRcdFx0XHRpZiAocHJvcGVydGllc1RleHQuaW5jbHVkZXMoa2V5ICsgJzonKSAmJiAhZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0pIHtcclxuXHRcdFx0XHRcdFx0ZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0gPSBbXTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBjYXRjaCB7XHJcblx0XHRcdFx0Ly8gRmFsbGJhY2sgdG8gdGVtcGxhdGUgaWYgcGFyc2luZyBmYWlsc1xyXG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWxsaW5nIGJhY2sgdG8gdGVtcGxhdGUgZHVlIHRvIHBhcnNpbmcgZXJyb3IuXCIpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0Y29uc3QgYm9keUNvbnRlbnQgPSBjb250ZW50LnNsaWNlKHByb3BlcnRpZXNFbmQpO1xyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0cHJvcGVydGllczogZXhpc3RpbmdQcm9wZXJ0aWVzLFxyXG5cdFx0XHRwcm9wZXJ0aWVzVGV4dCxcclxuXHRcdFx0cHJvcGVydGllc0VuZCxcclxuXHRcdFx0Ym9keUNvbnRlbnRcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHRwYXJzZVRlbXBsYXRlKHRlbXBsYXRlU3RyaW5nOiBzdHJpbmcsIHRpdGxlOiBzdHJpbmcpOiB7IHRlbXBsYXRlUHJvcHM6IHN0cmluZ1tdOyB0ZW1wbGF0ZVZhbHVlczogVGVtcGxhdGVWYWx1ZXMgfSB7XHJcblx0XHRjb25zdCB0ZW1wbGF0ZUxpbmVzID0gdGVtcGxhdGVTdHJpbmcuc3BsaXQoXCJcXG5cIik7XHJcblx0XHRjb25zdCB0ZW1wbGF0ZVByb3BzOiBzdHJpbmdbXSA9IFtdO1xyXG5cdFx0Y29uc3QgdGVtcGxhdGVWYWx1ZXM6IFRlbXBsYXRlVmFsdWVzID0ge307XHJcblx0XHRsZXQgaW5Qcm9wZXJ0aWVzID0gZmFsc2U7XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCB0ZW1wbGF0ZUxpbmVzLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdGNvbnN0IGxpbmUgPSB0ZW1wbGF0ZUxpbmVzW2ldLnRyaW0oKTtcclxuXHRcdFx0aWYgKGxpbmUgPT09IFwiLS0tXCIpIHtcclxuXHRcdFx0XHRpblByb3BlcnRpZXMgPSAhaW5Qcm9wZXJ0aWVzO1xyXG5cdFx0XHRcdGlmICghaW5Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0XHRicmVhazsgLy8gU3RvcCBhdCBzZWNvbmQgLS0tIHRvIGV4Y2x1ZGUgcG9zdC1wcm9wZXJ0eSBjb250ZW50XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGNvbnRpbnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmIChpblByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHRjb25zdCBtYXRjaCA9IGxpbmUubWF0Y2goL14oXFx3Kyk6XFxzKiguKikkLyk7XHJcblx0XHRcdFx0aWYgKG1hdGNoKSB7XHJcblx0XHRcdFx0XHRjb25zdCBbLCBrZXksIHZhbHVlXSA9IG1hdGNoO1xyXG5cdFx0XHRcdFx0dGVtcGxhdGVQcm9wcy5wdXNoKGtleSk7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgYW4gYXJyYXkgcHJvcGVydHkgKGtub3duIGFycmF5IGtleXMgb3IgWUFNTCBsaXN0IGZvcm1hdClcclxuXHRcdFx0XHRcdGNvbnN0IGlzS25vd25BcnJheUtleSA9IEtOT1dOX0FSUkFZX0tFWVMuaW5jbHVkZXMoa2V5IGFzIHR5cGVvZiBLTk9XTl9BUlJBWV9LRVlTW251bWJlcl0pO1xyXG5cdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhIFlBTUwgbGlzdCBmb3JtYXQgKG5vIHZhbHVlIGFmdGVyIGNvbG9uLCBlbXB0eSBicmFja2V0cywgb3IgZW1wdHkgdmFsdWUgbWVhbnMgaXQncyBhbiBhcnJheSlcclxuXHRcdFx0XHRcdGNvbnN0IGlzRW1wdHlBcnJheSA9ICF2YWx1ZSB8fCB2YWx1ZS50cmltKCkgPT09IFwiXCIgfHwgdmFsdWUudHJpbSgpID09PSBcIltdXCI7XHJcblx0XHRcdFx0XHRjb25zdCBpc0FycmF5UHJvcGVydHkgPSBpc0tub3duQXJyYXlLZXkgfHwgaXNFbXB0eUFycmF5O1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0XHRcdC8vIEhhbmRsZSBhcnJheSBwcm9wZXJ0aWVzXHJcblx0XHRcdFx0XHRcdGlmICh2YWx1ZSAmJiB2YWx1ZS5zdGFydHNXaXRoKFwiW1wiKSkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIEhhbmRsZSBicmFja2V0IGZvcm1hdDogW1wiaXRlbTFcIiwgXCJpdGVtMlwiXVxyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGl0ZW1zID0gdmFsdWVcclxuXHRcdFx0XHRcdFx0XHRcdC5yZXBsYWNlKC9bW1xcXV0vZywgXCJcIilcclxuXHRcdFx0XHRcdFx0XHRcdC5zcGxpdChcIixcIilcclxuXHRcdFx0XHRcdFx0XHRcdC5tYXAodCA9PiB0LnRyaW0oKSlcclxuXHRcdFx0XHRcdFx0XHRcdC5maWx0ZXIodCA9PiB0KTtcclxuXHRcdFx0XHRcdFx0XHR0ZW1wbGF0ZVZhbHVlc1trZXldID0gaXRlbXM7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gSGFuZGxlIFlBTUwgbGlzdCBmb3JtYXQ6IGVtcHR5IG9yIHdpdGggLSBpdGVtc1xyXG5cdFx0XHRcdFx0XHRcdHRlbXBsYXRlVmFsdWVzW2tleV0gPSBbXTtcclxuXHRcdFx0XHRcdFx0XHQvLyBMb29rIGFoZWFkIGZvciBpdGVtIGxpc3RcclxuXHRcdFx0XHRcdFx0XHRmb3IgKGxldCBqID0gaSArIDE7IGogPCB0ZW1wbGF0ZUxpbmVzLmxlbmd0aDsgaisrKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBuZXh0TGluZSA9IHRlbXBsYXRlTGluZXNbal0udHJpbSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKG5leHRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBpdGVtID0gbmV4dExpbmUucmVwbGFjZSgvXi1cXHMqLywgXCJcIikudHJpbSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoaXRlbSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGFycmF5VmFsdWUgPSB0ZW1wbGF0ZVZhbHVlc1trZXldO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KGFycmF5VmFsdWUpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhcnJheVZhbHVlLnB1c2goaXRlbSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKG5leHRMaW5lID09PSBcIi0tLVwiIHx8IChuZXh0TGluZSAmJiAhbmV4dExpbmUuc3RhcnRzV2l0aChcIi0gXCIpICYmIG5leHRMaW5lLmluY2x1ZGVzKFwiOlwiKSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Ly8gU3RvcCBhdCBuZXh0IHByb3BlcnR5IG9yIGVuZCBvZiBwcm9wZXJ0aWVzIHNlY3Rpb25cclxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XHJcblx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHQvLyBUaGlzIGlzIGEgc3RyaW5nIHByb3BlcnR5LCBub3QgYW4gYXJyYXlcclxuXHRcdFx0XHRcdFx0Y29uc3Qgc3RyaW5nVmFsdWUgPSAodmFsdWUgfHwgXCJcIikucmVwbGFjZSgvXFx7XFx7dGl0bGVcXH1cXH0vZywgdGl0bGUpLnJlcGxhY2UoL1xce1xce2RhdGVcXH1cXH0vZywgd2luZG93Lm1vbWVudChuZXcgRGF0ZSgpKS5mb3JtYXQodGhpcy5zZXR0aW5ncy5kYXRlRm9ybWF0KSk7XHJcblx0XHRcdFx0XHRcdC8vIFN0b3JlIGFzIGEgc2luZ2xlIHN0cmluZyB2YWx1ZSwgbm90IGluIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdHRlbXBsYXRlVmFsdWVzW2tleV0gPSBzdHJpbmdWYWx1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4geyB0ZW1wbGF0ZVByb3BzLCB0ZW1wbGF0ZVZhbHVlcyB9O1xyXG5cdH1cclxuXHJcblx0YnVpbGRGcm9udG1hdHRlckNvbnRlbnQoZmluYWxQcm9wczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+LCBhcnJheUtleXM/OiBTZXQ8c3RyaW5nPik6IHN0cmluZyB7XHJcblx0XHRsZXQgbmV3Q29udGVudCA9IFwiLS0tXFxuXCI7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBpbiBmaW5hbFByb3BzKSB7XHJcblx0XHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgYW4gYXJyYXkgcHJvcGVydHlcclxuXHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSkgfHwgXHJcblx0XHRcdFx0KGFycmF5S2V5cyAmJiBhcnJheUtleXMuaGFzKGtleSkpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTpcXG5gO1xyXG5cdFx0XHRcdGlmIChmaW5hbFByb3BzW2tleV0ubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0ZmluYWxQcm9wc1trZXldLmZvckVhY2goaXRlbSA9PiB7XHJcblx0XHRcdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCAgLSAke2l0ZW19XFxuYDtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRuZXdDb250ZW50ICs9IGAke2tleX06ICR7ZmluYWxQcm9wc1trZXldWzBdIHx8IFwiXCJ9XFxuYDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0bmV3Q29udGVudCArPSBcIi0tLVwiO1xyXG5cdFx0cmV0dXJuIG5ld0NvbnRlbnQ7XHJcblx0fVxyXG5cclxuXHRhc3luYyB1cGRhdGVUaXRsZUluRnJvbnRtYXR0ZXIoZmlsZTogVEZpbGUsIG5ld1RpdGxlOiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRcdC8vIENoZWNrIGlmIHRlbXBsYXRlIGhhcyB7e3RpdGxlfX0gLSBpZiBub3QsIGRvbid0IHVwZGF0ZSBmcm9udG1hdHRlciBhdCBhbGxcclxuXHRcdGNvbnN0IHRpdGxlS2V5ID0gdGhpcy5nZXRUaXRsZUtleSh0eXBlKTtcclxuXHRcdGNvbnN0IGhhc1RpdGxlSW5UZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVIYXNUaXRsZSh0eXBlKTtcclxuXHRcdFxyXG5cdFx0Ly8gSWYgdGVtcGxhdGUgZG9lc24ndCBoYXZlIHt7dGl0bGV9fSwgZG9uJ3QgbW9kaWZ5IGZyb250bWF0dGVyXHJcblx0XHRpZiAoIWhhc1RpdGxlSW5UZW1wbGF0ZSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG5cdFx0bGV0IHByb3BlcnRpZXNFbmQgPSAwO1xyXG5cdFx0bGV0IHByb3BlcnRpZXNUZXh0ID0gXCJcIjtcclxuXHRcdGxldCBoYXNGcm9udG1hdHRlciA9IGZhbHNlO1xyXG5cclxuXHRcdGlmIChjb250ZW50LnN0YXJ0c1dpdGgoXCItLS1cIikpIHtcclxuXHRcdFx0aGFzRnJvbnRtYXR0ZXIgPSB0cnVlO1xyXG5cdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5pbmRleE9mKFwiXFxuLS0tXCIsIDMpO1xyXG5cdFx0XHRpZiAocHJvcGVydGllc0VuZCA9PT0gLTEpIHtcclxuXHRcdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5sZW5ndGg7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCArPSA0O1xyXG5cdFx0XHR9XHJcblx0XHRcdHByb3BlcnRpZXNUZXh0ID0gY29udGVudC5zbGljZSg0LCBwcm9wZXJ0aWVzRW5kIC0gNCkudHJpbSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IHByb3BPcmRlcjogc3RyaW5nW10gPSBbXTtcclxuXHRcdGNvbnN0IGV4aXN0aW5nOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBzdHJpbmdbXT4gPSB7fTtcclxuXHRcdGxldCBjdXJyZW50S2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuXHRcdGxldCB0aXRsZUtleVBvc2l0aW9uID0gLTE7IC8vIFRyYWNrIHRoZSBvcmlnaW5hbCBwb3NpdGlvbiBvZiB0aGUgdGl0bGUga2V5XHJcblxyXG5cdFx0Y29uc3QgYXJyYXlLZXlzID0gbmV3IFNldDxzdHJpbmc+KCk7IC8vIFRyYWNrIHdoaWNoIGtleXMgYXJlIGFycmF5c1xyXG5cdFx0XHJcblx0XHRwcm9wZXJ0aWVzVGV4dC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xyXG5cdFx0XHRjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gTWF0Y2ggcHJvcGVydHkgbGluZXMgLSBtb3JlIGZsZXhpYmxlIHJlZ2V4IHRvIGhhbmRsZSB2YXJpb3VzIHByb3BlcnR5IG5hbWVzXHJcblx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW2EtekEtWl9dW2EtekEtWjAtOV8tXSopOlxccyooLiopJC8pO1xyXG5cdFx0XHRpZiAobWF0Y2gpIHtcclxuXHRcdFx0XHRjb25zdCBbLCBrZXksIHZhbHVlXSA9IG1hdGNoO1xyXG5cdFx0XHRcdHByb3BPcmRlci5wdXNoKGtleSk7XHJcblx0XHRcdFx0Y3VycmVudEtleSA9IGtleTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBUcmFjayB0aGUgb3JpZ2luYWwgcG9zaXRpb24gb2YgdGhlIHRpdGxlIGtleVxyXG5cdFx0XHRcdGlmIChrZXkgPT09IHRpdGxlS2V5KSB7XHJcblx0XHRcdFx0XHR0aXRsZUtleVBvc2l0aW9uID0gaW5kZXg7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGNvbnN0IGlzS25vd25BcnJheUtleSA9IEtOT1dOX0FSUkFZX0tFWVMuaW5jbHVkZXMoa2V5IGFzIHR5cGVvZiBLTk9XTl9BUlJBWV9LRVlTW251bWJlcl0pO1xyXG5cdFx0XHRcdGNvbnN0IGlzRW1wdHlBcnJheSA9ICF2YWx1ZSB8fCB2YWx1ZS50cmltKCkgPT09IFwiXCIgfHwgdmFsdWUudHJpbSgpID09PSBcIltdXCI7XHJcblx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0XHRleGlzdGluZ1trZXldID0gW107XHJcblx0XHRcdFx0XHRhcnJheUtleXMuYWRkKGtleSk7IC8vIE1hcmsgdGhpcyBrZXkgYXMgYW4gYXJyYXlcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0ZXhpc3Rpbmdba2V5XSA9IHZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSBpZiAoY3VycmVudEtleSAmJiBhcnJheUtleXMuaGFzKGN1cnJlbnRLZXkpICYmIHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSkge1xyXG5cdFx0XHRcdC8vIEhhbmRsZSBhcnJheSBpdGVtc1xyXG5cdFx0XHRcdGNvbnN0IGl0ZW0gPSB0cmltbWVkTGluZS5yZXBsYWNlKC9eLVxccyovLCBcIlwiKTtcclxuXHRcdFx0XHRpZiAoaXRlbSkgKGV4aXN0aW5nW2N1cnJlbnRLZXldIGFzIHN0cmluZ1tdKS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHRyaW1tZWRMaW5lICYmICF0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiLSBcIikgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XHJcblx0XHRcdFx0Ly8gSGFuZGxlIHVucmVjb2duaXplZCBwcm9wZXJ0aWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIHN0YW5kYXJkIGZvcm1hdFxyXG5cdFx0XHRcdC8vIFRoaXMgaXMgYSBmYWxsYmFjayB0byBwcmVzZXJ2ZSBwcm9wZXJ0aWVzIHRoYXQgbWlnaHQgaGF2ZSBzcGVjaWFsIGZvcm1hdHRpbmdcclxuXHRcdFx0XHRjb25zdCBrZXlNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKFteOl0rKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRpZiAoa2V5TWF0Y2gpIHtcclxuXHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0ga2V5TWF0Y2g7XHJcblx0XHRcdFx0XHRpZiAoIXByb3BPcmRlci5pbmNsdWRlcyhrZXkpKSB7XHJcblx0XHRcdFx0XHRcdHByb3BPcmRlci5wdXNoKGtleSk7XHJcblx0XHRcdFx0XHRcdGV4aXN0aW5nW2tleV0gPSB2YWx1ZSA/IHZhbHVlLnRyaW0oKSA6IFwiXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBQcm9wZXJseSBlc2NhcGUgWUFNTCBzdHJpbmcgdmFsdWVzXHJcblx0XHQvLyBZQU1MIHN0cmluZ3Mgd2l0aCBxdW90ZXMgbmVlZCB0byBiZSB3cmFwcGVkIGluIHNpbmdsZSBxdW90ZXMgb3IgZXNjYXBlZCBwcm9wZXJseVxyXG5cdFx0bGV0IHRpdGxlVmFsOiBzdHJpbmc7XHJcblx0XHRpZiAobmV3VGl0bGUuaW5jbHVkZXMoJ1wiJykgfHwgbmV3VGl0bGUuaW5jbHVkZXMoXCInXCIpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKCdcXG4nKSB8fCBuZXdUaXRsZS5pbmNsdWRlcygnXFxcXCcpKSB7XHJcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggcXVvdGVzLCBuZXdsaW5lcywgb3IgYmFja3NsYXNoZXMsIHVzZSBzaW5nbGUgcXVvdGVzIGFuZCBlc2NhcGUgc2luZ2xlIHF1b3Rlc1xyXG5cdFx0XHR0aXRsZVZhbCA9IGAnJHtuZXdUaXRsZS5yZXBsYWNlKC8nL2csIFwiJydcIil9J2A7XHJcblx0XHR9IGVsc2UgaWYgKG5ld1RpdGxlLmluY2x1ZGVzKFwiIFwiKSB8fCBuZXdUaXRsZS5pbmNsdWRlcyhcIjpcIikgfHwgbmV3VGl0bGUuaW5jbHVkZXMoXCIjXCIpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKFwiQFwiKSkge1xyXG5cdFx0XHQvLyBGb3Igc3RyaW5ncyB3aXRoIHNwYWNlcyBvciBzcGVjaWFsIFlBTUwgY2hhcmFjdGVycywgd3JhcCBpbiBkb3VibGUgcXVvdGVzIGFuZCBlc2NhcGUgZG91YmxlIHF1b3Rlc1xyXG5cdFx0XHR0aXRsZVZhbCA9IGBcIiR7bmV3VGl0bGUucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpfVwiYDtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIEZvciBzaW1wbGUgc3RyaW5ncywgbm8gcXVvdGVzIG5lZWRlZFxyXG5cdFx0XHR0aXRsZVZhbCA9IG5ld1RpdGxlO1xyXG5cdFx0fVxyXG5cdFx0ZXhpc3RpbmdbdGl0bGVLZXldID0gdGl0bGVWYWw7XHJcblxyXG5cdFx0Ly8gSWYgdGl0bGUga2V5IHdhcyBmb3VuZCBpbiBvcmlnaW5hbCBwcm9wZXJ0aWVzLCBwcmVzZXJ2ZSBpdHMgcG9zaXRpb25cclxuXHRcdC8vIE90aGVyd2lzZSwgYWRkIGl0IGF0IHRoZSBlbmRcclxuXHRcdGlmICh0aXRsZUtleVBvc2l0aW9uID09PSAtMSkge1xyXG5cdFx0XHQvLyBUaXRsZSBrZXkgbm90IGZvdW5kIGluIG9yaWdpbmFsIHByb3BlcnRpZXMsIGFkZCBpdCBhdCB0aGUgZW5kXHJcblx0XHRcdHByb3BPcmRlci5wdXNoKHRpdGxlS2V5KTtcclxuXHRcdH1cclxuXHRcdC8vIElmIHRpdGxlS2V5UG9zaXRpb24gPj0gMCwgdGhlIHRpdGxlIGtleSBpcyBhbHJlYWR5IGluIHByb3BPcmRlciBhdCB0aGUgY29ycmVjdCBwb3NpdGlvblxyXG5cclxuXHRcdC8vIE9ubHkgY3JlYXRlL3VwZGF0ZSBmcm9udG1hdHRlciBpZiBpdCBhbHJlYWR5IGV4aXN0c1xyXG5cdFx0Ly8gRG9uJ3QgY3JlYXRlIGZyb250bWF0dGVyIGZyb20gc2NyYXRjaCBpZiBmaWxlIGhhZCBub25lXHJcblx0XHRpZiAoIWhhc0Zyb250bWF0dGVyKSB7XHJcblx0XHRcdC8vIEZpbGUgaGFkIG5vIGZyb250bWF0dGVyIC0gZG9uJ3QgY3JlYXRlIGl0LCBqdXN0IHJldHVyblxyXG5cdFx0XHQvLyBUaGUgcmVuYW1lIGFscmVhZHkgaGFwcGVuZWQsIHdlIGp1c3QgZG9uJ3QgdXBkYXRlIGZyb250bWF0dGVyXHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBCdWlsZCBuZXcgY29udGVudCB3aXRoIGZyb250bWF0dGVyXHJcblx0XHRsZXQgbmV3Q29udGVudCA9IFwiLS0tXFxuXCI7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBvZiBwcm9wT3JkZXIpIHtcclxuXHRcdFx0Y29uc3QgdmFsID0gZXhpc3Rpbmdba2V5XTtcclxuXHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodmFsKSkge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTpcXG5gO1xyXG5cdFx0XHRcdGlmICh2YWwubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0dmFsLmZvckVhY2goKGl0ZW06IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRuZXdDb250ZW50ICs9IGAgIC0gJHtpdGVtfVxcbmA7XHJcblx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0bmV3Q29udGVudCArPSBgJHtrZXl9OiAke3ZhbCB8fCBcIlwifVxcbmA7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdG5ld0NvbnRlbnQgKz0gXCItLS1cXG5cIjtcclxuXHJcblx0XHQvLyBHZXQgYm9keSBjb250ZW50IChmcm9udG1hdHRlciBhbHJlYWR5IGV4aXN0ZWQsIHNvIHdlIGtub3cgcHJvcGVydGllc0VuZCBpcyBzZXQpXHJcblx0XHRjb25zdCBib2R5Q29udGVudCA9IGNvbnRlbnQuc2xpY2UocHJvcGVydGllc0VuZCk7XHJcblx0XHRuZXdDb250ZW50ICs9IGJvZHlDb250ZW50O1xyXG5cclxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0VGl0bGVLZXkodHlwZTogQ29udGVudFR5cGVJZCk6IHN0cmluZyB7XHJcblx0XHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHJldHVybiBcInRpdGxlXCI7XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gdHlwZSk7XHJcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm4gXCJ0aXRsZVwiO1xyXG5cdFx0XHJcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xyXG5cdFx0Y29uc3QgbGluZXMgPSB0ZW1wbGF0ZS5zcGxpdChcIlxcblwiKTtcclxuXHRcdGxldCBpblByb3BlcnRpZXMgPSBmYWxzZTtcclxuXHRcdGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xyXG5cdFx0XHRjb25zdCB0cmltbWVkID0gbGluZS50cmltKCk7XHJcblx0XHRcdGlmICh0cmltbWVkID09PSBcIi0tLVwiKSB7XHJcblx0XHRcdFx0aW5Qcm9wZXJ0aWVzID0gIWluUHJvcGVydGllcztcclxuXHRcdFx0XHRjb250aW51ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoaW5Qcm9wZXJ0aWVzKSB7XHJcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSB0cmltbWVkLm1hdGNoKC9eKFxcdyspOlxccyooLispJC8pO1xyXG5cdFx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdFx0Y29uc3Qga2V5ID0gbWF0Y2hbMV07XHJcblx0XHRcdFx0XHRjb25zdCB2YWx1ZSA9IG1hdGNoWzJdO1xyXG5cdFx0XHRcdFx0aWYgKHZhbHVlLmluY2x1ZGVzKFwie3t0aXRsZX19XCIpKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBrZXk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyZXR1cm4gXCJ0aXRsZVwiO1xyXG5cdH1cclxuXHRcclxuXHQvLyBDaGVjayBpZiB0aGUgdGVtcGxhdGUgZm9yIHRoaXMgY29udGVudCB0eXBlIGhhcyB7e3RpdGxlfX1cclxuXHRwcml2YXRlIHRlbXBsYXRlSGFzVGl0bGUodHlwZTogQ29udGVudFR5cGVJZCk6IGJvb2xlYW4ge1xyXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gdHJ1ZTsgLy8gTm90ZXMgYWx3YXlzIGhhdmUgdGl0bGVcclxuXHRcdFxyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKGN0ID0+IGN0LmlkID09PSB0eXBlKTtcclxuXHRcdGlmICghY29udGVudFR5cGUpIHJldHVybiB0cnVlOyAvLyBEZWZhdWx0IHRvIHRydWUgZm9yIHNhZmV0eVxyXG5cdFx0XHJcblx0XHRjb25zdCB0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xyXG5cdFx0cmV0dXJuIHRlbXBsYXRlLmluY2x1ZGVzKFwie3t0aXRsZX19XCIpO1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBURmlsZSwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcblxuaW1wb3J0IHsgbWF0Y2hlc0ZvbGRlclBhdHRlcm4sIHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eSB9IGZyb20gXCIuL3BhdGgtbWF0Y2hpbmdcIjtcblxuZXhwb3J0IGNsYXNzIExpbmtDb252ZXJ0ZXIge1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIHByaXZhdGUgcGx1Z2luPzogeyBzZXR0aW5ncz86IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB9KSB7fVxuXHRcblx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBzdG9yZWQgc2V0dGluZ3Ncblx0cHJpdmF0ZSBnZXRTZXR0aW5ncygpOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3Mge1xuXHRcdC8vIEFsd2F5cyBwcmVmZXIgcGx1Z2luIHNldHRpbmdzICh0aGV5J3JlIGtlcHQgdXAgdG8gZGF0ZSlcblx0XHRpZiAodGhpcy5wbHVnaW4/LnNldHRpbmdzKSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLnNldHRpbmdzO1xuXHR9XG5cblx0dG9LZWJhYkNhc2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBzdHJcblx0XHRcdC50b0xvd2VyQ2FzZSgpXG5cdFx0XHQucmVwbGFjZSgvW15hLXowLTlcXHMtXS9nLCBcIlwiKVxuXHRcdFx0LnRyaW0oKVxuXHRcdFx0LnJlcGxhY2UoL1xccysvZywgXCItXCIpXG5cdFx0XHQucmVwbGFjZSgvLSsvZywgXCItXCIpXG5cdFx0XHQucmVwbGFjZSgvXi18LSQvZywgXCJcIik7XG5cdH1cblxuXHRnZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsobGluazogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBoYXNoSW5kZXggPSBsaW5rLmluZGV4T2YoJyMnKTtcblx0XHRsZXQgcGF0aCA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZSgwLCBoYXNoSW5kZXgpIDogbGluaztcblx0XHRjb25zdCBhbmNob3IgPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoaGFzaEluZGV4KSA6ICcnO1xuXG5cdFx0Ly8gVVJMIGRlY29kZSB0aGUgcGF0aCB0byBoYW5kbGUgZW5jb2RlZCBjaGFyYWN0ZXJzIGxpa2UgJTIwXG5cdFx0cGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXRoKTtcblx0XHRwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC5tZCQvLCBcIlwiKTtcblxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aCB1c2luZyBwYXR0ZXJuIHNwZWNpZmljaXR5XG5cdFx0Y29uc3QgY29udGVudFR5cGVJbmZvID0gdGhpcy5nZXRDb250ZW50VHlwZUZvclBhdGgocGF0aCArICcubWQnKTtcblx0XHRsZXQgYmFzZVBhdGggPSBjb250ZW50VHlwZUluZm8uYmFzZVBhdGggfHwgXCJcIjtcblx0XHRsZXQgY29udGVudEZvbGRlciA9IGNvbnRlbnRUeXBlSW5mby5jb250ZW50Rm9sZGVyIHx8IFwiXCI7XG5cdFx0bGV0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZUluZm8uaW5kZXhGaWxlTmFtZSB8fCBcIlwiO1xuXG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblx0XHRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzIHRoZSBpbmRleCBmaWxlIG5hbWUgKHJlZ2FyZGxlc3Mgb2YgY3JlYXRpb24gbW9kZSksXG5cdFx0Ly8gdHJlYXQgaXQgYXMgZm9sZGVyLWJhc2VkIGxvZ2ljXG5cdFx0Ly8gTm90ZTogV2Ugb25seSBzZXQgYWRkVHJhaWxpbmdTbGFzaCBoZXJlOyB0aGUgZmluYWwgY2hlY2sgd2lsbCBwcmV2ZW50IGl0IGlmIHRoZXJlJ3MgYW4gYW5jaG9yXG5cdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0Y29uc3QgbGFzdFBhcnQgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGUgbGFzdCBwYXJ0IG1hdGNoZXMgdGhlIHNwZWNpZmllZCBpbmRleCBmaWxlIG5hbWVcblx0XHRpZiAoaW5kZXhGaWxlTmFtZSAmJiBpbmRleEZpbGVOYW1lLnRyaW0oKSAhPT0gXCJcIiAmJiBsYXN0UGFydCA9PT0gaW5kZXhGaWxlTmFtZSkge1xuXHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0fVxuXHRcdC8vIENoZWNrIGlmIHRoZSBsYXN0IHBhcnQgbWF0Y2hlcyB0aGUgZGVmYXVsdCBcImluZGV4XCIgKHdoZW4gbm8gaW5kZXhGaWxlTmFtZSBpcyBzcGVjaWZpZWQpXG5cdFx0ZWxzZSBpZiAoKCFpbmRleEZpbGVOYW1lIHx8IGluZGV4RmlsZU5hbWUudHJpbSgpID09PSBcIlwiKSAmJiBsYXN0UGFydCA9PT0gXCJpbmRleFwiKSB7XG5cdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBzbHVnUGFydHMgPSBwYXRoLnNwbGl0KCcvJykubWFwKHBhcnQgPT4gdGhpcy50b0tlYmFiQ2FzZShwYXJ0KSk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHNsdWdQYXJ0cy5qb2luKCcvJyk7XG5cblx0XHQvLyBGb3JtYXQgYmFzZSBwYXRoXG5cdFx0aWYgKGJhc2VQYXRoKSB7XG5cdFx0XHQvLyBBZGQgbGVhZGluZyBzbGFzaCBpZiBub3QgcHJlc2VudCB0byBtYWtlIGl0IGFic29sdXRlIGZyb20gcm9vdFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5zdGFydHNXaXRoKFwiL1wiKSkge1xuXHRcdFx0XHRiYXNlUGF0aCA9IFwiL1wiICsgYmFzZVBhdGg7XG5cdFx0XHR9XG5cdFx0XHQvLyBBZGQgdHJhaWxpbmcgc2xhc2ggaWYgbm90IHByZXNlbnRcblx0XHRcdGlmICghYmFzZVBhdGguZW5kc1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoICs9IFwiL1wiO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBXaGVuIG5vIGJhc2UgcGF0aCBpcyBzcGVjaWZpZWQsIGFkZCBsZWFkaW5nIHNsYXNoIHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRiYXNlUGF0aCA9IFwiL1wiO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgYWRkIHRyYWlsaW5nIHNsYXNoXG5cdFx0Ly8gQ1JJVElDQUw6IE5ldmVyIGFkZCB0cmFpbGluZyBzbGFzaCBiZWZvcmUgYW4gYW5jaG9yIChlLmcuLCAvYWJvdXQjaGVhZGluZyBub3QgL2Fib3V0LyNoZWFkaW5nKVxuXHRcdC8vIFRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgZm9yIGFuY2hvciBsaW5rcyBmcm9tIGNvcHkgaGVhZGluZyBVUkwgZnVuY3Rpb25hbGl0eVxuXHRcdC8vIEFuY2hvciBsaW5rcyBzaG91bGQgTkVWRVIgaGF2ZSB0cmFpbGluZyBzbGFzaGVzLCByZWdhcmRsZXNzIG9mIHNldHRpbmdzXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3Qgc2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA9IChzZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoKSAmJiAhYW5jaG9yO1xuXG5cdFx0cmV0dXJuIGAke2Jhc2VQYXRofSR7c2x1Z30ke3Nob3VsZEFkZFRyYWlsaW5nU2xhc2ggPyAnLycgOiAnJ30ke2FuY2hvcn1gO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChsaW5rOiBzdHJpbmcsIGN1cnJlbnRGaWxlUGF0aDogc3RyaW5nLCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlOiB7IGJhc2VQYXRoOiBzdHJpbmc7IGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiOyBpbmRleEZpbGVOYW1lOiBzdHJpbmc7IGNvbnRlbnRGb2xkZXI6IHN0cmluZyB9KTogc3RyaW5nIHtcblx0XHRcblx0XHRjb25zdCBoYXNoSW5kZXggPSBsaW5rLmluZGV4T2YoJyMnKTtcblx0XHRsZXQgcGF0aCA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZSgwLCBoYXNoSW5kZXgpIDogbGluaztcblx0XHRjb25zdCBhbmNob3IgPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoaGFzaEluZGV4KSA6ICcnO1xuXG5cdFx0Ly8gVVJMIGRlY29kZSB0aGUgcGF0aCB0byBoYW5kbGUgZW5jb2RlZCBjaGFyYWN0ZXJzIGxpa2UgJTIwXG5cdFx0cGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChwYXRoKTtcblx0XHRwYXRoID0gcGF0aC5yZXBsYWNlKC9cXC5tZCQvLCBcIlwiKTtcblx0XHRcblxuXHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgYW5kIGFwcHJvcHJpYXRlIGJhc2UgcGF0aFxuXHRcdGxldCBiYXNlUGF0aCA9IFwiXCI7XG5cdFx0bGV0IGNvbnRlbnRGb2xkZXIgPSBcIlwiO1xuXHRcdGxldCBpbmRleEZpbGVOYW1lID0gXCJcIjtcblxuXHRcdC8vIFVzZSB0aGUgc2FtZSBsb2dpYyBhcyBnZXRDb250ZW50VHlwZUZvclBhdGggYnV0IGZvciB0aGUgdGFyZ2V0IGxpbmtcblx0XHRjb25zdCB0YXJnZXRDb250ZW50VHlwZSA9IHRoaXMuZ2V0Q29udGVudFR5cGVGb3JQYXRoKHBhdGggKyAnLm1kJyk7XG5cdFx0XG5cdFx0Ly8gSWYgdGFyZ2V0IGxpbmsgZG9lc24ndCBoYXZlIGEgY2xlYXIgY29udGVudCB0eXBlIChubyBmb2xkZXIgcGF0aCksIHVzZSBjdXJyZW50IGZpbGUncyBjb250ZW50IHR5cGVcblx0XHRpZiAoIXRhcmdldENvbnRlbnRUeXBlLmJhc2VQYXRoICYmIGN1cnJlbnRGaWxlQ29udGVudFR5cGUuYmFzZVBhdGgpIHtcblx0XHRcdGJhc2VQYXRoID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5iYXNlUGF0aDtcblx0XHRcdGluZGV4RmlsZU5hbWUgPSBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWU7XG5cdFx0XHRjb250ZW50Rm9sZGVyID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5jb250ZW50Rm9sZGVyO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRiYXNlUGF0aCA9IHRhcmdldENvbnRlbnRUeXBlLmJhc2VQYXRoO1xuXHRcdFx0aW5kZXhGaWxlTmFtZSA9IHRhcmdldENvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWU7XG5cdFx0XHRjb250ZW50Rm9sZGVyID0gdGFyZ2V0Q29udGVudFR5cGUuY29udGVudEZvbGRlcjtcblx0XHR9XG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblx0XHRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzIHRoZSBpbmRleCBmaWxlIG5hbWUgKHJlZ2FyZGxlc3Mgb2YgY3JlYXRpb24gbW9kZSksXG5cdFx0Ly8gdHJlYXQgaXQgYXMgZm9sZGVyLWJhc2VkIGxvZ2ljXG5cdFx0Ly8gTm90ZTogV2Ugb25seSBzZXQgYWRkVHJhaWxpbmdTbGFzaCBoZXJlOyB0aGUgZmluYWwgY2hlY2sgd2lsbCBwcmV2ZW50IGl0IGlmIHRoZXJlJ3MgYW4gYW5jaG9yXG5cdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0Y29uc3QgbGFzdFBhcnQgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXTtcblx0XHRcblx0XHQvLyBDaGVjayBpZiB0aGUgbGFzdCBwYXJ0IG1hdGNoZXMgdGhlIHNwZWNpZmllZCBpbmRleCBmaWxlIG5hbWVcblx0XHRpZiAoaW5kZXhGaWxlTmFtZSAmJiBpbmRleEZpbGVOYW1lLnRyaW0oKSAhPT0gXCJcIiAmJiBsYXN0UGFydCA9PT0gaW5kZXhGaWxlTmFtZSkge1xuXHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0fVxuXHRcdC8vIENoZWNrIGlmIHRoZSBsYXN0IHBhcnQgbWF0Y2hlcyB0aGUgZGVmYXVsdCBcImluZGV4XCIgKHdoZW4gbm8gaW5kZXhGaWxlTmFtZSBpcyBzcGVjaWZpZWQpXG5cdFx0ZWxzZSBpZiAoKCFpbmRleEZpbGVOYW1lIHx8IGluZGV4RmlsZU5hbWUudHJpbSgpID09PSBcIlwiKSAmJiBsYXN0UGFydCA9PT0gXCJpbmRleFwiKSB7XG5cdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHR9XG5cblx0XHRjb25zdCBzbHVnUGFydHMgPSBwYXRoLnNwbGl0KCcvJykubWFwKHBhcnQgPT4gdGhpcy50b0tlYmFiQ2FzZShwYXJ0KSk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHNsdWdQYXJ0cy5qb2luKCcvJyk7XG5cblx0XHQvLyBGb3JtYXQgYmFzZSBwYXRoXG5cdFx0aWYgKGJhc2VQYXRoKSB7XG5cdFx0XHQvLyBBZGQgbGVhZGluZyBzbGFzaCBpZiBub3QgcHJlc2VudCB0byBtYWtlIGl0IGFic29sdXRlIGZyb20gcm9vdFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5zdGFydHNXaXRoKFwiL1wiKSkge1xuXHRcdFx0XHRiYXNlUGF0aCA9IFwiL1wiICsgYmFzZVBhdGg7XG5cdFx0XHR9XG5cdFx0XHQvLyBBZGQgdHJhaWxpbmcgc2xhc2ggaWYgbm90IHByZXNlbnRcblx0XHRcdGlmICghYmFzZVBhdGguZW5kc1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoICs9IFwiL1wiO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBXaGVuIG5vIGJhc2UgcGF0aCBpcyBzcGVjaWZpZWQsIGFkZCBsZWFkaW5nIHNsYXNoIHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRiYXNlUGF0aCA9IFwiL1wiO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgYWRkIHRyYWlsaW5nIHNsYXNoXG5cdFx0Ly8gQ1JJVElDQUw6IE5ldmVyIGFkZCB0cmFpbGluZyBzbGFzaCBiZWZvcmUgYW4gYW5jaG9yIChlLmcuLCAvYWJvdXQjaGVhZGluZyBub3QgL2Fib3V0LyNoZWFkaW5nKVxuXHRcdC8vIFRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgZm9yIGFuY2hvciBsaW5rcyBmcm9tIGNvcHkgaGVhZGluZyBVUkwgZnVuY3Rpb25hbGl0eVxuXHRcdC8vIEFuY2hvciBsaW5rcyBzaG91bGQgTkVWRVIgaGF2ZSB0cmFpbGluZyBzbGFzaGVzLCByZWdhcmRsZXNzIG9mIHNldHRpbmdzXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3Qgc2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA9IChzZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoKSAmJiAhYW5jaG9yO1xuXG5cdFx0cmV0dXJuIGAke2Jhc2VQYXRofSR7c2x1Z30ke3Nob3VsZEFkZFRyYWlsaW5nU2xhc2ggPyAnLycgOiAnJ30ke2FuY2hvcn1gO1xuXHR9XG5cblx0cHJpdmF0ZSBpc0luQ29uZmlndXJlZENvbnRlbnREaXJlY3RvcnkoZmlsZVBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdC8vIENoZWNrIGFsbCBjb250ZW50IHR5cGVzLCBzb3J0ZWQgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9yZSBzcGVjaWZpYyBmaXJzdClcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3Qgc29ydGVkVHlwZXMgPSBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkoY29udGVudFR5cGVzKTtcblx0XHRcblx0XHRmb3IgKGNvbnN0IGNvbnRlbnRUeXBlIG9mIHNvcnRlZFR5cGVzKSB7XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmVuYWJsZWQpIGNvbnRpbnVlO1xuXHRcdFx0XG5cdFx0XHQvLyBIYW5kbGUgYmxhbmsgZm9sZGVyIChyb290KSAtIG1hdGNoZXMgZmlsZXMgaW4gdmF1bHQgcm9vdCBvbmx5XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmZvbGRlciB8fCBjb250ZW50VHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKSB7XG5cdFx0XHRcdGlmICghZmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IGZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChtYXRjaGVzRm9sZGVyUGF0dGVybihmaWxlUGF0aCwgY29udGVudFR5cGUuZm9sZGVyKSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZ25vcmVTdWJmb2xkZXJzIGlmIGZvbGRlciBpcyBzcGVjaWZpZWRcblx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlLmlnbm9yZVN1YmZvbGRlcnMpIHtcblx0XHRcdFx0XHRjb25zdCBwYXRoU2VnbWVudHMgPSBmaWxlUGF0aC5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgcGF0aERlcHRoID0gcGF0aFNlZ21lbnRzLmxlbmd0aDtcblx0XHRcdFx0XHRjb25zdCBwYXR0ZXJuU2VnbWVudHMgPSBjb250ZW50VHlwZS5mb2xkZXIuc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdGNvbnN0IGV4cGVjdGVkRGVwdGggPSBwYXR0ZXJuU2VnbWVudHMubGVuZ3RoO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGlmIChjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmb2xkZXItYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBvbmUgbGV2ZWwgZGVlcGVyIChlLmcuLCB0ZXN0L215LWZpbGUvaW5kZXgubWQpXG5cdFx0XHRcdFx0XHQvLyBTbyB3ZSBuZWVkIHRvIGFsbG93IG9uZSBleHRyYSBsZXZlbCBiZXlvbmQgdGhlIHBhdHRlcm4gZGVwdGhcblx0XHRcdFx0XHRcdGNvbnN0IGZvbGRlckRlcHRoID0gcGF0aERlcHRoIC0gMTsgLy8gU3VidHJhY3QgMSBmb3IgdGhlIGluZGV4Lm1kIGZpbGVcblx0XHRcdFx0XHRcdGlmIChmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCB8fCBmb2xkZXJEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCArIDEpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmaWxlLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgYXQgdGhlIHNhbWUgZGVwdGggYXMgdGhlIHBhdHRlcm5cblx0XHRcdFx0XHRcdGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29udGVudFR5cGVGb3JQYXRoKGZpbGVQYXRoOiBzdHJpbmcpOiB7IGJhc2VQYXRoOiBzdHJpbmc7IGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiOyBpbmRleEZpbGVOYW1lOiBzdHJpbmc7IGNvbnRlbnRGb2xkZXI6IHN0cmluZyB9IHtcblx0XHQvLyBDaGVjayBhbGwgY29udGVudCB0eXBlcywgc29ydGVkIGJ5IHBhdHRlcm4gc3BlY2lmaWNpdHkgKG1vcmUgc3BlY2lmaWMgZmlyc3QpXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IHNvcnRlZFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRUeXBlcykge1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcblx0XHRcdFxuXHRcdFx0Ly8gSGFuZGxlIGJsYW5rIGZvbGRlciAocm9vdCkgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xuXHRcdFx0XHRpZiAoIWZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCBmaWxlUGF0aC5zcGxpdChcIi9cIikubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdGJhc2VQYXRoOiBjb250ZW50VHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIixcblx0XHRcdFx0XHRcdGNyZWF0aW9uTW9kZTogY29udGVudFR5cGUuY3JlYXRpb25Nb2RlLFxuXHRcdFx0XHRcdFx0aW5kZXhGaWxlTmFtZTogY29udGVudFR5cGUuaW5kZXhGaWxlTmFtZSB8fCBcIlwiLFxuXHRcdFx0XHRcdFx0Y29udGVudEZvbGRlcjogXCJcIlxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGgsIGNvbnRlbnRUeXBlLmZvbGRlcikpIHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWdub3JlU3ViZm9sZGVycyBpZiBmb2xkZXIgaXMgc3BlY2lmaWVkXG5cdFx0XHRcdGlmIChjb250ZW50VHlwZS5pZ25vcmVTdWJmb2xkZXJzKSB7XG5cdFx0XHRcdFx0Y29uc3QgcGF0aFNlZ21lbnRzID0gZmlsZVBhdGguc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhEZXB0aCA9IHBhdGhTZWdtZW50cy5sZW5ndGg7XG5cdFx0XHRcdFx0Y29uc3QgcGF0dGVyblNlZ21lbnRzID0gY29udGVudFR5cGUuZm9sZGVyLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBleHBlY3RlZERlcHRoID0gcGF0dGVyblNlZ21lbnRzLmxlbmd0aDtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAoY29udGVudFR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRcdFx0XHQvLyBGb3IgZm9sZGVyLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgb25lIGxldmVsIGRlZXBlciAoZS5nLiwgdGVzdC9teS1maWxlL2luZGV4Lm1kKVxuXHRcdFx0XHRcdFx0Ly8gU28gd2UgbmVlZCB0byBhbGxvdyBvbmUgZXh0cmEgbGV2ZWwgYmV5b25kIHRoZSBwYXR0ZXJuIGRlcHRoXG5cdFx0XHRcdFx0XHRjb25zdCBmb2xkZXJEZXB0aCA9IHBhdGhEZXB0aCAtIDE7IC8vIFN1YnRyYWN0IDEgZm9yIHRoZSBpbmRleC5tZCBmaWxlXG5cdFx0XHRcdFx0XHRpZiAoZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggfHwgZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggKyAxKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRcdFx0YmFzZVBhdGg6IGNvbnRlbnRUeXBlLmxpbmtCYXNlUGF0aCB8fCBcIlwiLFxuXHRcdFx0XHRcdFx0XHRcdGNyZWF0aW9uTW9kZTogY29udGVudFR5cGUuY3JlYXRpb25Nb2RlLFxuXHRcdFx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdFx0XHRjb250ZW50Rm9sZGVyOiBjb250ZW50VHlwZS5mb2xkZXJcblx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly8gRm9yIGZpbGUtYmFzZWQgY3JlYXRpb24sIGZpbGVzIGFyZSBhdCB0aGUgc2FtZSBkZXB0aCBhcyB0aGUgcGF0dGVyblxuXHRcdFx0XHRcdFx0aWYgKHBhdGhEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdGJhc2VQYXRoOiBjb250ZW50VHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIixcblx0XHRcdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdFx0XHRpbmRleEZpbGVOYW1lOiBjb250ZW50VHlwZS5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRcdFx0Y29udGVudEZvbGRlcjogY29udGVudFR5cGUuZm9sZGVyXG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHJldHVybiB7XG5cdFx0XHRcdFx0XHRiYXNlUGF0aDogY29udGVudFR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdGluZGV4RmlsZU5hbWU6IGNvbnRlbnRUeXBlLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcblx0XHRcdFx0XHRcdGNvbnRlbnRGb2xkZXI6IGNvbnRlbnRUeXBlLmZvbGRlclxuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0Ly8gRGVmYXVsdCBmYWxsYmFja1xuXHRcdHJldHVybiB7XG5cdFx0XHRiYXNlUGF0aDogXCJcIixcblx0XHRcdGNyZWF0aW9uTW9kZTogXCJmaWxlXCIsXG5cdFx0XHRpbmRleEZpbGVOYW1lOiBcIlwiLFxuXHRcdFx0Y29udGVudEZvbGRlcjogXCJcIlxuXHRcdH07XG5cdH1cblxuXHRjb252ZXJ0V2lraWxpbmtzRm9yQXN0cm8oZWRpdG9yOiBFZGl0b3IsIGZpbGU6IFRGaWxlIHwgbnVsbCk6IHZvaWQge1xuXHRcdGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgZmlsZS5cIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuXHRcdGxldCBuZXdDb250ZW50ID0gY29udGVudDtcblx0XHRsZXQgY29udmVydGVkQ291bnQgPSAwO1xuXHRcdGxldCBza2lwcGVkQ291bnQgPSAwO1xuXHRcdGNvbnN0IHNraXBwZWRMaW5rczogc3RyaW5nW10gPSBbXTtcblxuXHRcdC8vIERldGVybWluZSB0aGUgY3VycmVudCBmaWxlJ3MgY29udGVudCB0eXBlIGZvciByZWxhdGl2ZSBsaW5rc1xuXHRcdGNvbnN0IGN1cnJlbnRGaWxlQ29udGVudFR5cGUgPSB0aGlzLmdldENvbnRlbnRUeXBlRm9yUGF0aChmaWxlLnBhdGgpO1xuXG5cdFx0Ly8gRGVmaW5lIGNvbW1vbiBpbWFnZSBleHRlbnNpb25zXG5cdFx0Y29uc3QgaW1hZ2VFeHRlbnNpb25zID0gL1xcLihwbmd8anBnfGpwZWd8Z2lmfHN2ZykkL2k7XG5cblx0XHQvLyBIZWxwZXIgZnVuY3Rpb24gdG8gY2hlY2sgaWYgYSBsaW5rIGNhbiBiZSByZWxpYWJseSBjb252ZXJ0ZWRcblx0XHRjb25zdCBjYW5Db252ZXJ0TGluayA9IChsaW5rVGV4dDogc3RyaW5nKTogYm9vbGVhbiA9PiB7XG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGlmIGl0J3MgYW4gaW1hZ2Vcblx0XHRcdGlmIChpbWFnZUV4dGVuc2lvbnMudGVzdChsaW5rVGV4dCkpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGV4dGVybmFsIGxpbmtzXG5cdFx0XHRpZiAobGlua1RleHQubWF0Y2goL15odHRwcz86XFwvXFwvLykpIHtcblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBEb24ndCBjb252ZXJ0IGlmIGl0J3Mgbm90IGEgLm1kIGZpbGUgYW5kIGRvZXNuJ3QgbG9vayBsaWtlIGEgdmFsaWQgaW50ZXJuYWwgbGlua1xuXHRcdFx0aWYgKCFsaW5rVGV4dC5pbmNsdWRlcygnLm1kJykgJiYgIWxpbmtUZXh0Lm1hdGNoKC9eW2EtekEtWjAtOV8tXSsoXFwvW2EtekEtWjAtOV8tXSspKiQvKSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGlmIHRoZSB0YXJnZXQgZmlsZSBpcyBpbiBhbnkgY29uZmlndXJlZCBjb250ZW50IGRpcmVjdG9yeVxuXHRcdFx0Y29uc3QgdGFyZ2V0UGF0aCA9IGxpbmtUZXh0LmVuZHNXaXRoKCcubWQnKSA/IGxpbmtUZXh0IDogbGlua1RleHQgKyAnLm1kJztcblx0XHRcdFxuXHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBpbiBhIGNvbmZpZ3VyZWQgY29udGVudCBkaXJlY3Rvcnlcblx0XHRcdGNvbnN0IGlzSW5Db25maWd1cmVkRGlyZWN0b3J5ID0gdGhpcy5pc0luQ29uZmlndXJlZENvbnRlbnREaXJlY3RvcnkodGFyZ2V0UGF0aCk7XG5cdFx0XHRcblx0XHRcdC8vIEFsc28gY2hlY2sgaWYgaXQncyBhIHNpbXBsZSBmaWxlbmFtZSAobm8gcGF0aCkgYW5kIGN1cnJlbnQgZmlsZSBoYXMgYSBjb250ZW50IHR5cGVcblx0XHRcdGNvbnN0IGlzU2ltcGxlRmlsZW5hbWUgPSAhdGFyZ2V0UGF0aC5pbmNsdWRlcygnLycpO1xuXHRcdFx0Y29uc3QgaGFzQ3VycmVudENvbnRlbnRUeXBlID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5iYXNlUGF0aCAhPT0gXCJcIiB8fCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSAhPT0gXCJmaWxlXCIgfHwgY3VycmVudEZpbGVDb250ZW50VHlwZS5pbmRleEZpbGVOYW1lICE9PSBcIlwiO1xuXHRcdFx0XG5cdFx0XHRyZXR1cm4gaXNJbkNvbmZpZ3VyZWREaXJlY3RvcnkgfHwgKGlzU2ltcGxlRmlsZW5hbWUgJiYgaGFzQ3VycmVudENvbnRlbnRUeXBlKTtcblx0XHR9O1xuXG5cdFx0Ly8gSGFuZGxlIHJlZ3VsYXIgV2lraWxpbmtzIChub24taW1hZ2UpXG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZShcblx0XHRcdC9cXFtcXFsoW15cXF18XSspKFxcfChbXlxcXV0rKSk/XFxdXFxdL2csXG5cdFx0XHQobWF0Y2g6IHN0cmluZywgbGlua1RleHQ6IHN0cmluZywgX3BpcGU6IHN0cmluZyB8IHVuZGVmaW5lZCwgZGlzcGxheVRleHQ6IHN0cmluZyB8IHVuZGVmaW5lZCkgPT4ge1xuXHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGFuIGltYWdlIFdpa2lsaW5rXG5cdFx0XHRcdGlmIChpbWFnZUV4dGVuc2lvbnMudGVzdChsaW5rVGV4dCkpIHtcblx0XHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0XHRza2lwcGVkTGlua3MucHVzaChsaW5rVGV4dCk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgYW5kIHJldHVybiBvcmlnaW5hbCBpbWFnZSBXaWtpbGlua1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gQ2hlY2sgaWYgd2UgY2FuIHJlbGlhYmx5IGNvbnZlcnQgdGhpcyBsaW5rXG5cdFx0XHRcdGlmICghY2FuQ29udmVydExpbmsobGlua1RleHQpKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGlua1RleHQpO1xuXHRcdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gUmV0dXJuIG9yaWdpbmFsIGlmIHdlIGNhbid0IGNvbnZlcnQgcmVsaWFibHlcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGNvbnN0IGRpc3BsYXkgPSBkaXNwbGF5VGV4dCB8fCBsaW5rVGV4dC5yZXBsYWNlKC9cXC5tZCQvLCBcIlwiKTtcblxuXHRcdFx0XHQvLyBGb3IgcmVsYXRpdmUgbGlua3MgKG5vIGZvbGRlciBwYXRoKSwgdXNlIGN1cnJlbnQgZmlsZSdzIGNvbnRlbnQgdHlwZVxuXHRcdFx0XHRjb25zdCB1cmwgPSB0aGlzLmdldEFzdHJvVXJsRnJvbUludGVybmFsTGlua1dpdGhDb250ZXh0KGxpbmtUZXh0LCBmaWxlLnBhdGgsIGN1cnJlbnRGaWxlQ29udGVudFR5cGUpO1xuXG5cdFx0XHRcdGNvbnZlcnRlZENvdW50Kys7XG5cdFx0XHRcdHJldHVybiBgWyR7ZGlzcGxheX1dKCR7dXJsfSlgO1xuXHRcdFx0fVxuXHRcdCk7XG5cblx0XHQvLyBIYW5kbGUgc3RhbmRhcmQgTWFya2Rvd24gbGlua3MgKG5vbi1pbWFnZSwgbm9uLWV4dGVybmFsKVxuXHRcdC8vIE9ubHkgcHJvY2VzcyBsaW5rcyB0aGF0IGNvbnRhaW4gLm1kIHRvIGF2b2lkIHByb2Nlc3NpbmcgYWxyZWFkeS1jb252ZXJ0ZWQgbGlua3Ncblx0XHRuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKFxuXHRcdFx0L1xcWyhbXlxcXV0rKVxcXVxcKChbXildK1xcLm1kW14pXSopXFwpL2csXG5cdFx0XHQobWF0Y2g6IHN0cmluZywgZGlzcGxheVRleHQ6IHN0cmluZywgbGluazogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYW4gaW1hZ2UgbGluayBvciBleHRlcm5hbCBsaW5rXG5cdFx0XHRcdGlmIChsaW5rLm1hdGNoKC9eaHR0cHM/OlxcL1xcLy8pIHx8IGltYWdlRXh0ZW5zaW9ucy50ZXN0KGxpbmspKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGluayk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgZXh0ZXJuYWwgb3IgaW1hZ2UgbGlua3Ncblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrIGlmIHdlIGNhbiByZWxpYWJseSBjb252ZXJ0IHRoaXMgbGlua1xuXHRcdFx0XHRpZiAoIWNhbkNvbnZlcnRMaW5rKGxpbmspKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGluayk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBSZXR1cm4gb3JpZ2luYWwgaWYgd2UgY2FuJ3QgY29udmVydCByZWxpYWJseVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgdXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChsaW5rLCBmaWxlLnBhdGgsIGN1cnJlbnRGaWxlQ29udGVudFR5cGUpO1xuXG5cdFx0XHRcdGNvbnZlcnRlZENvdW50Kys7XG5cdFx0XHRcdHJldHVybiBgWyR7ZGlzcGxheVRleHR9XSgke3VybH0pYDtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0Ly8gSGFuZGxlIGltYWdlIGxpbmtzIGluIE1hcmtkb3duIGZvcm1hdCAoZS5nLiwgIVtJbWFnZV0obW91bnRhaW5zLnBuZykpXG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZShcblx0XHRcdC8hXFxbKC4qPylcXF1cXCgoW14pXSspXFwpL2csXG5cdFx0XHQobWF0Y2g6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgYWxsIGltYWdlIGxpbmtzXG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdC8vIEhhbmRsZSB7e2VtYmVkfX0gc3ludGF4XG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZSgvXFx7XFx7KFtefV0rKVxcfVxcfS9nLCAobWF0Y2g6IHN0cmluZywgZmlsZU5hbWU6IHN0cmluZykgPT4ge1xuXHRcdFx0aWYgKGltYWdlRXh0ZW5zaW9ucy50ZXN0KGZpbGVOYW1lKSkge1xuXHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2goZmlsZU5hbWUpO1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIElnbm9yZSBlbWJlZGRlZCBpbWFnZXNcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgd2UgY2FuIHJlbGlhYmx5IGNvbnZlcnQgdGhpcyBsaW5rXG5cdFx0XHRpZiAoIWNhbkNvbnZlcnRMaW5rKGZpbGVOYW1lKSkge1xuXHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2goZmlsZU5hbWUpO1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIFJldHVybiBvcmlnaW5hbCBpZiB3ZSBjYW4ndCBjb252ZXJ0IHJlbGlhYmx5XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHVybCA9IHRoaXMuZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rV2l0aENvbnRleHQoZmlsZU5hbWUsIGZpbGUucGF0aCwgY3VycmVudEZpbGVDb250ZW50VHlwZSk7XG5cblx0XHRcdGNvbnZlcnRlZENvdW50Kys7XG5cdFx0XHRyZXR1cm4gYFtFbWJlZGRlZDogJHtmaWxlTmFtZX1dKCR7dXJsfSlgO1xuXHRcdH0pO1xuXG5cdFx0ZWRpdG9yLnNldFZhbHVlKG5ld0NvbnRlbnQpO1xuXHRcdFxuXHRcdC8vIFNob3cgYXBwcm9wcmlhdGUgbm90aWNlIGJhc2VkIG9uIHJlc3VsdHNcblx0XHRpZiAoY29udmVydGVkQ291bnQgPiAwICYmIHNraXBwZWRDb3VudCA9PT0gMCkge1xuXHRcdFx0bmV3IE5vdGljZShgQ29udmVydGVkICR7Y29udmVydGVkQ291bnR9IGludGVybmFsIGxpbmske2NvbnZlcnRlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBmb3IgQXN0cm8uYCk7XG5cdFx0fSBlbHNlIGlmIChjb252ZXJ0ZWRDb3VudCA+IDAgJiYgc2tpcHBlZENvdW50ID4gMCkge1xuXHRcdFx0bmV3IE5vdGljZShgQ29udmVydGVkICR7Y29udmVydGVkQ291bnR9IGxpbmske2NvbnZlcnRlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBmb3IgQXN0cm8uIFNraXBwZWQgJHtza2lwcGVkQ291bnR9IGxpbmske3NraXBwZWRDb3VudCA+IDEgPyAncycgOiAnJ30gb3V0c2lkZSBjb25maWd1cmVkIGNvbnRlbnQgZGlyZWN0b3JpZXMuYCk7XG5cdFx0fSBlbHNlIGlmIChza2lwcGVkQ291bnQgPiAwKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBObyBsaW5rcyBjb252ZXJ0ZWQuIEFsbCAke3NraXBwZWRDb3VudH0gbGluayR7c2tpcHBlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBhcmUgb3V0c2lkZSBjb25maWd1cmVkIGNvbnRlbnQgZGlyZWN0b3JpZXMgb3IgYXJlIGltYWdlcy9leHRlcm5hbCBsaW5rcy5gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV3IE5vdGljZShcIk5vIGludGVybmFsIGxpbmtzIGZvdW5kIHRvIGNvbnZlcnQuXCIpO1xuXHRcdH1cblx0fVxufVxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFRGaWxlLCBOb3RpY2UsIFBsYXRmb3JtIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBDb250ZW50VHlwZUlkIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBGaWxlT3BlcmF0aW9ucyB9IGZyb20gXCIuLi91dGlscy9maWxlLW9wZXJhdGlvbnNcIjtcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSBcIi4uL3V0aWxzL3RlbXBsYXRlLXBhcnNpbmdcIjtcblxuZXhwb3J0IGNsYXNzIFRpdGxlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cdGZpbGU6IFRGaWxlIHwgbnVsbDtcblx0cGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xuXHR0eXBlOiBDb250ZW50VHlwZUlkO1xuXHRpc1JlbmFtZTogYm9vbGVhbjtcblx0aXNOZXdOb3RlOiBib29sZWFuO1xuXHR0aXRsZUlucHV0ITogSFRNTElucHV0RWxlbWVudDtcblx0cHJpdmF0ZSBmaWxlT3BzOiBGaWxlT3BlcmF0aW9ucztcblx0cHJpdmF0ZSB0ZW1wbGF0ZVBhcnNlcjogVGVtcGxhdGVQYXJzZXI7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlIHwgbnVsbCwgcGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCB0eXBlOiBDb250ZW50VHlwZUlkLCBpc1JlbmFtZSA9IGZhbHNlLCBpc05ld05vdGUgPSBmYWxzZSkge1xuXHRcdHN1cGVyKGFwcCk7XG5cdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLnR5cGUgPSB0eXBlO1xuXHRcdHRoaXMuaXNSZW5hbWUgPSBpc1JlbmFtZTtcblx0XHR0aGlzLmlzTmV3Tm90ZSA9IGlzTmV3Tm90ZTtcblx0XHRcblx0XHQvLyBJbml0aWFsaXplIHV0aWxpdGllcyB3aXRoIGN1cnJlbnQgc2V0dGluZ3Ncblx0XHQvLyBGaWxlT3BlcmF0aW9ucyB3aWxsIGdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBkeW5hbWljYWxseVxuXHRcdGNvbnN0IHNldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzO1xuXHRcdHRoaXMuZmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhhcHAsIHNldHRpbmdzLCBwbHVnaW4pO1xuXHRcdHRoaXMudGVtcGxhdGVQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIoYXBwLCBzZXR0aW5ncyk7XG5cdH1cblxuXHRnZXRDdXJyZW50VGl0bGUoKTogc3RyaW5nIHtcblx0XHRpZiAoIXRoaXMuZmlsZSkge1xuXHRcdFx0cmV0dXJuIFwiXCI7XG5cdFx0fVxuXHRcdFxuXHRcdGNvbnN0IHRpdGxlS2V5ID0gdGhpcy5maWxlT3BzLmdldFRpdGxlS2V5KHRoaXMudHlwZSk7XG5cdFx0Y29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZSh0aGlzLmZpbGUpO1xuXHRcdGxldCBiYXNlbmFtZSA9IHRoaXMuZmlsZS5iYXNlbmFtZTtcblx0XHRpZiAodGhpcy5maWxlLnBhcmVudCAmJiB0aGlzLnR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0XHRpZiAoaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIgJiYgYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWUpIHtcblx0XHRcdFx0YmFzZW5hbWUgPSB0aGlzLmZpbGUucGFyZW50Lm5hbWU7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChiYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSkge1xuXHRcdFx0YmFzZW5hbWUgPSBiYXNlbmFtZS5zbGljZSgxKTtcblx0XHR9XG5cdFx0Y29uc3QgZmFsbGJhY2tUaXRsZSA9IGJhc2VuYW1lLnJlcGxhY2UoLy0vZywgXCIgXCIpLnNwbGl0KFwiIFwiKS5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSkuam9pbihcIiBcIik7XG5cblx0XHRpZiAoY2FjaGU/LmZyb250bWF0dGVyICYmIHRpdGxlS2V5IGluIGNhY2hlLmZyb250bWF0dGVyKSB7XG5cdFx0XHRjb25zdCB0aXRsZVZhbHVlID0gY2FjaGUuZnJvbnRtYXR0ZXJbdGl0bGVLZXldIGFzIHVua25vd247XG5cdFx0XHRpZiAodHlwZW9mIHRpdGxlVmFsdWUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdHJldHVybiB0aXRsZVZhbHVlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKEFycmF5LmlzQXJyYXkodGl0bGVWYWx1ZSkgJiYgdGl0bGVWYWx1ZS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGNvbnN0IGZpcnN0VmFsdWUgPSB0aXRsZVZhbHVlWzBdIGFzIHVua25vd247XG5cdFx0XHRcdGlmICh0eXBlb2YgZmlyc3RWYWx1ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRyZXR1cm4gZmlyc3RWYWx1ZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZmlyc3RWYWx1ZSAhPSBudWxsKSB7XG5cdFx0XHRcdFx0aWYgKHR5cGVvZiBmaXJzdFZhbHVlID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgZmlyc3RWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gU3RyaW5nKGZpcnN0VmFsdWUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAodHlwZW9mIGZpcnN0VmFsdWUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gZmlyc3RWYWx1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdGlmICh0aXRsZVZhbHVlID09IG51bGwpIHtcblx0XHRcdFx0cmV0dXJuICcnO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHR5cGVvZiB0aXRsZVZhbHVlID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgdGl0bGVWYWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG5cdFx0XHRcdHJldHVybiBTdHJpbmcodGl0bGVWYWx1ZSk7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHlwZW9mIHRpdGxlVmFsdWUgPT09ICdzdHJpbmcnKSB7XG5cdFx0XHRcdHJldHVybiB0aXRsZVZhbHVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuICcnO1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsbGJhY2tUaXRsZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBFeHRyYWN0cyBhIHN1Z2dlc3RlZCB0aXRsZSBmcm9tIHRoZSBmaWxlIGJhc2VuYW1lIGZvciBuZXdseSBjcmVhdGVkIGZpbGVzLlxuXHQgKiBUaGlzIGlzIHVzZWQgd2hlbiBhIGZpbGUgaXMgY3JlYXRlZCBmcm9tIGEgbGluayAoZS5nLiwgW1tzRWZzbGVpZl1dKS5cblx0ICogUHJlc2VydmVzIHRoZSBvcmlnaW5hbCB0ZXh0IGFzIG11Y2ggYXMgcG9zc2libGUuXG5cdCAqL1xuXHRnZXRTdWdnZXN0ZWRUaXRsZUZyb21CYXNlbmFtZSgpOiBzdHJpbmcge1xuXHRcdGlmICghdGhpcy5maWxlKSB7XG5cdFx0XHRyZXR1cm4gXCJcIjtcblx0XHR9XG5cblx0XHRsZXQgYmFzZW5hbWUgPSB0aGlzLmZpbGUuYmFzZW5hbWU7XG5cblx0XHQvLyBIYW5kbGUgaW5kZXggZmlsZSBuYW1lcyAtIHVzZSBwYXJlbnQgZm9sZGVyIG5hbWUgaW5zdGVhZFxuXHRcdGlmICh0aGlzLmZpbGUucGFyZW50ICYmIHRoaXMudHlwZSAhPT0gXCJub3RlXCIpIHtcblx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5maWxlT3BzLmdldENvbnRlbnRUeXBlKHRoaXMudHlwZSk7XG5cdFx0XHRjb25zdCBpbmRleEZpbGVOYW1lID0gY29udGVudFR5cGU/LmluZGV4RmlsZU5hbWUgfHwgXCJcIjtcblx0XHRcdGlmIChpbmRleEZpbGVOYW1lLnRyaW0oKSAhPT0gXCJcIiAmJiBiYXNlbmFtZSA9PT0gaW5kZXhGaWxlTmFtZSkge1xuXHRcdFx0XHRiYXNlbmFtZSA9IHRoaXMuZmlsZS5wYXJlbnQubmFtZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBSZW1vdmUgbGVhZGluZyB1bmRlcnNjb3JlIGlmIHByZXNlbnRcblx0XHRpZiAoYmFzZW5hbWUuc3RhcnRzV2l0aChcIl9cIikpIHtcblx0XHRcdGJhc2VuYW1lID0gYmFzZW5hbWUuc2xpY2UoMSk7XG5cdFx0fVxuXG5cdFx0Ly8gUmV0dXJuIHRoZSBiYXNlbmFtZSBhcy1pcyB0byBwcmVzZXJ2ZSB1c2VyJ3Mgb3JpZ2luYWwgaW5wdXRcblx0XHQvLyAoZS5nLiwgXCJzRWZzbGVpZlwiIHN0YXlzIGFzIFwic0Vmc2xlaWZcIilcblx0XHRyZXR1cm4gYmFzZW5hbWU7XG5cdH1cblxuXHRvbk9wZW4oKSB7XG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XG5cdFx0XG5cdFx0Ly8gQWRkIG1vYmlsZS1mcmllbmRseSBwb3NpdGlvbmluZyBjbGFzcyAtIGNoZWNrIGJvdGggd2lkdGggYW5kIHBsYXRmb3JtXG5cdFx0Y29uc3QgaXNNb2JpbGUgPSB3aW5kb3cuaW5uZXJXaWR0aCA8PSA3NjggfHwgUGxhdGZvcm0uaXNNb2JpbGU7XG5cdFx0aWYgKGlzTW9iaWxlKSB7XG5cdFx0XHR0aGlzLm1vZGFsRWwuYWRkQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLW1vYmlsZS1tb2RhbCcpO1xuXHRcdH1cblxuXHRcdGlmICh0aGlzLmlzUmVuYW1lKSB7XG5cdFx0XHRjb25zdCB0eXBlTmFtZSA9IHRoaXMuZ2V0VHlwZURpc3BsYXlOYW1lKCk7XG5cdFx0XHRcblx0XHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHRcdC8vIEZvciBnZW5lcmljIG5vdGVzIG91dHNpZGUgb2YgYW55IGtub3duIGNvbnRlbnQgdHlwZVxuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiUmVuYW1lIGNvbnRlbnRcIiB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiRW50ZXIgYSB0aXRsZSBmb3IgdGhpcyBjb250ZW50OlwiIH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBgUmVuYW1lICR7dHlwZU5hbWV9IGNvbnRlbnRgIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYEVudGVyIG5ldyB0aXRsZSBmb3IgeW91ciAke3R5cGVOYW1lfSBjb250ZW50OmAgfSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMudGl0bGVJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcblx0XHRcdFx0dHlwZTogXCJ0ZXh0XCIsXG5cdFx0XHRcdHBsYWNlaG9sZGVyOiBcIk5ldyBUaXRsZVwiLFxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItdGl0bGUtaW5wdXRcIlxuXHRcdFx0fSk7XG5cdFx0XHR0aGlzLnRpdGxlSW5wdXQudmFsdWUgPSB0aGlzLmdldEN1cnJlbnRUaXRsZSgpO1xuXHRcdH0gZWxzZSBpZiAodGhpcy5pc05ld05vdGUpIHtcblx0XHRcdGNvbnN0IHR5cGVOYW1lID0gdGhpcy5nZXRUeXBlRGlzcGxheU5hbWUoKTtcblx0XHRcdFxuXHRcdFx0aWYgKHRoaXMudHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIk5ldyBjb250ZW50XCIgfSk7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIkVudGVyIGEgdGl0bGUgZm9yIHRoaXMgY29udGVudDpcIiB9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogYENyZWF0ZSBuZXcgJHt0eXBlTmFtZX0gY29udGVudGAgfSk7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBgRW50ZXIgYSB0aXRsZSBmb3IgeW91ciBuZXcgJHt0eXBlTmFtZX0gY29udGVudDpgIH0pO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHR0aGlzLnRpdGxlSW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG5cdFx0XHRcdHR5cGU6IFwidGV4dFwiLFxuXHRcdFx0XHRwbGFjZWhvbGRlcjogXCJOZXcgVGl0bGVcIixcblx0XHRcdFx0Y2xzOiBcImFzdHJvLWNvbXBvc2VyLXRpdGxlLWlucHV0XCJcblx0XHRcdH0pO1xuXHRcdFx0Ly8gTGVhdmUgaW5wdXQgZW1wdHkgZm9yIG5ldyBub3RlcyAtIHVzZXIgY2FuIHR5cGUgZGlyZWN0bHlcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgdHlwZU5hbWUgPSB0aGlzLmdldFR5cGVEaXNwbGF5TmFtZSgpO1xuXHRcdFx0XG5cdFx0XHRpZiAodGhpcy50eXBlID09PSBcIm5vdGVcIikge1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiTmV3IGNvbnRlbnRcIiB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiRW50ZXIgYSB0aXRsZSBmb3IgdGhpcyBjb250ZW50OlwiIH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBgQ3JlYXRlIG5ldyAke3R5cGVOYW1lfSBjb250ZW50YCB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IGBFbnRlciBhIHRpdGxlIGZvciB5b3VyIG5ldyAke3R5cGVOYW1lfSBjb250ZW50OmAgfSk7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdHRoaXMudGl0bGVJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcblx0XHRcdFx0dHlwZTogXCJ0ZXh0XCIsXG5cdFx0XHRcdHBsYWNlaG9sZGVyOiBcIk5ldyBUaXRsZVwiLFxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItdGl0bGUtaW5wdXRcIlxuXHRcdFx0fSk7XG5cdFx0XHQvLyBQcmUtcG9wdWxhdGUgd2l0aCBzdWdnZXN0ZWQgdGl0bGUgZnJvbSBiYXNlbmFtZSBpZiBhdmFpbGFibGVcblx0XHRcdC8vIFRoaXMgaGFuZGxlcyBmaWxlcyBjcmVhdGVkIGZyb20gbGlua3MgKGUuZy4sIFtbc0Vmc2xlaWZdXSlcblx0XHRcdGlmICh0aGlzLmZpbGUpIHtcblx0XHRcdFx0Y29uc3Qgc3VnZ2VzdGVkVGl0bGUgPSB0aGlzLmdldFN1Z2dlc3RlZFRpdGxlRnJvbUJhc2VuYW1lKCk7XG5cdFx0XHRcdGlmIChzdWdnZXN0ZWRUaXRsZSkge1xuXHRcdFx0XHRcdHRoaXMudGl0bGVJbnB1dC52YWx1ZSA9IHN1Z2dlc3RlZFRpdGxlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMudGl0bGVJbnB1dC5mb2N1cygpO1xuXHRcdC8vIEZvciBuZXcgbm90ZXMsIGVuc3VyZSBjdXJzb3IgaXMgYXQgdGhlIHN0YXJ0IChwb3NpdGlvbiAwKVxuXHRcdGlmICh0aGlzLmlzTmV3Tm90ZSkge1xuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdHRoaXMudGl0bGVJbnB1dC5zZXRTZWxlY3Rpb25SYW5nZSgwLCAwKTtcblx0XHRcdH0sIDApO1xuXHRcdH1cblxuXHRcdGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwiYXN0cm8tY29tcG9zZXItYnV0dG9uLWNvbnRhaW5lclwiIH0pO1xuXG5cdFx0Y29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogXCJDYW5jZWxcIiwgY2xzOiBcImFzdHJvLWNvbXBvc2VyLWNhbmNlbC1idXR0b25cIiB9KTtcblx0XHRjYW5jZWxCdXR0b24ub25jbGljayA9ICgpID0+IHRoaXMuY2xvc2UoKTtcblxuXHRcdGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7IHRleHQ6IHRoaXMuaXNSZW5hbWUgPyBcIlJlbmFtZVwiIDogXCJDcmVhdGVcIiwgY2xzOiBbXCJhc3Ryby1jb21wb3Nlci1jcmVhdGUtYnV0dG9uXCIsIFwibW9kLWN0YVwiXSB9KTtcblx0XHRzdWJtaXRCdXR0b24ub25jbGljayA9ICgpID0+IHRoaXMuc3VibWl0KCk7XG5cblx0XHR0aGlzLnRpdGxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXByZXNzXCIsIChlKSA9PiB7XG5cdFx0XHRpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikgdm9pZCB0aGlzLnN1Ym1pdCgpO1xuXHRcdH0pO1xuXHR9XG5cblx0YXN5bmMgc3VibWl0KCkge1xuXHRcdGNvbnN0IHRpdGxlID0gdGhpcy50aXRsZUlucHV0LnZhbHVlLnRyaW0oKTtcblx0XHRcblx0XHRpZiAoIXRpdGxlKSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiUGxlYXNlIGVudGVyIGEgdGl0bGUuXCIpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRsZXQgbmV3RmlsZTogVEZpbGUgfCBudWxsID0gbnVsbDtcblx0XHRcdGlmICh0aGlzLmlzUmVuYW1lKSB7XG5cdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmZpbGVPcHMucmVuYW1lRmlsZSh7IGZpbGU6IHRoaXMuZmlsZSEsIHRpdGxlLCB0eXBlOiB0aGlzLnR5cGUgfSk7XG5cdFx0XHRcdFxuXHRcdFx0XHRpZiAobmV3RmlsZSkge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMudGVtcGxhdGVQYXJzZXIudXBkYXRlVGl0bGVJbkZyb250bWF0dGVyKG5ld0ZpbGUsIHRpdGxlLCB0aGlzLnR5cGUpO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIHJlbmFtZUZpbGUgYWxyZWFkeSBzaG93ZWQgYW4gZXJyb3Igbm90aWNlLCBjbG9zZSBtb2RhbCBhbmQgcmV0dXJuXG5cdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0XHRcdHJldHVybjtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLmlzTmV3Tm90ZSkge1xuXHRcdFx0XHQvLyBQcm9jZXNzIHRoZSBcIlVudGl0bGVkXCIgZmlsZSAtIHJlbmFtZSBpdCBhbmQgYWRkIHByb3BlcnRpZXNcblx0XHRcdFx0Ly8gVGhpcyByZXNwZWN0cyBjcmVhdGlvbk1vZGUgKGZvbGRlciB2cyBmaWxlKSBhbmQgZG9lc24ndCByZXF1aXJlIGRlbGV0aW9uXG5cdFx0XHRcdGlmICh0aGlzLmZpbGUpIHtcblx0XHRcdFx0XHRuZXdGaWxlID0gYXdhaXQgdGhpcy5maWxlT3BzLmNyZWF0ZUZpbGUoeyBmaWxlOiB0aGlzLmZpbGUsIHRpdGxlLCB0eXBlOiB0aGlzLnR5cGUgfSk7XG5cdFx0XHRcdFx0Ly8gQWx3YXlzIGluc2VydCBwcm9wZXJ0aWVzIHdoZW4gYXV0b0luc2VydFByb3BlcnRpZXMgaXMgZW5hYmxlZFxuXHRcdFx0XHRcdGNvbnN0IHNob3VsZEluc2VydFByb3BlcnRpZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvSW5zZXJ0UHJvcGVydGllcztcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRpZiAobmV3RmlsZSAmJiBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLmFkZFByb3BlcnRpZXNUb0ZpbGUobmV3RmlsZSwgdGl0bGUsIHRoaXMudHlwZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMuZmlsZSkge1xuXHRcdFx0XHQvLyBXZSBoYXZlIGFuIGV4aXN0aW5nIGZpbGUsIHByb2Nlc3MgaXRcblx0XHRcdFx0bmV3RmlsZSA9IGF3YWl0IHRoaXMuZmlsZU9wcy5jcmVhdGVGaWxlKHsgZmlsZTogdGhpcy5maWxlLCB0aXRsZSwgdHlwZTogdGhpcy50eXBlIH0pO1xuXHRcdFx0XHQvLyBBbHdheXMgaW5zZXJ0IHByb3BlcnRpZXMgd2hlbiBhdXRvSW5zZXJ0UHJvcGVydGllcyBpcyBlbmFibGVkXG5cdFx0XHRcdGNvbnN0IHNob3VsZEluc2VydFByb3BlcnRpZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvSW5zZXJ0UHJvcGVydGllcztcblx0XHRcdFx0XG5cdFx0XHRcdGlmIChuZXdGaWxlICYmIHNob3VsZEluc2VydFByb3BlcnRpZXMpIHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmFkZFByb3BlcnRpZXNUb0ZpbGUobmV3RmlsZSwgdGl0bGUsIHRoaXMudHlwZSk7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEZhbGxiYWNrIC0gY3JlYXRlIG5ldyBmaWxlXG5cdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmNyZWF0ZU5ld0ZpbGUodGl0bGUpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRpZiAoIW5ld0ZpbGUpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvICR7dGhpcy5pc1JlbmFtZSA/IFwicmVuYW1lXCIgOiBcImNyZWF0ZVwifSAke3RoaXMudHlwZX0uYCk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdUaXRsZU1vZGFsOiBFcnJvciBkdXJpbmcgcHJvY2VzczonLCBlcnJvcik7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBFcnJvciAke3RoaXMuaXNSZW5hbWUgPyBcInJlbmFtaW5nXCIgOiBcImNyZWF0aW5nXCJ9ICR7dGhpcy50eXBlfTogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblxuXHRcdHRoaXMuY2xvc2UoKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0VHlwZURpc3BsYXlOYW1lKCk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMudHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdHJldHVybiBcIkNvbnRlbnRcIjtcblx0XHR9XG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRyZXR1cm4gY29udGVudFR5cGUgPyBjb250ZW50VHlwZS5uYW1lIDogXCJDb250ZW50XCI7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZU5ld0ZpbGUodGl0bGU6IHN0cmluZyk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0Ly8gRGV0ZXJtaW5lIHRoZSBhcHByb3ByaWF0ZSBmb2xkZXIgYmFzZWQgb24gd2hlcmUgdGhlIHVzZXIgY3JlYXRlZCB0aGUgZmlsZVxuXHRcdGxldCB0YXJnZXRGb2xkZXI6IHN0cmluZztcblx0XHRcblx0XHQvLyBHZXQgdGhlIGRpcmVjdG9yeSB3aGVyZSB0aGUgdXNlciBjcmVhdGVkIHRoZSBmaWxlXG5cdFx0Y29uc3Qgb3JpZ2luYWxEaXIgPSB0aGlzLmZpbGU/LnBhcmVudD8ucGF0aCB8fCBcIlwiO1xuXHRcdFxuXHRcdGlmICh0aGlzLnR5cGUgIT09IFwibm90ZVwiKSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0Ly8gRm9yIGNvbnRlbnQgdHlwZXMsIHJlc3BlY3QgdGhlIHVzZXIncyBjaG9zZW4gbG9jYXRpb24gKHN1YmZvbGRlcilcblx0XHRcdC8vIE9ubHkgdXNlIHRoZSBjb25maWd1cmVkIGZvbGRlciBpZiB0aGUgdXNlciBjcmVhdGVkIHRoZSBmaWxlIGluIHRoZSB2YXVsdCByb290XG5cdFx0XHRpZiAob3JpZ2luYWxEaXIgPT09IFwiXCIgfHwgb3JpZ2luYWxEaXIgPT09IFwiL1wiKSB7XG5cdFx0XHRcdHRhcmdldEZvbGRlciA9IGNvbnRlbnRUeXBlPy5mb2xkZXIgfHwgXCJcIjtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHRhcmdldEZvbGRlciA9IG9yaWdpbmFsRGlyO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBGb3Igbm90ZXMsIHVzZSB0aGUgb3JpZ2luYWwgZGlyZWN0b3J5XG5cdFx0XHR0YXJnZXRGb2xkZXIgPSBvcmlnaW5hbERpcjtcblx0XHR9XG5cblx0XHQvLyBDcmVhdGUgdGhlIGZpbGVuYW1lIGZyb20gdGhlIHRpdGxlXG5cdFx0Y29uc3QgZmlsZW5hbWUgPSB0aGlzLmZpbGVPcHMuZ2VuZXJhdGVGaWxlbmFtZSh0aXRsZSk7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSB0YXJnZXRGb2xkZXIgPyBgJHt0YXJnZXRGb2xkZXJ9LyR7ZmlsZW5hbWV9Lm1kYCA6IGAke2ZpbGVuYW1lfS5tZGA7XG5cblx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBCRUZPUkUgY3JlYXRpbmcgaXRcblx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRpZiAodGhpcy5wbHVnaW4gJiYgJ3BsdWdpbkNyZWF0ZWRGaWxlcycgaW4gdGhpcy5wbHVnaW4pIHtcblx0XHRcdCh0aGlzLnBsdWdpbiBhcyB7IHBsdWdpbkNyZWF0ZWRGaWxlcz86IFNldDxzdHJpbmc+IH0pLnBsdWdpbkNyZWF0ZWRGaWxlcz8uYWRkKGZpbGVQYXRoKTtcblx0XHR9XG5cblx0XHQvLyBDcmVhdGUgdGhlIGZpbGUgd2l0aCBpbml0aWFsIGNvbnRlbnRcblx0XHRsZXQgaW5pdGlhbENvbnRlbnQgPSBcIlwiO1xuXHRcdC8vIEFsd2F5cyBpbnNlcnQgcHJvcGVydGllcyB3aGVuIGF1dG9JbnNlcnRQcm9wZXJ0aWVzIGlzIGVuYWJsZWRcblx0XHRpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXMpIHtcblx0XHRcdGluaXRpYWxDb250ZW50ID0gdGhpcy5nZW5lcmF0ZUluaXRpYWxDb250ZW50KHRpdGxlKTtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgaW5pdGlhbENvbnRlbnQpO1xuXHRcdFx0XG5cdFx0XHQvLyBPcGVuIHRoZSBuZXcgZmlsZVxuXHRcdFx0YXdhaXQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShuZXdGaWxlKTtcblx0XHRcdFxuXHRcdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNyZWF0ZSBmaWxlOiAke2Vycm9yTWVzc2FnZX1gKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGdlbmVyYXRlSW5pdGlhbENvbnRlbnQodGl0bGU6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBkYXRlU3RyaW5nID0gd2luZG93Lm1vbWVudChub3cpLmZvcm1hdCh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kYXRlRm9ybWF0KTtcblxuXHRcdGxldCB0ZW1wbGF0ZTogc3RyaW5nO1xuXHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3RlcywgdXNlIGEgc2ltcGxlIHRlbXBsYXRlXG5cdFx0XHQvLyBQcm9wZXJseSBlc2NhcGUgdGhlIHRpdGxlIGZvciBZQU1MXG5cdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZSkge1xuXHRcdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGAtLS1cXG50aXRsZTogJHtlc2NhcGVkVGl0bGV9XFxuZGF0ZTogJHtkYXRlU3RyaW5nfVxcbi0tLVxcbmA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0ZW1wbGF0ZSA9IGNvbnRlbnRUeXBlLnRlbXBsYXRlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3RpdGxlXFx9XFx9L2csIHRpdGxlKTtcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce2RhdGVcXH1cXH0vZywgZGF0ZVN0cmluZyk7XG5cblx0XHRyZXR1cm4gdGVtcGxhdGU7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGFkZFByb3BlcnRpZXNUb0ZpbGUoZmlsZTogVEZpbGUsIHRpdGxlOiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQpIHtcblx0XHRjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXHRcdGNvbnN0IGRhdGVTdHJpbmcgPSB3aW5kb3cubW9tZW50KG5vdykuZm9ybWF0KHRoaXMucGx1Z2luLnNldHRpbmdzLmRhdGVGb3JtYXQpO1xuXG5cdFx0bGV0IHRlbXBsYXRlOiBzdHJpbmc7XG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3RlcywgdXNlIGEgc2ltcGxlIHRlbXBsYXRlXG5cdFx0XHQvLyBQcm9wZXJseSBlc2NhcGUgdGhlIHRpdGxlIGZvciBZQU1MXG5cdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRcdGlmICghY29udGVudFR5cGUpIHtcblx0XHRcdFx0Y29uc3QgZXNjYXBlZFRpdGxlID0gdGhpcy5lc2NhcGVZYW1sU3RyaW5nKHRpdGxlKTtcblx0XHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGVtcGxhdGUgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcblx0XHRcdH1cblx0XHR9XG5cdFx0XG5cdFx0dGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHt0aXRsZVxcfVxcfS9nLCB0aXRsZSk7XG5cdFx0dGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHtkYXRlXFx9XFx9L2csIGRhdGVTdHJpbmcpO1xuXG5cdFx0Ly8gRW5zdXJlIG5vIGV4dHJhIG5ld2xpbmVzIG9yIC0tLSBhcmUgYWRkZWQgYmV5b25kIHRoZSB0ZW1wbGF0ZVxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCB0ZW1wbGF0ZSk7XG5cdH1cblxuXHRwcml2YXRlIGVzY2FwZVlhbWxTdHJpbmcoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFByb3Blcmx5IGVzY2FwZSBZQU1MIHN0cmluZyB2YWx1ZXNcblx0XHQvLyBZQU1MIHN0cmluZ3Mgd2l0aCBxdW90ZXMgbmVlZCB0byBiZSB3cmFwcGVkIGluIHNpbmdsZSBxdW90ZXMgb3IgZXNjYXBlZCBwcm9wZXJseVxuXHRcdGlmIChzdHIuaW5jbHVkZXMoJ1wiJykgfHwgc3RyLmluY2x1ZGVzKFwiJ1wiKSB8fCBzdHIuaW5jbHVkZXMoJ1xcbicpIHx8IHN0ci5pbmNsdWRlcygnXFxcXCcpKSB7XG5cdFx0XHQvLyBGb3Igc3RyaW5ncyB3aXRoIHF1b3RlcywgbmV3bGluZXMsIG9yIGJhY2tzbGFzaGVzLCB1c2Ugc2luZ2xlIHF1b3RlcyBhbmQgZXNjYXBlIHNpbmdsZSBxdW90ZXNcblx0XHRcdHJldHVybiBgJyR7c3RyLnJlcGxhY2UoLycvZywgXCInJ1wiKX0nYDtcblx0XHR9IGVsc2UgaWYgKHN0ci5pbmNsdWRlcyhcIiBcIikgfHwgc3RyLmluY2x1ZGVzKFwiOlwiKSB8fCBzdHIuaW5jbHVkZXMoXCIjXCIpIHx8IHN0ci5pbmNsdWRlcyhcIkBcIikpIHtcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggc3BhY2VzIG9yIHNwZWNpYWwgWUFNTCBjaGFyYWN0ZXJzLCB3cmFwIGluIGRvdWJsZSBxdW90ZXMgYW5kIGVzY2FwZSBkb3VibGUgcXVvdGVzXG5cdFx0XHRyZXR1cm4gYFwiJHtzdHIucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpfVwiYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRm9yIHNpbXBsZSBzdHJpbmdzLCBubyBxdW90ZXMgbmVlZGVkXG5cdFx0XHRyZXR1cm4gc3RyO1xuXHRcdH1cblx0fVxuXG5cdG9uQ2xvc2UoKSB7XG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XG5cdH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFBsYXRmb3JtLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBQbHVnaW4gfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IENvbnRlbnRUeXBlLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlLCBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgfSBmcm9tIFwiLi4vdHlwZXNcIjtcbmltcG9ydCB7IENvbW1hbmRQaWNrZXJNb2RhbCB9IGZyb20gXCIuL2NvbXBvbmVudHMvQ29tbWFuZFBpY2tlck1vZGFsXCI7XG5pbXBvcnQgeyBJY29uUGlja2VyTW9kYWwgfSBmcm9tIFwiLi9jb21wb25lbnRzL0ljb25QaWNrZXJNb2RhbFwiO1xuaW1wb3J0IHsgQ29uZmlybU1vZGFsIH0gZnJvbSBcIi4vY29tcG9uZW50cy9Db25maXJtTW9kYWxcIjtcbmltcG9ydCB7IGNyZWF0ZVNldHRpbmdzR3JvdXAgfSBmcm9tIFwiLi4vdXRpbHMvc2V0dGluZ3MtY29tcGF0XCI7XG5cbmV4cG9ydCBjbGFzcyBBc3Ryb0NvbXBvc2VyU2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwbHVnaW46IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2U7XG5cdGF1dG9SZW5hbWVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdHBvc3RzRm9sZGVyQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRvbmx5QXV0b21hdGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdGNyZWF0aW9uTW9kZUNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0aW5kZXhGaWxlQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRleGNsdWRlZERpcnNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdHVuZGVyc2NvcmVQcmVmaXhDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdGF1dG9JbnNlcnRDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdHBhZ2VzRmllbGRzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHRwYWdlc0luZGV4RmlsZUNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0cGFnZXNPbmx5QXV0b21hdGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XG5cdHRlcm1pbmFsQ29tbWFuZENvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0Y29uZmlnQ29tbWFuZENvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcblx0Y3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXHR0ZXJtaW5hbFJpYmJvblRvZ2dsZTogU2V0dGluZyB8IG51bGwgPSBudWxsO1xuXHRjb25maWdSaWJib25Ub2dnbGU6IFNldHRpbmcgfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSB0ZXJtaW5hbFJpYmJvblRvZ2dsZUNvbXBvbmVudDogeyBzZXREaXNhYmxlZDogKGRpc2FibGVkOiBib29sZWFuKSA9PiB2b2lkIH0gfCBudWxsID0gbnVsbDtcblx0cHJpdmF0ZSBjb25maWdSaWJib25Ub2dnbGVDb21wb25lbnQ6IHsgc2V0RGlzYWJsZWQ6IChkaXNhYmxlZDogYm9vbGVhbikgPT4gdm9pZCB9IHwgbnVsbCA9IG51bGw7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcblx0fVxuXG5cdC8qKlxuXHQgKiBSZWZyZXNoIGp1c3QgdGhlIGNvbnRlbnQgdHlwZXMgc2VjdGlvblxuXHQgKiBNb3JlIGVmZmljaWVudCB0aGFuIHJlZnJlc2hpbmcgdGhlIGVudGlyZSBzZXR0aW5ncyB0YWJcblx0ICovXG5cdHB1YmxpYyByZWZyZXNoQ29udGVudFR5cGVzKCk6IHZvaWQge1xuXHRcdGlmICh0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikge1xuXHRcdFx0dGhpcy5yZW5kZXJDdXN0b21Db250ZW50VHlwZXMoKTtcblx0XHR9XG5cdH1cblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblxuXHRcdC8vIFVzZSBjdXJyZW50IHBsdWdpbiBzZXR0aW5ncyAoYWxyZWFkeSBsb2FkZWQgYW5kIHVwLXRvLWRhdGUpXG5cdFx0Ly8gQWx3YXlzIHJlYWQgZnJlc2ggc2V0dGluZ3MgdG8gZW5zdXJlIHdlIHNob3cgbWlncmF0ZWQgY29udGVudCB0eXBlcyBpbW1lZGlhdGVseVxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0XG5cdFx0Ly8gUmVuZGVyIHRoZSBzZXR0aW5ncyB0YWIgd2l0aCBjdXJyZW50IHNldHRpbmdzXG5cdFx0Ly8gVGhpcyB3aWxsIHNob3cgYWxsIGNvbnRlbnQgdHlwZXMgaW5jbHVkaW5nIG5ld2x5IG1pZ3JhdGVkIG9uZXNcblx0XHR0aGlzLnJlbmRlclNldHRpbmdzVGFiKGNvbnRhaW5lckVsLCBzZXR0aW5ncyk7XG5cdH1cblxuXHRwcml2YXRlIHJlbmRlclNldHRpbmdzVGFiKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IHZvaWQge1xuXG5cdFx0Ly8gR2xvYmFsIHNldHRpbmdzIChmaXJzdCBncm91cCAtIG5vIGhlYWRpbmcpXG5cdFx0Y29uc3QgZ2VuZXJhbEdyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCk7XG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdHNldHRpbmdcblx0XHRcdFx0LnNldE5hbWUoXCJEYXRlIGZvcm1hdFwiKVxuXHRcdFx0XHQvLyBGYWxzZSBwb3NpdGl2ZTogRGF0ZSBmb3JtYXQgY29kZXMgKE1NTU0sIHl5eXksIGV0Yy4pIGFyZSB0ZWNobmljYWwgbm90YXRpb24sIG5vdCBVSSB0ZXh0XG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBvYnNpZGlhbm1kL3VpL3NlbnRlbmNlLWNhc2Vcblx0XHRcdFx0LnNldERlc2MoXCJGb3JtYXQgZm9yIHRoZSBkYXRlIGluIHByb3BlcnRpZXMgKGUuZy4sIHl5eXktbW0tZGQsIE1NTU0gRCwgeXl5eSwgeXl5eS1tbS1kZCBISDptbSlcIilcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XG5cdFx0XHRcdFx0dGV4dFxuXHRcdFx0XHRcdFx0Ly8gRmFsc2UgcG9zaXRpdmU6IFwiWVlZWS1NTS1ERFwiIGlzIGEgZGF0ZSBmb3JtYXQgcGxhY2Vob2xkZXIsIG5vdCBVSSB0ZXh0XG5cdFx0XHRcdFx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgb2JzaWRpYW5tZC91aS9zZW50ZW5jZS1jYXNlXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJZWVlZLU1NLUREXCIpXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZGF0ZUZvcm1hdClcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5kYXRlRm9ybWF0ID0gdmFsdWUgfHwgXCJZWVlZLU1NLUREXCI7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRzZXR0aW5nXG5cdFx0XHRcdC5zZXROYW1lKFwiRW5hYmxlIGNvcHkgaGVhZGluZyBsaW5rc1wiKVxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCByaWdodC1jbGljayBjb250ZXh0IG1lbnUgb3B0aW9uIHRvIGNvcHkgaGVhZGluZyBsaW5rcyBpbiB2YXJpb3VzIGZvcm1hdHMuXCIpXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cblx0XHRcdFx0XHR0b2dnbGVcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmspXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0dGhpcy51cGRhdGVDb3B5SGVhZGluZ0ZpZWxkcygpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRzZXR0aW5nXG5cdFx0XHRcdC5zZXROYW1lKFwiRGVmYXVsdCBoZWFkaW5nIGxpbmsgZm9ybWF0XCIpXG5cdFx0XHRcdC8vIEZhbHNlIHBvc2l0aXZlOiBcIkFzdHJvXCIgaXMgYSBwcm9wZXIgbm91biAoZnJhbWV3b3JrIG5hbWUpIGFuZCBzaG91bGQgYmUgY2FwaXRhbGl6ZWRcblx0XHRcdFx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG9ic2lkaWFubWQvdWkvc2VudGVuY2UtY2FzZVxuXHRcdFx0XHQuc2V0RGVzYyhcIkNob29zZSB0aGUgZGVmYXVsdCBmb3JtYXQgZm9yIGNvcGllZCBoZWFkaW5nIGxpbmtzLiBPYnNpZGlhbiBmb3JtYXQgcmVzcGVjdHMgeW91ciBPYnNpZGlhbiBzZXR0aW5ncyBmb3Igd2lraWxpbmsgdnMgbWFya2Rvd24gcHJlZmVyZW5jZS4gQXN0cm8gbGluayB1c2VzIHlvdXIgbGluayBiYXNlIHBhdGggZnJvbSBhYm92ZSBhbmQgY29udmVydHMgdGhlIGhlYWRpbmcgaW50byBrZWJhYi1jYXNlIGZvcm1hdCBhcyBhbiBhbmNob3IgbGlua1wiKVxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxuXHRcdFx0XHRcdGRyb3Bkb3duXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwib2JzaWRpYW5cIiwgXCJPYnNpZGlhbiBsaW5rXCIpXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiYXN0cm9cIiwgXCJBc3RybyBsaW5rXCIpXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuY29weUhlYWRpbmdMaW5rRm9ybWF0KVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmNvcHlIZWFkaW5nTGlua0Zvcm1hdCA9IHZhbHVlIGFzIFwib2JzaWRpYW5cIiB8IFwiYXN0cm9cIjtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpO1xuXHRcdFx0Ly8gQWRkIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgY2xhc3NlcyAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxuXHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlQ29weUhlYWRpbmdMaW5rKTtcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluayk7XG5cdFx0fSk7XG5cblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xuXHRcdFx0c2V0dGluZ1xuXHRcdFx0XHQuc2V0TmFtZShcIkFkZCB0cmFpbGluZyBzbGFzaCB0byBsaW5rc1wiKVxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCB0cmFpbGluZyBzbGFzaGVzIHRvIGFsbCBjb252ZXJ0ZWQgaW50ZXJuYWwgbGlua3MgKGUuZy4sIC9hYm91dC8gaW5zdGVhZCBvZiAvYWJvdXQpLlwiKVxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG5cdFx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuYWRkVHJhaWxpbmdTbGFzaFRvTGlua3MpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdC8vIEF1dG8taW5zZXJ0IHByb3BlcnRpZXMgKGdsb2JhbCBzZXR0aW5nKVxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRzZXR0aW5nXG5cdFx0XHRcdC5zZXROYW1lKFwiQXV0by1pbnNlcnQgcHJvcGVydGllc1wiKVxuXHRcdFx0XHQuc2V0RGVzYyhcIkF1dG9tYXRpY2FsbHkgaW5zZXJ0IHRoZSBwcm9wZXJ0aWVzIHRlbXBsYXRlIHdoZW4gY3JlYXRpbmcgbmV3IGZpbGVzIGZvciBhbnkgY29udGVudCB0eXBlLlwiKVxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG5cdFx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXMpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblx0XHR9KTtcblxuXHRcdC8vIENvbnRlbnQgdHlwZXNcblx0XHRjb25zdCBjb250ZW50VHlwZXNHcm91cCA9IGNyZWF0ZVNldHRpbmdzR3JvdXAoY29udGFpbmVyRWwsIFwiQ29udGVudCB0eXBlc1wiKTtcblxuXHRcdC8vIEFkZCBjb250YWluZXIgYXMgYSBzZXR0aW5nIC0gaGlkZSB0aGUgc2V0dGluZydzIGRlZmF1bHQgVUksIGFkZCBvdXIgY29udGFpbmVyIGluc2lkZVxuXHRcdGNvbnRlbnRUeXBlc0dyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdC8vIEhpZGUgdGhlIHNldHRpbmcncyBkZWZhdWx0IFVJIGVsZW1lbnRzIHVzaW5nIENTUyBjbGFzc2VzXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctaGlkZGVuLWVsZW1lbnRzXCIpO1xuXHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuYWRkQ2xhc3MoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1mdWxsLXdpZHRoXCIpO1xuXHRcdFx0Ly8gQWRkIG91ciBjb250YWluZXIgaW5zaWRlIHRoZSBzZXR0aW5nIGVsZW1lbnQgLSBlbnN1cmUgaXQncyB2aXNpYmxlXG5cdFx0XHR0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lciA9IHNldHRpbmcuc2V0dGluZ0VsLmNyZWF0ZURpdih7IFxuXHRcdFx0XHRjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZXMtY29udGFpbmVyIGFzdHJvLWNvbXBvc2VyLWN1c3RvbS10eXBlcy1jb250YWluZXItdmlzaWJsZVwiIFxuXHRcdFx0fSk7XG5cdFx0fSk7XG5cdFx0Ly8gUmVuZGVyIGNvbnRlbnQgdHlwZXMgYWZ0ZXIgY29udGFpbmVyIGlzIGNyZWF0ZWRcblx0XHRpZiAodGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIpIHtcblx0XHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XG5cdFx0fVxuXG5cdFx0Ly8gRGV2ZWxvcGVyIGNvbW1hbmRzIChkZXNrdG9wIG9ubHkgLSBub3QgYXZhaWxhYmxlIG9uIG1vYmlsZSlcblx0XHRpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XG5cdFx0XHRjb25zdCBkZXZlbG9wZXJHcm91cCA9IGNyZWF0ZVNldHRpbmdzR3JvdXAoY29udGFpbmVyRWwsIFwiRGV2ZWxvcGVyIGNvbW1hbmRzXCIpO1xuXG5cdFx0XHQvLyBUZXJtaW5hbCBjb21tYW5kIHNldHRpbmdzXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRcdHNldHRpbmdcblx0XHRcdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBvcGVuIHRlcm1pbmFsIGNvbW1hbmRcIilcblx0XHRcdFx0XHQuc2V0RGVzYyhcIkVuYWJsZSBjb21tYW5kIHRvIG9wZW4gdGVybWluYWwgaW4gcHJvamVjdCByb290IGRpcmVjdG9yeS5cIilcblx0XHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG5cdFx0XHRcdFx0XHR0b2dnbGVcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcdFx0dGhpcy51cGRhdGVUZXJtaW5hbENvbW1hbmRGaWVsZHMoKTtcblx0XHRcdFx0XHRcdFx0XHQvLyByZWdpc3RlclJpYmJvbkljb25zIGNoZWNrcyBib3RoIGNvbW1hbmQgYW5kIGljb24gc2V0dGluZ3Ncblx0XHRcdFx0XHRcdFx0XHQvLyBJZiBjb21tYW5kIGlzIGVuYWJsZWQgQU5EIGljb24gaXMgZW5hYmxlZCwgaXQgd2lsbCBzaG93OyBvdGhlcndpc2UgaXQgd2lsbCBoaWRlXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0KTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBDcmVhdGUgY29udGFpbmVyIGZvciB0ZXJtaW5hbCBjb21tYW5kIGZpZWxkcyAtIGtlZXAgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCB1cGRhdGUgbWV0aG9kc1xuXHRcdFx0dGhpcy50ZXJtaW5hbENvbW1hbmRDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwidGVybWluYWwtY29tbWFuZC1maWVsZHNcIiB9KTtcblx0XHRcdHRoaXMudGVybWluYWxDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xuXHRcdFx0dGhpcy50ZXJtaW5hbENvbW1hbmRDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XG5cblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdFx0Y29uc3QgZGVzY0ZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXHRcdFx0XHQvLyBGYWxzZSBwb3NpdGl2ZTogVGV4dCBpcyBhbHJlYWR5IGluIHNlbnRlbmNlIGNhc2U7IFwiT2JzaWRpYW5cIiBpcyBhIHByb3BlciBub3VuXG5cdFx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBvYnNpZGlhbm1kL3VpL3NlbnRlbmNlLWNhc2Vcblx0XHRcdFx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJQYXRoIHJlbGF0aXZlIHRvIHRoZSBPYnNpZGlhbiB2YXVsdCByb290IGZvbGRlci4gVXNlIC4uLy4uIGZvciB0d28gbGV2ZWxzIHVwLiBMZWF2ZSBibGFuayB0byB1c2UgdGhlIHZhdWx0IGZvbGRlclwiIH0pO1xuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlRoaXMgaXMgd2hlcmUgdGhlIHRlcm1pbmFsIHdpbGwgb3Blbi4gQWJzb2x1dGUgcGF0aHMgd29yayBhbHNvLlwiIH0pO1xuXHRcdFx0XHRzZXR0aW5nXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJQcm9qZWN0IHJvb3QgZGlyZWN0b3J5IHBhdGhcIilcblx0XHRcdFx0XHQuc2V0RGVzYyhkZXNjRnJhZ21lbnQpXG5cdFx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XG5cdFx0XHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIi4uLy4uXCIpXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy50ZXJtaW5hbFByb2plY3RSb290UGF0aClcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MudGVybWluYWxQcm9qZWN0Um9vdFBhdGggPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHQpO1xuXHRcdFx0XHQvLyBBZGQgY2xhc3MgZm9yIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgLSBrZWVwIHNldHRpbmcgaW4gZ3JvdXBcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdFx0c2V0dGluZ1xuXHRcdFx0XHRcdC5zZXROYW1lKFwiU2hvdyBvcGVuIHRlcm1pbmFsIHJpYmJvbiBpY29uXCIpXG5cdFx0XHRcdFx0LnNldERlc2MoXCJBZGQgYSByaWJib24gaWNvbiB0byBsYXVuY2ggdGhlIHRlcm1pbmFsIGNvbW1hbmQuXCIpXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uVG9nZ2xlQ29tcG9uZW50ID0gdG9nZ2xlO1xuXHRcdFx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24pXG5cdFx0XHRcdFx0XHRcdC5zZXREaXNhYmxlZCghc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZClcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBzZXR0aW5ncyBkaXJlY3RseSBvbiBwbHVnaW4gaW5zdGFuY2Vcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0XHQvLyBTbWFsbCBkZWxheSB0byBlbnN1cmUgc2V0dGluZ3MgYXJlIHNhdmVkLCB0aGVuIHJlLXJlZ2lzdGVyXG5cdFx0XHRcdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucykge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlclJpYmJvbkljb25zKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSwgNTApO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcblx0XHRcdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciB1cGRhdGluZyBkaXNhYmxlZCBzdGF0ZVxuXHRcdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uVG9nZ2xlID0gc2V0dGluZztcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBDb25maWcgZmlsZSBjb21tYW5kIHNldHRpbmdzXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRcdHNldHRpbmdcblx0XHRcdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBlZGl0IGNvbmZpZyBmaWxlIGNvbW1hbmRcIilcblx0XHRcdFx0XHQuc2V0RGVzYyhcIkVuYWJsZSBjb21tYW5kIHRvIG9wZW4gYXN0cm8gY29uZmlnIGZpbGUgaW4gZGVmYXVsdCBlZGl0b3IuXCIpXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuXHRcdFx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbmZpZ0NvbW1hbmRGaWVsZHMoKTtcblx0XHRcdFx0XHRcdFx0XHQvLyByZWdpc3RlclJpYmJvbkljb25zIGNoZWNrcyBib3RoIGNvbW1hbmQgYW5kIGljb24gc2V0dGluZ3Ncblx0XHRcdFx0XHRcdFx0XHQvLyBJZiBjb21tYW5kIGlzIGVuYWJsZWQgQU5EIGljb24gaXMgZW5hYmxlZCwgaXQgd2lsbCBzaG93OyBvdGhlcndpc2UgaXQgd2lsbCBoaWRlXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0KTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBDcmVhdGUgY29udGFpbmVyIGZvciBjb25maWcgY29tbWFuZCBmaWVsZHMgLSBrZWVwIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IHdpdGggdXBkYXRlIG1ldGhvZHNcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJjb25maWctY29tbWFuZC1maWVsZHNcIiB9KTtcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xuXHRcdFx0dGhpcy5jb25maWdDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCk7XG5cblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdFx0Y29uc3QgZGVzY0ZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlBhdGggdG8gdGhlIGNvbmZpZyBmaWxlIHJlbGF0aXZlIHRvIHRoZSB2YXVsdCByb290LiBVc2UgLi4vY29uZmlnLnRzIG9yIC4uLy4uL2FzdHJvLmNvbmZpZy5tanMuXCIgfSk7XG5cdFx0XHRcdGRlc2NGcmFnbWVudC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiQWJzb2x1dGUgcGF0aHMgd29yayBhbHNvLlwiIH0pO1xuXHRcdFx0XHRzZXR0aW5nXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJDb25maWcgZmlsZSBwYXRoXCIpXG5cdFx0XHRcdFx0LnNldERlc2MoZGVzY0ZyYWdtZW50KVxuXHRcdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxuXHRcdFx0XHRcdFx0dGV4dFxuXHRcdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCIuLi9jb25maWcudHNcIilcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmNvbmZpZ0ZpbGVQYXRoKVxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5jb25maWdGaWxlUGF0aCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdCk7XG5cdFx0XHRcdC8vIEFkZCBjbGFzcyBmb3IgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xuXHRcdFx0fSk7XG5cblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdFx0c2V0dGluZ1xuXHRcdFx0XHRcdC5zZXROYW1lKFwiU2hvdyBvcGVuIGNvbmZpZyByaWJib24gaWNvblwiKVxuXHRcdFx0XHRcdC5zZXREZXNjKFwiQWRkIGEgcmliYm9uIGljb24gdG8gbGF1bmNoIHRoZSBjb25maWcgZmlsZSBjb21tYW5kLlwiKVxuXHRcdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5jb25maWdSaWJib25Ub2dnbGVDb21wb25lbnQgPSB0b2dnbGU7XG5cdFx0XHRcdFx0XHR0b2dnbGVcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24pXG5cdFx0XHRcdFx0XHRcdC5zZXREaXNhYmxlZCghc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKVxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gVXBkYXRlIHNldHRpbmdzIGRpcmVjdGx5IG9uIHBsdWdpbiBpbnN0YW5jZVxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU21hbGwgZGVsYXkgdG8gZW5zdXJlIHNldHRpbmdzIGFyZSBzYXZlZCwgdGhlbiByZS1yZWdpc3RlclxuXHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH0sIDUwKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHRcdC8vIEFkZCBjbGFzcyBmb3IgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xuXHRcdFx0XHQvLyBTdG9yZSByZWZlcmVuY2UgZm9yIHVwZGF0aW5nIGRpc2FibGVkIHN0YXRlXG5cdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uVG9nZ2xlID0gc2V0dGluZztcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBIZWxwIGJ1dHRvbiByZXBsYWNlbWVudCB0b2dnbGUgKHBhcnQgb2YgZGV2ZWxvcGVyIGNvbW1hbmRzIGdyb3VwKVxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xuXHRcdFx0XHRzZXR0aW5nXG5cdFx0XHRcdFx0LnNldE5hbWUoJ1N3YXAgb3V0IGhlbHAgYnV0dG9uIGZvciBjdXN0b20gYWN0aW9uJylcblx0XHRcdFx0XHQuc2V0RGVzYygnUmVwbGFjZSB0aGUgaGVscCBidXR0b24gaW4gdGhlIHZhdWx0IHByb2ZpbGUgYXJlYSB3aXRoIGEgY3VzdG9tIGFjdGlvbi4nKVxuXHRcdFx0XHRcdC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudD8uZW5hYmxlZCA/PyBmYWxzZSlcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdFx0aWYgKCFzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQpIHtcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQgPSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlbmFibGVkOiBmYWxzZSxcblx0XHRcdFx0XHRcdFx0XHRcdGNvbW1hbmRJZDogJ2VkaXQtYXN0cm8tY29uZmlnJyxcblx0XHRcdFx0XHRcdFx0XHRcdGljb25JZDogJ3dyZW5jaCcsXG5cdFx0XHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuZW5hYmxlZCA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdFx0Ly8gVHJpZ2dlciBoZWxwIGJ1dHRvbiByZXBsYWNlbWVudCB1cGRhdGUgKGl0IHdpbGwgcmVsb2FkIHNldHRpbmdzKVxuXHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbikge1xuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24oKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHQvLyBSZS1yZW5kZXIgdG8gc2hvdy9oaWRlIG9wdGlvbnNcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHR9KSk7XG5cdFx0XHR9KTtcblxuXHRcdFx0Ly8gU2hvdyBjb21tYW5kIGFuZCBpY29uIHBpY2tlcnMgb25seSBpZiBlbmFibGVkIChwYXJ0IG9mIGRldmVsb3BlciBjb21tYW5kcyBncm91cClcblx0XHRcdGlmIChzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQpIHtcblx0XHRcdFx0Ly8gQ29tbWFuZCBwaWNrZXJcblx0XHRcdFx0Y29uc3QgY29tbWFuZE5hbWUgPSB0aGlzLmdldENvbW1hbmROYW1lKHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudC5jb21tYW5kSWQpO1xuXHRcdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XG5cdFx0XHRcdFx0c2V0dGluZ1xuXHRcdFx0XHRcdFx0LnNldE5hbWUoJ0NvbW1hbmQnKVxuXHRcdFx0XHRcdFx0LnNldERlc2MoJ1NlbGVjdCB0aGUgY29tbWFuZCB0byBleGVjdXRlIHdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkLicpXG5cdFx0XHRcdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cblx0XHRcdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoY29tbWFuZE5hbWUgfHwgJ1NlbGVjdCBjb21tYW5kJylcblx0XHRcdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IG1vZGFsID0gbmV3IENvbW1hbmRQaWNrZXJNb2RhbCh0aGlzLmFwcCwgKGNvbW1hbmRJZCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIXNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCA9IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb21tYW5kSWQ6ICdlZGl0LWFzdHJvLWNvbmZpZycsXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpY29uSWQ6ICd3cmVuY2gnLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50LmNvbW1hbmRJZCA9IGNvbW1hbmRJZDtcblx0XHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRyaWdnZXIgaGVscCBidXR0b24gcmVwbGFjZW1lbnQgdXBkYXRlIGltbWVkaWF0ZWx5IChpdCB3aWxsIHJlbG9hZCBzZXR0aW5ncylcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24pIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi51cGRhdGVIZWxwQnV0dG9uKCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVuZGVyIHRvIHNob3cgdXBkYXRlZCBjb21tYW5kIG5hbWVcblx0XHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9KSgpO1xuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHRcdFx0fSkpO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0XHQvLyBJY29uIHBpY2tlclxuXHRcdFx0XHRjb25zdCBpY29uTmFtZSA9IHRoaXMuZ2V0SWNvbk5hbWUoc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Lmljb25JZCk7XG5cdFx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcblx0XHRcdFx0XHRzZXR0aW5nXG5cdFx0XHRcdFx0XHQuc2V0TmFtZSgnSWNvbicpXG5cdFx0XHRcdFx0XHQuc2V0RGVzYygnU2VsZWN0IHRoZSBpY29uIHRvIGRpc3BsYXkgb24gdGhlIGJ1dHRvbi4nKVxuXHRcdFx0XHRcdFx0LmFkZEJ1dHRvbihidXR0b24gPT4gYnV0dG9uXG5cdFx0XHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KGljb25OYW1lIHx8ICdTZWxlY3QgaWNvbi4uLicpXG5cdFx0XHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBJY29uUGlja2VyTW9kYWwodGhpcy5hcHAsIChpY29uSWQpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRcdHZvaWQgKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQgPSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbmFibGVkOiB0cnVlLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29tbWFuZElkOiAnZWRpdC1hc3Ryby1jb25maWcnLFxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWNvbklkOiAnd3JlbmNoJyxcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudC5pY29uSWQgPSBpY29uSWQ7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUcmlnZ2VyIGhlbHAgYnV0dG9uIHJlcGxhY2VtZW50IHVwZGF0ZSBpbW1lZGlhdGVseSAoaXQgd2lsbCByZWxvYWQgc2V0dGluZ3MpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi51cGRhdGVIZWxwQnV0dG9uKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbigpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFJlLXJlbmRlciB0byBzaG93IHVwZGF0ZWQgaWNvbiBuYW1lXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSkoKTtcblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0XHRcdH0pKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dGhpcy51cGRhdGVDb3B5SGVhZGluZ0ZpZWxkcygpO1xuXHRcdC8vIE9ubHkgdXBkYXRlIHRlcm1pbmFsL2NvbmZpZyBmaWVsZHMgaWYgbm90IG9uIG1vYmlsZVxuXHRcdGlmICghUGxhdGZvcm0uaXNNb2JpbGUpIHtcblx0XHRcdHRoaXMudXBkYXRlVGVybWluYWxDb21tYW5kRmllbGRzKCk7XG5cdFx0XHR0aGlzLnVwZGF0ZUNvbmZpZ0NvbW1hbmRGaWVsZHMoKTtcblx0XHR9XG5cdH1cblxuXG5cdHVwZGF0ZUNvcHlIZWFkaW5nRmllbGRzKCkge1xuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0Y29uc3QgaXNWaXNpYmxlID0gc2V0dGluZ3MuZW5hYmxlQ29weUhlYWRpbmdMaW5rO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSB0aGUgXCJEZWZhdWx0IGhlYWRpbmcgbGluayBmb3JtYXRcIiBzZXR0aW5nIGVsZW1lbnQgdmlzaWJpbGl0eVxuXHRcdGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbDtcblx0XHRjb25zdCBhbGxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZXR0aW5nLWl0ZW0nKTtcblx0XHRhbGxTZXR0aW5ncy5mb3JFYWNoKChzZXR0aW5nRWwpID0+IHtcblx0XHRcdGNvbnN0IG5hbWVFbCA9IHNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLW5hbWUnKTtcblx0XHRcdGlmIChuYW1lRWwgJiYgbmFtZUVsLnRleHRDb250ZW50Py50cmltKCkgPT09IFwiRGVmYXVsdCBoZWFkaW5nIGxpbmsgZm9ybWF0XCIpIHtcblx0XHRcdFx0c2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGlzVmlzaWJsZSk7XG5cdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9XG5cblx0dXBkYXRlVGVybWluYWxDb21tYW5kRmllbGRzKCkge1xuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0Y29uc3QgaXNWaXNpYmxlID0gc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcblx0XHRcblx0XHQvLyBVcGRhdGUgY29udGFpbmVyIGZvciBiYWNrd2FyZCBjb21wYXRpYmlsaXR5XG5cdFx0aWYgKHRoaXMudGVybWluYWxDb21tYW5kQ29udGFpbmVyKSB7XG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBpc1Zpc2libGUpO1xuXHRcdFx0dGhpcy50ZXJtaW5hbENvbW1hbmRDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhaXNWaXNpYmxlKTtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIGluZGl2aWR1YWwgc2V0dGluZyBlbGVtZW50cyB0aGF0IGFyZSBpbiB0aGUgZ3JvdXBcblx0XHQvLyBGaW5kIHNldHRpbmdzIGJ5IHRoZWlyIG5hbWUgdGV4dCBjb250ZW50XG5cdFx0Y29uc3QgY29udGFpbmVyRWwgPSB0aGlzLmNvbnRhaW5lckVsO1xuXHRcdGNvbnN0IGFsbFNldHRpbmdzID0gY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbCgnLnNldHRpbmctaXRlbScpO1xuXHRcdGFsbFNldHRpbmdzLmZvckVhY2goKHNldHRpbmdFbCkgPT4ge1xuXHRcdFx0Y29uc3QgbmFtZUVsID0gc2V0dGluZ0VsLnF1ZXJ5U2VsZWN0b3IoJy5zZXR0aW5nLWl0ZW0tbmFtZScpO1xuXHRcdFx0aWYgKG5hbWVFbCkge1xuXHRcdFx0XHRjb25zdCBuYW1lID0gbmFtZUVsLnRleHRDb250ZW50Py50cmltKCk7XG5cdFx0XHRcdGlmIChuYW1lID09PSBcIlByb2plY3Qgcm9vdCBkaXJlY3RvcnkgcGF0aFwiIHx8IG5hbWUgPT09IFwiU2hvdyBvcGVuIHRlcm1pbmFsIHJpYmJvbiBpY29uXCIpIHtcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgaXNWaXNpYmxlKTtcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhaXNWaXNpYmxlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSByaWJib24gdG9nZ2xlIGRpc2FibGVkIHN0YXRlIHVzaW5nIHRoZSB0b2dnbGUgY29tcG9uZW50XG5cdFx0aWYgKHRoaXMudGVybWluYWxSaWJib25Ub2dnbGVDb21wb25lbnQpIHtcblx0XHRcdHRoaXMudGVybWluYWxSaWJib25Ub2dnbGVDb21wb25lbnQuc2V0RGlzYWJsZWQoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xuXHRcdH1cblx0fVxuXG5cdHVwZGF0ZUNvbmZpZ0NvbW1hbmRGaWVsZHMoKSB7XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcblx0XHRjb25zdCBpc1Zpc2libGUgPSBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ7XG5cdFx0XG5cdFx0Ly8gVXBkYXRlIGNvbnRhaW5lciBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuXHRcdGlmICh0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIpIHtcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBpc1Zpc2libGUpO1xuXHRcdFx0dGhpcy5jb25maWdDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWlzVmlzaWJsZSk7XG5cdFx0fVxuXHRcdFxuXHRcdC8vIFVwZGF0ZSBpbmRpdmlkdWFsIHNldHRpbmcgZWxlbWVudHMgdGhhdCBhcmUgaW4gdGhlIGdyb3VwXG5cdFx0Ly8gRmluZCBzZXR0aW5ncyBieSB0aGVpciBuYW1lIHRleHQgY29udGVudFxuXHRcdGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbDtcblx0XHRjb25zdCBhbGxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZXR0aW5nLWl0ZW0nKTtcblx0XHRhbGxTZXR0aW5ncy5mb3JFYWNoKChzZXR0aW5nRWwpID0+IHtcblx0XHRcdGNvbnN0IG5hbWVFbCA9IHNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLW5hbWUnKTtcblx0XHRcdGlmIChuYW1lRWwpIHtcblx0XHRcdFx0Y29uc3QgbmFtZSA9IG5hbWVFbC50ZXh0Q29udGVudD8udHJpbSgpO1xuXHRcdFx0XHRpZiAobmFtZSA9PT0gXCJDb25maWcgZmlsZSBwYXRoXCIgfHwgbmFtZSA9PT0gXCJTaG93IG9wZW4gY29uZmlnIHJpYmJvbiBpY29uXCIpIHtcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgaXNWaXNpYmxlKTtcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhaXNWaXNpYmxlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSByaWJib24gdG9nZ2xlIGRpc2FibGVkIHN0YXRlIHVzaW5nIHRoZSB0b2dnbGUgY29tcG9uZW50XG5cdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uVG9nZ2xlQ29tcG9uZW50KSB7XG5cdFx0XHR0aGlzLmNvbmZpZ1JpYmJvblRvZ2dsZUNvbXBvbmVudC5zZXREaXNhYmxlZCghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcblx0XHR9XG5cdH1cblxuXHRjaGVja0ZvckZvbGRlckNvbmZsaWN0cygpIHtcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xuXHRcdGNvbnN0IGJsYW5rRm9sZGVyczogc3RyaW5nW10gPSBbXTtcblx0XHRjb25zdCBmb2xkZXJDb25mbGljdHM6IHsgW2ZvbGRlcjogc3RyaW5nXTogc3RyaW5nW10gfSA9IHt9O1xuXHRcdFxuXHRcdC8vIENoZWNrIGNvbnRlbnQgdHlwZXNcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBjb250ZW50VHlwZXMpIHtcblx0XHRcdGlmIChjb250ZW50VHlwZS5lbmFibGVkKSB7XG5cdFx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcblx0XHRcdFx0XHRibGFua0ZvbGRlcnMucHVzaChjb250ZW50VHlwZS5uYW1lIHx8IFwiQ29udGVudFwiKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoIWZvbGRlckNvbmZsaWN0c1tjb250ZW50VHlwZS5mb2xkZXJdKSB7XG5cdFx0XHRcdFx0XHRmb2xkZXJDb25mbGljdHNbY29udGVudFR5cGUuZm9sZGVyXSA9IFtdO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRmb2xkZXJDb25mbGljdHNbY29udGVudFR5cGUuZm9sZGVyXS5wdXNoKGNvbnRlbnRUeXBlLm5hbWUgfHwgXCJDb250ZW50XCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdFxuXHRcdC8vIENoZWNrIGZvciBjb25mbGljdHNcblx0XHQvLyBXYXJuaW5nIGJveCByZW1vdmVkIC0gY29uZmxpY3RzIGFyZSBzdGlsbCBkZXRlY3RlZCBhdCBydW50aW1lXG5cdH1cblxuXHRwcml2YXRlIGFkZEN1c3RvbUNvbnRlbnRUeXBlKCkge1xuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IG5ld1R5cGU6IENvbnRlbnRUeXBlID0ge1xuXHRcdFx0aWQ6IGBjb250ZW50LSR7RGF0ZS5ub3coKX1gLFxuXHRcdFx0bmFtZTogYENvbnRlbnQgJHtjb250ZW50VHlwZXMubGVuZ3RoICsgMX1gLFxuXHRcdFx0Zm9sZGVyOiBcIlwiLFxuXHRcdFx0bGlua0Jhc2VQYXRoOiBcIlwiLFxuXHRcdFx0dGVtcGxhdGU6ICctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxuLS0tXFxuJyxcblx0XHRcdGVuYWJsZWQ6IHRydWUsXG5cdFx0XHRjcmVhdGlvbk1vZGU6IFwiZmlsZVwiLFxuXHRcdFx0aW5kZXhGaWxlTmFtZTogXCJcIixcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnM6IGZhbHNlLFxuXHRcdFx0ZW5hYmxlVW5kZXJzY29yZVByZWZpeDogZmFsc2UsXG5cdFx0fTtcblx0XHRjb250ZW50VHlwZXMucHVzaChuZXdUeXBlKTtcblx0XHRzZXR0aW5ncy5jb250ZW50VHlwZXMgPSBjb250ZW50VHlwZXM7XG5cdFx0dm9pZCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xuXHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcblx0fVxuXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCkge1xuXHRcdGlmICghdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIpIHJldHVybjtcblx0XHRcblx0XHR0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lci5lbXB0eSgpO1xuXHRcdFxuXHRcdC8vIEFsd2F5cyByZWFkIGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIHRvIGVuc3VyZSB3ZSBoYXZlIGxhdGVzdCBkYXRhXG5cdFx0Ly8gVGhpcyBpcyBjcml0aWNhbCBhZnRlciBtaWdyYXRpb25cblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRjb250ZW50VHlwZXMuZm9yRWFjaCgoY3VzdG9tVHlwZTogQ29udGVudFR5cGUsIGluZGV4OiBudW1iZXIpID0+IHtcblx0XHRcdGlmICghdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIpIHJldHVybjtcblx0XHRcdGNvbnN0IHR5cGVDb250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBcblx0XHRcdFx0Y2xzOiBcImN1c3RvbS1jb250ZW50LXR5cGUtaXRlbVwiLFxuXHRcdFx0XHRhdHRyOiB7IFwiZGF0YS10eXBlLWlkXCI6IGN1c3RvbVR5cGUuaWQgfVxuXHRcdFx0fSk7XG5cblx0XHRcdC8vIEhlYWRlciB3aXRoIGNvbnRyb2xzXG5cdFx0XHRjb25zdCBoZWFkZXIgPSB0eXBlQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjdXN0b20tY29udGVudC10eXBlLWhlYWRlclwiIH0pO1xuXHRcdFx0aGVhZGVyLmNsYXNzTGlzdC5hZGQoXCJhc3Ryby1jb21wb3Nlci1jdXN0b20tdHlwZS1oZWFkZXJcIik7XG5cdFx0XHRcblx0XHRcdC8vIExlZnQgc2lkZSAtIGNvbGxhcHNlL2V4cGFuZCBidXR0b25cblx0XHRcdGNvbnN0IGNvbGxhcHNlQnV0dG9uID0gaGVhZGVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci1jb2xsYXBzZS1idXR0b25cIixcblx0XHRcdFx0YXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJDb2xsYXBzZS9leHBhbmRcIiB9XG5cdFx0XHR9KTtcblx0XHRcdGNvbnN0IGlzQ29sbGFwc2VkID0gY3VzdG9tVHlwZS5jb2xsYXBzZWQgPz8gZmFsc2U7XG5cdFx0XHQvLyBBbHdheXMgdXNlIGNoZXZyb24tZG93biwgcm90YXRlIGl0IHdoZW4gY29sbGFwc2VkIHRvIHBvaW50IHJpZ2h0XG5cdFx0XHRzZXRJY29uKGNvbGxhcHNlQnV0dG9uLCBcImNoZXZyb24tZG93blwiKTtcblx0XHRcdGlmIChpc0NvbGxhcHNlZCkge1xuXHRcdFx0XHRjb2xsYXBzZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiaXMtY29sbGFwc2VkXCIpO1xuXHRcdFx0fVxuXHRcdFx0Y29sbGFwc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdFx0dm9pZCB0aGlzLnRvZ2dsZUNvbnRlbnRUeXBlQ29sbGFwc2UoY3VzdG9tVHlwZS5pZCk7XG5cdFx0XHRcdC8vIFVwZGF0ZSBjbGFzcyBhZnRlciB0b2dnbGUgKGljb24gc3RheXMgdGhlIHNhbWUsIGp1c3Qgcm90YXRlcylcblx0XHRcdFx0Y29uc3QgdXBkYXRlZFR5cGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMuZmluZCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gY3VzdG9tVHlwZS5pZCk7XG5cdFx0XHRcdGlmICh1cGRhdGVkVHlwZSkge1xuXHRcdFx0XHRcdGlmICh1cGRhdGVkVHlwZS5jb2xsYXBzZWQpIHtcblx0XHRcdFx0XHRcdGNvbGxhcHNlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJpcy1jb2xsYXBzZWRcIik7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdGNvbGxhcHNlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1jb2xsYXBzZWRcIik7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gTWlkZGxlIGxlZnQgLSBjb250ZW50IHR5cGUgbmFtZVxuXHRcdFx0Y29uc3QgaGVhZGVyTmFtZSA9IGhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiYXN0cm8tY29tcG9zZXItaGVhZGVyLW5hbWVcIiB9KTtcblx0XHRcdGhlYWRlck5hbWUuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBjdXN0b21UeXBlLm5hbWUgfHwgYENvbnRlbnQgJHtpbmRleCArIDF9YCwgY2xzOiBcInNldHRpbmctaXRlbS1uYW1lXCIgfSk7XG5cdFx0XHRcblx0XHRcdC8vIE1pZGRsZSByaWdodCAtIHVwL2Rvd24gYnV0dG9ucyAoc2lkZS1ieS1zaWRlKVxuXHRcdFx0Y29uc3QgcmVvcmRlckNvbnRhaW5lciA9IGhlYWRlci5jcmVhdGVEaXYoeyBjbHM6IFwiYXN0cm8tY29tcG9zZXItcmVvcmRlci1idXR0b25zXCIgfSk7XG5cdFx0XHRjb25zdCB1cEJ1dHRvbiA9IHJlb3JkZXJDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItcmVvcmRlci1idXR0b25cIixcblx0XHRcdFx0YXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJNb3ZlIHVwXCIgfVxuXHRcdFx0fSk7XG5cdFx0XHRzZXRJY29uKHVwQnV0dG9uLCBcImNoZXZyb24tdXBcIik7XG5cdFx0XHR1cEJ1dHRvbi5kaXNhYmxlZCA9IGluZGV4ID09PSAwO1xuXHRcdFx0dXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdFx0dm9pZCB0aGlzLm1vdmVDb250ZW50VHlwZVVwKGN1c3RvbVR5cGUuaWQpO1xuXHRcdFx0fSk7XG5cdFx0XHRcblx0XHRcdGNvbnN0IGRvd25CdXR0b24gPSByZW9yZGVyQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcblx0XHRcdFx0Y2xzOiBcImFzdHJvLWNvbXBvc2VyLXJlb3JkZXItYnV0dG9uXCIsXG5cdFx0XHRcdGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTW92ZSBkb3duXCIgfVxuXHRcdFx0fSk7XG5cdFx0XHRzZXRJY29uKGRvd25CdXR0b24sIFwiY2hldnJvbi1kb3duXCIpO1xuXHRcdFx0ZG93bkJ1dHRvbi5kaXNhYmxlZCA9IGluZGV4ID09PSBjb250ZW50VHlwZXMubGVuZ3RoIC0gMTtcblx0XHRcdGRvd25CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcblx0XHRcdFx0dm9pZCB0aGlzLm1vdmVDb250ZW50VHlwZURvd24oY3VzdG9tVHlwZS5pZCk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gUmlnaHQgc2lkZSAtIHRvZ2dsZVxuXHRcdFx0Y29uc3QgdG9nZ2xlQ29udGFpbmVyID0gaGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJjaGVja2JveC1jb250YWluZXJcIiB9KTtcblx0XHRcdGlmIChjdXN0b21UeXBlLmVuYWJsZWQpIHtcblx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpcy1lbmFibGVkXCIpO1xuXHRcdFx0fVxuXHRcdFx0XG5cdFx0XHRjb25zdCB0b2dnbGUgPSB0b2dnbGVDb250YWluZXIuY3JlYXRlRWwoXCJpbnB1dFwiLCB7IHR5cGU6IFwiY2hlY2tib3hcIiwgY2xzOiBcImNoZWNrYm94LWlucHV0XCIgfSk7XG5cdFx0XHR0b2dnbGUuY2hlY2tlZCA9IGN1c3RvbVR5cGUuZW5hYmxlZDtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGNsaWNrIGV2ZW50IHRvIHRoZSBjb250YWluZXIgYXMgd2VsbFxuXHRcdFx0dG9nZ2xlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuXHRcdFx0XHR2b2lkIChhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0XHRcdGNvbnN0IG5ld1ZhbHVlID0gIWN1c3RvbVR5cGUuZW5hYmxlZDtcblx0XHRcdFx0XHRjdXN0b21UeXBlLmVuYWJsZWQgPSBuZXdWYWx1ZTtcblx0XHRcdFx0XHR0b2dnbGUuY2hlY2tlZCA9IG5ld1ZhbHVlO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIGNvbnRhaW5lciBjbGFzcyBmb3IgdmlzdWFsIGZlZWRiYWNrXG5cdFx0XHRcdFx0aWYgKG5ld1ZhbHVlKSB7XG5cdFx0XHRcdFx0XHR0b2dnbGVDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImlzLWVuYWJsZWRcIik7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtZW5hYmxlZFwiKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gVXBkYXRlIHZpc2liaWxpdHlcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCBuZXdWYWx1ZSk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Ly8gQ29uZmxpY3QgY2hlY2tpbmcgcmVtb3ZlZCBmcm9tIHNldHRpbmdzIFVJXG5cdFx0XHRcdH0pKCk7XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gQWxzbyBhZGQgY2hhbmdlIGV2ZW50IGFzIGJhY2t1cFxuXHRcdFx0dG9nZ2xlLmFkZEV2ZW50TGlzdGVuZXIoXCJjaGFuZ2VcIiwgKGUpID0+IHtcblx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IHZhbHVlID0gKGUudGFyZ2V0IGFzIEhUTUxJbnB1dEVsZW1lbnQpLmNoZWNrZWQ7XG5cdFx0XHRcdFx0Y3VzdG9tVHlwZS5lbmFibGVkID0gdmFsdWU7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdC8vIFVwZGF0ZSB0aGUgY29udGFpbmVyIGNsYXNzIGZvciB2aXN1YWwgZmVlZGJhY2tcblx0XHRcdFx0XHRpZiAodmFsdWUpIHtcblx0XHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaXMtZW5hYmxlZFwiKTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1lbmFibGVkXCIpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcblx0XHRcdFx0XHQvLyBVcGRhdGUgdmlzaWJpbGl0eVxuXHRcdFx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVWaXNpYmlsaXR5KGN1c3RvbVR5cGUuaWQsIHZhbHVlKTtcblx0XHRcdFx0fSkoKTtcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBTZXR0aW5ncyBjb250YWluZXIgdGhhdCBjYW4gYmUgY29sbGFwc2VkXG5cdFx0XHRjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IHR5cGVDb250YWluZXIuY3JlYXRlRGl2KHsgXG5cdFx0XHRcdGNsczogXCJjdXN0b20tY29udGVudC10eXBlLXNldHRpbmdzXCIsXG5cdFx0XHRcdGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9XG5cdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gU2V0IGluaXRpYWwgdmlzaWJpbGl0eSBzdGF0ZSBiYXNlZCBvbiBlbmFibGVkIGFuZCBjb2xsYXBzZWQgc3RhdGVcblx0XHRcdGNvbnN0IGluaXRpYWxseUNvbGxhcHNlZCA9IGN1c3RvbVR5cGUuY29sbGFwc2VkID8/IGZhbHNlO1xuXHRcdFx0Y29uc3QgaW5pdGlhbGx5VmlzaWJsZSA9IGN1c3RvbVR5cGUuZW5hYmxlZCAmJiAhaW5pdGlhbGx5Q29sbGFwc2VkO1xuXHRcdFx0aWYgKGluaXRpYWxseVZpc2libGUpIHtcblx0XHRcdFx0c2V0dGluZ3NDb250YWluZXIuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIik7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIpO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDb250ZW50IHR5cGUgbmFtZVxuXHRcdFx0Y29uc3QgbmFtZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuXHRcdFx0bmV3IFNldHRpbmcobmFtZUNvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoXCJDb250ZW50IHR5cGUgbmFtZVwiKVxuXHRcdFx0XHQuc2V0RGVzYyhcIkRpc3BsYXkgbmFtZSBmb3IgdGhpcyBjb250ZW50IHR5cGUgKGUuZy4sICdwcm9qZWN0cycsICdub3RlcycsICd0dXRvcmlhbHMnKVwiKVxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xuXHRcdFx0XHRcdHRleHRcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIGNvbnRlbnQgdHlwZSBuYW1lXCIpXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5uYW1lKVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUubmFtZSA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblxuXHRcdFx0Ly8gRm9sZGVyIGxvY2F0aW9uXG5cdFx0XHRjb25zdCBmb2xkZXJDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcblx0XHRcdGNvbnN0IGZvbGRlclNldHRpbmcgPSBuZXcgU2V0dGluZyhmb2xkZXJDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKFwiRm9sZGVyIGxvY2F0aW9uXCIpXG5cdFx0XHRcdC5zZXREZXNjKFwiRm9sZGVyIHBhdGggd2hlcmUgdGhpcyBjb250ZW50IHR5cGUgd2lsbCBiZSBjcmVhdGVkLiBMZWF2ZSBibGFuayB0byB1c2UgdGhlIHZhdWx0IGZvbGRlci4gU3VwcG9ydHMgd2lsZGNhcmRzIGxpa2UgZGlyZWN0b3J5Lyogb3IgZGlyZWN0b3J5LyovKiB0byBtYXRjaCBzcGVjaWZpYyBmb2xkZXIgZGVwdGhzLlwiKVxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xuXHRcdFx0XHRcdHRleHRcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkVudGVyIGZvbGRlciBwYXRoIChlLmcuLCAnZG9jcycsICdkb2NzLyonLCAnZG9jcy8qLyonKSBvciBsZWF2ZSBibGFuayBmb3IgdmF1bHQgcm9vdFwiKVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuZm9sZGVyKVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuZm9sZGVyID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XG5cdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVJZ25vcmVTdWJmb2xkZXJzRmllbGQoY3VzdG9tVHlwZS5pZCk7XG5cdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBjb25mbGljdCB3YXJuaW5ncyBmb3IgYWxsIGNvbnRlbnQgdHlwZXMgKGZvbGRlciBjaGFuZ2UgbWF5IGFmZmVjdCBvdGhlcnMpXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGFsbENvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRcdFx0XHRcdFx0Zm9yIChjb25zdCBjdCBvZiBhbGxDb250ZW50VHlwZXMpIHtcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyhjdC5pZCwgbnVsbCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gQWRkIGNvbmZsaWN0IHdhcm5pbmcgZWxlbWVudFxuXHRcdFx0Zm9sZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1jb25mbGljdC13YXJuaW5nIGhpZGRlblwiLCBhdHRyOiB7IFwiZGF0YS10eXBlLWlkXCI6IGN1c3RvbVR5cGUuaWQgfSB9KTtcblx0XHRcdHRoaXMudXBkYXRlRm9sZGVyQ29uZmxpY3RXYXJuaW5nKGN1c3RvbVR5cGUuaWQsIGZvbGRlclNldHRpbmcpO1xuXG5cdFx0XHQvLyBJZ25vcmUgc3ViZm9sZGVycyAob25seSBzaG93IHdoZW4gZm9sZGVyIGlzIHNldClcblx0XHRcdGNvbnN0IGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY3VzdG9tLWlnbm9yZS1zdWJmb2xkZXJzLWZpZWxkXCIgfSk7XG5cdFx0XHRpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyLnNldEF0dHJpYnV0ZShcImRhdGEtdHlwZS1pZFwiLCBjdXN0b21UeXBlLmlkKTtcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgISFjdXN0b21UeXBlLmZvbGRlcik7XG5cdFx0XHRpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWN1c3RvbVR5cGUuZm9sZGVyKTtcblx0XHRcdG5ldyBTZXR0aW5nKGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKFwiSWdub3JlIHN1YmZvbGRlcnNcIilcblx0XHRcdFx0LnNldERlc2MoXCJXaGVuIGVuYWJsZWQsIGF1dG9tYXRpb24gd2lsbCBvbmx5IHRyaWdnZXIgZm9yIG5ldyAubWQgZmlsZXMgd2l0aGluIHRoaXMgY29udGVudCB0eXBlJ3MgZm9sZGVyIGFuZCBvbmUgbGV2ZWwgZG93biAoZm9yIGZvbGRlci1iYXNlZCBjb250ZW50KS4gRmlsZXMgaW4gZGVlcGVyIHN1YmZvbGRlcnMgd2lsbCBiZSBpZ25vcmVkLlwiKVxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XG5cdFx0XHRcdFx0dG9nZ2xlXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5pZ25vcmVTdWJmb2xkZXJzIHx8IGZhbHNlKVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmlnbm9yZVN1YmZvbGRlcnMgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpO1xuXG5cdFx0XHQvLyBVbmRlcnNjb3JlIHByZWZpeFxuXHRcdFx0Y29uc3QgdW5kZXJzY29yZVByZWZpeENvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuXHRcdFx0bmV3IFNldHRpbmcodW5kZXJzY29yZVByZWZpeENvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoXCJVc2UgdW5kZXJzY29yZSBwcmVmaXggZm9yIGRyYWZ0c1wiKVxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCBhbiB1bmRlcnNjb3JlIHByZWZpeCAoX2NvbnRlbnQtdGl0bGUpIHRvIG5ldyBub3RlcyBieSBkZWZhdWx0IHdoZW4gZW5hYmxlZC4gVGhpcyBoaWRlcyB0aGVtIGZyb20gYXN0cm8sIHdoaWNoIGNhbiBiZSBoZWxwZnVsIGZvciBkcmFmdHNcIilcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxuXHRcdFx0XHRcdHRvZ2dsZVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuZW5hYmxlVW5kZXJzY29yZVByZWZpeCB8fCBmYWxzZSlcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5lbmFibGVVbmRlcnNjb3JlUHJlZml4ID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0KTtcblxuXHRcdFx0Ly8gTGluayBiYXNlIHBhdGhcblx0XHRcdGNvbnN0IGxpbmtDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcblx0XHRcdG5ldyBTZXR0aW5nKGxpbmtDb250YWluZXIpXG5cdFx0XHRcdC5zZXROYW1lKFwiTGluayBiYXNlIHBhdGhcIilcblx0XHRcdFx0LnNldERlc2MoXCJCYXNlIHBhdGggZm9yIGNvbnZlcnRlZCBsaW5rcyAoZS5nLiwgJy9wcm9qZWN0cy8nLCAnL25vdGVzL3R1dG9yaWFscy8nLCBsZWF2ZSBibGFuayBmb3Igcm9vdCAvKS5cIilcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcblx0XHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciBsaW5rIGJhc2UgcGF0aFwiKVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5saW5rQmFzZVBhdGggPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdC8vIENyZWF0aW9uIG1vZGVcblx0XHRcdGNvbnN0IGNyZWF0aW9uTW9kZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuXHRcdFx0bmV3IFNldHRpbmcoY3JlYXRpb25Nb2RlQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZShcIkNyZWF0aW9uIG1vZGVcIilcblx0XHRcdFx0LnNldERlc2MoXCJIb3cgdG8gY3JlYXRlIG5ldyBlbnRyaWVzOiBmaWxlLWJhc2VkIG9yIGZvbGRlci1iYXNlZCB3aXRoIGFuIGluZGV4IGZpbGUuXCIpXG5cdFx0XHRcdC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+XG5cdFx0XHRcdFx0ZHJvcGRvd25cblx0XHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmaWxlXCIsIFwiRmlsZS1iYXNlZCAoY29udGVudC10aXRsZS5tZClcIilcblx0XHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmb2xkZXJcIiwgXCJGb2xkZXItYmFzZWQgKGNvbnRlbnQtdGl0bGUvaW5kZXgubWQpXCIpXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUpXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPSB2YWx1ZSBhcyBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSW5kZXhGaWxlRmllbGQoY3VzdG9tVHlwZS5pZCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpO1xuXG5cdFx0XHQvLyBJbmRleCBmaWxlIG5hbWUgKG9ubHkgc2hvdyBmb3IgZm9sZGVyLWJhc2VkKVxuXHRcdFx0Y29uc3QgaW5kZXhGaWxlQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcImN1c3RvbS1pbmRleC1maWxlLWZpZWxkXCIgfSk7XG5cdFx0XHRpbmRleEZpbGVDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpO1xuXHRcdGluZGV4RmlsZUNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsIGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlICE9PSBcImZvbGRlclwiKTtcblx0XHRcdG5ldyBTZXR0aW5nKGluZGV4RmlsZUNvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoXCJJbmRleCBmaWxlIG5hbWVcIilcblx0XHRcdFx0LnNldERlc2MoXCJOYW1lIGZvciBpbmRleCBmaWxlcyBpbiBmb2xkZXItYmFzZWQgY29udGVudCAod2l0aG91dCAubWQgZXh0ZW5zaW9uKS4gRGVmYXVsdHMgdG8gJ2luZGV4JyBpZiBsZWZ0IGJsYW5rLlwiKVxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cblx0XHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJJbmRleFwiKVxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuaW5kZXhGaWxlTmFtZSlcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmluZGV4RmlsZU5hbWUgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHR9KVxuXHRcdFx0XHQpO1xuXG5cdFx0XHQvLyBUZW1wbGF0ZVxuXHRcdFx0Y29uc3QgdGVtcGxhdGVDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcblx0XHRcdG5ldyBTZXR0aW5nKHRlbXBsYXRlQ29udGFpbmVyKVxuXHRcdFx0XHQuc2V0TmFtZShcIlByb3BlcnRpZXMgdGVtcGxhdGVcIilcblx0XHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XG5cdFx0XHRcdFx0dGV4dFxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxuLS0tXFxuJylcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLnRlbXBsYXRlKVxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUudGVtcGxhdGUgPSB2YWx1ZTtcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR0ZXh0LmlucHV0RWwuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXRlbXBsYXRlLXRleHRhcmVhXCIpO1xuXHRcdFx0XHRcdHJldHVybiB0ZXh0O1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQudGhlbigoc2V0dGluZykgPT4ge1xuXHRcdFx0XHRzZXR0aW5nLmRlc2NFbC5lbXB0eSgpO1xuXHRcdFx0XHRjb25zdCBkZXNjRGl2ID0gc2V0dGluZy5kZXNjRWwuY3JlYXRlRWwoXCJkaXZcIik7XG5cdFx0XHRcdGRlc2NEaXYuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlRlbXBsYXRlIGZvciBuZXcgZmlsZXMgb2YgdGhpcyBjb250ZW50IHR5cGUuXCIgfSk7XG5cdFx0XHRcdGRlc2NEaXYuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlZhcmlhYmxlcyBpbmNsdWRlIHt7dGl0bGV9fSBhbmQge3tkYXRlfX0uXCIgfSk7XG5cdFx0XHRcdGRlc2NEaXYuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIkRvIG5vdCB3cmFwIHt7ZGF0ZX19IGluIHF1b3RlcyBhcyBpdCByZXByZXNlbnRzIGEgZGF0ZXRpbWUgdmFsdWUsIG5vdCBhIHN0cmluZy5cIiB9KTtcblx0XHRcdFx0fSk7XG5cblx0XHRcdC8vIFJlbW92ZSBidXR0b24gYXQgdGhlIGJvdHRvbSAobm8gZGl2aWRlcilcblx0XHRcdGNvbnN0IHJlbW92ZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuXHRcdFx0Y29uc3QgcmVtb3ZlU2V0dGluZyA9IG5ldyBTZXR0aW5nKHJlbW92ZUNvbnRhaW5lcilcblx0XHRcdFx0LnNldE5hbWUoXCJcIilcblx0XHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XG5cdFx0XHRcdFx0YnV0dG9uXG5cdFx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIlJlbW92ZVwiKVxuXHRcdFx0XHRcdFx0LnNldFdhcm5pbmcoKVxuXHRcdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcy5maW5kKGN0ID0+IGN0LmlkID09PSBjdXN0b21UeXBlLmlkKTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgdHlwZU5hbWUgPSBjb250ZW50VHlwZT8ubmFtZSB8fCBcImNvbnRlbnQgdHlwZVwiO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBDb25maXJtTW9kYWwoXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5hcHAsXG5cdFx0XHRcdFx0XHRcdFx0YEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmUgXCIke3R5cGVOYW1lfVwiPyBUaGlzIGFjdGlvbiBjYW5ub3QgYmUgdW5kb25lLmAsXG5cdFx0XHRcdFx0XHRcdFx0XCJSZW1vdmVcIixcblx0XHRcdFx0XHRcdFx0XHRcIkNhbmNlbFwiXG5cdFx0XHRcdFx0XHRcdCk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGNvbmZpcm1lZCA9IGF3YWl0IG1vZGFsLndhaXRGb3JSZXN1bHQoKTtcblx0XHRcdFx0XHRcdFx0aWYgKGNvbmZpcm1lZCkge1xuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucmVtb3ZlQ3VzdG9tQ29udGVudFR5cGUoY3VzdG9tVHlwZS5pZCk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdFxuXHRcdFx0Ly8gSGlkZSB0aGUgZGl2aWRlciBsaW5lIGZvciB0aGUgcmVtb3ZlIGJ1dHRvblxuXHRcdFx0cmVtb3ZlU2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXJlbW92ZS1zZXR0aW5nXCIpO1xuXG5cdFx0XHQvLyBTZXQgaW5pdGlhbCB2aXNpYmlsaXR5IChjaGVja3MgYm90aCBlbmFibGVkIGFuZCBjb2xsYXBzZWQgc3RhdGUpXG5cdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCBjdXN0b21UeXBlLmVuYWJsZWQpO1xuXHRcdH0pO1xuXHRcdFxuXHRcdC8vIFVwZGF0ZSBjb25mbGljdCB3YXJuaW5ncyBmb3IgYWxsIHR5cGVzIGFmdGVyIHJlbmRlcmluZyAoZm9sZGVyIGNoYW5nZXMgbWF5IGFmZmVjdCBvdGhlcnMpXG5cdFx0Y29udGVudFR5cGVzLmZvckVhY2goKGN1c3RvbVR5cGU6IENvbnRlbnRUeXBlKSA9PiB7XG5cdFx0XHR0aGlzLnVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyhjdXN0b21UeXBlLmlkLCBudWxsKTtcblx0XHR9KTtcblxuXHRcdC8vIEFkZCBmbG9hdGluZyBidXR0b24gZm9yIGNyZWF0aW5nIG5ldyBjdXN0b20gY29udGVudCB0eXBlcyAobm8gc2V0dGluZ3MgYmFja2dyb3VuZClcblx0XHRjb25zdCBhZGRCdXR0b25Db250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiYXN0cm8tY29tcG9zZXItYWRkLWJ1dHRvbi1jb250YWluZXJcIiB9KTtcblx0XHRjb25zdCBhZGRCdXR0b24gPSBhZGRCdXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xuXHRcdFx0Y2xzOiBcIm1vZC1jdGFcIixcblx0XHRcdHRleHQ6IFwiQWRkIGNvbnRlbnQgdHlwZVwiXG5cdFx0fSk7XG5cdFx0YWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG5cdFx0XHR0aGlzLmFkZEN1c3RvbUNvbnRlbnRUeXBlKCk7XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eSh0eXBlSWQ6IHN0cmluZywgZW5hYmxlZDogYm9vbGVhbikge1xuXHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXR5cGUtaWQ9XCIke3R5cGVJZH1cIl0uY3VzdG9tLWNvbnRlbnQtdHlwZS1zZXR0aW5nc2ApIGFzIEhUTUxFbGVtZW50O1xuXHRcdGlmIChzZXR0aW5nc0NvbnRhaW5lcikge1xuXHRcdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gdHlwZUlkKTtcblx0XHRcdGNvbnN0IGlzQ29sbGFwc2VkID0gY29udGVudFR5cGU/LmNvbGxhcHNlZCA/PyBmYWxzZTtcblx0XHRcdGNvbnN0IHNob3VsZEJlVmlzaWJsZSA9IGVuYWJsZWQgJiYgIWlzQ29sbGFwc2VkO1xuXHRcdFx0XG5cdFx0XHRzZXR0aW5nc0NvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzaG91bGRCZVZpc2libGUpO1xuXHRcdFx0c2V0dGluZ3NDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2hvdWxkQmVWaXNpYmxlKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSW5kZXhGaWxlRmllbGQodHlwZUlkOiBzdHJpbmcpIHtcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3QgY3VzdG9tVHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKHR5cGUgPT4gdHlwZS5pZCA9PT0gdHlwZUlkKTtcblx0XHRpZiAoIWN1c3RvbVR5cGUpIHJldHVybjtcblxuXHRcdGNvbnN0IGluZGV4RmlsZUNvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyPy5xdWVyeVNlbGVjdG9yKGBbZGF0YS10eXBlLWlkPVwiJHt0eXBlSWR9XCJdIC5jdXN0b20taW5kZXgtZmlsZS1maWVsZGApIGFzIEhUTUxFbGVtZW50O1xuXHRcdGlmIChpbmRleEZpbGVDb250YWluZXIpIHtcblx0XHRcdGluZGV4RmlsZUNvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBjdXN0b21UeXBlLmNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIik7XG5cdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgIT09IFwiZm9sZGVyXCIpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgdXBkYXRlQ3VzdG9tQ29udGVudFR5cGVJZ25vcmVTdWJmb2xkZXJzRmllbGQodHlwZUlkOiBzdHJpbmcpIHtcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3QgY3VzdG9tVHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKHR5cGUgPT4gdHlwZS5pZCA9PT0gdHlwZUlkKTtcblx0XHRpZiAoIWN1c3RvbVR5cGUpIHJldHVybjtcblxuXHRcdGNvbnN0IGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcj8ucXVlcnlTZWxlY3RvcihgW2RhdGEtdHlwZS1pZD1cIiR7dHlwZUlkfVwiXS5jdXN0b20taWdub3JlLXN1YmZvbGRlcnMtZmllbGRgKSBhcyBIVE1MRWxlbWVudDtcblx0XHRpZiAoaWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lcikge1xuXHRcdFx0aWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCAhIWN1c3RvbVR5cGUuZm9sZGVyICYmIGN1c3RvbVR5cGUuZm9sZGVyLnRyaW0oKSAhPT0gXCJcIik7XG5cdFx0XHRpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWN1c3RvbVR5cGUuZm9sZGVyIHx8IGN1c3RvbVR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIik7XG5cdFx0fVxuXHR9XG5cblx0cHJpdmF0ZSB1cGRhdGVGb2xkZXJDb25mbGljdFdhcm5pbmcodHlwZUlkOiBzdHJpbmcsIHNldHRpbmc6IFNldHRpbmcgfCBudWxsKSB7XG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IGN1cnJlbnRUeXBlID0gY29udGVudFR5cGVzLmZpbmQodHlwZSA9PiB0eXBlLmlkID09PSB0eXBlSWQpO1xuXHRcdGlmICghY3VycmVudFR5cGUpIHJldHVybjtcblxuXHRcdGNvbnN0IGNvbmZsaWN0V2FybmluZ0VsID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXR5cGUtaWQ9XCIke3R5cGVJZH1cIl0uYXN0cm8tY29tcG9zZXItY29uZmxpY3Qtd2FybmluZ2ApIGFzIEhUTUxFbGVtZW50O1xuXHRcdGlmICghY29uZmxpY3RXYXJuaW5nRWwpIHJldHVybjtcblxuXHRcdC8vIEZpbmQgY29uZmxpY3RzIC0gb3RoZXIgY29udGVudCB0eXBlcyB3aXRoIHRoZSBzYW1lIGZvbGRlciBwYXR0ZXJuXG5cdFx0Y29uc3QgY3VycmVudEZvbGRlciA9IChjdXJyZW50VHlwZS5mb2xkZXIgfHwgXCJcIikudHJpbSgpO1xuXHRcdGNvbnN0IGNvbmZsaWN0aW5nVHlwZXM6IHN0cmluZ1tdID0gW107XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBvdGhlclR5cGUgb2YgY29udGVudFR5cGVzKSB7XG5cdFx0XHRpZiAob3RoZXJUeXBlLmlkID09PSB0eXBlSWQgfHwgIW90aGVyVHlwZS5lbmFibGVkKSBjb250aW51ZTtcblx0XHRcdFxuXHRcdFx0Y29uc3Qgb3RoZXJGb2xkZXIgPSAob3RoZXJUeXBlLmZvbGRlciB8fCBcIlwiKS50cmltKCk7XG5cdFx0XHRcblx0XHRcdC8vIENoZWNrIGlmIGZvbGRlcnMgY29uZmxpY3Rcblx0XHRcdC8vIEJvdGggYmxhbmsgPSBjb25mbGljdCAoYm90aCBtYXRjaCB2YXVsdCByb290KVxuXHRcdFx0aWYgKGN1cnJlbnRGb2xkZXIgPT09IFwiXCIgJiYgb3RoZXJGb2xkZXIgPT09IFwiXCIpIHtcblx0XHRcdFx0Y29uZmxpY3RpbmdUeXBlcy5wdXNoKG90aGVyVHlwZS5uYW1lIHx8IFwiVW5uYW1lZFwiKTtcblx0XHRcdH1cblx0XHRcdC8vIFNhbWUgZm9sZGVyID0gY29uZmxpY3Rcblx0XHRcdGVsc2UgaWYgKGN1cnJlbnRGb2xkZXIgPT09IG90aGVyRm9sZGVyICYmIGN1cnJlbnRGb2xkZXIgIT09IFwiXCIpIHtcblx0XHRcdFx0Y29uZmxpY3RpbmdUeXBlcy5wdXNoKG90aGVyVHlwZS5uYW1lIHx8IFwiVW5uYW1lZFwiKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoY29uZmxpY3RpbmdUeXBlcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRjb25mbGljdFdhcm5pbmdFbC5yZW1vdmVDbGFzcyhcImhpZGRlblwiKTtcblx0XHRcdGNvbmZsaWN0V2FybmluZ0VsLnRleHRDb250ZW50ID0gYENvbmZsaWN0OiAke2NvbmZsaWN0aW5nVHlwZXMuam9pbihcIiwgXCIpfSBhbHNvIHVzZSR7Y29uZmxpY3RpbmdUeXBlcy5sZW5ndGggPT09IDEgPyBcInNcIiA6IFwiXCJ9IHRoaXMgZm9sZGVyLiBNb3JlIHNwZWNpZmljIHBhdHRlcm5zIHdpbGwgdGFrZSBwcmlvcml0eS5gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25mbGljdFdhcm5pbmdFbC5hZGRDbGFzcyhcImhpZGRlblwiKTtcblx0XHR9XG5cdH1cblxuXG5cdHByaXZhdGUgYXN5bmMgbW92ZUNvbnRlbnRUeXBlVXAodHlwZUlkOiBzdHJpbmcpIHtcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRjb25zdCBjdXJyZW50SW5kZXggPSBjb250ZW50VHlwZXMuZmluZEluZGV4KChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkID09PSB0eXBlSWQpO1xuXHRcdFxuXHRcdGlmIChjdXJyZW50SW5kZXggPD0gMCkgcmV0dXJuOyAvLyBBbHJlYWR5IGF0IHRoZSB0b3Bcblx0XHRcblx0XHQvLyBTd2FwIHdpdGggcHJldmlvdXMgaXRlbVxuXHRcdFtjb250ZW50VHlwZXNbY3VycmVudEluZGV4XSwgY29udGVudFR5cGVzW2N1cnJlbnRJbmRleCAtIDFdXSA9IFtjb250ZW50VHlwZXNbY3VycmVudEluZGV4IC0gMV0sIGNvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXhdXTtcblx0XHRzZXR0aW5ncy5jb250ZW50VHlwZXMgPSBjb250ZW50VHlwZXM7XG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db250ZW50VHlwZXMoKTtcblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgbW92ZUNvbnRlbnRUeXBlRG93bih0eXBlSWQ6IHN0cmluZykge1xuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IGN1cnJlbnRJbmRleCA9IGNvbnRlbnRUeXBlcy5maW5kSW5kZXgoKGN0OiBDb250ZW50VHlwZSkgPT4gY3QuaWQgPT09IHR5cGVJZCk7XG5cdFx0XG5cdFx0aWYgKGN1cnJlbnRJbmRleCA8IDAgfHwgY3VycmVudEluZGV4ID49IGNvbnRlbnRUeXBlcy5sZW5ndGggLSAxKSByZXR1cm47IC8vIEFscmVhZHkgYXQgdGhlIGJvdHRvbVxuXHRcdFxuXHRcdC8vIFN3YXAgd2l0aCBuZXh0IGl0ZW1cblx0XHRbY29udGVudFR5cGVzW2N1cnJlbnRJbmRleF0sIGNvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXggKyAxXV0gPSBbY29udGVudFR5cGVzW2N1cnJlbnRJbmRleCArIDFdLCBjb250ZW50VHlwZXNbY3VycmVudEluZGV4XV07XG5cdFx0c2V0dGluZ3MuY29udGVudFR5cGVzID0gY29udGVudFR5cGVzO1xuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdHRoaXMucmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHRvZ2dsZUNvbnRlbnRUeXBlQ29sbGFwc2UodHlwZUlkOiBzdHJpbmcpIHtcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkID09PSB0eXBlSWQpO1xuXHRcdFxuXHRcdGlmICghY29udGVudFR5cGUpIHJldHVybjtcblx0XHRcblx0XHRjb250ZW50VHlwZS5jb2xsYXBzZWQgPSAhY29udGVudFR5cGUuY29sbGFwc2VkO1xuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdHRoaXMudXBkYXRlQ3VzdG9tQ29udGVudFR5cGVWaXNpYmlsaXR5KHR5cGVJZCwgY29udGVudFR5cGUuZW5hYmxlZCk7XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIHJlbW92ZUN1c3RvbUNvbnRlbnRUeXBlKHR5cGVJZDogc3RyaW5nKSB7XG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0c2V0dGluZ3MuY29udGVudFR5cGVzID0gY29udGVudFR5cGVzLmZpbHRlcigoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCAhPT0gdHlwZUlkKTtcblx0XHQvLyBDUklUSUNBTDogQXdhaXQgdGhlIHNhdmUgdG8gZW5zdXJlIGRlbGV0aW9uIGlzIHBlcnNpc3RlZCBiZWZvcmUgYW55IHJlbG9hZHMgaGFwcGVuXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZW5kZXJDdXN0b21Db250ZW50VHlwZXMoKTtcblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XG5cdH1cblxuXHRwcml2YXRlIGdldENvbW1hbmROYW1lKGNvbW1hbmRJZDogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRpZiAoIWNvbW1hbmRJZCkgcmV0dXJuICcnO1xuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBjb21tYW5kUmVnaXN0cnkgPSAodGhpcy5hcHAgYXMgdW5rbm93biBhcyB7IGNvbW1hbmRzPzogeyBsaXN0Q29tbWFuZHM/OiAoKSA9PiBBcnJheTx7IGlkOiBzdHJpbmc7IG5hbWU6IHN0cmluZyB9PjsgY29tbWFuZHM/OiBSZWNvcmQ8c3RyaW5nLCB7IGlkOiBzdHJpbmc7IG5hbWU6IHN0cmluZyB9PiB9IH0pLmNvbW1hbmRzO1xuXHRcdFx0XG5cdFx0XHQvLyBNZXRob2QgMTogVHJ5IGxpc3RDb21tYW5kcygpXG5cdFx0XHRpZiAoY29tbWFuZFJlZ2lzdHJ5ICYmIHR5cGVvZiBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzID09PSAnZnVuY3Rpb24nKSB7XG5cdFx0XHRcdHRyeSB7XG5cdFx0XHRcdFx0Y29uc3QgYWxsQ29tbWFuZHMgPSBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzKCk7XG5cdFx0XHRcdFx0Y29uc3QgY29tbWFuZCA9IGFsbENvbW1hbmRzLmZpbmQoKGNtZDogeyBpZDogc3RyaW5nOyBuYW1lPzogc3RyaW5nIH0pID0+IGNtZC5pZCA9PT0gY29tbWFuZElkKTtcblx0XHRcdFx0XHRpZiAoY29tbWFuZD8ubmFtZSkge1xuXHRcdFx0XHRcdFx0cmV0dXJuIGNvbW1hbmQubmFtZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kIG5hbWUgdmlhIGxpc3RDb21tYW5kcygpOicsIGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdC8vIE1ldGhvZCAyOiBUcnkgYWNjZXNzaW5nIHRoZSBpbnRlcm5hbCBjb21tYW5kcyByZWdpc3RyeSBkaXJlY3RseVxuXHRcdFx0dHJ5IHtcblx0XHRcdFx0Y29uc3QgcmVnaXN0cnkgPSBjb21tYW5kUmVnaXN0cnk/LmNvbW1hbmRzO1xuXHRcdFx0XHRpZiAocmVnaXN0cnkgJiYgdHlwZW9mIHJlZ2lzdHJ5ID09PSAnb2JqZWN0Jykge1xuXHRcdFx0XHRcdGNvbnN0IGNvbW1hbmQgPSAocmVnaXN0cnkgYXMgUmVjb3JkPHN0cmluZywgeyBuYW1lPzogc3RyaW5nIH0+KVtjb21tYW5kSWRdO1xuXHRcdFx0XHRcdGlmIChjb21tYW5kPy5uYW1lKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gY29tbWFuZC5uYW1lO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kIG5hbWUgdmlhIHJlZ2lzdHJ5OicsIGUpO1xuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGUpIHtcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmQgbmFtZTonLCBlKTtcblx0XHR9XG5cdFx0Ly8gUmV0dXJuIGVtcHR5IHN0cmluZyBpZiBjb21tYW5kIG5vdCBmb3VuZCwgc28gaXQgc2hvd3MgXCJTZWxlY3QgY29tbWFuZC4uLlwiIHBsYWNlaG9sZGVyXG5cdFx0cmV0dXJuICcnO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRJY29uTmFtZShpY29uSWQ6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0aWYgKCFpY29uSWQpIHJldHVybiAnJztcblx0XHQvLyBDb252ZXJ0IGljb24gSUQgdG8gYSByZWFkYWJsZSBuYW1lLCByZW1vdmluZyBsdWNpZGUtIHByZWZpeCBpZiBwcmVzZW50XG5cdFx0cmV0dXJuIGljb25JZFxuXHRcdFx0LnJlcGxhY2UoL15sdWNpZGUtLywgJycpIC8vIFJlbW92ZSBsdWNpZGUtIHByZWZpeFxuXHRcdFx0LnNwbGl0KCctJylcblx0XHRcdC5tYXAod29yZCA9PiB3b3JkLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgd29yZC5zbGljZSgxKSlcblx0XHRcdC5qb2luKCcgJyk7XG5cdH1cbn1cbiIsICIvKipcclxuICogQ29tbWFuZCBQaWNrZXIgTW9kYWxcclxuICogU2VhcmNoYWJsZSBtb2RhbCBmb3Igc2VsZWN0aW5nIGFuIE9ic2lkaWFuIGNvbW1hbmRcclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW50ZXJmYWNlIENvbW1hbmRPcHRpb24ge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ29tbWFuZFBpY2tlck1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8Q29tbWFuZE9wdGlvbj4ge1xyXG5cdHByaXZhdGUgb25TZWxlY3Q6IChjb21tYW5kSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoY29tbWFuZElkOiBzdHJpbmcpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtcygpOiBDb21tYW5kT3B0aW9uW10ge1xyXG5cdFx0Ly8gR2V0IGFsbCBhdmFpbGFibGUgY29tbWFuZHNcclxuXHRcdC8vIFRyeSBtdWx0aXBsZSBtZXRob2RzIHRvIGVuc3VyZSB3ZSBnZXQgQUxMIGNvbW1hbmRzLCBub3QganVzdCBjb250ZXh0LWZpbHRlcmVkIG9uZXNcclxuXHRcdGNvbnN0IGNvbW1hbmRSZWdpc3RyeSA9ICh0aGlzLmFwcCBhcyB7IGNvbW1hbmRzPzogeyBsaXN0Q29tbWFuZHM/OiAoKSA9PiBDb21tYW5kT3B0aW9uW107IGNvbW1hbmRzPzogUmVjb3JkPHN0cmluZywgQ29tbWFuZE9wdGlvbj47IGNvbW1hbmRSZWdpc3RyeT86IFJlY29yZDxzdHJpbmcsIENvbW1hbmRPcHRpb24+IH0gfSkuY29tbWFuZHM7XHJcblx0XHRcclxuXHRcdC8vIFVzZSBhIFNldCB0byBkZWR1cGxpY2F0ZSBieSBjb21tYW5kIElEXHJcblx0XHRjb25zdCBjb21tYW5kTWFwID0gbmV3IE1hcDxzdHJpbmcsIENvbW1hbmRPcHRpb24+KCk7XHJcblx0XHRcclxuXHRcdC8vIE1ldGhvZCAxOiBUcnkgbGlzdENvbW1hbmRzKCkgLSBidXQgdGhpcyBtaWdodCBiZSBjb250ZXh0LWZpbHRlcmVkXHJcblx0XHRpZiAoY29tbWFuZFJlZ2lzdHJ5ICYmIHR5cGVvZiBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Y29uc3QgY29tbWFuZHMgPSBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzKCk7XHJcblx0XHRcdFx0Zm9yIChjb25zdCBjb21tYW5kIG9mIGNvbW1hbmRzKSB7XHJcblx0XHRcdFx0XHRpZiAoY29tbWFuZCAmJiBjb21tYW5kLmlkICYmIGNvbW1hbmQubmFtZSAmJiAhY29tbWFuZE1hcC5oYXMoY29tbWFuZC5pZCkpIHtcclxuXHRcdFx0XHRcdFx0Y29tbWFuZE1hcC5zZXQoY29tbWFuZC5pZCwge1xyXG5cdFx0XHRcdFx0XHRcdGlkOiBjb21tYW5kLmlkLFxyXG5cdFx0XHRcdFx0XHRcdG5hbWU6IGNvbW1hbmQubmFtZVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kcyB2aWEgbGlzdENvbW1hbmRzKCk6JywgZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gTWV0aG9kIDI6IFRyeSBhY2Nlc3NpbmcgdGhlIGludGVybmFsIGNvbW1hbmRzIHJlZ2lzdHJ5IGRpcmVjdGx5XHJcblx0XHQvLyBUaGlzIHNob3VsZCBnaXZlIHVzIEFMTCBjb21tYW5kcyByZWdhcmRsZXNzIG9mIGNvbnRleHRcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlZ2lzdHJ5ID0gY29tbWFuZFJlZ2lzdHJ5Py5jb21tYW5kcztcclxuXHRcdFx0aWYgKHJlZ2lzdHJ5ICYmIHR5cGVvZiByZWdpc3RyeSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0XHRjb25zdCBhbGxDb21tYW5kcyA9IE9iamVjdC52YWx1ZXMocmVnaXN0cnkpO1xyXG5cdFx0XHRcdGZvciAoY29uc3QgY29tbWFuZCBvZiBhbGxDb21tYW5kcykge1xyXG5cdFx0XHRcdFx0aWYgKGNvbW1hbmQgJiYgY29tbWFuZC5pZCAmJiBjb21tYW5kLm5hbWUgJiYgIWNvbW1hbmRNYXAuaGFzKGNvbW1hbmQuaWQpKSB7XHJcblx0XHRcdFx0XHRcdGNvbW1hbmRNYXAuc2V0KGNvbW1hbmQuaWQsIHtcclxuXHRcdFx0XHRcdFx0XHRpZDogY29tbWFuZC5pZCxcclxuXHRcdFx0XHRcdFx0XHRuYW1lOiBjb21tYW5kLm5hbWVcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmRzIHZpYSByZWdpc3RyeTonLCBlKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gTWV0aG9kIDM6IFRyeSBhY2Nlc3NpbmcgdmlhIGludGVybmFsIHN0cnVjdHVyZSAoZmFsbGJhY2spXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBpbnRlcm5hbFJlZ2lzdHJ5ID0gY29tbWFuZFJlZ2lzdHJ5Py5jb21tYW5kUmVnaXN0cnk7XHJcblx0XHRcdGlmIChpbnRlcm5hbFJlZ2lzdHJ5ICYmIHR5cGVvZiBpbnRlcm5hbFJlZ2lzdHJ5ID09PSAnb2JqZWN0Jykge1xyXG5cdFx0XHRcdGNvbnN0IGFsbENvbW1hbmRzID0gT2JqZWN0LnZhbHVlcyhpbnRlcm5hbFJlZ2lzdHJ5KTtcclxuXHRcdFx0XHRmb3IgKGNvbnN0IGNvbW1hbmQgb2YgYWxsQ29tbWFuZHMpIHtcclxuXHRcdFx0XHRcdGlmIChjb21tYW5kICYmIGNvbW1hbmQuaWQgJiYgY29tbWFuZC5uYW1lICYmICFjb21tYW5kTWFwLmhhcyhjb21tYW5kLmlkKSkge1xyXG5cdFx0XHRcdFx0XHRjb21tYW5kTWFwLnNldChjb21tYW5kLmlkLCB7XHJcblx0XHRcdFx0XHRcdFx0aWQ6IGNvbW1hbmQuaWQsXHJcblx0XHRcdFx0XHRcdFx0bmFtZTogY29tbWFuZC5uYW1lXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kcyB2aWEgaW50ZXJuYWwgcmVnaXN0cnk6JywgZSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbW1hbmRPcHRpb25zID0gQXJyYXkuZnJvbShjb21tYW5kTWFwLnZhbHVlcygpKTtcclxuXHRcdFxyXG5cdFx0Ly8gU29ydCBhbHBoYWJldGljYWxseSBieSBuYW1lXHJcblx0XHRjb21tYW5kT3B0aW9ucy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIGNvbW1hbmRPcHRpb25zO1xyXG5cdH1cclxuXHJcblx0Z2V0SXRlbVRleHQoaXRlbTogQ29tbWFuZE9wdGlvbik6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gaXRlbS5uYW1lO1xyXG5cdH1cclxuXHJcblx0b25DaG9vc2VJdGVtKGl0ZW06IENvbW1hbmRPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuXHRcdHRoaXMub25TZWxlY3QoaXRlbS5pZCk7XHJcblx0fVxyXG5cclxuXHQvLyBPdmVycmlkZSB0byBzaG93IGNvbW1hbmQgbmFtZSBvbmx5XHJcblx0cmVuZGVyU3VnZ2VzdGlvbihtYXRjaDogeyBpdGVtOiBDb21tYW5kT3B0aW9uIH0sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG5cdFx0Y29uc3QgaXRlbSA9IG1hdGNoLml0ZW07XHJcblx0XHRlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJywgdGV4dDogaXRlbS5uYW1lIH0pO1xyXG5cdH1cclxufVxyXG5cclxuIiwgIi8qKlxyXG4gKiBJY29uIFBpY2tlciBNb2RhbFxyXG4gKiBTZWFyY2hhYmxlIG1vZGFsIGZvciBzZWxlY3RpbmcgYSBMdWNpZGUgaWNvblxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgRnV6enlTdWdnZXN0TW9kYWwsIHNldEljb24sIGdldEljb25JZHMsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW50ZXJmYWNlIEljb25PcHRpb24ge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBHZXQgaWNvbiBsaXN0IGZyb20gT2JzaWRpYW4gQVBJIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBmYWxsYmFjayBsaXN0XHJcbmNvbnN0IGdldEljb25MaXN0ID0gKCk6IHN0cmluZ1tdID0+IHtcclxuXHRpZiAocmVxdWlyZUFwaVZlcnNpb24gJiYgcmVxdWlyZUFwaVZlcnNpb24oJzEuNy4zJykgJiYgZ2V0SWNvbklkcykge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0cmV0dXJuIGdldEljb25JZHMoKTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0Y29uc29sZS53YXJuKCdbQXN0cm8gQ29tcG9zZXJdIEVycm9yIGdldHRpbmcgaWNvbiBJRHMgZnJvbSBPYnNpZGlhbjonLCBlKTtcclxuXHRcdH1cclxuXHR9XHJcblx0Ly8gRmFsbGJhY2sgdG8gYSBiYXNpYyBsaXN0IGlmIEFQSSBpcyBub3QgYXZhaWxhYmxlXHJcblx0cmV0dXJuIFtcclxuXHRcdCdzZXR0aW5ncy0yJywgJ3NldHRpbmdzJywgJ2hlbHAtY2lyY2xlJywgJ2luZm8nLCAnc3RhcicsICdoZWFydCcsICdib29rbWFyaycsXHJcblx0XHQnaG9tZScsICdzZWFyY2gnLCAnYmVsbCcsICdtYWlsJywgJ3VzZXInLCAndXNlcnMnLCAnZm9sZGVyJywgJ2ZpbGUnLCAnZmlsZS10ZXh0JyxcclxuXHRcdCdpbWFnZScsICd2aWRlbycsICdtdXNpYycsICdjYWxlbmRhcicsICdjbG9jaycsICdlZGl0JywgJ3BlbmNpbCcsICd0cmFzaCcsXHJcblx0XHQnY29weScsICdjdXQnLCAncGFzdGUnLCAnZG93bmxvYWQnLCAndXBsb2FkJywgJ3NhdmUnLCAnc2hhcmUnLCAnbGluaycsXHJcblx0XHQnZXh0ZXJuYWwtbGluaycsICdsb2NrJywgJ3VubG9jaycsICdleWUnLCAnZXllLW9mZicsICdrZXknLCAnc2hpZWxkJyxcclxuXHRcdCdjaGVjaycsICd4JywgJ3BsdXMnLCAnbWludXMnLCAnYXJyb3ctbGVmdCcsICdhcnJvdy1yaWdodCcsICdhcnJvdy11cCcsXHJcblx0XHQnYXJyb3ctZG93bicsICdjaGV2cm9uLWxlZnQnLCAnY2hldnJvbi1yaWdodCcsICdjaGV2cm9uLXVwJywgJ2NoZXZyb24tZG93bicsXHJcblx0XHQnbWVudScsICdtb3JlLWhvcml6b250YWwnLCAnbW9yZS12ZXJ0aWNhbCcsICdncmlkJywgJ2xpc3QnLCAnbGF5b3V0JyxcclxuXHRcdCdjb2x1bW5zJywgJ3Jvd3MnLCAnbWF4aW1pemUnLCAnbWluaW1pemUnLCAnem9vbS1pbicsICd6b29tLW91dCcsXHJcblx0XHQncmVmcmVzaC1jdycsICdwbGF5JywgJ3BhdXNlJywgJ3N0b3AnLCAnc3VuJywgJ21vb24nLCAnY2xvdWQnLCAnemFwJyxcclxuXHRcdCd3YW5kLTInLCAnd2FuZCcsICd3YW5kLXNwYXJrbGVzJywgJ3BhbGV0dGUnLCAnYnJ1c2gnLCAnc2xpZGVycycsXHJcblx0XHQncG93ZXInLCAnd2lmaScsICdibHVldG9vdGgnLCAnbW9uaXRvcicsICdsYXB0b3AnLCAnc21hcnRwaG9uZScsXHJcblx0XHQnY2FtZXJhJywgJ21pYycsICdoZWFkcGhvbmVzJywgJ2NvZGUnLCAndGVybWluYWwnLCAndGVybWluYWwtc3F1YXJlJyxcclxuXHRcdCdnaXRodWInLCAnZ2l0bGFiJywgJ2dpdC1icmFuY2gnLCAnZ2l0LWNvbW1pdCcsICdkYXRhYmFzZScsICdzZXJ2ZXInLFxyXG5cdFx0J2Nsb3VkLWRvd25sb2FkJywgJ2Nsb3VkLXVwbG9hZCcsICd0YWcnLCAndGFncycsICdmbGFnJywgJ3BpbicsXHJcblx0XHQnbWFwLXBpbicsICdjb21wYXNzJywgJ2dsb2JlJywgJ3JvY2tldCcsICdjYXInLCAnYmlrZScsICdyb2JvdCcsXHJcblx0XHQnYXBwbGUnLCAnd2luZG93cycsICdsaW51eCcsICdjaHJvbWUnLCAnZmlyZWZveCcsICdzYWZhcmknLFxyXG5cdFx0J2NyZWRpdC1jYXJkJywgJ3dhbGxldCcsICdjb2lucycsICdib29rJywgJ2Jvb2stb3BlbicsICdhd2FyZCcsXHJcblx0XHQndHJvcGh5JywgJ2JhZGdlJywgJ3dyZW5jaCcsICd0b29sJywgJ3BhY2thZ2UnLCAnYm94JywgJ2FyY2hpdmUnLFxyXG5cdFx0J3NlbmQnLCAncmVwbHknLCAnZm9yd2FyZCcsICdtYWlsLW9wZW4nLCAndGFnLXBsdXMnLCAndGFnLW1pbnVzJyxcclxuXHRcdCdmbGFnLW9mZicsICdwaW4tb2ZmJywgJ21hcC1waW4tb2ZmJywgJ25hdmlnYXRpb24nLCAnbWFwJywgJ2VhcnRoJyxcclxuXHRcdCdwbGFuZScsICdzaGlwJywgJ2FuY2hvcicsICdoZWxpY29wdGVyJywgJ2Ryb25lJywgJ2FuZHJvaWQnLFxyXG5cdFx0J2tleWhvbGUnLCAna2V5cycsICdmaW5nZXJwcmludCcsICdzY2FuJywgJ3FyLWNvZGUnLCAnYmFyY29kZScsXHJcblx0XHQncmVjZWlwdCcsICdwaWdneS1iYW5rJywgJ2Jhbmtub3RlJ1xyXG5cdF07XHJcbn07XHJcblxyXG4vLyBDb252ZXJ0IGljb24gSURzIHRvIEljb25PcHRpb24gZm9ybWF0XHJcbmNvbnN0IExVQ0lERV9JQ09OUzogSWNvbk9wdGlvbltdID0gZ2V0SWNvbkxpc3QoKS5tYXAoaWQgPT4gKHtcclxuXHRpZDogaWQsXHJcblx0bmFtZTogaWRcclxuXHRcdC5yZXBsYWNlKC9ebHVjaWRlLS8sICcnKSAvLyBSZW1vdmUgbHVjaWRlLSBwcmVmaXggZm9yIGRpc3BsYXlcclxuXHRcdC5yZXBsYWNlKC8tL2csICcgJylcclxuXHRcdC5yZXBsYWNlKC8oXlxcd3sxfSl8KFxccytcXHd7MX0pL2csIChsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKVxyXG59KSkuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XHJcblxyXG5leHBvcnQgY2xhc3MgSWNvblBpY2tlck1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8SWNvbk9wdGlvbj4ge1xyXG5cdHByaXZhdGUgb25TZWxlY3Q6IChpY29uSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoaWNvbklkOiBzdHJpbmcpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtcygpOiBJY29uT3B0aW9uW10ge1xyXG5cdFx0cmV0dXJuIExVQ0lERV9JQ09OUztcclxuXHR9XHJcblxyXG5cdGdldEl0ZW1UZXh0KGl0ZW06IEljb25PcHRpb24pOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIGl0ZW0ubmFtZTtcclxuXHR9XHJcblxyXG5cdG9uQ2hvb3NlSXRlbShpdGVtOiBJY29uT3B0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcblx0XHR0aGlzLm9uU2VsZWN0KGl0ZW0uaWQpO1xyXG5cdH1cclxuXHJcblx0Ly8gT3ZlcnJpZGUgdG8gc2hvdyBpY29uIHByZXZpZXdcclxuXHRyZW5kZXJTdWdnZXN0aW9uKG1hdGNoOiB7IGl0ZW06IEljb25PcHRpb24gfSwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBpdGVtID0gbWF0Y2guaXRlbTtcclxuXHRcdGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xyXG5cdFx0Y29uc3QgY29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XHJcblx0XHRjb250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnLCB0ZXh0OiBpdGVtLm5hbWUgfSk7XHJcblx0XHRcclxuXHRcdC8vIENyZWF0ZSBpY29uIHByZXZpZXcgdXNpbmcgT2JzaWRpYW4ncyBzZXRJY29uXHJcblx0XHRjb25zdCBhdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XHJcblx0XHRzZXRJY29uKGF1eC5jcmVhdGVTcGFuKHsgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicgfSksIGl0ZW0uaWQpO1xyXG5cdH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb25maXJtTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblx0cmVzdWx0OiBib29sZWFuID0gZmFsc2U7XHJcblx0cmVzb2x2ZVByb21pc2U6ICgocmVzdWx0OiBib29sZWFuKSA9PiB2b2lkKSB8IG51bGwgPSBudWxsO1xyXG5cclxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcHJpdmF0ZSBtZXNzYWdlOiBzdHJpbmcsIHByaXZhdGUgY29uZmlybVRleHQ6IHN0cmluZyA9IFwiQ29uZmlybVwiLCBwcml2YXRlIGNhbmNlbFRleHQ6IHN0cmluZyA9IFwiQ2FuY2VsXCIpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0fVxyXG5cclxuXHRvbk9wZW4oKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdFx0Y29udGVudEVsLmFkZENsYXNzKFwiYXN0cm8tY29tcG9zZXItY29uZmlybS1tb2RhbFwiKTtcclxuXHJcblx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogdGhpcy5tZXNzYWdlIH0pO1xyXG5cclxuXHRcdGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibW9kYWwtYnV0dG9uLWNvbnRhaW5lclwiIH0pO1xyXG5cclxuXHRcdGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IHRoaXMuY2FuY2VsVGV4dCxcclxuXHRcdH0pO1xyXG5cdFx0Y2FuY2VsQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzdWx0ID0gZmFsc2U7XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0Y29uc3QgY29uZmlybUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IHRoaXMuY29uZmlybVRleHQsXHJcblx0XHRcdGNsczogXCJtb2QtY3RhIG1vZC13YXJuaW5nXCIsXHJcblx0XHR9KTtcclxuXHRcdGNvbmZpcm1CdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5yZXN1bHQgPSB0cnVlO1xyXG5cdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0b25DbG9zZSgpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XHJcblx0XHRpZiAodGhpcy5yZXNvbHZlUHJvbWlzZSkge1xyXG5cdFx0XHR0aGlzLnJlc29sdmVQcm9taXNlKHRoaXMucmVzdWx0KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIHdhaXRGb3JSZXN1bHQoKTogUHJvbWlzZTxib29sZWFuPiB7XHJcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHRcdFx0dGhpcy5yZXNvbHZlUHJvbWlzZSA9IHJlc29sdmU7XHJcblx0XHRcdHRoaXMub3BlbigpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59XHJcblxyXG4iLCAiLyoqXHJcbiAqIENvbXBhdGliaWxpdHkgdXRpbGl0aWVzIGZvciBzZXR0aW5nc1xyXG4gKiBQcm92aWRlcyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IGZvciBTZXR0aW5nR3JvdXAgKHJlcXVpcmVzIEFQSSAxLjExLjArKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFNldHRpbmcsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgKiBhcyBPYnNpZGlhbk1vZHVsZSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIHRoYXQgd29ya3Mgd2l0aCBib3RoIFNldHRpbmdHcm91cCBhbmQgZmFsbGJhY2sgY29udGFpbmVyXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCk6IHZvaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgc2V0dGluZ3MgY29udGFpbmVyIHRoYXQgdXNlcyBTZXR0aW5nR3JvdXAgaWYgYXZhaWxhYmxlIChBUEkgMS4xMS4wKyksXHJcbiAqIG90aGVyd2lzZSBmYWxscyBiYWNrIHRvIGNyZWF0aW5nIGEgaGVhZGluZyBhbmQgdXNpbmcgdGhlIGNvbnRhaW5lciBkaXJlY3RseS5cclxuICogXHJcbiAqIFVzZXMgcmVxdWlyZUFwaVZlcnNpb24oJzEuMTEuMCcpIHRvIGNoZWNrIGlmIFNldHRpbmdHcm91cCBpcyBhdmFpbGFibGUuXHJcbiAqIFRoaXMgaXMgdGhlIG9mZmljaWFsIE9ic2lkaWFuIEFQSSBtZXRob2QgZm9yIHZlcnNpb24gY2hlY2tpbmcuXHJcbiAqIFxyXG4gKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgY29udGFpbmVyIGVsZW1lbnQgZm9yIHNldHRpbmdzXHJcbiAqIEBwYXJhbSBoZWFkaW5nIC0gVGhlIGhlYWRpbmcgdGV4dCBmb3IgdGhlIHNldHRpbmdzIGdyb3VwIChvcHRpb25hbClcclxuICogQHJldHVybnMgQSBjb250YWluZXIgdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgc2V0dGluZ3NcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXR0aW5nc0dyb3VwKFxyXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcclxuXHRoZWFkaW5nPzogc3RyaW5nXHJcbik6IFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHQvLyBDaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlIChBUEkgMS4xMS4wKylcclxuXHQvLyByZXF1aXJlQXBpVmVyc2lvbiBpcyB0aGUgb2ZmaWNpYWwgT2JzaWRpYW4gQVBJIG1ldGhvZCBmb3IgdmVyc2lvbiBjaGVja2luZ1xyXG5cdGlmIChyZXF1aXJlQXBpVmVyc2lvbignMS4xMS4wJykpIHtcclxuXHRcdC8vIFVzZSBTZXR0aW5nR3JvdXAgLSBpdCdzIGd1YXJhbnRlZWQgdG8gZXhpc3QgaWYgcmVxdWlyZUFwaVZlcnNpb24gcmV0dXJucyB0cnVlXHJcblx0XHQvLyBBY2Nlc3MgU2V0dGluZ0dyb3VwIHZpYSB0eXBlIGFzc2VydGlvbiBzaW5jZSBpdCBtYXkgbm90IGJlIGluIHR5cGUgZGVmaW5pdGlvbnNcclxuXHRcdC8vIGZvciBvbGRlciBUeXBlU2NyaXB0IHZlcnNpb25zLCBidXQgZXhpc3RzIGF0IHJ1bnRpbWUgaW4gT2JzaWRpYW4gMS4xMS4wK1xyXG5cdFx0Ly8gVXNpbmcgdW5rbm93biBpbnN0ZWFkIG9mIGFueSB0byBzYXRpc2Z5IGVzbGludCB3aGlsZSBtYWludGFpbmluZyB0eXBlIHNhZmV0eVxyXG5cdFx0Y29uc3QgU2V0dGluZ0dyb3VwQ2xhc3MgPSAoT2JzaWRpYW5Nb2R1bGUgYXMgdW5rbm93biBhcyB7IFNldHRpbmdHcm91cD86IG5ldyAoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSA9PiB7XHJcblx0XHRcdHNldEhlYWRpbmcoaGVhZGluZzogc3RyaW5nKToge1xyXG5cdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcclxuXHRcdFx0fTtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG5cdFx0fSB9KS5TZXR0aW5nR3JvdXA7XHJcblx0XHRcclxuXHRcdGlmIChTZXR0aW5nR3JvdXBDbGFzcykge1xyXG5cdFx0XHRjb25zdCBncm91cCA9IGhlYWRpbmcgXHJcblx0XHRcdFx0PyBuZXcgU2V0dGluZ0dyb3VwQ2xhc3MoY29udGFpbmVyRWwpLnNldEhlYWRpbmcoaGVhZGluZylcclxuXHRcdFx0XHQ6IG5ldyBTZXR0aW5nR3JvdXBDbGFzcyhjb250YWluZXJFbCk7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRcdGdyb3VwLmFkZFNldHRpbmcoY2IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0Ly8gRmFsbGJhY2sgcGF0aCAoZWl0aGVyIEFQSSA8IDEuMTEuMCBvciBTZXR0aW5nR3JvdXAgbm90IGZvdW5kKVxyXG5cdHtcclxuXHRcdC8vIEZhbGxiYWNrOiBDcmVhdGUgYSBoZWFkaW5nIG1hbnVhbGx5IGZvciBvbGRlciBBUEkgdmVyc2lvbnNcclxuXHRcdC8vIE5vdGU6IFdoaWxlIGJlc3QgcHJhY3RpY2UgcHJlZmVycyBTZXR0aW5nLnNldEhlYWRpbmcoKSwgdGhlIGZhbGxiYWNrIHBhdGhcclxuXHRcdC8vIGlzIGZvciB2ZXJzaW9ucyB0aGF0IG1heSBub3Qgc3VwcG9ydCBpdCwgc28gbWFudWFsIGhlYWRpbmcgaXMgYXBwcm9wcmlhdGUgaGVyZVxyXG5cdFx0aWYgKGhlYWRpbmcpIHtcclxuXHRcdFx0Y29uc3QgaGVhZGluZ0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdzZXR0aW5nLWdyb3VwLWhlYWRpbmcnKTtcclxuXHRcdFx0aGVhZGluZ0VsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogaGVhZGluZyB9KTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpO1xyXG5cdFx0XHRcdGNiKHNldHRpbmcpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxufVxyXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBNaWdyYXRpb25Db25mbGljdFJlc3VsdCB7XHJcblx0YWN0aW9uOiBcInNraXBcIiB8IFwibWlncmF0ZVwiO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTWlncmF0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcblx0cmVzdWx0OiBNaWdyYXRpb25Db25mbGljdFJlc3VsdCB8IG51bGwgPSBudWxsO1xyXG5cdHJlc29sdmVQcm9taXNlOiAoKHJlc3VsdDogTWlncmF0aW9uQ29uZmxpY3RSZXN1bHQpID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBjb25mbGljdHM6IHN0cmluZ1tdKSB7XHJcblx0XHRzdXBlcihhcHApO1xyXG5cdH1cclxuXHJcblx0b25PcGVuKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcclxuXHRcdGNvbnRlbnRFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLW1pZ3JhdGlvbi1tb2RhbFwiKTtcclxuXHJcblx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiTWlncmF0aW9uIGNvbmZsaWN0IGRldGVjdGVkXCIgfSk7XHJcblxyXG5cdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7XHJcblx0XHRcdHRleHQ6IFwiWW91IGhhdmUgZXhpc3RpbmcgY29udGVudCB0eXBlcyB3aXRoIG5hbWVzIHRoYXQgY29uZmxpY3Qgd2l0aCBwb3N0cyBvciBwYWdlcy4gSG93IHdvdWxkIHlvdSBsaWtlIHRvIHByb2NlZWQ/XCIsXHJcblx0XHR9KTtcclxuXHJcblx0XHRjb25zdCBjb25mbGljdExpc3QgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJ1bFwiKTtcclxuXHRcdGNvbmZsaWN0TGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJTa2lwIG1pZ3JhdGlvbjoga2VlcCB5b3VyIGV4aXN0aW5nIHBvc3RzL3BhZ2VzIHNldHRpbmdzICh0aGV5IHdpbGwgYmUgaWdub3JlZClcIiB9KTtcclxuXHRcdGNvbmZsaWN0TGlzdC5jcmVhdGVFbChcImxpXCIsIHsgdGV4dDogXCJNaWdyYXRlIHdpdGggcmVuYW1lZCB0eXBlczogY3JlYXRlICdwb3N0cyAobWlncmF0ZWQpJyBhbmQgJ3BhZ2VzIChtaWdyYXRlZCknIGNvbnRlbnQgdHlwZXNcIiB9KTtcclxuXHJcblx0XHRjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1vZGFsLWJ1dHRvbi1jb250YWluZXJcIiB9KTtcclxuXHJcblx0XHRjb25zdCBza2lwQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0dGV4dDogXCJTa2lwIG1pZ3JhdGlvblwiLFxyXG5cdFx0XHRjbHM6IFwibW9kLWN0YVwiLFxyXG5cdFx0fSk7XHJcblx0XHRza2lwQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzdWx0ID0geyBhY3Rpb246IFwic2tpcFwiIH07XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0Y29uc3QgbWlncmF0ZUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbChcImJ1dHRvblwiLCB7XHJcblx0XHRcdHRleHQ6IFwiTWlncmF0ZSB3aXRoIHJlbmFtZWQgdHlwZXNcIixcclxuXHRcdFx0Y2xzOiBcIm1vZC1jdGFcIixcclxuXHRcdH0pO1xyXG5cdFx0bWlncmF0ZUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnJlc3VsdCA9IHsgYWN0aW9uOiBcIm1pZ3JhdGVcIiB9O1xyXG5cdFx0XHR0aGlzLmNsb3NlKCk7XHJcblx0XHR9O1xyXG5cdH1cclxuXHJcblx0b25DbG9zZSgpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XHJcblx0XHRpZiAodGhpcy5yZXNvbHZlUHJvbWlzZSAmJiB0aGlzLnJlc3VsdCkge1xyXG5cdFx0XHR0aGlzLnJlc29sdmVQcm9taXNlKHRoaXMucmVzdWx0KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIHdhaXRGb3JSZXN1bHQoKTogUHJvbWlzZTxNaWdyYXRpb25Db25mbGljdFJlc3VsdD4ge1xyXG5cdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG5cdFx0XHR0aGlzLm9wZW4oKTtcclxuXHRcdH0pO1xyXG5cdH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IFRGaWxlLCBIZWFkaW5nQ2FjaGUsIEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBtYXRjaGVzRm9sZGVyUGF0dGVybiwgc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5IH0gZnJvbSBcIi4vcGF0aC1tYXRjaGluZ1wiO1xuXG5leHBvcnQgY2xhc3MgSGVhZGluZ0xpbmtHZW5lcmF0b3Ige1xuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpIHt9XG5cblx0LyoqXG5cdCAqIENvbnZlcnRzIHRleHQgdG8ga2ViYWItY2FzZSBzbHVnIGZvciBVUkxzXG5cdCAqL1xuXHRwcml2YXRlIHRvS2ViYWJDYXNlKHN0cjogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gc3RyXG5cdFx0XHQudG9Mb3dlckNhc2UoKVxuXHRcdFx0LnJlcGxhY2UoL1teYS16MC05XFxzLV0vZywgXCJcIilcblx0XHRcdC50cmltKClcblx0XHRcdC5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKVxuXHRcdFx0LnJlcGxhY2UoLy0rL2csIFwiLVwiKVxuXHRcdFx0LnJlcGxhY2UoL14tfC0kL2csIFwiXCIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdldHMgdGhlIEFzdHJvLWNvbXBhdGlibGUgVVJMIGZyb20gYW4gaW50ZXJuYWwgbGluayAoY29waWVkIGZyb20gTGlua0NvbnZlcnRlcilcblx0ICovXG5cdHByaXZhdGUgZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rKGxpbms6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGFzaEluZGV4ID0gbGluay5pbmRleE9mKCcjJyk7XG5cdFx0bGV0IHBhdGggPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoMCwgaGFzaEluZGV4KSA6IGxpbms7XG5cdFx0Y29uc3QgYW5jaG9yID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKGhhc2hJbmRleCkgOiAnJztcblxuXHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLm1kJC8sIFwiXCIpO1xuXG5cdFx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZSBhbmQgYXBwcm9wcmlhdGUgYmFzZSBwYXRoXG5cdFx0bGV0IGJhc2VQYXRoID0gXCJcIjtcblx0XHRsZXQgY29udGVudEZvbGRlciA9IFwiXCI7XG5cdFx0bGV0IGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiID0gXCJmaWxlXCI7XG5cdFx0bGV0IGluZGV4RmlsZU5hbWUgPSBcIlwiO1xuXG5cdFx0Ly8gQ2hlY2sgYWxsIGNvbnRlbnQgdHlwZXMsIHNvcnRlZCBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIGZpcnN0KVxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IHNvcnRlZFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XG5cdFx0XG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBzb3J0ZWRUeXBlcykge1xuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcblx0XHRcdFxuXHRcdFx0bGV0IG1hdGNoZXMgPSBmYWxzZTtcblx0XHRcdFxuXHRcdFx0Ly8gSGFuZGxlIGJsYW5rIGZvbGRlciAocm9vdCkgLSBtYXRjaGVzIGZpbGVzIGluIHZhdWx0IHJvb3Qgb25seVxuXHRcdFx0aWYgKCFjb250ZW50VHlwZS5mb2xkZXIgfHwgY29udGVudFR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIikge1xuXHRcdFx0XHRpZiAoIXBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IHBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdG1hdGNoZXMgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKHBhdGgsIGNvbnRlbnRUeXBlLmZvbGRlcikpIHtcblx0XHRcdFx0bWF0Y2hlcyA9IHRydWU7XG5cdFx0XHR9XG5cdFx0XHRcblx0XHRcdGlmIChtYXRjaGVzKSB7XG5cdFx0XHRcdGNvbnRlbnRGb2xkZXIgPSBjb250ZW50VHlwZS5mb2xkZXIgfHwgXCJcIjtcblx0XHRcdFx0YmFzZVBhdGggPSBjb250ZW50VHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIjtcblx0XHRcdFx0Y3JlYXRpb25Nb2RlID0gY29udGVudFR5cGUuY3JlYXRpb25Nb2RlO1xuXHRcdFx0XHRpbmRleEZpbGVOYW1lID0gY29udGVudFR5cGUuaW5kZXhGaWxlTmFtZSB8fCBcIlwiO1xuXHRcdFx0XHRicmVhazsgLy8gTW9zdCBzcGVjaWZpYyBwYXR0ZXJuIHdpbnNcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBTdHJpcCBjb250ZW50IGZvbGRlciBpZiBwcmVzZW50XG5cdFx0aWYgKGNvbnRlbnRGb2xkZXIpIHtcblx0XHRcdHBhdGggPSBwYXRoLnNsaWNlKGNvbnRlbnRGb2xkZXIubGVuZ3RoICsgMSk7XG5cdFx0fVxuXG5cdFx0bGV0IGFkZFRyYWlsaW5nU2xhc2ggPSBmYWxzZTtcblx0XHRcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzIHRoZSBpbmRleCBmaWxlIG5hbWUgKHJlZ2FyZGxlc3Mgb2YgY3JlYXRpb24gbW9kZSksXG5cdFx0Ly8gdHJlYXQgaXQgYXMgZm9sZGVyLWJhc2VkIGxvZ2ljXG5cdFx0Ly8gTm90ZTogV2Ugb25seSBzZXQgYWRkVHJhaWxpbmdTbGFzaCBoZXJlOyB0aGUgZmluYWwgY2hlY2sgd2lsbCBwcmV2ZW50IGl0IGlmIHRoZXJlJ3MgYW4gYW5jaG9yXG5cdFx0aWYgKGluZGV4RmlsZU5hbWUgJiYgaW5kZXhGaWxlTmFtZS50cmltKCkgIT09IFwiXCIpIHtcblx0XHRcdGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xuXHRcdFx0aWYgKHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdID09PSBpbmRleEZpbGVOYW1lKSB7XG5cdFx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKGNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0Ly8gRmFsbGJhY2sgdG8gb3JpZ2luYWwgbG9naWMgaWYgbm8gaW5kZXggZmlsZSBuYW1lIGlzIHNwZWNpZmllZFxuXHRcdFx0Ly8gRGVmYXVsdCB0byBcImluZGV4XCIgd2hlbiBpbmRleEZpbGVOYW1lIGlzIGJsYW5rXG5cdFx0XHRjb25zdCBkZWZhdWx0SW5kZXhOYW1lID0gXCJpbmRleFwiO1xuXHRcdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0XHRpZiAocGFydHNbcGFydHMubGVuZ3RoIC0gMV0gPT09IGRlZmF1bHRJbmRleE5hbWUpIHtcblx0XHRcdFx0cGFydHMucG9wKCk7XG5cdFx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbnN0IHNsdWdQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKS5tYXAocGFydCA9PiB0aGlzLnRvS2ViYWJDYXNlKHBhcnQpKTtcblx0XHRjb25zdCBzbHVnID0gc2x1Z1BhcnRzLmpvaW4oJy8nKTtcblxuXHRcdC8vIEZvcm1hdCBiYXNlIHBhdGhcblx0XHRpZiAoYmFzZVBhdGgpIHtcblx0XHRcdGlmICghYmFzZVBhdGguc3RhcnRzV2l0aChcIi9cIikpIGJhc2VQYXRoID0gXCIvXCIgKyBiYXNlUGF0aDtcblx0XHRcdGlmICghYmFzZVBhdGguZW5kc1dpdGgoXCIvXCIpKSBiYXNlUGF0aCArPSBcIi9cIjtcblx0XHR9XG5cblx0XHQvLyBEZXRlcm1pbmUgaWYgd2Ugc2hvdWxkIGFkZCB0cmFpbGluZyBzbGFzaFxuXHRcdC8vIENSSVRJQ0FMOiBOZXZlciBhZGQgdHJhaWxpbmcgc2xhc2ggYmVmb3JlIGFuIGFuY2hvciAoZS5nLiwgL2Fib3V0I2hlYWRpbmcgbm90IC9hYm91dC8jaGVhZGluZylcblx0XHQvLyBUaGlzIGlzIGVzcGVjaWFsbHkgaW1wb3J0YW50IGZvciBhbmNob3IgbGlua3MgZnJvbSBjb3B5IGhlYWRpbmcgVVJMIGZ1bmN0aW9uYWxpdHlcblx0XHQvLyBBbmNob3IgbGlua3Mgc2hvdWxkIE5FVkVSIGhhdmUgdHJhaWxpbmcgc2xhc2hlcywgcmVnYXJkbGVzcyBvZiBzZXR0aW5nc1xuXHRcdGNvbnN0IHNob3VsZEFkZFRyYWlsaW5nU2xhc2ggPSAodGhpcy5zZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoKSAmJiAhYW5jaG9yO1xuXG5cdFx0cmV0dXJuIGAke2Jhc2VQYXRofSR7c2x1Z30ke3Nob3VsZEFkZFRyYWlsaW5nU2xhc2ggPyAnLycgOiAnJ30ke2FuY2hvcn1gO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhIHN0YW5kYXJkIE9ic2lkaWFuIGxpbmsgdG8gYSBoZWFkaW5nLCByZXNwZWN0aW5nIHVzZXIncyBsaW5rIGZvcm1hdCBwcmVmZXJlbmNlXG5cdCAqL1xuXHRnZW5lcmF0ZU9ic2lkaWFuTGluayhhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XG5cdFx0XG5cdFx0Ly8gQ2hlY2sgaWYgdXNlciBwcmVmZXJzIHdpa2lsaW5rcyBieSB0ZXN0aW5nIE9ic2lkaWFuJ3MgZGVmYXVsdCBiZWhhdmlvclxuXHRcdGNvbnN0IHRlc3RMaW5rID0gYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKGZpbGUsICcnLCAnJyk7XG5cdFx0aWYgKHRlc3RMaW5rLnN0YXJ0c1dpdGgoJ1tbJykpIHtcblx0XHRcdC8vIFVzZXIgcHJlZmVycyB3aWtpbGlua3MgLSB1c2UganVzdCB0aGUgZmlsZW5hbWUgKGJhc2VuYW1lKSB3aXRob3V0IHBhdGhcblx0XHRcdGNvbnN0IGZpbGVOYW1lID0gZmlsZS5iYXNlbmFtZTtcblx0XHRcdHJldHVybiBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdUZXh0fXwke2hlYWRpbmdUZXh0fV1dYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gVXNlciBwcmVmZXJzIG1hcmtkb3duIGxpbmtzIC0gdXNlIE9ic2lkaWFuJ3MgbWV0aG9kIHdpdGggaGVhZGluZyB0ZXh0IGFzLWlzIChVUkwtZW5jb2RlZClcblx0XHRcdC8vIEdldCB0aGUgYmFzZSBsaW5rIGZyb20gT2JzaWRpYW4gKHJlc3BlY3RzIHVzZXIncyBwYXRoIHNldHRpbmdzKVxuXHRcdFx0Y29uc3QgYmFzZUxpbmsgPSBhcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoZmlsZSwgJycsICcnKTtcblx0XHRcdC8vIEV4dHJhY3QgdGhlIHBhdGggcGFydCBhbmQgYWRkIG91ciBhbmNob3Igd2l0aCBwcm9wZXIgZGlzcGxheSB0ZXh0XG5cdFx0XHRpZiAoYmFzZUxpbmsuc3RhcnRzV2l0aCgnW1snKSkge1xuXHRcdFx0XHQvLyBUaGlzIHNob3VsZG4ndCBoYXBwZW4gc2luY2Ugd2UncmUgaW4gdGhlIG1hcmtkb3duIGJyYW5jaCwgYnV0IGp1c3QgaW4gY2FzZVxuXHRcdFx0XHRjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cdFx0XHRcdHJldHVybiBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdUZXh0fXwke2hlYWRpbmdUZXh0fV1dYDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIEV4dHJhY3QgdGhlIHBhdGggZnJvbSB0aGUgZ2VuZXJhdGVkIGxpbmsgYW5kIHJlY29uc3RydWN0IHdpdGggcHJvcGVyIGRpc3BsYXkgdGV4dFxuXHRcdFx0XHRjb25zdCBtYXRjaCA9IGJhc2VMaW5rLm1hdGNoKC9cXFsoW15cXF1dKylcXF1cXCgoW14pXSspXFwpLyk7XG5cdFx0XHRcdGlmIChtYXRjaCkge1xuXHRcdFx0XHRcdGNvbnN0IFssICwgcGF0aF0gPSBtYXRjaDtcblx0XHRcdFx0XHQvLyBGb3IgT2JzaWRpYW4sIHVzZSB0aGUgaGVhZGluZyB0ZXh0IGFzLWlzIChVUkwtZW5jb2RlZCksIG5vdCBrZWJhYi1jYXNlXG5cdFx0XHRcdFx0cmV0dXJuIGBbJHtoZWFkaW5nVGV4dH1dKCR7cGF0aH0jJHtlbmNvZGVVUklDb21wb25lbnQoaGVhZGluZ1RleHQpfSlgO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIEZhbGxiYWNrIHRvIG1hbnVhbCBjb25zdHJ1Y3Rpb25cblx0XHRcdFx0XHRjb25zdCBlbmNvZGVkRmlsZW5hbWUgPSBlbmNvZGVVUklDb21wb25lbnQoZmlsZS5uYW1lKTtcblx0XHRcdFx0XHQvLyBGb3IgT2JzaWRpYW4sIHVzZSB0aGUgaGVhZGluZyB0ZXh0IGFzLWlzIChVUkwtZW5jb2RlZClcblx0XHRcdFx0XHRyZXR1cm4gYFske2hlYWRpbmdUZXh0fV0oJHtlbmNvZGVkRmlsZW5hbWV9IyR7ZW5jb2RlVVJJQ29tcG9uZW50KGhlYWRpbmdUZXh0KX0pYDtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYSBzdGFuZGFyZCBPYnNpZGlhbiB3aWtpbGluayB0byBhIGhlYWRpbmdcblx0ICovXG5cdGdlbmVyYXRlT2JzaWRpYW5XaWtpbGluayhmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRjb25zdCBoZWFkaW5nVGV4dCA9IGhlYWRpbmcuaGVhZGluZztcblx0XHQvLyBVc2UganVzdCB0aGUgZmlsZW5hbWUgKGJhc2VuYW1lKSwgbm90IHRoZSBmdWxsIHBhdGhcblx0XHRjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cdFx0cmV0dXJuIGBbWyR7ZmlsZU5hbWV9IyR7aGVhZGluZ1RleHR9fCR7aGVhZGluZ1RleHR9XV1gO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhbiBBc3Ryby1jb21wYXRpYmxlIG1hcmtkb3duIGxpbmsgdG8gYSBoZWFkaW5nXG5cdCAqL1xuXHRnZW5lcmF0ZUFzdHJvTGluayhmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRjb25zdCBoZWFkaW5nVGV4dCA9IGhlYWRpbmcuaGVhZGluZztcblx0XHRjb25zdCBhbmNob3IgPSB0aGlzLnRvS2ViYWJDYXNlKGhlYWRpbmdUZXh0KTtcblx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgdGhlIGV4aXN0aW5nIGxpbmsgY29udmVydGVyXG5cdFx0Y29uc3QgaW50ZXJuYWxMaW5rID0gYCR7ZmlsZS5wYXRofSMke2FuY2hvcn1gO1xuXHRcdGNvbnN0IGFzdHJvVXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsoaW50ZXJuYWxMaW5rKTtcblx0XHRyZXR1cm4gYFske2hlYWRpbmdUZXh0fV0oJHthc3Ryb1VybH0pYDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYW4gQXN0cm8tY29tcGF0aWJsZSB3aWtpbGluayB0byBhIGhlYWRpbmdcblx0ICovXG5cdGdlbmVyYXRlQXN0cm9XaWtpbGluayhmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRjb25zdCBoZWFkaW5nVGV4dCA9IGhlYWRpbmcuaGVhZGluZztcblx0XHRjb25zdCBhbmNob3IgPSB0aGlzLnRvS2ViYWJDYXNlKGhlYWRpbmdUZXh0KTtcblx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgdGhlIGV4aXN0aW5nIGxpbmsgY29udmVydGVyXG5cdFx0Y29uc3QgaW50ZXJuYWxMaW5rID0gYCR7ZmlsZS5wYXRofSMke2FuY2hvcn1gO1xuXHRcdGNvbnN0IGFzdHJvVXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsoaW50ZXJuYWxMaW5rKTtcblx0XHQvLyBDcmVhdGUgYSB3aWtpbGluayB3aXRoIHRoZSBBc3RybyBVUkwgYXMgdGhlIHRhcmdldFxuXHRcdHJldHVybiBgW1ske2hlYWRpbmdUZXh0fXwke2FzdHJvVXJsfV1dYDtcblx0fVxuXG5cdC8qKlxuXHQgKiBFeHRyYWN0cyB0aGUgVVJMIGZyb20gYSBtYXJrZG93biBsaW5rIG9yIHdpa2lsaW5rXG5cdCAqL1xuXHRleHRyYWN0VXJsKGxpbms6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gSGFuZGxlIG1hcmtkb3duIGxpbmtzOiBbdGV4dF0odXJsKVxuXHRcdGNvbnN0IG1hcmtkb3duTWF0Y2ggPSBsaW5rLm1hdGNoKC9cXFsoW15cXF1dKylcXF1cXCgoW14pXSspXFwpLyk7XG5cdFx0aWYgKG1hcmtkb3duTWF0Y2gpIHtcblx0XHRcdHJldHVybiBtYXJrZG93bk1hdGNoWzJdO1xuXHRcdH1cblx0XHRcblx0XHQvLyBIYW5kbGUgd2lraWxpbmtzOiBbW3BhdGgjaGVhZGluZ3x0ZXh0XV0gb3IgW1twYXRoI2hlYWRpbmddXVxuXHRcdGNvbnN0IHdpa2lsaW5rTWF0Y2ggPSBsaW5rLm1hdGNoKC9cXFtcXFsoW15cXF1dKylcXF1cXF0vKTtcblx0XHRpZiAod2lraWxpbmtNYXRjaCkge1xuXHRcdFx0Y29uc3QgY29udGVudCA9IHdpa2lsaW5rTWF0Y2hbMV07XG5cdFx0XHQvLyBFeHRyYWN0IHRoZSBwYXRoIHBhcnQgKGJlZm9yZSB8IGlmIHByZXNlbnQpXG5cdFx0XHRjb25zdCBwYXRoUGFydCA9IGNvbnRlbnQuc3BsaXQoJ3wnKVswXTtcblx0XHRcdHJldHVybiBwYXRoUGFydDtcblx0XHR9XG5cdFx0XG5cdFx0Ly8gSWYgaXQgZG9lc24ndCBtYXRjaCBlaXRoZXIgZm9ybWF0LCByZXR1cm4gYXMtaXMgKG1pZ2h0IGFscmVhZHkgYmUgYSBVUkwpXG5cdFx0cmV0dXJuIGxpbms7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIHRoZSBhcHByb3ByaWF0ZSBsaW5rIGZvcm1hdCBiYXNlZCBvbiBzZXR0aW5nc1xuXHQgKi9cblx0Z2VuZXJhdGVMaW5rKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRpZiAodGhpcy5zZXR0aW5ncy5jb3B5SGVhZGluZ0xpbmtGb3JtYXQgPT09IFwiYXN0cm9cIikge1xuXHRcdFx0Ly8gQXN0cm8gZm9ybWF0IGFsd2F5cyB1c2VzIG1hcmtkb3duIGxpbmtzICh3aWtpbGlua3Mgd2l0aCBBc3RybyBVUkxzIGRvbid0IG1ha2Ugc2Vuc2UpXG5cdFx0XHRyZXR1cm4gdGhpcy5nZW5lcmF0ZUFzdHJvTGluayhmaWxlLCBoZWFkaW5nKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gVXNlIE9ic2lkaWFuJ3MgYnVpbHQtaW4gbWV0aG9kIHdoaWNoIHJlc3BlY3RzIHVzZXIgc2V0dGluZ3Ncblx0XHRcdHJldHVybiB0aGlzLmdlbmVyYXRlT2JzaWRpYW5MaW5rKGFwcCwgZmlsZSwgaGVhZGluZyk7XG5cdFx0fVxuXHR9XG5cblx0LyoqXG5cdCAqIEZpbmRzIHRoZSBoZWFkaW5nIGF0IGEgc3BlY2lmaWMgbGluZSBpbiBhIGZpbGVcblx0ICovXG5cdGZpbmRIZWFkaW5nQXRMaW5lKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgbGluZTogbnVtYmVyKTogSGVhZGluZ0NhY2hlIHwgbnVsbCB7XG5cdFx0Y29uc3QgY2FjaGUgPSBhcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG5cdFx0aWYgKCFjYWNoZSB8fCAhY2FjaGUuaGVhZGluZ3MpIHtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdC8vIEZpbmQgdGhlIGhlYWRpbmcgdGhhdCBjb250YWlucyB0aGlzIGxpbmVcblx0XHRmb3IgKGxldCBpID0gY2FjaGUuaGVhZGluZ3MubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdGNvbnN0IGhlYWRpbmcgPSBjYWNoZS5oZWFkaW5nc1tpXTtcblx0XHRcdGlmIChoZWFkaW5nLnBvc2l0aW9uLnN0YXJ0LmxpbmUgPD0gbGluZSkge1xuXHRcdFx0XHRyZXR1cm4gaGVhZGluZztcblx0XHRcdH1cblx0XHR9XG5cblx0XHRyZXR1cm4gbnVsbDtcblx0fVxufVxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsb0JBTU87OztBQzZFQSxJQUFNLG1CQUFtQixDQUFDLFFBQVEsV0FBVyxZQUFZO0FBRXpELElBQU0sWUFBWTtBQUFBLEVBQ3hCLGFBQWE7QUFBQSxFQUNiLHNCQUFzQjtBQUFBLEVBQ3RCLHdCQUF3QjtBQUFBLEVBQ3hCLDRCQUE0QjtBQUM3Qjs7O0FDckZPLElBQU0sbUJBQTBDO0FBQUEsRUFDdEQsaUJBQ0M7QUFBQSxFQUNELHNCQUFzQjtBQUFBLEVBQ3RCLFlBQVk7QUFBQSxFQUNaLHVCQUF1QjtBQUFBLEVBQ3ZCLHVCQUF1QjtBQUFBLEVBQ3ZCLHlCQUF5QjtBQUFBLEVBQ3pCLDJCQUEyQjtBQUFBLEVBQzNCLHlCQUF5QjtBQUFBLEVBQ3pCLDBCQUEwQjtBQUFBLEVBQzFCLDZCQUE2QjtBQUFBLEVBQzdCLGdCQUFnQjtBQUFBLEVBQ2hCLHdCQUF3QjtBQUFBLEVBQ3hCLGNBQWMsQ0FBQztBQUFBLEVBQ2Ysb0JBQW9CO0FBQUEsRUFDcEIsdUJBQXVCO0FBQUEsSUFDdEIsU0FBUztBQUFBLElBQ1QsV0FBVztBQUFBLElBQ1gsUUFBUTtBQUFBLEVBQ1Q7QUFDRDs7O0FDMUJBLElBQUFDLG1CQUE2Rjs7O0FDQTdGLHNCQUE0Qzs7O0FDa0JyQyxTQUFTLHFCQUFxQixVQUFrQixlQUFnQztBQUV0RixNQUFJLENBQUMsaUJBQWlCLGNBQWMsS0FBSyxNQUFNLElBQUk7QUFHbEQsV0FBTyxDQUFDLFNBQVMsU0FBUyxHQUFHLEtBQU0sU0FBUyxNQUFNLEdBQUcsRUFBRSxXQUFXO0FB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U0FBUyxVQUFVLEtBQUssU0FBUyxTQUFTLGtCQUFrQixHQUFHO0FBQzNFLGlCQUFLLE9BQU87QUFBQSxVQUNiO0FBQUEsUUFDRDtBQUdBLFlBQUksd0JBQXdCLGFBQWEsVUFBVTtBQUNsRCxnQkFBTSxhQUFXLFVBQUssZ0JBQUwsbUJBQWtCLGtCQUFpQjtBQUNwRCxjQUFJLFNBQVMsU0FBUyxRQUFRLEtBQUssU0FBUyxTQUFTLGNBQWMsR0FBRztBQUNyRSxpQkFBSyxPQUFPO0FBQUEsVUFDYjtBQUFBLFFBQ0Q7QUFBQSxNQUNEO0FBQUEsSUFDRDtBQUFBLEVBQ0Q7QUFDRDsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJuZXdGaWxlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImhhc01hdGNoaW5nQ29udGVudFR5cGUiLCAic2V0dGluZ3MiLCAicGx1Z2luSW50ZXJmYWNlIiwgImZpbGUiLCAidHlwZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIl9hIiwgInRvZ2dsZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAidmF1bHRBY3Rpb25zIl0KfQo=
