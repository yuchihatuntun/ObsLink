/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => AstroComposerPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian15 = require("obsidian");

// src/types.ts
var KNOWN_ARRAY_KEYS = ["tags", "aliases", "cssclasses"];
var CONSTANTS = {
  DEBOUNCE_MS: 500,
  STAT_MTIME_THRESHOLD: 1e3,
  EDITOR_STABILIZE_DELAY: 100,
  FILE_EXPLORER_REVEAL_DELAY: 200
};

// src/settings.ts
var DEFAULT_SETTINGS = {
  defaultTemplate: '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
  autoInsertProperties: true,
  dateFormat: "YYYY-MM-DD",
  enableCopyHeadingLink: true,
  copyHeadingLinkFormat: "obsidian",
  addTrailingSlashToLinks: false,
  enableOpenTerminalCommand: false,
  terminalProjectRootPath: "",
  terminalApplicationName: "",
  enableTerminalDebugLogging: false,
  enableTerminalRibbonIcon: false,
  enableOpenConfigFileCommand: false,
  configFilePath: "",
  enableConfigRibbonIcon: false,
  contentTypes: [],
  migrationCompleted: false,
  helpButtonReplacement: {
    enabled: false,
    commandId: "edit-astro-config",
    iconId: "rocket"
  },
  showMdxFilesInExplorer: false,
  processBackgroundFileChanges: true,
  syncDraftDate: false,
  draftProperty: "",
  draftLogic: "true-is-draft",
  publishDateField: "",
  updateModifiedDate: false,
  modifiedDateField: ""
};

// src/commands/index.ts
var import_obsidian5 = require("obsidian");

// src/utils/file-operations.ts
var import_obsidian = require("obsidian");

// src/utils/path-matching.ts
function matchesFolderPattern(filePath, folderPattern) {
  const normalizedFilePath = filePath.toLowerCase();
  const normalizedPattern = folderPattern.toLowerCase().replace(/^\/|\/$/g, "");
  if (!normalizedPattern || normalizedPattern.trim() === "") {
    return !normalizedFilePath.includes("/") || normalizedFilePath.split("/").length === 1;
  }
  if (!normalizedPattern.includes("*")) {
    return normalizedFilePath === normalizedPattern || normalizedFilePath.startsWith(normalizedPattern + "/");
  }
  const escapedPattern = normalizedPattern.replace(/[.+?^${}()|[\]\\]/g, "\\$&").replace(/\*/g, "[^/]+");
  const regexPattern = `^${escapedPattern}(?:/|$)`;
  const regex = new RegExp(regexPattern);
  return regex.test(normalizedFilePath);
}
function getPatternDepth(folderPattern) {
  if (!folderPattern || folderPattern.trim() === "") return 0;
  return folderPattern.split("/").length;
}
function sortByPatternSpecificity(types) {
  return [...types].sort((a, b) => {
    const depthA = getPatternDepth(a.folder);
    const depthB = getPatternDepth(b.folder);
    return depthB - depthA;
  });
}

// src/utils/string-utils.ts
function toKebabCase(str) {
  return str.replace(/([a-z0-9])([A-Z])/g, "$1-$2").replace(/([A-Z])([A-Z][a-z])/g, "$1-$2$3").toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
}

// src/utils/file-operations.ts
var FileOperations = class {
  constructor(app, settings, plugin) {
    this.app = app;
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  generateFilename(title, enableUnderscorePrefix = false) {
    const kebabTitle = toKebabCase(title);
    const safeKebabTitle = kebabTitle || "untitled";
    const prefix = enableUnderscorePrefix ? "_" : "";
    return `${prefix}${safeKebabTitle}`;
  }
  determineType(file) {
    const filePath = file.path;
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return contentType.id;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return contentType.id;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return contentType.id;
            }
          }
        } else {
          return contentType.id;
        }
      }
    }
    return "note";
  }
  getContentType(typeId) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    return contentTypes.find((ct) => ct.id === typeId) || null;
  }
  /**
   * Helper to get content type for a given file path
   */
  getContentTypeByPath(filePath) {
    const dummyFile = { path: filePath };
    const typeId = this.determineType(dummyFile);
    if (typeId === "note") return null;
    return this.getContentType(typeId);
  }
  getTitleKey(type) {
    if (type === "note") return "title";
    const contentType = this.getContentType(type);
    if (!contentType) return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  async createFile(options) {
    var _a;
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to create a ${type}.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = toKebabCase(title);
    const enableUnderscorePrefix = (contentType == null ? void 0 : contentType.enableUnderscorePrefix) || false;
    const prefix = enableUnderscorePrefix ? "_" : "";
    let targetFolder = "";
    if (type === "note") {
      targetFolder = "";
    } else if (contentType) {
      const originalDir = ((_a = file.parent) == null ? void 0 : _a.path) || "";
      if (originalDir === "" || originalDir === "/") {
        targetFolder = contentType.folder || "";
      } else {
        targetFolder = originalDir;
      }
    }
    if (targetFolder) {
      const folder = this.app.vault.getAbstractFileByPath(targetFolder);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(targetFolder);
      }
    }
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType);
    } else {
      return this.createFileStructure(file, kebabTitle, prefix, targetFolder, contentType);
    }
  }
  async createFolderStructure(file, kebabTitle, prefix, targetFolder, type, contentType) {
    const folderName = `${prefix}${kebabTitle}`;
    let folderPath;
    if (targetFolder) {
      folderPath = `${targetFolder}/${folderName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        folderPath = `${currentDir}/${folderName}`;
      } else {
        folderPath = folderName;
      }
    }
    try {
      const folder = this.app.vault.getAbstractFileByPath(folderPath);
      if (!(folder instanceof import_obsidian.TFolder)) {
        await this.app.vault.createFolder(folderPath);
      }
    } catch (e) {
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const fileName = `${indexFileName}${extension}`;
    const newPath = `${folderPath}/${fileName}`;
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        return null;
      }
      setTimeout(() => {
        const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
        if (fileExplorer && fileExplorer.view) {
          const view = fileExplorer.view;
          if (view && typeof view === "object" && "tree" in view) {
            const fileTree = view.tree;
            if (fileTree && newFile instanceof import_obsidian.TFile && typeof fileTree.revealFile === "function") {
              fileTree.revealFile(newFile);
            }
          }
        }
      }, 200);
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a;
        const view = leaf.view;
        if (view && "editor" in view) {
          const editor = view.editor;
          if (editor) {
            const content = editor.getValue();
            if (content) {
              const lines = content.split("\n");
              const lastLine = lines.length - 1;
              const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
              editor.setCursor({ line: lastLine, ch: lastLineLength });
              editor.focus();
              return true;
            }
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to create folder structure: ${errorMessage}.`);
      return null;
    }
  }
  async createFileStructure(file, kebabTitle, prefix, targetFolder, contentType) {
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const newName = `${prefix}${kebabTitle}${extension}`;
    let newPath;
    if (targetFolder) {
      newPath = `${targetFolder}/${newName}`;
    } else {
      const currentDir = file.parent ? file.parent.path : "";
      if (currentDir && currentDir !== "/") {
        newPath = `${currentDir}/${newName}`;
      } else {
        newPath = newName;
      }
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File with name "${newName}" already exists.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      const leaf = this.app.workspace.getLeaf(false);
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a;
        const view = leaf.view;
        if (view && "editor" in view) {
          const editor = view.editor;
          if (editor) {
            const content = editor.getValue();
            if (content) {
              const lines = content.split("\n");
              const lastLine = lines.length - 1;
              const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
              editor.setCursor({ line: lastLine, ch: lastLineLength });
              editor.focus();
              return true;
            }
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
  }
  async renameFile(options) {
    const { file, title, type } = options;
    if (!title) {
      new import_obsidian.Notice(`Title is required to rename the content.`);
      return null;
    }
    const contentType = this.getContentType(type);
    if (!contentType && type !== "note") {
      new import_obsidian.Notice(`Content type ${type} not found.`);
      return null;
    }
    const kebabTitle = toKebabCase(title);
    const prefix = "";
    const creationMode = (contentType == null ? void 0 : contentType.creationMode) || "file";
    if (creationMode === "folder") {
      return this.renameFolderStructure(file, kebabTitle, prefix, type, contentType);
    } else {
      return this.renameFileStructure(file, kebabTitle, prefix, contentType);
    }
  }
  async renameFolderStructure(file, kebabTitle, prefix, type, contentType) {
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "index";
    const isIndex = file.basename === indexFileName;
    if (isIndex) {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      const newFile = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    } else {
      if (!file.parent) {
        new import_obsidian.Notice("Cannot rename: file has no parent folder.");
        return null;
      }
      prefix = file.basename.startsWith("_") ? "_" : "";
      const extension = file.extension;
      const newName = `${prefix}${kebabTitle}.${extension}`;
      const newPath = `${file.parent.path}/${newName}`;
      const existingFile = this.app.vault.getAbstractFileByPath(newPath);
      if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
        new import_obsidian.Notice(`File already exists at ${newPath}.`);
        return null;
      }
      await this.app.fileManager.renameFile(file, newPath);
      const newFile = this.app.vault.getAbstractFileByPath(newPath);
      if (!(newFile instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile;
    }
  }
  async renameFileStructure(file, kebabTitle, prefix, contentType) {
    if (!file.parent) {
      new import_obsidian.Notice("Cannot rename: file has no parent folder.");
      return null;
    }
    const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
    const isIndex = indexFileName && indexFileName.trim() !== "" && file.basename === indexFileName;
    if (isIndex) {
      prefix = file.parent.name.startsWith("_") ? "_" : "";
      const newFolderName = `${prefix}${kebabTitle}`;
      const parentFolder = file.parent.parent;
      if (!parentFolder) {
        new import_obsidian.Notice("Cannot rename: parent folder has no parent.");
        return null;
      }
      let newFolderPath;
      if (parentFolder.path === "" || parentFolder.path === "/") {
        newFolderPath = newFolderName;
      } else {
        newFolderPath = `${parentFolder.path}/${newFolderName}`;
      }
      const existingFolder = this.app.vault.getAbstractFileByPath(newFolderPath);
      if (existingFolder instanceof import_obsidian.TFolder) {
        new import_obsidian.Notice(`Folder already exists at ${newFolderPath}.`);
        return null;
      }
      const newFilePath = `${newFolderPath}/${file.name}`;
      if (this.plugin) {
        this.plugin.pluginCreatedFiles.set(newFilePath, Date.now());
      }
      try {
        await this.app.fileManager.renameFile(file.parent, newFolderPath);
      } catch (error) {
        console.error("FileOperations: Folder rename failed:", error);
        const errorMessage = error instanceof Error ? error.message : String(error);
        new import_obsidian.Notice(`Failed to rename folder: ${errorMessage}.`);
        return null;
      }
      const newFile2 = this.app.vault.getAbstractFileByPath(newFilePath);
      if (!(newFile2 instanceof import_obsidian.TFile)) {
        new import_obsidian.Notice("Failed to locate renamed file.");
        return null;
      }
      return newFile2;
    }
    prefix = file.basename.startsWith("_") ? "_" : "";
    const extension = file.extension;
    const newName = `${prefix}${kebabTitle}.${extension}`;
    let newPath;
    if (file.parent.path === "" || file.parent.path === "/") {
      newPath = newName;
    } else {
      newPath = `${file.parent.path}/${newName}`;
    }
    const existingFile = this.app.vault.getAbstractFileByPath(newPath);
    if (existingFile instanceof import_obsidian.TFile && existingFile !== file) {
      new import_obsidian.Notice(`File already exists at ${newPath}.`);
      return null;
    }
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(newPath, Date.now());
    }
    try {
      await this.app.fileManager.renameFile(file, newPath);
    } catch (error) {
      console.error("FileOperations: File rename failed:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian.Notice(`Failed to rename file: ${errorMessage}.`);
      return null;
    }
    const newFile = this.app.vault.getAbstractFileByPath(newPath);
    if (!(newFile instanceof import_obsidian.TFile)) {
      new import_obsidian.Notice("Failed to locate renamed file.");
      return null;
    }
    return newFile;
  }
};

// src/utils/template-parsing.ts
var import_obsidian2 = require("obsidian");
var TemplateParser = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
  }
  /**
   * Convert a string to kebab-case for slug generation
   */
  toKebabCase(str) {
    return str.toLowerCase().replace(/[^a-z0-9\s-]/g, "").trim().replace(/\s+/g, "-").replace(/-+/g, "-").replace(/^-|-$/g, "");
  }
  parseFrontmatter(content) {
    let propertiesEnd = 0;
    let propertiesText = "";
    const existingProperties = {};
    if (content.startsWith("---")) {
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
      try {
        let currentKey = null;
        const arrayKeys = /* @__PURE__ */ new Set();
        propertiesText.split("\n").forEach((line) => {
          const trimmedLine = line.trim();
          const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
          if (match) {
            const [, key, value] = match;
            currentKey = key;
            const trimmedValue = value ? value.trim() : "";
            const bracketArrayMatch = trimmedValue.match(/^\[(.*)\]$/);
            if (bracketArrayMatch) {
              const arrayContent = bracketArrayMatch[1].trim();
              existingProperties[key] = [];
              arrayKeys.add(key);
              if (arrayContent) {
                const items = [];
                let currentItem = "";
                let inQuotes = false;
                let quoteChar = "";
                for (let i = 0; i < arrayContent.length; i++) {
                  const char = arrayContent[i];
                  if (!inQuotes && (char === '"' || char === "'")) {
                    inQuotes = true;
                    quoteChar = char;
                  } else if (inQuotes && char === quoteChar) {
                    if (i > 0 && arrayContent[i - 1] === "\\") {
                      currentItem += char;
                    } else {
                      inQuotes = false;
                      quoteChar = "";
                    }
                  } else if (!inQuotes && char === ",") {
                    const trimmedItem = currentItem.trim();
                    if (trimmedItem) {
                      const unquoted = trimmedItem.replace(/^["']|["']$/g, "");
                      items.push(unquoted);
                    }
                    currentItem = "";
                  } else {
                    currentItem += char;
                  }
                }
                if (currentItem.trim()) {
                  const trimmedItem = currentItem.trim();
                  const unquoted = trimmedItem.replace(/^["']|["']$/g, "");
                  items.push(unquoted);
                }
                existingProperties[key] = items;
              }
            } else {
              const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
              const isEmptyArray = !trimmedValue || trimmedValue === "";
              const isArrayProperty = isKnownArrayKey || isEmptyArray;
              if (isArrayProperty) {
                existingProperties[key] = [];
                arrayKeys.add(key);
              } else {
                const unquotedValue = trimmedValue.replace(/^["']|["']$/g, "");
                existingProperties[key] = [unquotedValue];
              }
            }
          } else if (currentKey && trimmedLine.startsWith("- ")) {
            const isArrayProperty = arrayKeys.has(currentKey);
            if (isArrayProperty) {
              const item = trimmedLine.replace(/^-\s*/, "");
              if (item) existingProperties[currentKey].push(item);
            }
          } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
            const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
            if (keyMatch) {
              const [, key, value] = keyMatch;
              if (!existingProperties[key]) {
                existingProperties[key] = [value ? value.trim() : ""];
              }
            }
          }
        });
        KNOWN_ARRAY_KEYS.forEach((key) => {
          if (propertiesText.includes(key + ":") && !existingProperties[key]) {
            existingProperties[key] = [];
          }
        });
      } catch (e) {
        new import_obsidian2.Notice("Falling back to template due to parsing error.");
      }
    }
    const bodyContent = content.slice(propertiesEnd);
    return {
      properties: existingProperties,
      propertiesText,
      propertiesEnd,
      bodyContent
    };
  }
  parseTemplate(templateString, title) {
    const templateLines = templateString.split("\n");
    const templateProps = [];
    const templateValues = {};
    let inProperties = false;
    for (let i = 0; i < templateLines.length; i++) {
      const line = templateLines[i].trim();
      if (line === "---") {
        inProperties = !inProperties;
        if (!inProperties) {
          break;
        }
        continue;
      }
      if (inProperties) {
        const match = line.match(/^(\w+):\s*(.*)$/);
        if (match) {
          const [, key, value] = match;
          templateProps.push(key);
          const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
          const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
          const isArrayProperty = isKnownArrayKey || isEmptyArray;
          if (isArrayProperty) {
            if (value && value.startsWith("[")) {
              const items = value.replace(/[[\]]/g, "").split(",").map((t) => t.trim()).filter((t) => t);
              templateValues[key] = items;
            } else {
              templateValues[key] = [];
              for (let j = i + 1; j < templateLines.length; j++) {
                const nextLine = templateLines[j].trim();
                if (nextLine.startsWith("- ")) {
                  const item = nextLine.replace(/^-\s*/, "").trim();
                  if (item) {
                    const arrayValue = templateValues[key];
                    if (Array.isArray(arrayValue)) {
                      arrayValue.push(item);
                    }
                  }
                } else if (nextLine === "---" || nextLine && !nextLine.startsWith("- ") && nextLine.includes(":")) {
                  break;
                }
              }
            }
          } else {
            const slug = this.toKebabCase(title);
            const stringValue = (value || "").replace(/\{\{title\}\}/g, title).replace(/\{\{date\}\}/g, window.moment(/* @__PURE__ */ new Date()).format(this.settings.dateFormat)).replace(/\{\{slug\}\}/g, slug);
            templateValues[key] = stringValue;
          }
        }
      }
    }
    return { templateProps, templateValues };
  }
  buildFrontmatterContent(finalProps, arrayKeys) {
    let newContent = "---\n";
    for (const key in finalProps) {
      const isArrayProperty = KNOWN_ARRAY_KEYS.includes(key) || arrayKeys && arrayKeys.has(key);
      if (isArrayProperty) {
        newContent += `${key}:
`;
        if (finalProps[key].length > 0) {
          finalProps[key].forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${finalProps[key][0] || ""}
`;
      }
    }
    newContent += "---";
    return newContent;
  }
  async updateTitleInFrontmatter(file, newTitle, type) {
    const titleKey = this.getTitleKey(type);
    const hasTitleInTemplate = this.templateHasTitle(type);
    if (!hasTitleInTemplate) {
      return;
    }
    const content = await this.app.vault.read(file);
    let propertiesEnd = 0;
    let propertiesText = "";
    let hasFrontmatter = false;
    if (content.startsWith("---")) {
      hasFrontmatter = true;
      propertiesEnd = content.indexOf("\n---", 3);
      if (propertiesEnd === -1) {
        propertiesEnd = content.length;
      } else {
        propertiesEnd += 4;
      }
      propertiesText = content.slice(4, propertiesEnd - 4).trim();
    }
    const propOrder = [];
    const existing = {};
    let currentKey = null;
    let titleKeyPosition = -1;
    const arrayKeys = /* @__PURE__ */ new Set();
    propertiesText.split("\n").forEach((line, index) => {
      const trimmedLine = line.trim();
      const match = trimmedLine.match(/^([a-zA-Z_][a-zA-Z0-9_-]*):\s*(.*)$/);
      if (match) {
        const [, key, value] = match;
        propOrder.push(key);
        currentKey = key;
        if (key === titleKey) {
          titleKeyPosition = index;
        }
        const isKnownArrayKey = KNOWN_ARRAY_KEYS.includes(key);
        const isEmptyArray = !value || value.trim() === "" || value.trim() === "[]";
        const isArrayProperty = isKnownArrayKey || isEmptyArray;
        if (isArrayProperty) {
          existing[key] = [];
          arrayKeys.add(key);
        } else {
          existing[key] = value ? value.trim() : "";
        }
      } else if (currentKey && arrayKeys.has(currentKey) && trimmedLine.startsWith("- ")) {
        const item = trimmedLine.replace(/^-\s*/, "");
        if (item) existing[currentKey].push(item);
      } else if (trimmedLine && !trimmedLine.startsWith("- ") && !trimmedLine.startsWith("#")) {
        const keyMatch = trimmedLine.match(/^([^:]+):\s*(.*)$/);
        if (keyMatch) {
          const [, key, value] = keyMatch;
          if (!propOrder.includes(key)) {
            propOrder.push(key);
            existing[key] = value ? value.trim() : "";
          }
        }
      }
    });
    let titleVal;
    if (newTitle.includes('"') || newTitle.includes("'") || newTitle.includes("\n") || newTitle.includes("\\")) {
      titleVal = `'${newTitle.replace(/'/g, "''")}'`;
    } else if (newTitle.includes(" ") || newTitle.includes(":") || newTitle.includes("#") || newTitle.includes("@")) {
      titleVal = `"${newTitle.replace(/"/g, '\\"')}"`;
    } else {
      titleVal = newTitle;
    }
    existing[titleKey] = titleVal;
    if ("slug" in existing) {
      const newSlug = this.toKebabCase(newTitle);
      existing["slug"] = newSlug;
    }
    if (titleKeyPosition === -1) {
      propOrder.push(titleKey);
    }
    if (!hasFrontmatter) {
      return;
    }
    let newContent = "---\n";
    for (const key of propOrder) {
      const val = existing[key];
      if (Array.isArray(val)) {
        newContent += `${key}:
`;
        if (val.length > 0) {
          val.forEach((item) => {
            newContent += `  - ${item}
`;
          });
        }
      } else {
        newContent += `${key}: ${val || ""}
`;
      }
    }
    newContent += "---\n";
    const bodyContent = content.slice(propertiesEnd);
    newContent += bodyContent;
    await this.app.vault.modify(file, newContent);
  }
  getTitleKey(type) {
    if (type === "note") return "title";
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType) return "title";
    const template = contentType.template;
    const lines = template.split("\n");
    let inProperties = false;
    for (const line of lines) {
      const trimmed = line.trim();
      if (trimmed === "---") {
        inProperties = !inProperties;
        continue;
      }
      if (inProperties) {
        const match = trimmed.match(/^(\w+):\s*(.+)$/);
        if (match) {
          const key = match[1];
          const value = match[2];
          if (value.includes("{{title}}")) {
            return key;
          }
        }
      }
    }
    return "title";
  }
  // Check if the template for this content type has {{title}}
  templateHasTitle(type) {
    if (type === "note") return true;
    const contentTypes = this.settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === type);
    if (!contentType) return true;
    const template = contentType.template;
    return template.includes("{{title}}");
  }
};

// src/utils/link-conversion.ts
var import_obsidian3 = require("obsidian");
var LinkConverter = class {
  constructor(settings, plugin) {
    this.settings = settings;
    this.plugin = plugin;
  }
  // Get fresh settings from plugin if available, otherwise use stored settings
  getSettings() {
    var _a;
    if ((_a = this.plugin) == null ? void 0 : _a.settings) {
      return this.plugin.settings;
    }
    return this.settings;
  }
  // Local toKebabCase removed, using imported one instead
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.(md|mdx)$/, "");
    const fileExtension = link.endsWith(".mdx") ? ".mdx" : ".md";
    const contentTypeInfo = this.getContentTypeForPath(path + fileExtension);
    let basePath = contentTypeInfo.basePath || "";
    let contentFolder = contentTypeInfo.contentFolder || "";
    let indexFileName = contentTypeInfo.indexFileName || "";
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  getAstroUrlFromInternalLinkWithContext(link, currentFilePath, currentFileContentType) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = decodeURIComponent(path);
    path = path.replace(/\.(md|mdx)$/, "");
    let basePath = "";
    let contentFolder = "";
    let indexFileName = "";
    const fileExtension = link.endsWith(".mdx") ? ".mdx" : ".md";
    const targetContentType = this.getContentTypeForPath(path + fileExtension);
    if (!targetContentType.basePath && currentFileContentType.basePath) {
      basePath = currentFileContentType.basePath;
      indexFileName = currentFileContentType.indexFileName;
      contentFolder = currentFileContentType.contentFolder;
    } else {
      basePath = targetContentType.basePath;
      indexFileName = targetContentType.indexFileName;
      contentFolder = targetContentType.contentFolder;
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    const parts = path.split("/");
    const lastPart = parts[parts.length - 1];
    if (indexFileName && indexFileName.trim() !== "" && lastPart === indexFileName) {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    } else if ((!indexFileName || indexFileName.trim() === "") && lastPart === "index") {
      parts.pop();
      path = parts.join("/");
      addTrailingSlash = true;
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) {
        basePath = "/" + basePath;
      }
      if (!basePath.endsWith("/")) {
        basePath += "/";
      }
    } else {
      basePath = "/";
    }
    const settings = this.getSettings();
    const shouldAddTrailingSlash = (settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  isInConfiguredContentDirectory(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return true;
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return true;
            }
          } else {
            if (pathDepth === expectedDepth) {
              return true;
            }
          }
        } else {
          return true;
        }
      }
    }
    return false;
  }
  getContentTypeForPath(filePath) {
    const settings = this.getSettings();
    const contentTypes = settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!filePath.includes("/") || filePath.split("/").length === 1) {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: ""
          };
        }
      } else if (matchesFolderPattern(filePath, contentType.folder)) {
        if (contentType.ignoreSubfolders) {
          const pathSegments = filePath.split("/");
          const pathDepth = pathSegments.length;
          const patternSegments = contentType.folder.split("/");
          const expectedDepth = patternSegments.length;
          if (contentType.creationMode === "folder") {
            const folderDepth = pathDepth - 1;
            if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          } else {
            if (pathDepth === expectedDepth) {
              return {
                basePath: contentType.linkBasePath || "",
                creationMode: contentType.creationMode,
                indexFileName: contentType.indexFileName || "",
                contentFolder: contentType.folder
              };
            }
          }
        } else {
          return {
            basePath: contentType.linkBasePath || "",
            creationMode: contentType.creationMode,
            indexFileName: contentType.indexFileName || "",
            contentFolder: contentType.folder
          };
        }
      }
    }
    return {
      basePath: "",
      creationMode: "file",
      indexFileName: "",
      contentFolder: ""
    };
  }
  convertWikilinksForAstro(editor, file) {
    var _a, _b;
    if (!(file instanceof import_obsidian3.TFile)) {
      new import_obsidian3.Notice("No active file.");
      return;
    }
    const cursor = editor.getCursor();
    const originalLine = cursor.line;
    const originalCh = cursor.ch;
    const originalContent = editor.getValue();
    const originalLineCount = originalContent.split("\n").length;
    const originalLineLength = ((_a = originalContent.split("\n")[originalLine]) == null ? void 0 : _a.length) || 0;
    const content = editor.getValue();
    let newContent = content;
    let convertedCount = 0;
    let skippedCount = 0;
    const skippedLinks = [];
    const currentFileContentType = this.getContentTypeForPath(file.path);
    const imageExtensions = /\.(png|jpg|jpeg|gif|svg)$/i;
    const canConvertLink = (linkText) => {
      if (imageExtensions.test(linkText)) {
        return false;
      }
      if (linkText.match(/^https?:\/\//)) {
        return false;
      }
      if (!linkText.includes(".md") && !linkText.includes(".mdx") && !linkText.match(/^[a-zA-Z0-9_-]+(\/[a-zA-Z0-9_-]+)*$/)) {
        return false;
      }
      let targetPath;
      if (linkText.endsWith(".md") || linkText.endsWith(".mdx")) {
        targetPath = linkText;
      } else {
        targetPath = linkText + ".md";
      }
      const isInConfiguredDirectory = this.isInConfiguredContentDirectory(targetPath);
      const isSimpleFilename = !targetPath.includes("/");
      const hasCurrentContentType = currentFileContentType.basePath !== "" || currentFileContentType.creationMode !== "file" || currentFileContentType.indexFileName !== "";
      return isInConfiguredDirectory || isSimpleFilename && hasCurrentContentType;
    };
    newContent = newContent.replace(
      /\[\[([^\]|]+)(\|([^\]]+))?\]\]/g,
      (match, linkText, _pipe, displayText) => {
        if (imageExtensions.test(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        if (!canConvertLink(linkText)) {
          skippedCount++;
          skippedLinks.push(linkText);
          return match;
        }
        const display = displayText || linkText.replace(/\.(md|mdx)$/, "");
        const url = this.getAstroUrlFromInternalLinkWithContext(linkText, file.path, currentFileContentType);
        convertedCount++;
        return `[${display}](${url})`;
      }
    );
    newContent = newContent.replace(
      /\[([^\]]+)\]\(([^)]+\.(md|mdx)[^)]*)\)/g,
      (match, displayText, link) => {
        if (link.match(/^https?:\/\//) || imageExtensions.test(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        if (!canConvertLink(link)) {
          skippedCount++;
          skippedLinks.push(link);
          return match;
        }
        const url = this.getAstroUrlFromInternalLinkWithContext(link, file.path, currentFileContentType);
        convertedCount++;
        return `[${displayText}](${url})`;
      }
    );
    newContent = newContent.replace(
      /!\[(.*?)\]\(([^)]+)\)/g,
      (match) => {
        skippedCount++;
        return match;
      }
    );
    newContent = newContent.replace(/\{\{([^}]+)\}\}/g, (match, fileName) => {
      if (imageExtensions.test(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      if (!canConvertLink(fileName)) {
        skippedCount++;
        skippedLinks.push(fileName);
        return match;
      }
      const url = this.getAstroUrlFromInternalLinkWithContext(fileName, file.path, currentFileContentType);
      convertedCount++;
      return `[Embedded: ${fileName}](${url})`;
    });
    editor.setValue(newContent);
    const newLineCount = newContent.split("\n").length;
    const newLineLength = ((_b = newContent.split("\n")[originalLine]) == null ? void 0 : _b.length) || 0;
    let newLine = originalLine;
    let newCh = originalCh;
    if (newLineCount !== originalLineCount) {
      if (newLine >= newLineCount) {
        newLine = Math.max(0, newLineCount - 1);
      }
    }
    if (newLineLength !== originalLineLength) {
      if (newCh > newLineLength) {
        newCh = Math.max(0, newLineLength);
      }
    }
    editor.setCursor({ line: newLine, ch: newCh });
    if (convertedCount > 0 && skippedCount === 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} internal link${convertedCount > 1 ? "s" : ""} for Astro.`);
    } else if (convertedCount > 0 && skippedCount > 0) {
      new import_obsidian3.Notice(`Converted ${convertedCount} link${convertedCount > 1 ? "s" : ""} for Astro. Skipped ${skippedCount} link${skippedCount > 1 ? "s" : ""} outside configured content directories.`);
    } else if (skippedCount > 0) {
      new import_obsidian3.Notice(`No links converted. All ${skippedCount} link${skippedCount > 1 ? "s" : ""} are outside configured content directories or are images/external links.`);
    } else {
      new import_obsidian3.Notice("No internal links found to convert.");
    }
  }
};

// src/ui/title-modal.ts
var import_obsidian4 = require("obsidian");
var TitleModal = class extends import_obsidian4.Modal {
  constructor(app, file, plugin, type, isRename = false, isNewNote = false) {
    super(app);
    this.file = file;
    this.plugin = plugin;
    this.type = type;
    this.isRename = isRename;
    this.isNewNote = isNewNote;
    const settings = plugin.settings;
    this.fileOps = new FileOperations(app, settings, plugin);
    this.templateParser = new TemplateParser(app, settings);
  }
  async getCurrentTitleAsync() {
    if (!this.file) {
      return "";
    }
    try {
      const content = await this.app.vault.read(this.file);
      const titleKey = this.fileOps.getTitleKey(this.type);
      const { properties } = this.templateParser.parseFrontmatter(content);
      if (titleKey in properties) {
        const titleValue = properties[titleKey];
        if (Array.isArray(titleValue) && titleValue.length > 0) {
          return String(titleValue[0]);
        }
        if (titleValue !== null && titleValue !== void 0) {
          return String(titleValue);
        }
      }
    } catch (error) {
      console.error("Error reading file for title:", error);
    }
    return this.getFallbackTitle();
  }
  getCurrentTitle() {
    if (!this.file) {
      return "";
    }
    const titleKey = this.fileOps.getTitleKey(this.type);
    const cache = this.app.metadataCache.getFileCache(this.file);
    if ((cache == null ? void 0 : cache.frontmatter) && titleKey in cache.frontmatter) {
      const titleValue = cache.frontmatter[titleKey];
      if (typeof titleValue === "string") {
        return titleValue;
      }
      if (Array.isArray(titleValue) && titleValue.length > 0) {
        const firstValue = titleValue[0];
        if (typeof firstValue === "string") {
          return firstValue;
        }
        if (firstValue != null) {
          if (typeof firstValue === "number" || typeof firstValue === "boolean") {
            return String(firstValue);
          }
          if (typeof firstValue === "string") {
            return firstValue;
          }
        }
      }
      if (titleValue == null) {
        return "";
      }
      if (typeof titleValue === "number" || typeof titleValue === "boolean") {
        return String(titleValue);
      }
      if (typeof titleValue === "string") {
        return titleValue;
      }
      return "";
    }
    return this.getFallbackTitle();
  }
  getFallbackTitle() {
    if (!this.file) {
      return "";
    }
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    return basename.replace(/-/g, " ").split(" ").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
  /**
   * Extracts a suggested title from the file basename for newly created files.
   * This is used when a file is created from a link (e.g., [[sEfsleif]]).
   * Preserves the original text as much as possible.
   */
  getSuggestedTitleFromBasename() {
    if (!this.file) {
      return "";
    }
    let basename = this.file.basename;
    if (this.file.parent && this.type !== "note") {
      const contentType = this.fileOps.getContentType(this.type);
      const indexFileName = (contentType == null ? void 0 : contentType.indexFileName) || "";
      if (indexFileName.trim() !== "" && basename === indexFileName) {
        basename = this.file.parent.name;
      }
    }
    if (basename.startsWith("_")) {
      basename = basename.slice(1);
    }
    return basename;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    const isMobile = window.innerWidth <= 768 || import_obsidian4.Platform.isMobile;
    if (isMobile) {
      this.modalEl.addClass("astro-composer-mobile-modal");
    }
    if (this.isRename) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "Rename content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Rename ${typeName} content` });
        contentEl.createEl("p", { text: `Enter new title for your ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      void this.getCurrentTitleAsync().then((title) => {
        this.titleInput.value = title;
      });
    } else if (this.isNewNote) {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
    } else {
      const typeName = this.getTypeDisplayName();
      if (this.type === "note") {
        contentEl.createEl("h2", { text: "New content" });
        contentEl.createEl("p", { text: "Enter a title for this content:" });
      } else {
        contentEl.createEl("h2", { text: `Create new ${typeName} content` });
        contentEl.createEl("p", { text: `Enter a title for your new ${typeName} content:` });
      }
      this.titleInput = contentEl.createEl("input", {
        type: "text",
        placeholder: "New Title",
        cls: "astro-composer-title-input"
      });
      if (this.file) {
        const suggestedTitle = this.getSuggestedTitleFromBasename();
        if (suggestedTitle) {
          this.titleInput.value = suggestedTitle;
        }
      }
    }
    this.titleInput.focus();
    if (this.isNewNote) {
      setTimeout(() => {
        this.titleInput.setSelectionRange(0, 0);
      }, 0);
    }
    const buttonContainer = contentEl.createDiv({ cls: "astro-composer-button-container" });
    const cancelButton = buttonContainer.createEl("button", { text: "Cancel", cls: "astro-composer-cancel-button" });
    cancelButton.onclick = () => this.close();
    const submitButton = buttonContainer.createEl("button", { text: this.isRename ? "Rename" : "Create", cls: ["astro-composer-create-button", "mod-cta"] });
    submitButton.onclick = () => this.submit();
    this.titleInput.addEventListener("keypress", (e) => {
      if (e.key === "Enter") void this.submit();
    });
  }
  async submit() {
    const title = this.titleInput.value.trim();
    if (!title) {
      new import_obsidian4.Notice("Please enter a title.");
      return;
    }
    try {
      let newFile = null;
      if (this.isRename) {
        newFile = await this.fileOps.renameFile({ file: this.file, title, type: this.type });
        if (newFile) {
          await this.templateParser.updateTitleInFrontmatter(newFile, title, this.type);
        } else {
          this.close();
          return;
        }
      } else if (this.isNewNote) {
        if (this.file) {
          newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
          const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
          if (newFile && shouldInsertProperties) {
            await this.addPropertiesToFile(newFile, title, this.type);
            this.positionCursorAtEnd(newFile);
          }
        }
      } else if (this.file) {
        newFile = await this.fileOps.createFile({ file: this.file, title, type: this.type });
        const shouldInsertProperties = this.plugin.settings.autoInsertProperties;
        if (newFile && shouldInsertProperties) {
          await this.addPropertiesToFile(newFile, title, this.type);
          this.positionCursorAtEnd(newFile);
        }
      } else {
        newFile = await this.createNewFile(title);
      }
      if (!newFile) {
        new import_obsidian4.Notice(`Failed to ${this.isRename ? "rename" : "create"} ${this.type}.`);
        this.close();
        return;
      }
    } catch (error) {
      console.error("TitleModal: Error during process:", error);
      const errorMessage = error instanceof Error ? error.message : String(error);
      new import_obsidian4.Notice(`Error ${this.isRename ? "renaming" : "creating"} ${this.type}: ${errorMessage}.`);
      this.close();
      return;
    }
    this.close();
  }
  getTypeDisplayName() {
    if (this.type === "note") {
      return "Content";
    }
    const contentType = this.fileOps.getContentType(this.type);
    return contentType ? contentType.name : "Content";
  }
  async createNewFile(title) {
    var _a, _b;
    let targetFolder;
    const originalDir = ((_b = (_a = this.file) == null ? void 0 : _a.parent) == null ? void 0 : _b.path) || "";
    if (this.type !== "note") {
      const contentType2 = this.fileOps.getContentType(this.type);
      if (originalDir === "" || originalDir === "/") {
        targetFolder = (contentType2 == null ? void 0 : contentType2.folder) || "";
      } else {
        targetFolder = originalDir;
      }
    } else {
      targetFolder = originalDir;
    }
    const filename = this.fileOps.generateFilename(title);
    const contentType = this.fileOps.getContentType(this.type);
    const extension = (contentType == null ? void 0 : contentType.useMdxExtension) ? ".mdx" : ".md";
    const filePath = targetFolder ? `${targetFolder}/${filename}${extension}` : `${filename}${extension}`;
    if (this.plugin) {
      this.plugin.pluginCreatedFiles.set(filePath, Date.now());
    }
    let initialContent = "";
    if (this.plugin.settings.autoInsertProperties) {
      initialContent = this.generateInitialContent(title);
    }
    try {
      const newFile = await this.app.vault.create(filePath, initialContent);
      const leaf = this.app.workspace.getLeaf();
      await leaf.openFile(newFile);
      const positionCursor = () => {
        var _a2;
        const view = leaf.view;
        if (view instanceof import_obsidian4.MarkdownView && view.editor) {
          const editor = view.editor;
          const content = editor.getValue();
          if (content) {
            const lines = content.split("\n");
            const lastLine = lines.length - 1;
            const lastLineLength = ((_a2 = lines[lastLine]) == null ? void 0 : _a2.length) || 0;
            editor.setCursor({ line: lastLine, ch: lastLineLength });
            editor.focus();
            return true;
          }
        }
        return false;
      };
      setTimeout(() => {
        if (!positionCursor()) {
          setTimeout(() => {
            positionCursor();
          }, 200);
        }
      }, 100);
      return newFile;
    } catch (error) {
      const errorMessage = error instanceof Error ? error.message : String(error);
      throw new Error(`Failed to create file: ${errorMessage}`);
    }
  }
  generateInitialContent(title) {
    const now = /* @__PURE__ */ new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    const slug = toKebabCase(title);
    let template;
    if (this.type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(this.type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    template = template.replace(/\{\{slug\}\}/g, slug);
    return template;
  }
  async addPropertiesToFile(file, title, type) {
    const now = /* @__PURE__ */ new Date();
    const dateString = window.moment(now).format(this.plugin.settings.dateFormat);
    const slug = toKebabCase(title);
    let template;
    if (type === "note") {
      const escapedTitle = this.escapeYamlString(title);
      template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
    } else {
      const contentType = this.fileOps.getContentType(type);
      if (!contentType) {
        const escapedTitle = this.escapeYamlString(title);
        template = `---
title: ${escapedTitle}
date: ${dateString}
---
`;
      } else {
        template = contentType.template;
      }
    }
    template = template.replace(/\{\{title\}\}/g, title);
    template = template.replace(/\{\{date\}\}/g, dateString);
    template = template.replace(/\{\{slug\}\}/g, slug);
    await this.app.vault.modify(file, template);
  }
  positionCursorAtEnd(file) {
    const positionCursor = () => {
      var _a;
      const view = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
      if (view && view.file === file && view.editor) {
        const editor = view.editor;
        const content = editor.getValue();
        if (content) {
          const lines = content.split("\n");
          const lastLine = lines.length - 1;
          const lastLineLength = ((_a = lines[lastLine]) == null ? void 0 : _a.length) || 0;
          editor.setCursor({ line: lastLine, ch: lastLineLength });
          editor.focus();
          return true;
        }
      }
      return false;
    };
    setTimeout(() => {
      if (!positionCursor()) {
        setTimeout(() => {
          positionCursor();
        }, 200);
      }
    }, 100);
  }
  escapeYamlString(str) {
    if (str.includes('"') || str.includes("'") || str.includes("\n") || str.includes("\\")) {
      return `'${str.replace(/'/g, "''")}'`;
    } else if (str.includes(" ") || str.includes(":") || str.includes("#") || str.includes("@")) {
      return `"${str.replace(/"/g, '\\"')}"`;
    } else {
      return str;
    }
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};

// src/commands/index.ts
function registerCommands(plugin, settings) {
  const isMobile = import_obsidian5.Platform.isMobile;
  if (isMobile) {
    let hasMatchingContentType2 = function(file, settings2) {
      const type = fileOps.determineType(file);
      if (type === "note") {
        return false;
      }
      const contentType = fileOps.getContentType(type);
      return contentType !== null && contentType.enabled;
    };
    var hasMatchingContentType = hasMatchingContentType2;
    const pluginInterface2 = plugin;
    const fileOps = new FileOperations(plugin.app, settings, pluginInterface2);
    const linkConverter = new LinkConverter(settings, pluginInterface2);
    plugin.addCommand({
      id: "standardize-properties",
      name: "Standardize properties",
      icon: "file-check",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          const currentSettings = pluginInterface2.settings || settings;
          void standardizeProperties(plugin.app, currentSettings, file, pluginInterface2, editor);
        }
      }
    });
    plugin.addCommand({
      id: "convert-wikilinks-astro",
      name: "Convert internal links for astro",
      icon: "link-2",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          linkConverter.convertWikilinksForAstro(editor, file);
        }
      }
    });
    plugin.addCommand({
      id: "rename-content",
      name: "Rename current content",
      icon: "pencil",
      editorCallback: (editor, ctx) => {
        const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
        if (file instanceof import_obsidian5.TFile) {
          if (!hasMatchingContentType2(file, settings)) {
            new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
            return;
          }
          const type = fileOps.determineType(file);
          const cache = plugin.app.metadataCache.getFileCache(file);
          const titleKey = fileOps.getTitleKey(type);
          if (!(cache == null ? void 0 : cache.frontmatter) || !(titleKey in cache.frontmatter)) {
            new import_obsidian5.Notice(`Cannot rename: No ${titleKey} found in properties`);
            return;
          }
          new TitleModal(plugin.app, file, plugin, type, true).open();
        }
      }
    });
    return;
  }
  const pluginInterface = plugin;
  function hasMatchingContentType(file, settings2) {
    const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings2;
    const tempFileOps = new FileOperations(plugin.app, currentSettings, plugin);
    const type = tempFileOps.determineType(file);
    if (type === "note") {
      return false;
    }
    const contentType = tempFileOps.getContentType(type);
    return contentType !== null && contentType.enabled;
  }
  plugin.addCommand({
    id: "standardize-properties",
    name: "Standardize properties",
    icon: "file-check",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        void standardizeProperties(plugin.app, settings, file, plugin, editor);
      }
    }
  });
  plugin.addCommand({
    id: "convert-wikilinks-astro",
    name: "Convert internal links for astro",
    icon: "link-2",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentLinkConverter = new LinkConverter(currentSettings, pluginInterface);
        currentLinkConverter.convertWikilinksForAstro(editor, file);
      }
    }
  });
  plugin.addCommand({
    id: "rename-content",
    name: "Rename current content",
    icon: "pencil",
    editorCallback: (editor, ctx) => {
      const file = ctx instanceof import_obsidian5.MarkdownView ? ctx.file : ctx.file;
      if (file instanceof import_obsidian5.TFile) {
        const currentSettings = pluginInterface.settings || settings;
        const currentFileOps = new FileOperations(plugin.app, currentSettings, pluginInterface);
        if (!hasMatchingContentType(file, currentSettings)) {
          new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
          return;
        }
        const type = currentFileOps.determineType(file);
        new TitleModal(plugin.app, file, pluginInterface, type, true).open();
      }
    }
  });
  if (!isMobile) {
    plugin.addCommand({
      id: "open-project-terminal",
      name: "Open project terminal",
      icon: "terminal-square",
      callback: () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenTerminalCommand) {
          new import_obsidian5.Notice("Open terminal command is disabled. Enable it in settings to use this command.");
          return;
        }
        openTerminalInProjectRoot(plugin.app, currentSettings);
      }
    });
  }
  if (!isMobile) {
    plugin.addCommand({
      id: "edit-astro-config",
      name: "Edit astro config",
      icon: "rocket",
      callback: async () => {
        const currentSettings = plugin.settings;
        if (!currentSettings.enableOpenConfigFileCommand) {
          new import_obsidian5.Notice("Edit config file command is disabled. Enable it in settings to use this command.");
          return;
        }
        await openConfigFile(plugin.app, currentSettings);
      }
    });
  }
}
async function standardizeProperties(app, settings, file, plugin, editor) {
  var _a;
  const currentSettings = (plugin == null ? void 0 : plugin.settings) || settings;
  const templateParser = new TemplateParser(app, currentSettings);
  const fileOps = new FileOperations(app, currentSettings, plugin);
  let cursorPosition = null;
  let originalContent = "";
  if (editor) {
    const cursor = editor.getCursor();
    cursorPosition = { line: cursor.line, ch: cursor.ch };
    originalContent = editor.getValue();
  }
  const type = fileOps.determineType(file);
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  let templateString;
  if (type === "note") {
    new import_obsidian5.Notice("No properties template specified for this content. This file doesn't match any configured content type folders.");
    return;
  }
  const contentType = fileOps.getContentType(type);
  if (!contentType) {
    new import_obsidian5.Notice("Content type not found.");
    return;
  }
  templateString = contentType.template;
  await new Promise((resolve) => setTimeout(resolve, 100));
  const content = await app.vault.read(file);
  const title = file.basename.replace(/^_/, "");
  const parsed = templateParser.parseFrontmatter(content);
  const { templateProps, templateValues } = templateParser.parseTemplate(templateString, title);
  const finalProps = { ...parsed.properties };
  const arrayKeys = /* @__PURE__ */ new Set();
  const slug = toKebabCase(title);
  for (const key of templateProps) {
    if (!(key in parsed.properties)) {
      const templateValue = templateValues[key];
      if (Array.isArray(templateValue)) {
        finalProps[key] = templateValue;
        arrayKeys.add(key);
      } else {
        finalProps[key] = [templateValue || ""];
      }
    } else {
      const templateValue = templateValues[key];
      const isArrayValue = Array.isArray(templateValue);
      if (isArrayValue) {
        const existingItems = parsed.properties[key] || [];
        const newItems = templateValue.filter((item) => !existingItems.includes(item));
        finalProps[key] = [...existingItems, ...newItems];
        arrayKeys.add(key);
      } else {
        if (key === "slug") {
          const existingSlug = parsed.properties[key][0] || "";
          if (!existingSlug || existingSlug.trim() === "") {
            finalProps[key] = [slug];
          }
        }
      }
    }
  }
  if ("slug" in parsed.properties && templateString.includes("{{slug}}")) {
    const existingSlug = parsed.properties["slug"][0] || "";
    if (!existingSlug || existingSlug.trim() === "") {
      finalProps["slug"] = [slug];
    }
  }
  for (const key in parsed.properties) {
    if (parsed.properties[key].length > 1) {
      arrayKeys.add(key);
    }
  }
  const newContent = templateParser.buildFrontmatterContent(finalProps, arrayKeys) + parsed.bodyContent;
  await app.vault.modify(file, newContent);
  if (editor && cursorPosition) {
    await new Promise((resolve) => setTimeout(resolve, 50));
    const activeView = app.workspace.getActiveViewOfType(import_obsidian5.MarkdownView);
    if (activeView && activeView.file === file && activeView.editor) {
      const activeEditor = activeView.editor;
      const newLineCount = newContent.split("\n").length;
      const originalLineCount = originalContent.split("\n").length;
      let newLine = cursorPosition.line;
      let newCh = cursorPosition.ch;
      if (newLineCount !== originalLineCount) {
        if (newLine >= newLineCount) {
          newLine = Math.max(0, newLineCount - 1);
        }
      }
      const newLineLength = ((_a = newContent.split("\n")[newLine]) == null ? void 0 : _a.length) || 0;
      if (newCh > newLineLength) {
        newCh = Math.max(0, newLineLength);
      }
      activeEditor.setCursor({ line: newLine, ch: newCh });
    }
  }
  new import_obsidian5.Notice("Properties standardized using template.");
}
function renameContentByPath(app, filePath, settings, plugin) {
  const file = app.vault.getAbstractFileByPath(filePath);
  if (!(file instanceof import_obsidian5.TFile)) {
    new import_obsidian5.Notice(`File not found: ${filePath}`);
    return;
  }
  const fileOps = new FileOperations(app, settings, plugin);
  function hasMatchingContentType(file2, settings2) {
    const type2 = fileOps.determineType(file2);
    if (type2 === "note") {
      return false;
    }
    const contentType = fileOps.getContentType(type2);
    return contentType !== null && contentType.enabled;
  }
  if (!hasMatchingContentType(file, settings)) {
    new import_obsidian5.Notice("Cannot rename: this file is not part of a configured content type folder.");
    return;
  }
  const type = fileOps.determineType(file);
  new TitleModal(app, file, plugin, type, true).open();
}
function registerContentTypeCommands(plugin, settings) {
  const pluginInterface = plugin;
  const contentTypes = settings.contentTypes || [];
  for (const contentType of contentTypes) {
    if (!contentType.enabled) {
      continue;
    }
    const commandId = `create-content-type-${contentType.id}`;
    const commandName = `Create new content type: ${contentType.name}`;
    plugin.addCommand({
      id: commandId,
      name: commandName,
      callback: async () => {
        let targetFolder = contentType.folder || "";
        if (targetFolder && targetFolder.trim() !== "") {
          const folder = plugin.app.vault.getAbstractFileByPath(targetFolder);
          if (!(folder instanceof import_obsidian5.TFolder)) {
            try {
              await plugin.app.vault.createFolder(targetFolder);
            } catch (error) {
              const errorMessage = error instanceof Error ? error.message : String(error);
              new import_obsidian5.Notice(`Failed to create folder: ${errorMessage}`);
              return;
            }
          }
        }
        const tempFileName = "Untitled.md";
        const filePath = targetFolder ? `${targetFolder}/${tempFileName}` : tempFileName;
        const existingFile = plugin.app.vault.getAbstractFileByPath(filePath);
        if (existingFile instanceof import_obsidian5.TFile) {
          new TitleModal(plugin.app, existingFile, pluginInterface, contentType.id, false, true).open();
          return;
        }
        if (pluginInterface && "pluginCreatedFiles" in pluginInterface) {
          pluginInterface.pluginCreatedFiles.set(filePath, Date.now());
        }
        try {
          const tempFile = await plugin.app.vault.create(filePath, "");
          new TitleModal(plugin.app, tempFile, pluginInterface, contentType.id, false, true).open();
        } catch (error) {
          const errorMessage = error instanceof Error ? error.message : String(error);
          new import_obsidian5.Notice(`Failed to create file: ${errorMessage}`);
          if (pluginInterface && "pluginCreatedFiles" in pluginInterface) {
            pluginInterface.pluginCreatedFiles.delete(filePath);
          }
        }
      }
    });
  }
}
var terminalLogger = {
  enabled: false,
  setEnabled(value) {
    this.enabled = value;
  },
  log(...args) {
    if (this.enabled) {
      console.debug("[astro-composer:terminal]", ...args);
    }
  }
};
function getDefaultTerminalApp() {
  if (!import_obsidian5.Platform.isDesktopApp) {
    return "";
  }
  if (import_obsidian5.Platform.isMacOS) {
    return "Terminal";
  }
  if (import_obsidian5.Platform.isWin) {
    try {
      const os = require("os");
      const release = os.release();
      const majorVersion = parseInt(release.split(".")[0]);
      const buildNumber = parseInt(release.split(".")[2]);
      if (majorVersion > 10 || majorVersion === 10 && buildNumber >= 22e3) {
        return "wt.exe";
      }
    } catch (e) {
    }
    return "cmd.exe";
  }
  if (import_obsidian5.Platform.isLinux) {
    return "gnome-terminal";
  }
  return "";
}
function sanitizeTerminalApp(value) {
  return value.trim();
}
function escapeDoubleQuotes(value) {
  return value.replace(/"/g, '\\"');
}
function openTerminalInProjectRoot(app, settings) {
  terminalLogger.setEnabled(settings.enableTerminalDebugLogging);
  try {
    const { exec } = require("child_process");
    const path = require("path");
    const fs = require("fs");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    let projectPath;
    if (settings.terminalProjectRootPath && settings.terminalProjectRootPath.trim()) {
      projectPath = path.resolve(vaultPathString, settings.terminalProjectRootPath);
    } else {
      projectPath = vaultPathString;
    }
    if (!fs.existsSync(projectPath)) {
      new import_obsidian5.Notice(`Project root directory not found at: ${projectPath}`);
      return;
    }
    const configuredApp = sanitizeTerminalApp(settings.terminalApplicationName || "");
    const terminalApp = configuredApp || getDefaultTerminalApp();
    if (!configuredApp && !terminalApp) {
      new import_obsidian5.Notice("Terminal application name is empty. Please configure it in settings.");
      return;
    }
    const platform = process.platform;
    terminalLogger.log("Opening terminal", { platform, terminalApp, projectPath });
    if (platform === "win32") {
      const escapedPath = projectPath.replace(/"/g, '"');
      const lowerApp = terminalApp.toLowerCase();
      if (lowerApp === "wt.exe" || lowerApp === "wt" || lowerApp === "windows terminal") {
        exec("where wt", (error) => {
          if (!error) {
            const command = `start "" wt.exe -d "${escapedPath}"`;
            terminalLogger.log("Windows launch (wt)", { command, projectPath });
            exec(command, (execError) => {
              if (execError) {
                terminalLogger.log("Windows Terminal failed, falling back to cmd", { error: execError.message });
                const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
                exec(fallbackCommand, (cmdError) => {
                  if (cmdError) {
                    new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
                  }
                });
              }
            });
          } else {
            terminalLogger.log("Windows Terminal not found, using cmd", {});
            const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
            exec(fallbackCommand, (cmdError) => {
              if (cmdError) {
                new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
              }
            });
          }
        });
      } else if (lowerApp === "powershell" || lowerApp === "powershell.exe") {
        const escapedPathForPS = projectPath.replace(/'/g, "''");
        const command = `start "" powershell -NoExit -Command "Set-Location '${escapedPathForPS}';"`;
        terminalLogger.log("Windows launch (powershell)", { command, projectPath });
        exec(command, (error) => {
          if (error) {
            new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
          }
        });
      } else if (lowerApp === "cmd.exe" || lowerApp === "cmd") {
        const command = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
        terminalLogger.log("Windows launch (cmd)", { command, projectPath });
        exec(command, (error) => {
          if (error) {
            new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
          }
        });
      } else {
        const command = `start "" "${terminalApp}"`;
        terminalLogger.log("Windows launch (generic)", { command, terminalApp, projectPath });
        exec(command, (error) => {
          if (error) {
            terminalLogger.log("Generic terminal failed, falling back to cmd", { error: error.message });
            const fallbackCommand = `start "" cmd.exe /K "cd /d "${escapedPath}""`;
            exec(fallbackCommand, (cmdError) => {
              if (cmdError) {
                new import_obsidian5.Notice(`Error opening terminal: ${cmdError.message || "Unknown error"}`);
              }
            });
          }
        });
      }
    } else if (platform === "darwin") {
      const escapedApp = escapeDoubleQuotes(terminalApp);
      const escapedPath = escapeDoubleQuotes(projectPath);
      const command = `open -na "${escapedApp}" "${escapedPath}"`;
      terminalLogger.log("macOS launch", { command, terminalApp, projectPath });
      exec(command, (error) => {
        if (error) {
          new import_obsidian5.Notice(`Error opening terminal: ${error.message || "Unknown error"}`);
        }
      });
    } else {
      const terminals = terminalApp ? [terminalApp] : ["gnome-terminal", "konsole", "xterm"];
      const projectPathEscaped = projectPath.replace(/"/g, '\\"');
      const tryTerminal = (index) => {
        if (index >= terminals.length) {
          new import_obsidian5.Notice("No supported terminal found. Please install a terminal application or configure one in settings.");
          return;
        }
        const currentTerminal = terminals[index];
        const terminalName = currentTerminal.split(" ")[0];
        exec(`which ${terminalName}`, (error) => {
          if (!error) {
            let command;
            if (currentTerminal.includes("gnome-terminal")) {
              command = `gnome-terminal --working-directory="${projectPathEscaped}"`;
            } else if (currentTerminal.includes("konsole")) {
              command = `konsole --workdir "${projectPathEscaped}"`;
            } else {
              command = `${currentTerminal} -e "cd \\"${projectPathEscaped}\\" && bash"`;
            }
            terminalLogger.log("Linux launch", { command, terminal: currentTerminal, projectPath });
            exec(command, (execError) => {
              if (execError && index < terminals.length - 1) {
                terminalLogger.log("Terminal launch failed, trying next", { terminal: currentTerminal, error: execError.message });
                tryTerminal(index + 1);
              } else if (execError) {
                new import_obsidian5.Notice(`Error opening terminal: ${execError.message || "Unknown error"}`);
              }
            });
          } else {
            terminalLogger.log("Terminal not found, trying next", { terminal: currentTerminal });
            tryTerminal(index + 1);
          }
        });
      };
      tryTerminal(0);
    }
  } catch (error) {
    terminalLogger.log("Unexpected error", { error });
    new import_obsidian5.Notice(`Error opening terminal: ${error instanceof Error ? error.message : String(error)}`);
  }
}
async function openConfigFile(app, settings) {
  try {
    const fs = require("fs");
    const path = require("path");
    const { shell } = require("electron");
    const adapter = app.vault.adapter;
    const vaultPath = adapter.basePath || adapter.path;
    const vaultPathString = typeof vaultPath === "string" ? vaultPath : String(vaultPath);
    if (!settings.configFilePath || !settings.configFilePath.trim()) {
      new import_obsidian5.Notice("Please specify a config file path in settings.");
      return;
    }
    const configPath = path.resolve(vaultPathString, settings.configFilePath);
    if (!fs.existsSync(configPath)) {
      new import_obsidian5.Notice(`Config file not found at: ${configPath}`);
      return;
    }
    await shell.openPath(configPath);
  } catch (error) {
    new import_obsidian5.Notice(`Error opening config file: ${error instanceof Error ? error.message : String(error)}`);
  }
}

// src/ui/settings-tab.ts
var import_obsidian10 = require("obsidian");

// src/ui/components/CommandPickerModal.ts
var import_obsidian6 = require("obsidian");
var CommandPickerModal = class extends import_obsidian6.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    const commandRegistry = this.app.commands;
    const commandMap = /* @__PURE__ */ new Map();
    if (commandRegistry && typeof commandRegistry.listCommands === "function") {
      try {
        const commands = commandRegistry.listCommands();
        for (const command of commands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting commands via listCommands():", e);
      }
    }
    try {
      const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
      if (registry && typeof registry === "object") {
        const allCommands = Object.values(registry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via registry:", e);
    }
    try {
      const internalRegistry = commandRegistry == null ? void 0 : commandRegistry.commandRegistry;
      if (internalRegistry && typeof internalRegistry === "object") {
        const allCommands = Object.values(internalRegistry);
        for (const command of allCommands) {
          if (command && command.id && command.name && !commandMap.has(command.id)) {
            commandMap.set(command.id, {
              id: command.id,
              name: command.name
            });
          }
        }
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting commands via internal registry:", e);
    }
    const commandOptions = Array.from(commandMap.values());
    commandOptions.sort((a, b) => a.name.localeCompare(b.name));
    return commandOptions;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    this.onSelect(item.id);
  }
  // Override to show command name only
  renderSuggestion(match, el) {
    const item = match.item;
    el.createDiv({ cls: "suggestion-title", text: item.name });
  }
};

// src/ui/components/IconPickerModal.ts
var import_obsidian7 = require("obsidian");
var getIconList = () => {
  if (import_obsidian7.requireApiVersion && (0, import_obsidian7.requireApiVersion)("1.7.3") && import_obsidian7.getIconIds) {
    try {
      return (0, import_obsidian7.getIconIds)();
    } catch (e) {
      console.warn("[Astro Composer] Error getting icon IDs from Obsidian:", e);
    }
  }
  return [
    "settings-2",
    "settings",
    "help-circle",
    "info",
    "star",
    "heart",
    "bookmark",
    "home",
    "search",
    "bell",
    "mail",
    "user",
    "users",
    "folder",
    "file",
    "file-text",
    "image",
    "video",
    "music",
    "calendar",
    "clock",
    "edit",
    "pencil",
    "trash",
    "copy",
    "cut",
    "paste",
    "download",
    "upload",
    "save",
    "share",
    "link",
    "external-link",
    "lock",
    "unlock",
    "eye",
    "eye-off",
    "key",
    "shield",
    "check",
    "x",
    "plus",
    "minus",
    "arrow-left",
    "arrow-right",
    "arrow-up",
    "arrow-down",
    "chevron-left",
    "chevron-right",
    "chevron-up",
    "chevron-down",
    "menu",
    "more-horizontal",
    "more-vertical",
    "grid",
    "list",
    "layout",
    "columns",
    "rows",
    "maximize",
    "minimize",
    "zoom-in",
    "zoom-out",
    "refresh-cw",
    "play",
    "pause",
    "stop",
    "sun",
    "moon",
    "cloud",
    "zap",
    "wand-2",
    "wand",
    "wand-sparkles",
    "palette",
    "brush",
    "sliders",
    "power",
    "wifi",
    "bluetooth",
    "monitor",
    "laptop",
    "smartphone",
    "camera",
    "mic",
    "headphones",
    "code",
    "terminal",
    "terminal-square",
    "github",
    "gitlab",
    "git-branch",
    "git-commit",
    "database",
    "server",
    "cloud-download",
    "cloud-upload",
    "tag",
    "tags",
    "flag",
    "pin",
    "map-pin",
    "compass",
    "globe",
    "rocket",
    "car",
    "bike",
    "robot",
    "apple",
    "windows",
    "linux",
    "chrome",
    "firefox",
    "safari",
    "credit-card",
    "wallet",
    "coins",
    "book",
    "book-open",
    "award",
    "trophy",
    "badge",
    "wrench",
    "tool",
    "package",
    "box",
    "archive",
    "send",
    "reply",
    "forward",
    "mail-open",
    "tag-plus",
    "tag-minus",
    "flag-off",
    "pin-off",
    "map-pin-off",
    "navigation",
    "map",
    "earth",
    "plane",
    "ship",
    "anchor",
    "helicopter",
    "drone",
    "android",
    "keyhole",
    "keys",
    "fingerprint",
    "scan",
    "qr-code",
    "barcode",
    "receipt",
    "piggy-bank",
    "banknote"
  ];
};
var LUCIDE_ICONS = getIconList().map((id) => ({
  id,
  name: id.replace(/^lucide-/, "").replace(/-/g, " ").replace(/(^\w{1})|(\s+\w{1})/g, (letter) => letter.toUpperCase())
})).sort((a, b) => a.name.localeCompare(b.name));
var IconPickerModal = class extends import_obsidian7.FuzzySuggestModal {
  constructor(app, onSelect) {
    super(app);
    this.onSelect = onSelect;
  }
  getItems() {
    return LUCIDE_ICONS;
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    const normalizedId = item.id.replace(/^lucide-/, "");
    this.onSelect(normalizedId);
  }
  // Override to show icon preview
  renderSuggestion(match, el) {
    const item = match.item;
    el.addClass("mod-complex");
    const content = el.createDiv({ cls: "suggestion-content" });
    content.createDiv({ cls: "suggestion-title", text: item.name });
    const aux = el.createDiv({ cls: "suggestion-aux" });
    (0, import_obsidian7.setIcon)(aux.createSpan({ cls: "suggestion-flair" }), item.id);
  }
};

// src/ui/components/ConfirmModal.ts
var import_obsidian8 = require("obsidian");
var ConfirmModal = class extends import_obsidian8.Modal {
  constructor(app, message, confirmText = "Confirm", cancelText = "Cancel") {
    super(app);
    this.message = message;
    this.confirmText = confirmText;
    this.cancelText = cancelText;
    this.result = false;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-confirm-modal");
    contentEl.createEl("p", { text: this.message });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const cancelButton = buttonContainer.createEl("button", {
      text: this.cancelText
    });
    cancelButton.onclick = () => {
      this.result = false;
      this.close();
    };
    const confirmButton = buttonContainer.createEl("button", {
      text: this.confirmText,
      cls: "mod-cta mod-warning"
    });
    confirmButton.onclick = () => {
      this.result = true;
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/utils/settings-compat.ts
var import_obsidian9 = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"), 1);
function createSettingsGroup(containerEl, heading, manifestId) {
  if ((0, import_obsidian9.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  if (manifestId) {
    containerEl.addClass(`${manifestId}-settings-compat`);
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian9.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/ui/settings-tab.ts
var AstroComposerSettingTab = class extends import_obsidian10.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.icon = "lucide-pencil-line";
    this.autoRenameContainer = null;
    this.postsFolderContainer = null;
    this.onlyAutomateContainer = null;
    this.creationModeContainer = null;
    this.indexFileContainer = null;
    this.excludedDirsContainer = null;
    this.underscorePrefixContainer = null;
    this.autoInsertContainer = null;
    this.pagesFieldsContainer = null;
    this.pagesIndexFileContainer = null;
    this.pagesOnlyAutomateContainer = null;
    this.terminalCommandContainer = null;
    this.configCommandContainer = null;
    this.customContentTypesContainer = null;
    this.terminalRibbonToggle = null;
    this.configRibbonToggle = null;
    this.terminalRibbonToggleComponent = null;
    this.configRibbonToggleComponent = null;
    this.plugin = plugin;
  }
  /**
   * Refresh just the content types section
   * More efficient than refreshing the entire settings tab
   */
  refreshContentTypes() {
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    const settings = this.plugin.settings;
    this.renderSettingsTab(containerEl, settings);
  }
  renderSettingsTab(containerEl, settings) {
    var _a;
    const generalGroup = createSettingsGroup(containerEl, void 0, "astro-composer");
    generalGroup.addSetting((setting) => {
      setting.setName("Date format").setDesc("Format for the date in properties (e.g., yyyy-mm-dd, MMMM D, yyyy, yyyy-mm-dd HH:mm)").addText(
        (text) => text.setPlaceholder("YYYY-MM-DD").setValue(settings.dateFormat).onChange(async (value) => {
          settings.dateFormat = value || "YYYY-MM-DD";
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Enable copy heading links").setDesc("Add right-click context menu option to copy heading links in various formats.").addToggle(
        (toggle) => toggle.setValue(settings.enableCopyHeadingLink).onChange(async (value) => {
          settings.enableCopyHeadingLink = value;
          await this.plugin.saveSettings();
          this.updateCopyHeadingFields();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Default heading link format").setDesc("Choose the default format for copied heading links. Obsidian format respects your Obsidian settings for wikilink vs markdown preference. Astro link uses your link base path from above and converts the heading into kebab-case format as an anchor link").addDropdown(
        (dropdown) => dropdown.addOption("obsidian", "Obsidian link").addOption("astro", "Astro link").setValue(settings.copyHeadingLinkFormat).onChange(async (value) => {
          settings.copyHeadingLinkFormat = value;
          await this.plugin.saveSettings();
        })
      );
      setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableCopyHeadingLink);
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableCopyHeadingLink);
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Add trailing slash to links").setDesc("Add trailing slashes to all converted internal links (e.g., /about/ instead of /about).").addToggle(
        (toggle) => toggle.setValue(settings.addTrailingSlashToLinks).onChange(async (value) => {
          settings.addTrailingSlashToLinks = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Process background file changes").setDesc("Automatically process new files when they're changed in the background (by Git or other plugins). Disable to prevent modal spam when files are already processed on other devices during a sync.").addToggle(
        (toggle) => toggle.setValue(settings.processBackgroundFileChanges).onChange(async (value) => {
          settings.processBackgroundFileChanges = value;
          await this.plugin.saveSettings();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Show MDX files in file explorer").setDesc("Make .mdx files visible in Obsidian's file explorer. Requires reload to take effect.").addToggle(
        (toggle) => toggle.setValue(settings.showMdxFilesInExplorer).onChange(async (value) => {
          settings.showMdxFilesInExplorer = value;
          await this.plugin.saveSettings();
        })
      );
    });
    const automationGroup = createSettingsGroup(containerEl, "Property automation", "astro-composer");
    automationGroup.addSetting((setting) => {
      setting.setName("Auto-insert properties").setDesc("Automatically insert the properties template when creating new files.").addToggle(
        (toggle) => toggle.setValue(settings.autoInsertProperties).onChange(async (value) => {
          settings.autoInsertProperties = value;
          await this.plugin.saveSettings();
        })
      );
    });
    let draftPropertySetting;
    let draftLogicSetting;
    let publishDateFieldSetting;
    automationGroup.addSetting((setting) => {
      setting.setName("Update date on publish").setDesc("Update 'date' property when switching from draft to published status.").addToggle(
        (toggle) => toggle.setValue(settings.syncDraftDate).onChange(async (value) => {
          settings.syncDraftDate = value;
          await this.plugin.saveSettings();
          if (draftPropertySetting) draftPropertySetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
          if (draftLogicSetting) draftLogicSetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
          if (publishDateFieldSetting) publishDateFieldSetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
        })
      );
    });
    automationGroup.addSetting((setting) => {
      draftPropertySetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.syncDraftDate);
      setting.setName("Draft property name").setDesc("The property field to use for draft status.").addText(
        (text) => text.setPlaceholder("draft").setValue(settings.draftProperty || "").onChange(async (value) => {
          var _a2;
          settings.draftProperty = value;
          await this.plugin.saveSettings();
          (_a2 = this.plugin.frontmatterService) == null ? void 0 : _a2.initializeDraftStatusMap();
        })
      );
    });
    automationGroup.addSetting((setting) => {
      draftLogicSetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.syncDraftDate);
      setting.setName("Draft logic").setDesc("Whether the property value 'true' means it is a draft or published.").addDropdown(
        (dropdown) => dropdown.addOption("true-is-draft", "True = Draft").addOption("false-is-draft", "True = Published").setValue(settings.draftLogic || "true-is-draft").onChange(async (value) => {
          var _a2;
          settings.draftLogic = value;
          await this.plugin.saveSettings();
          (_a2 = this.plugin.frontmatterService) == null ? void 0 : _a2.initializeDraftStatusMap();
        })
      );
    });
    automationGroup.addSetting((setting) => {
      publishDateFieldSetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.syncDraftDate);
      setting.setName("Published date property name").setDesc("The property field to update when published (e.g., 'date' or 'pubDate').").addText(
        (text) => text.setPlaceholder("date").setValue(settings.publishDateField || "").onChange(async (value) => {
          settings.publishDateField = value;
          await this.plugin.saveSettings();
        })
      );
    });
    let modifiedDateFieldSetting;
    automationGroup.addSetting((setting) => {
      setting.setName("Update modified date").setDesc("Automatically update a property with current date when a file is edited.").addToggle(
        (toggle) => toggle.setValue(settings.updateModifiedDate).onChange(async (value) => {
          settings.updateModifiedDate = value;
          await this.plugin.saveSettings();
          if (modifiedDateFieldSetting) {
            modifiedDateFieldSetting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !value);
          }
        })
      );
    });
    automationGroup.addSetting((setting) => {
      modifiedDateFieldSetting = setting;
      setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.updateModifiedDate);
      setting.setName("Modified date property name").setDesc("The property field to update with the modified date.").addText(
        (text) => text.setPlaceholder("modified").setValue(settings.modifiedDateField || "").onChange(async (value) => {
          settings.modifiedDateField = value;
          await this.plugin.saveSettings();
        })
      );
    });
    const contentTypesGroup = createSettingsGroup(containerEl, "Content types", "astro-composer");
    contentTypesGroup.addSetting((setting) => {
      setting.settingEl.addClass("astro-composer-setting-hidden-elements");
      setting.settingEl.addClass("astro-composer-setting-container-full-width");
      this.customContentTypesContainer = setting.settingEl.createDiv({
        cls: "custom-content-types-container astro-composer-custom-types-container-visible"
      });
    });
    if (this.customContentTypesContainer) {
      this.renderCustomContentTypes();
    }
    if (!import_obsidian10.Platform.isMobile) {
      const developerGroup = createSettingsGroup(containerEl, "Developer commands", "astro-composer");
      developerGroup.addSetting((setting) => {
        setting.setName("Enable open terminal command").setDesc("Enable command to open terminal in project root directory.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenTerminalCommand).onChange(async (value) => {
            settings.enableOpenTerminalCommand = value;
            await this.plugin.saveSettings();
            this.updateTerminalCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.terminalCommandContainer = containerEl.createDiv({ cls: "terminal-command-fields" });
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path relative to the Obsidian vault root folder. Use ../.. for two levels up. Leave blank to use the vault folder" });
        descFragment.createEl("div", { text: "This is where the terminal will open. Absolute paths work also." });
        setting.setName("Project root directory path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../..").setValue(settings.terminalProjectRootPath).onChange(async (value) => {
            settings.terminalProjectRootPath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Leave blank to use platform defaults. On macOS, the default is Terminal. On Windows, it's Windows Terminal (Win 11) or cmd.exe (Win 10). On Linux, it's gnome-terminal, konsole, or xterm" });
        descFragment.createEl("div", { text: "Examples include Terminal, iTerm, PowerShell, and Alacritty" });
        setting.setName("Terminal application name").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("Terminal").setValue(settings.terminalApplicationName).onChange(async (value) => {
            settings.terminalApplicationName = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Enable debug logging").setDesc("Log terminal launch commands and platform decisions to the developer console for troubleshooting.").addToggle(
          (toggle) => toggle.setValue(settings.enableTerminalDebugLogging).onChange(async (value) => {
            settings.enableTerminalDebugLogging = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open terminal ribbon icon").setDesc("Add a ribbon icon to launch the terminal command.").addToggle((toggle) => {
          this.terminalRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableTerminalRibbonIcon).setDisabled(!settings.enableOpenTerminalCommand).onChange(async (value) => {
            this.plugin.settings.enableTerminalRibbonIcon = value;
            settings.enableTerminalRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenTerminalCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenTerminalCommand);
        this.terminalRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Enable edit config file command").setDesc("Enable command to open astro config file in default editor.").addToggle(
          (toggle) => toggle.setValue(settings.enableOpenConfigFileCommand).onChange(async (value) => {
            settings.enableOpenConfigFileCommand = value;
            await this.plugin.saveSettings();
            this.updateConfigCommandFields();
            if (this.plugin.registerRibbonIcons) {
              this.plugin.registerRibbonIcons();
            }
          })
        );
      });
      this.configCommandContainer = containerEl.createDiv({ cls: "config-command-fields" });
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      developerGroup.addSetting((setting) => {
        const descFragment = document.createDocumentFragment();
        descFragment.createEl("div", { text: "Path to the config file relative to the vault root. Use ../config.ts or ../../astro.config.mjs." });
        descFragment.createEl("div", { text: "Absolute paths work also." });
        setting.setName("Config file path").setDesc(descFragment).addText(
          (text) => text.setPlaceholder("../config.ts").setValue(settings.configFilePath).onChange(async (value) => {
            settings.configFilePath = value;
            await this.plugin.saveSettings();
          })
        );
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Show open config ribbon icon").setDesc("Add a ribbon icon to launch the config file command.").addToggle((toggle) => {
          this.configRibbonToggleComponent = toggle;
          toggle.setValue(settings.enableConfigRibbonIcon).setDisabled(!settings.enableOpenConfigFileCommand).onChange(async (value) => {
            this.plugin.settings.enableConfigRibbonIcon = value;
            settings.enableConfigRibbonIcon = value;
            await this.plugin.saveSettings();
            setTimeout(() => {
              if (this.plugin.registerRibbonIcons) {
                this.plugin.registerRibbonIcons();
              }
            }, 50);
          });
        });
        setting.settingEl.classList.toggle("astro-composer-setting-container-visible", settings.enableOpenConfigFileCommand);
        setting.settingEl.classList.toggle("astro-composer-setting-container-hidden", !settings.enableOpenConfigFileCommand);
        this.configRibbonToggle = setting;
      });
      developerGroup.addSetting((setting) => {
        setting.setName("Swap out help button for custom action").setDesc("Replace the help button in the vault profile area with a custom action.").addToggle((toggle) => {
          var _a2, _b;
          return toggle.setValue((_b = (_a2 = settings.helpButtonReplacement) == null ? void 0 : _a2.enabled) != null ? _b : false).onChange(async (value) => {
            if (!settings.helpButtonReplacement) {
              settings.helpButtonReplacement = {
                enabled: false,
                commandId: "edit-astro-config",
                iconId: "rocket"
              };
            }
            settings.helpButtonReplacement.enabled = value;
            await this.plugin.saveSettings();
            if (this.plugin.updateHelpButton) {
              await this.plugin.updateHelpButton();
            }
            this.display();
          });
        });
      });
      if ((_a = settings.helpButtonReplacement) == null ? void 0 : _a.enabled) {
        const commandName = this.getCommandName(settings.helpButtonReplacement.commandId);
        developerGroup.addSetting((setting) => {
          setting.setName("Command").setDesc("Select the command to execute when the button is clicked.").addButton((button) => button.setButtonText(commandName || "Select command").onClick(() => {
            const modal = new CommandPickerModal(this.app, (commandId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "rocket"
                  };
                }
                settings.helpButtonReplacement.commandId = commandId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
        const iconName = this.getIconName(settings.helpButtonReplacement.iconId);
        developerGroup.addSetting((setting) => {
          setting.setName("Icon").setDesc("Select the icon to display on the button.").addButton((button) => button.setButtonText(iconName || "Select icon...").onClick(() => {
            const modal = new IconPickerModal(this.app, (iconId) => {
              void (async () => {
                if (!settings.helpButtonReplacement) {
                  settings.helpButtonReplacement = {
                    enabled: true,
                    commandId: "edit-astro-config",
                    iconId: "rocket"
                  };
                }
                settings.helpButtonReplacement.iconId = iconId;
                await this.plugin.saveSettings();
                if (this.plugin.updateHelpButton) {
                  await this.plugin.updateHelpButton();
                }
                this.display();
              })();
            });
            modal.open();
          }));
        });
      }
    }
    this.updateCopyHeadingFields();
    if (!import_obsidian10.Platform.isMobile) {
      this.updateTerminalCommandFields();
      this.updateConfigCommandFields();
    }
  }
  updateCopyHeadingFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableCopyHeadingLink;
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl && ((_a = nameEl.textContent) == null ? void 0 : _a.trim()) === "Default heading link format") {
        settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
        settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
      }
    });
  }
  updateTerminalCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenTerminalCommand;
    if (this.terminalCommandContainer) {
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.terminalCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Project root directory path" || name === "Show open terminal ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.terminalRibbonToggleComponent) {
      this.terminalRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenTerminalCommand);
    }
  }
  updateConfigCommandFields() {
    const settings = this.plugin.settings;
    const isVisible = settings.enableOpenConfigFileCommand;
    if (this.configCommandContainer) {
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-visible", isVisible);
      this.configCommandContainer.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
    }
    const containerEl = this.containerEl;
    const allSettings = containerEl.querySelectorAll(".setting-item");
    allSettings.forEach((settingEl) => {
      var _a;
      const nameEl = settingEl.querySelector(".setting-item-name");
      if (nameEl) {
        const name = (_a = nameEl.textContent) == null ? void 0 : _a.trim();
        if (name === "Config file path" || name === "Show open config ribbon icon") {
          settingEl.classList.toggle("astro-composer-setting-container-visible", isVisible);
          settingEl.classList.toggle("astro-composer-setting-container-hidden", !isVisible);
        }
      }
    });
    if (this.configRibbonToggleComponent) {
      this.configRibbonToggleComponent.setDisabled(!this.plugin.settings.enableOpenConfigFileCommand);
    }
  }
  checkForFolderConflicts() {
    const settings = this.plugin.settings;
    const blankFolders = [];
    const folderConflicts = {};
    const contentTypes = settings.contentTypes || [];
    for (const contentType of contentTypes) {
      if (contentType.enabled) {
        if (!contentType.folder || contentType.folder.trim() === "") {
          blankFolders.push(contentType.name || "Content");
        } else {
          if (!folderConflicts[contentType.folder]) {
            folderConflicts[contentType.folder] = [];
          }
          folderConflicts[contentType.folder].push(contentType.name || "Content");
        }
      }
    }
  }
  addCustomContentType() {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const newType = {
      id: `content-${Date.now()}`,
      name: `Content ${contentTypes.length + 1}`,
      folder: "",
      linkBasePath: "",
      template: '---\ntitle: "{{title}}"\ndate: {{date}}\n---\n',
      enabled: true,
      creationMode: "file",
      indexFileName: "",
      ignoreSubfolders: false,
      enableUnderscorePrefix: false,
      useMdxExtension: false
    };
    contentTypes.push(newType);
    settings.contentTypes = contentTypes;
    void this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
    registerContentTypeCommands(this.plugin, settings);
  }
  renderCustomContentTypes() {
    if (!this.customContentTypesContainer) return;
    this.customContentTypesContainer.empty();
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    contentTypes.forEach((customType, index) => {
      var _a, _b;
      if (!this.customContentTypesContainer) return;
      const typeContainer = this.customContentTypesContainer.createDiv({
        cls: "custom-content-type-item",
        attr: { "data-type-id": customType.id }
      });
      const header = typeContainer.createDiv({ cls: "custom-content-type-header" });
      header.classList.add("astro-composer-custom-type-header");
      const collapseButton = header.createEl("button", {
        cls: "astro-composer-collapse-button",
        attr: { "aria-label": "Collapse/expand" }
      });
      const isCollapsed = (_a = customType.collapsed) != null ? _a : false;
      (0, import_obsidian10.setIcon)(collapseButton, "chevron-down");
      if (isCollapsed) {
        collapseButton.classList.add("is-collapsed");
      }
      collapseButton.addEventListener("click", () => {
        void this.toggleContentTypeCollapse(customType.id);
        const updatedType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
        if (updatedType) {
          if (updatedType.collapsed) {
            collapseButton.classList.add("is-collapsed");
          } else {
            collapseButton.classList.remove("is-collapsed");
          }
        }
      });
      const headerName = header.createDiv({ cls: "astro-composer-header-name" });
      headerName.createEl("div", { text: customType.name || `Content ${index + 1}`, cls: "setting-item-name" });
      const reorderContainer = header.createDiv({ cls: "astro-composer-reorder-buttons" });
      const upButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move up" }
      });
      (0, import_obsidian10.setIcon)(upButton, "chevron-up");
      upButton.disabled = index === 0;
      upButton.addEventListener("click", () => {
        void this.moveContentTypeUp(customType.id);
      });
      const downButton = reorderContainer.createEl("button", {
        cls: "astro-composer-reorder-button",
        attr: { "aria-label": "Move down" }
      });
      (0, import_obsidian10.setIcon)(downButton, "chevron-down");
      downButton.disabled = index === contentTypes.length - 1;
      downButton.addEventListener("click", () => {
        void this.moveContentTypeDown(customType.id);
      });
      const toggleContainer = header.createDiv({ cls: "checkbox-container" });
      if (customType.enabled) {
        toggleContainer.classList.add("is-enabled");
      }
      const toggle = toggleContainer.createEl("input", { type: "checkbox", cls: "checkbox-input" });
      toggle.checked = customType.enabled;
      toggleContainer.addEventListener("click", (e) => {
        void (async () => {
          e.preventDefault();
          const newValue = !customType.enabled;
          customType.enabled = newValue;
          toggle.checked = newValue;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (newValue) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, newValue);
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        })();
      });
      toggle.addEventListener("change", (e) => {
        void (async () => {
          const value = e.target.checked;
          customType.enabled = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          if (value) {
            toggleContainer.classList.add("is-enabled");
          } else {
            toggleContainer.classList.remove("is-enabled");
          }
          this.updateCustomContentTypeVisibility(customType.id, value);
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        })();
      });
      const settingsContainer = typeContainer.createDiv({
        cls: "custom-content-type-settings",
        attr: { "data-type-id": customType.id }
      });
      const initiallyCollapsed = (_b = customType.collapsed) != null ? _b : false;
      const initiallyVisible = customType.enabled && !initiallyCollapsed;
      if (initiallyVisible) {
        settingsContainer.classList.add("astro-composer-setting-container-visible");
      } else {
        settingsContainer.classList.add("astro-composer-setting-container-hidden");
      }
      const nameContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(nameContainer).setName("Content type name").setDesc("Display name for this content type (e.g., 'projects', 'notes', 'tutorials')").addText((text) => {
        text.setPlaceholder("Enter content type name").setValue(customType.name).onChange(async (value) => {
          customType.name = value;
          await this.plugin.saveSettings();
          registerContentTypeCommands(this.plugin, this.plugin.settings);
        });
      });
      const folderContainer = settingsContainer.createDiv();
      const folderSetting = new import_obsidian10.Setting(folderContainer).setName("Folder location").setDesc("Folder path where this content type will be created. Leave blank to use the vault folder. Supports wildcards like directory/* or directory/*/* to match specific folder depths.").addText((text) => {
        text.setPlaceholder("Enter folder path (e.g., 'docs', 'docs/*', 'docs/*/*') or leave blank for vault root").setValue(customType.folder).onChange(async (value) => {
          customType.folder = value;
          await this.plugin.saveSettings();
          this.plugin.registerCreateEvent();
          this.updateCustomContentTypeIgnoreSubfoldersField(customType.id);
          const allContentTypes = this.plugin.settings.contentTypes || [];
          for (const ct of allContentTypes) {
            this.updateFolderConflictWarning(ct.id, null);
          }
        });
      });
      folderContainer.createDiv({ cls: "astro-composer-conflict-warning hidden", attr: { "data-type-id": customType.id } });
      this.updateFolderConflictWarning(customType.id, folderSetting);
      const ignoreSubfoldersContainer = settingsContainer.createDiv({ cls: "custom-ignore-subfolders-field" });
      ignoreSubfoldersContainer.setAttribute("data-type-id", customType.id);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder);
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder);
      new import_obsidian10.Setting(ignoreSubfoldersContainer).setName("Ignore subfolders").setDesc("When enabled, automation will only trigger for new .md files within this content type's folder and one level down (for folder-based content). Files in deeper subfolders will be ignored.").addToggle(
        (toggle2) => toggle2.setValue(customType.ignoreSubfolders || false).onChange(async (value) => {
          customType.ignoreSubfolders = value;
          await this.plugin.saveSettings();
        })
      );
      const underscorePrefixContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(underscorePrefixContainer).setName("Use underscore prefix for drafts").setDesc("Add an underscore prefix (_content-title) to new notes by default when enabled. This hides them from astro, which can be helpful for drafts").addToggle(
        (toggle2) => toggle2.setValue(customType.enableUnderscorePrefix || false).onChange(async (value) => {
          customType.enableUnderscorePrefix = value;
          await this.plugin.saveSettings();
        })
      );
      const linkContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(linkContainer).setName("Link base path").setDesc("Base path for converted links (e.g., '/projects/', '/notes/tutorials/', leave blank for root /).").addText((text) => {
        text.setPlaceholder("Enter link base path").setValue(customType.linkBasePath || "").onChange(async (value) => {
          customType.linkBasePath = value;
          await this.plugin.saveSettings();
        });
      });
      const creationModeContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(creationModeContainer).setName("Creation mode").setDesc("How to create new entries: file-based or folder-based with an index file.").addDropdown(
        (dropdown) => dropdown.addOption("file", "File-based (content-title.md)").addOption("folder", "Folder-based (content-title/index.md)").setValue(customType.creationMode).onChange(async (value) => {
          customType.creationMode = value;
          await this.plugin.saveSettings();
          this.updateCustomContentTypeIndexFileField(customType.id);
        })
      );
      const useMdxContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(useMdxContainer).setName("Use MDX instead of MD").setDesc("Create files with .mdx extension instead of .md extension.").addToggle(
        (toggle2) => toggle2.setValue(customType.useMdxExtension || false).onChange(async (value) => {
          customType.useMdxExtension = value;
          await this.plugin.saveSettings();
        })
      );
      const indexFileContainer = settingsContainer.createDiv({ cls: "custom-index-file-field" });
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
      new import_obsidian10.Setting(indexFileContainer).setName("Index file name").setDesc("Name for index files in folder-based content (without .md extension). Defaults to 'index' if left blank.").addText(
        (text) => text.setPlaceholder("Index").setValue(customType.indexFileName).onChange(async (value) => {
          customType.indexFileName = value;
          await this.plugin.saveSettings();
        })
      );
      const templateContainer = settingsContainer.createDiv();
      new import_obsidian10.Setting(templateContainer).setName("Properties template").addTextArea((text) => {
        text.setPlaceholder('---\ntitle: "{{title}}"\ndate: {{date}}\n---\n').setValue(customType.template).onChange(async (value) => {
          customType.template = value;
          await this.plugin.saveSettings();
        });
        text.inputEl.classList.add("astro-composer-template-textarea");
        return text;
      }).then((setting) => {
        setting.descEl.empty();
        const descDiv = setting.descEl.createEl("div");
        descDiv.createEl("div", { text: "Template for new files of this content type." });
        descDiv.createEl("div", { text: "Variables include {{title}}, {{date}}, and {{slug}}." });
        descDiv.createEl("div", { text: "Do not wrap {{date}} in quotes as it represents a datetime value, not a string." });
      });
      const removeContainer = settingsContainer.createDiv();
      const removeSetting = new import_obsidian10.Setting(removeContainer).setName("").addButton((button) => {
        button.setButtonText("Remove").setWarning().onClick(async () => {
          const contentType = this.plugin.settings.contentTypes.find((ct) => ct.id === customType.id);
          const typeName = (contentType == null ? void 0 : contentType.name) || "content type";
          const modal = new ConfirmModal(
            this.app,
            `Are you sure you want to remove "${typeName}"? This action cannot be undone.`,
            "Remove",
            "Cancel"
          );
          const confirmed = await modal.waitForResult();
          if (confirmed) {
            await this.removeCustomContentType(customType.id);
          }
        });
      });
      removeSetting.settingEl.classList.add("astro-composer-remove-setting");
      this.updateCustomContentTypeVisibility(customType.id, customType.enabled);
    });
    contentTypes.forEach((customType) => {
      this.updateFolderConflictWarning(customType.id, null);
    });
    const addButtonContainer = this.customContentTypesContainer.createDiv({ cls: "astro-composer-add-button-container" });
    const addButton = addButtonContainer.createEl("button", {
      cls: "mod-cta",
      text: "Add content type"
    });
    addButton.addEventListener("click", () => {
      this.addCustomContentType();
    });
  }
  updateCustomContentTypeVisibility(typeId, enabled) {
    var _a, _b;
    const settingsContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-content-type-settings`);
    if (settingsContainer) {
      const contentTypes = this.plugin.settings.contentTypes || [];
      const contentType = contentTypes.find((ct) => ct.id === typeId);
      const isCollapsed = (_b = contentType == null ? void 0 : contentType.collapsed) != null ? _b : false;
      const shouldBeVisible = enabled && !isCollapsed;
      settingsContainer.classList.toggle("astro-composer-setting-container-visible", shouldBeVisible);
      settingsContainer.classList.toggle("astro-composer-setting-container-hidden", !shouldBeVisible);
    }
  }
  updateCustomContentTypeIndexFileField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType) return;
    const indexFileContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"] .custom-index-file-field`);
    if (indexFileContainer) {
      indexFileContainer.classList.toggle("astro-composer-setting-container-visible", customType.creationMode === "folder");
      indexFileContainer.classList.toggle("astro-composer-setting-container-hidden", customType.creationMode !== "folder");
    }
  }
  updateCustomContentTypeIgnoreSubfoldersField(typeId) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const customType = contentTypes.find((type) => type.id === typeId);
    if (!customType) return;
    const ignoreSubfoldersContainer = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].custom-ignore-subfolders-field`);
    if (ignoreSubfoldersContainer) {
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-visible", !!customType.folder && customType.folder.trim() !== "");
      ignoreSubfoldersContainer.classList.toggle("astro-composer-setting-container-hidden", !customType.folder || customType.folder.trim() === "");
    }
  }
  updateFolderConflictWarning(typeId, setting) {
    var _a;
    const contentTypes = this.plugin.settings.contentTypes || [];
    const currentType = contentTypes.find((type) => type.id === typeId);
    if (!currentType) return;
    const conflictWarningEl = (_a = this.customContentTypesContainer) == null ? void 0 : _a.querySelector(`[data-type-id="${typeId}"].astro-composer-conflict-warning`);
    if (!conflictWarningEl) return;
    const currentFolder = (currentType.folder || "").trim();
    const conflictingTypes = [];
    for (const otherType of contentTypes) {
      if (otherType.id === typeId || !otherType.enabled) continue;
      const otherFolder = (otherType.folder || "").trim();
      if (currentFolder === "" && otherFolder === "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      } else if (currentFolder === otherFolder && currentFolder !== "") {
        conflictingTypes.push(otherType.name || "Unnamed");
      }
    }
    if (conflictingTypes.length > 0) {
      conflictWarningEl.removeClass("hidden");
      conflictWarningEl.textContent = `Conflict: ${conflictingTypes.join(", ")} also use${conflictingTypes.length === 1 ? "s" : ""} this folder. More specific patterns will take priority.`;
    } else {
      conflictWarningEl.addClass("hidden");
    }
  }
  async moveContentTypeUp(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex <= 0) return;
    [contentTypes[currentIndex], contentTypes[currentIndex - 1]] = [contentTypes[currentIndex - 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async moveContentTypeDown(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const currentIndex = contentTypes.findIndex((ct) => ct.id === typeId);
    if (currentIndex < 0 || currentIndex >= contentTypes.length - 1) return;
    [contentTypes[currentIndex], contentTypes[currentIndex + 1]] = [contentTypes[currentIndex + 1], contentTypes[currentIndex]];
    settings.contentTypes = contentTypes;
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
  }
  async toggleContentTypeCollapse(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    const contentType = contentTypes.find((ct) => ct.id === typeId);
    if (!contentType) return;
    contentType.collapsed = !contentType.collapsed;
    await this.plugin.saveSettings();
    this.updateCustomContentTypeVisibility(typeId, contentType.enabled);
  }
  async removeCustomContentType(typeId) {
    const settings = this.plugin.settings;
    const contentTypes = settings.contentTypes || [];
    settings.contentTypes = contentTypes.filter((ct) => ct.id !== typeId);
    await this.plugin.saveSettings();
    this.renderCustomContentTypes();
    this.plugin.registerCreateEvent();
    registerContentTypeCommands(this.plugin, settings);
  }
  getCommandName(commandId) {
    if (!commandId) return "";
    try {
      const commandRegistry = this.app.commands;
      if (commandRegistry && typeof commandRegistry.listCommands === "function") {
        try {
          const allCommands = commandRegistry.listCommands();
          const command = allCommands.find((cmd) => cmd.id === commandId);
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        } catch (e) {
          console.warn("[Astro Composer] Error getting command name via listCommands():", e);
        }
      }
      try {
        const registry = commandRegistry == null ? void 0 : commandRegistry.commands;
        if (registry && typeof registry === "object") {
          const command = registry[commandId];
          if (command == null ? void 0 : command.name) {
            return command.name;
          }
        }
      } catch (e) {
        console.warn("[Astro Composer] Error getting command name via registry:", e);
      }
    } catch (e) {
      console.warn("[Astro Composer] Error getting command name:", e);
    }
    return "";
  }
  getIconName(iconId) {
    if (!iconId) return "";
    return iconId.replace(/^lucide-/, "").split("-").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  }
};

// src/utils/heading-link-generator.ts
var HeadingLinkGenerator = class {
  constructor(settings) {
    this.settings = settings;
  }
  /**
   * Converts text to kebab-case slug for URLs
   */
  // Local toKebabCase removed, using imported one instead
  /**
   * Gets the Astro-compatible URL from an internal link (copied from LinkConverter)
   */
  getAstroUrlFromInternalLink(link) {
    const hashIndex = link.indexOf("#");
    let path = hashIndex >= 0 ? link.slice(0, hashIndex) : link;
    const anchor = hashIndex >= 0 ? link.slice(hashIndex) : "";
    path = path.replace(/\.md$/, "");
    let basePath = "";
    let contentFolder = "";
    let creationMode = "file";
    let indexFileName = "";
    const contentTypes = this.settings.contentTypes || [];
    const sortedTypes = sortByPatternSpecificity(contentTypes);
    for (const contentType of sortedTypes) {
      if (!contentType.enabled) continue;
      let matches = false;
      if (!contentType.folder || contentType.folder.trim() === "") {
        if (!path.includes("/") || path.split("/").length === 1) {
          matches = true;
        }
      } else if (matchesFolderPattern(path, contentType.folder)) {
        matches = true;
      }
      if (matches) {
        contentFolder = contentType.folder || "";
        basePath = contentType.linkBasePath || "";
        creationMode = contentType.creationMode;
        indexFileName = contentType.indexFileName || "";
        break;
      }
    }
    if (contentFolder) {
      path = path.slice(contentFolder.length + 1);
    }
    let addTrailingSlash = false;
    if (indexFileName && indexFileName.trim() !== "") {
      const parts = path.split("/");
      if (parts[parts.length - 1] === indexFileName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    } else if (creationMode === "folder") {
      const defaultIndexName = "index";
      const parts = path.split("/");
      if (parts[parts.length - 1] === defaultIndexName) {
        parts.pop();
        path = parts.join("/");
        addTrailingSlash = true;
      }
    }
    const slugParts = path.split("/").map((part) => toKebabCase(part));
    const slug = slugParts.join("/");
    if (basePath) {
      if (!basePath.startsWith("/")) basePath = "/" + basePath;
      if (!basePath.endsWith("/")) basePath += "/";
    }
    const shouldAddTrailingSlash = (this.settings.addTrailingSlashToLinks || addTrailingSlash) && !anchor;
    return `${basePath}${slug}${shouldAddTrailingSlash ? "/" : ""}${anchor}`;
  }
  /**
   * Generates a standard Obsidian link to a heading, respecting user's link format preference
   */
  generateObsidianLink(app, file, heading) {
    const headingText = heading.heading;
    const testLink = app.fileManager.generateMarkdownLink(file, "", "");
    if (testLink.startsWith("[[")) {
      const fileName = file.basename;
      return `[[${fileName}#${headingText}|${headingText}]]`;
    } else {
      const baseLink = app.fileManager.generateMarkdownLink(file, "", "");
      if (baseLink.startsWith("[[")) {
        const fileName = file.basename;
        return `[[${fileName}#${headingText}|${headingText}]]`;
      } else {
        const match = baseLink.match(/\[([^\]]+)\]\(([^)]+)\)/);
        if (match) {
          const [, , path] = match;
          return `[${headingText}](${path}#${encodeURIComponent(headingText)})`;
        } else {
          const encodedFilename = encodeURIComponent(file.name);
          return `[${headingText}](${encodedFilename}#${encodeURIComponent(headingText)})`;
        }
      }
    }
  }
  /**
   * Generates a standard Obsidian wikilink to a heading
   */
  generateObsidianWikilink(file, heading) {
    const headingText = heading.heading;
    const fileName = file.basename;
    return `[[${fileName}#${headingText}|${headingText}]]`;
  }
  /**
   * Generates an Astro-compatible markdown link to a heading
   */
  generateAstroLink(file, heading) {
    const headingText = heading.heading;
    const anchor = toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[${headingText}](${astroUrl})`;
  }
  /**
   * Generates an Astro-compatible wikilink to a heading
   */
  generateAstroWikilink(file, heading) {
    const headingText = heading.heading;
    const anchor = toKebabCase(headingText);
    const internalLink = `${file.path}#${anchor}`;
    const astroUrl = this.getAstroUrlFromInternalLink(internalLink);
    return `[[${headingText}|${astroUrl}]]`;
  }
  /**
   * Extracts the URL from a markdown link or wikilink
   */
  extractUrl(link) {
    const markdownMatch = link.match(/\[([^\]]+)\]\(([^)]+)\)/);
    if (markdownMatch) {
      return markdownMatch[2];
    }
    const wikilinkMatch = link.match(/\[\[([^\]]+)\]\]/);
    if (wikilinkMatch) {
      const content = wikilinkMatch[1];
      const pathPart = content.split("|")[0];
      return pathPart;
    }
    return link;
  }
  /**
   * Generates the appropriate link format based on settings
   */
  generateLink(app, file, heading) {
    if (this.settings.copyHeadingLinkFormat === "astro") {
      return this.generateAstroLink(file, heading);
    } else {
      return this.generateObsidianLink(app, file, heading);
    }
  }
  /**
   * Finds the heading at a specific line in a file
   */
  findHeadingAtLine(app, file, line) {
    const cache = app.metadataCache.getFileCache(file);
    if (!cache || !cache.headings) {
      return null;
    }
    for (let i = cache.headings.length - 1; i >= 0; i--) {
      const heading = cache.headings[i];
      if (heading.position.start.line <= line) {
        return heading;
      }
    }
    return null;
  }
};

// src/services/MigrationService.ts
var import_obsidian12 = require("obsidian");

// src/ui/components/MigrationModal.ts
var import_obsidian11 = require("obsidian");
var MigrationModal = class extends import_obsidian11.Modal {
  constructor(app, conflicts) {
    super(app);
    this.result = null;
    this.resolvePromise = null;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.addClass("astro-composer-migration-modal");
    contentEl.createEl("h2", { text: "Migration conflict detected" });
    contentEl.createEl("p", {
      text: "You have existing content types with names that conflict with posts or pages. How would you like to proceed?"
    });
    const conflictList = contentEl.createEl("ul");
    conflictList.createEl("li", { text: "Skip migration: keep your existing posts/pages settings (they will be ignored)" });
    conflictList.createEl("li", { text: "Migrate with renamed types: create 'posts (migrated)' and 'pages (migrated)' content types" });
    const buttonContainer = contentEl.createDiv({ cls: "modal-button-container" });
    const skipButton = buttonContainer.createEl("button", {
      text: "Skip migration",
      cls: "mod-cta"
    });
    skipButton.onclick = () => {
      this.result = { action: "skip" };
      this.close();
    };
    const migrateButton = buttonContainer.createEl("button", {
      text: "Migrate with renamed types",
      cls: "mod-cta"
    });
    migrateButton.onclick = () => {
      this.result = { action: "migrate" };
      this.close();
    };
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    if (this.resolvePromise && this.result) {
      this.resolvePromise(this.result);
    }
  }
  async waitForResult() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
};

// src/services/MigrationService.ts
var MigrationService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
  }
  /**
   * Migrate old posts/pages settings to unified content types
   */
  async migrateSettingsIfNeeded() {
    const settings = this.plugin.settings;
    if (settings.migrationCompleted) {
      return;
    }
    const hasPostsSettings = settings.automatePostCreation !== void 0 && settings.automatePostCreation;
    const hasPagesSettings = settings.enablePages !== void 0 && settings.enablePages;
    if (!hasPostsSettings && !hasPagesSettings) {
      settings.migrationCompleted = true;
      await this.plugin.saveSettings();
      return;
    }
    const legacyContentTypes = settings.customContentTypes;
    const existingContentTypes = settings.contentTypes || legacyContentTypes || [];
    const conflicts = [];
    if (existingContentTypes.some((ct) => ct.name === "Posts")) {
      conflicts.push("Posts");
    }
    if (existingContentTypes.some((ct) => ct.name === "Pages")) {
      conflicts.push("Pages");
    }
    let shouldMigrate = true;
    if (conflicts.length > 0) {
      await new Promise((resolve) => {
        setTimeout(() => {
          void (async () => {
            try {
              const modal = new MigrationModal(this.app, conflicts);
              const timeoutPromise = new Promise((timeoutResolve) => {
                setTimeout(() => {
                  timeoutResolve({ action: "skip" });
                }, 3e4);
              });
              const result = await Promise.race([
                modal.waitForResult(),
                timeoutPromise
              ]);
              if (result.action === "skip") {
                shouldMigrate = false;
                new import_obsidian12.Notice("Migration skipped. Old posts/pages settings will be ignored.");
              }
            } catch (error) {
              console.warn("Migration modal error:", error);
              shouldMigrate = false;
              new import_obsidian12.Notice("Migration skipped due to error. You can migrate manually in settings.");
            }
            resolve();
          })();
        }, 500);
      });
    }
    if (!shouldMigrate) {
      settings.migrationCompleted = true;
      await this.plugin.saveSettings();
      return;
    }
    const migratedTypes = [];
    if (hasPostsSettings && !conflicts.includes("Posts")) {
      const postsType = {
        id: `posts-${Date.now()}`,
        name: "Posts",
        folder: settings.postsFolder || "",
        linkBasePath: settings.postsLinkBasePath || "",
        template: settings.defaultTemplate || '---\ntitle: "{{title}}"\ndate: {{date}}\ntags: []\n---\n',
        enabled: true,
        creationMode: settings.creationMode || "file",
        indexFileName: settings.indexFileName || "",
        ignoreSubfolders: settings.onlyAutomateInPostsFolder || false,
        enableUnderscorePrefix: settings.enableUnderscorePrefix || false,
        useMdxExtension: false
      };
      migratedTypes.push(postsType);
    }
    if (hasPagesSettings && !conflicts.includes("Pages")) {
      const pagesType = {
        id: `pages-${Date.now()}`,
        name: "Pages",
        folder: settings.pagesFolder || "",
        linkBasePath: settings.pagesLinkBasePath || "",
        template: settings.pageTemplate || '---\ntitle: "{{title}}"\ndescription: ""\n---\n',
        enabled: true,
        creationMode: settings.pagesCreationMode || "file",
        indexFileName: settings.pagesIndexFileName || "",
        ignoreSubfolders: settings.onlyAutomateInPagesFolder || false,
        enableUnderscorePrefix: false,
        useMdxExtension: false
      };
      migratedTypes.push(pagesType);
    }
    const existingFromNew = settings.contentTypes || [];
    const existingFromLegacy = legacyContentTypes || [];
    let existingTypes = existingFromNew.length > 0 ? existingFromNew : existingFromLegacy;
    let finalTypes = [...existingTypes];
    if (migratedTypes.length > 0) {
      const existingNames = new Set(existingTypes.map((ct) => ct.name));
      const newMigratedTypes = migratedTypes.filter((mt) => !existingNames.has(mt.name));
      if (newMigratedTypes.length > 0) {
        finalTypes = [...existingTypes, ...newMigratedTypes];
      }
    }
    settings.contentTypes = finalTypes;
    const legacyFields = [
      "customContentTypes",
      "enableUnderscorePrefix",
      "postsFolder",
      "postsLinkBasePath",
      "automatePostCreation",
      "creationMode",
      "indexFileName",
      "excludedDirectories",
      "onlyAutomateInPostsFolder",
      "enablePages",
      "pagesFolder",
      "pagesLinkBasePath",
      "pagesCreationMode",
      "pagesIndexFileName",
      "pageTemplate",
      "onlyAutomateInPagesFolder"
    ];
    const settingsRecord = settings;
    for (const field of legacyFields) {
      delete settingsRecord[field];
    }
    settings.migrationCompleted = true;
    await this.plugin.saveSettings();
    await this.plugin.loadSettings();
    if (migratedTypes.length > 0) {
      new import_obsidian12.Notice(`Migration completed: ${migratedTypes.length} content type(s) migrated.`);
      setTimeout(() => {
        if (this.plugin.settingsTab instanceof AstroComposerSettingTab) {
          const settingsTab = this.plugin.settingsTab;
          try {
            if (settingsTab.customContentTypesContainer || settingsTab.containerEl) {
              settingsTab.display();
            }
          } catch (e) {
            console.warn("Could not refresh settings tab after migration:", e);
          }
        }
      }, 300);
    }
  }
};

// src/services/CreateEventService.ts
var import_obsidian13 = require("obsidian");
var CreateEventService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    this.lastProcessedFiles = /* @__PURE__ */ new Map();
  }
  handleCreate(file) {
    void (async () => {
      const now = Date.now();
      if (!(file instanceof import_obsidian13.TFile) || file.extension !== "md" && file.extension !== "mdx") {
        return;
      }
      const filePath = file.path;
      const createdTime = this.plugin.pluginCreatedFiles.get(filePath);
      if (createdTime && now - createdTime < 5 * 60 * 1e3) {
        return;
      }
      const lastProcessed = this.lastProcessedFiles.get(filePath) || 0;
      if (lastProcessed > 0 && now - lastProcessed < CONSTANTS.DEBOUNCE_MS) {
        return;
      }
      if (lastProcessed > 0 && now - lastProcessed > 2e3) {
        this.lastProcessedFiles.delete(filePath);
      }
      const periodicCutoff = now - CONSTANTS.DEBOUNCE_MS * 2;
      for (const [path, time] of this.lastProcessedFiles.entries()) {
        if (time < periodicCutoff) {
          this.lastProcessedFiles.delete(path);
        }
      }
      await this.plugin.loadSettings();
      const activeFile = this.app.workspace.getActiveFile();
      const isActiveFile = activeFile && activeFile.path === file.path;
      if (!this.plugin.settings.processBackgroundFileChanges && !isActiveFile) {
        return;
      }
      const contentTypes = this.plugin.settings.contentTypes || [];
      const hasEnabledContentTypes = contentTypes.some((ct) => ct.enabled);
      if (!hasEnabledContentTypes) {
        return;
      }
      const sortedContentTypes = sortByPatternSpecificity(contentTypes);
      let matchedContentTypeId = null;
      const matchingTypes = [];
      for (const contentType of sortedContentTypes) {
        if (!contentType.enabled) continue;
        let matches = false;
        if (!contentType.folder || contentType.folder.trim() === "") {
          if (!filePath.includes("/") || filePath.split("/").length === 1) {
            matches = true;
          }
        } else if (matchesFolderPattern(filePath, contentType.folder)) {
          if (contentType.ignoreSubfolders) {
            const pathSegments = filePath.split("/");
            const pathDepth = pathSegments.length;
            const patternSegments = contentType.folder.split("/");
            const expectedDepth = patternSegments.length;
            if (contentType.creationMode === "folder") {
              const folderDepth = pathDepth - 1;
              if (folderDepth === expectedDepth || folderDepth === expectedDepth + 1) {
                matches = true;
              }
            } else {
              if (pathDepth === expectedDepth) {
                matches = true;
              }
            }
          } else {
            matches = true;
          }
        }
        if (matches) {
          matchingTypes.push(contentType);
          if (!matchedContentTypeId) {
            matchedContentTypeId = contentType.id;
          }
        }
      }
      if (matchingTypes.length > 1) {
        const typeNames = matchingTypes.map((ct) => ct.name || "Unnamed").join(", ");
        new import_obsidian13.Notice(`Multiple content types (${typeNames}) match this file. Using most specific: ${matchingTypes[0].name || "Unnamed"}`);
      }
      if (!matchedContentTypeId) {
        return;
      }
      const stat = await this.app.vault.adapter.stat(file.path);
      const isNewNote = (stat == null ? void 0 : stat.mtime) && now - stat.mtime < CONSTANTS.STAT_MTIME_THRESHOLD;
      if (!isNewNote) {
        return;
      }
      await new Promise((resolve) => setTimeout(resolve, 50));
      let content;
      try {
        content = await this.app.vault.read(file);
      } catch (error) {
        console.error("Error reading file for create detection:", error);
        return;
      }
      if (content.trim().length > 0) {
        if (content.startsWith("---")) {
          const frontmatterEnd = content.indexOf("\n---", 3);
          if (frontmatterEnd !== -1) {
            const frontmatterText = content.slice(4, frontmatterEnd).trim();
            const lines = frontmatterText.split("\n").filter((line) => line.trim().length > 0);
            if (!this.plugin.settings.processBackgroundFileChanges && lines.length > 0) {
              return;
            }
            if (lines.length > 1 || lines.length === 1 && !lines[0].startsWith("title:")) {
              return;
            }
          }
        }
        const contentWithoutFrontmatter = content.startsWith("---") ? content.slice(content.indexOf("\n---", 3) + 4).trim() : content.trim();
        if (contentWithoutFrontmatter.length > 0) {
          return;
        }
      }
      this.lastProcessedFiles.set(file.path, now);
      setTimeout(() => {
        this.lastProcessedFiles.delete(file.path);
      }, CONSTANTS.DEBOUNCE_MS + 100);
      new TitleModal(this.app, file, this.plugin, matchedContentTypeId, false, true).open();
    })();
  }
};

// src/services/FrontmatterService.ts
var import_obsidian14 = require("obsidian");
var FrontmatterService = class {
  constructor(app, plugin) {
    this.app = app;
    this.plugin = plugin;
    this.lastProcessedFile = "";
    this.lastProcessedTime = 0;
    this.debounceTimeout = null;
    this.draftStatusMap = /* @__PURE__ */ new Map();
    this.registerEvents();
    this.app.workspace.onLayoutReady(() => {
      this.initializeDraftStatusMap();
    });
  }
  initializeDraftStatusMap() {
    var _a;
    this.draftStatusMap.clear();
    const settings = this.plugin.settings;
    const draftProp = settings.draftProperty || "draft";
    const files = this.app.vault.getFiles().filter((f) => f instanceof import_obsidian14.TFile && (f.extension === "md" || f.extension === "mdx"));
    for (const file of files) {
      const cache = this.app.metadataCache.getFileCache(file);
      const rawValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[draftProp];
      this.draftStatusMap.set(file.path, this.calculateIsDraft(rawValue, settings));
    }
  }
  calculateIsDraft(rawValue, settings) {
    if (rawValue === void 0 || rawValue === null) return false;
    const val = String(rawValue).toLowerCase();
    if (settings.draftLogic === "false-is-draft") {
      return val === "false" || val === "0" || rawValue === false;
    } else {
      return val === "true" || val === "1" || rawValue === true;
    }
  }
  registerEvents() {
    this.plugin.registerEvent(
      this.app.metadataCache.on("changed", (file) => {
        if (file instanceof import_obsidian14.TFile) {
          this.onMetadataChange(file);
        }
      })
    );
    this.plugin.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian14.TFile) {
          this.onRename(file, oldPath);
        }
      })
    );
  }
  onRename(file, oldPath) {
    var _a;
    const settings = this.plugin.settings;
    if (!settings.syncDraftDate) return;
    const oldName = oldPath.split("/").pop() || "";
    const newName = file.name;
    if (oldName.startsWith("_") && !newName.startsWith("_")) {
      const contentType = (_a = this.plugin.fileOps) == null ? void 0 : _a.getContentTypeByPath(file.path);
      if (contentType == null ? void 0 : contentType.enableUnderscorePrefix) {
        void this.updateDate(file);
      }
    }
  }
  onMetadataChange(file) {
    var _a;
    const settings = this.plugin.settings;
    if (!settings.syncDraftDate && !settings.updateModifiedDate) {
      return;
    }
    const cache = this.app.metadataCache.getFileCache(file);
    const draftProp = settings.draftProperty || "draft";
    const rawValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[draftProp];
    const isCurrentlyDraft = this.calculateIsDraft(rawValue, settings);
    if (!this.draftStatusMap.has(file.path)) {
      this.draftStatusMap.set(file.path, isCurrentlyDraft);
      return;
    }
    const previousDraftStatus = this.draftStatusMap.get(file.path);
    let draftStatusChangedToPublished = false;
    if (previousDraftStatus === true && isCurrentlyDraft === false) {
      draftStatusChangedToPublished = true;
    }
    this.draftStatusMap.set(file.path, isCurrentlyDraft);
    if (!draftStatusChangedToPublished && !settings.updateModifiedDate) {
      return;
    }
    const now = Date.now();
    if (this.lastProcessedFile === file.path && now - this.lastProcessedTime < 2e3) {
      return;
    }
    if (this.debounceTimeout) {
      window.clearTimeout(this.debounceTimeout);
    }
    this.debounceTimeout = window.setTimeout(() => {
      void this.processFile(file, draftStatusChangedToPublished);
    }, 500);
  }
  async updateDate(file) {
    const settings = this.plugin.settings;
    const dateField = settings.publishDateField || "date";
    await this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      const today = (0, import_obsidian14.moment)().format(settings.dateFormat);
      if (frontmatter[dateField] !== today) {
        frontmatter[dateField] = today;
        this.lastProcessedFile = file.path;
        this.lastProcessedTime = Date.now();
      }
    });
  }
  async processFile(file, draftStatusChangedToPublished) {
    const settings = this.plugin.settings;
    const publishDateField = settings.publishDateField || "date";
    await this.app.fileManager.processFrontMatter(file, (frontmatter) => {
      let changed = false;
      if (settings.syncDraftDate && draftStatusChangedToPublished) {
        const today = (0, import_obsidian14.moment)().format(settings.dateFormat);
        if (frontmatter[publishDateField] !== today) {
          frontmatter[publishDateField] = today;
          changed = true;
        }
      }
      const modifiedField = settings.modifiedDateField || "modified";
      if (settings.updateModifiedDate) {
        const now = (0, import_obsidian14.moment)().format(settings.dateFormat);
        if (frontmatter[modifiedField] !== now) {
          frontmatter[modifiedField] = now;
          changed = true;
        }
      }
      if (changed) {
        this.lastProcessedFile = file.path;
        this.lastProcessedTime = Date.now();
      }
    });
  }
};

// src/main.ts
var AstroComposerPlugin = class extends import_obsidian15.Plugin {
  constructor() {
    super(...arguments);
    this.pluginCreatedFiles = /* @__PURE__ */ new Map();
    this.processedFiles = /* @__PURE__ */ new Map();
    this.terminalRibbonIcon = null;
    this.configRibbonIcon = null;
  }
  /**
   * Migrate old posts/pages settings to unified content types
   */
  async migrateSettingsIfNeeded() {
    if (!this.migrationService) {
      this.migrationService = new MigrationService(this.app, this);
    }
    await this.migrationService.migrateSettingsIfNeeded();
  }
  async onload() {
    try {
      await this.loadSettings();
      this.fileOps = new FileOperations(this.app, this.settings, this);
      this.migrationService = new MigrationService(this.app, this);
      this.createEventService = new CreateEventService(this.app, this);
      this.frontmatterService = new FrontmatterService(this.app, this);
      this.templateParser = new TemplateParser(this.app, this.settings);
      this.headingLinkGenerator = new HeadingLinkGenerator(this.settings);
      if (this.settings.showMdxFilesInExplorer) {
        try {
          this.registerExtensions(["mdx"], "markdown");
        } catch (error) {
          console.warn("[Astro Composer] MDX extension already registered:", error);
        }
      }
      this.app.workspace.onLayoutReady(() => {
        this.registerCreateEvent();
        if (!import_obsidian15.Platform.isMobile) {
          this.startHelpButtonMonitor();
        }
        void this.migrateSettingsIfNeeded();
      });
      registerCommands(this, this.settings);
      registerContentTypeCommands(this, this.settings);
      this.settingsTab = new AstroComposerSettingTab(this.app, this);
      this.addSettingTab(this.settingsTab);
      this.registerContextMenu();
      this.registerRibbonIcons();
      this.setupRibbonContextMenuHandling();
    } catch (error) {
      console.error("[Astro Composer] Critical error during onload:", error);
      new import_obsidian15.Notice("Astro Composer failed to load. Check console (Ctrl+Shift+I) for details.");
      throw error;
    }
  }
  registerCreateEvent() {
    if (this.createEventRef) {
      this.app.vault.offref(this.createEventRef);
      this.createEventRef = void 0;
    }
    const createEventRef = this.app.vault.on("create", (file) => {
      if (file instanceof import_obsidian15.TFile) {
        this.createEventService.handleCreate(file);
        this.cleanupPluginCreatedFiles();
      }
    });
    this.registerEvent(createEventRef);
    this.createEventRef = createEventRef;
  }
  cleanupPluginCreatedFiles() {
    const now = Date.now();
    const ttl = 5 * 60 * 1e3;
    for (const [path, timestamp] of this.pluginCreatedFiles.entries()) {
      if (now - timestamp > ttl) {
        this.pluginCreatedFiles.delete(path);
      }
    }
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData);
    if (!this.settings.contentTypes || !Array.isArray(this.settings.contentTypes)) {
      this.settings.contentTypes = [];
    }
    if (!this.settings.migrationCompleted) {
      const legacySettings = this.settings;
      const hasLegacyTypes = legacySettings.customContentTypes && Array.isArray(legacySettings.customContentTypes) && legacySettings.customContentTypes.length > 0;
      const hasNewTypes = this.settings.contentTypes && Array.isArray(this.settings.contentTypes) && this.settings.contentTypes.length > 0;
      if (hasLegacyTypes && !hasNewTypes) {
        this.settings.contentTypes = legacySettings.customContentTypes || [];
      }
    } else {
      const legacyFields = [
        "customContentTypes",
        "enableUnderscorePrefix",
        "postsFolder",
        "postsLinkBasePath",
        "automatePostCreation",
        "creationMode",
        "indexFileName",
        "excludedDirectories",
        "onlyAutomateInPostsFolder",
        "enablePages",
        "pagesFolder",
        "pagesLinkBasePath",
        "pagesCreationMode",
        "pagesIndexFileName",
        "pageTemplate",
        "onlyAutomateInPagesFolder",
        "linkBasePath",
        "enableAutoRename",
        "enableAutoInsertFrontmatter",
        "draftStyle"
      ];
      const settingsRecord = this.settings;
      let fieldsRemoved = false;
      for (const field of legacyFields) {
        if (settingsRecord[field] !== void 0) {
          delete settingsRecord[field];
          fieldsRemoved = true;
        }
      }
      if (fieldsRemoved) {
        await this.saveSettings();
      }
    }
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  registerContextMenu() {
    this.registerEvent(
      this.app.workspace.on("editor-menu", (menu, editor, view) => {
        if (!this.settings.enableCopyHeadingLink) {
          return;
        }
        const cursor = editor.getCursor();
        const file = view.file;
        if (!(file instanceof import_obsidian15.TFile)) {
          return;
        }
        const heading = this.headingLinkGenerator.findHeadingAtLine(this.app, file, cursor.line);
        if (heading) {
          const fullLink = this.headingLinkGenerator.generateLink(this.app, file, heading);
          const urlOnly = this.headingLinkGenerator.extractUrl(fullLink);
          menu.addItem((item) => {
            item.setTitle("Copy heading link").setIcon("link-2").onClick(async () => {
              await navigator.clipboard.writeText(urlOnly);
              new import_obsidian15.Notice("Heading link copied to clipboard");
            });
          });
          menu.addItem((item) => {
            item.setTitle("Copy heading link with text").setIcon("heading").onClick(async () => {
              await navigator.clipboard.writeText(fullLink);
              new import_obsidian15.Notice("Heading link with text copied to clipboard");
            });
          });
        }
      })
    );
  }
  renameContentByPath(filePath) {
    renameContentByPath(this.app, filePath, this.settings, this);
  }
  registerRibbonIcons() {
    if (import_obsidian15.Platform.isMobile) {
      if (this.terminalRibbonIcon) {
        try {
          if (this.terminalRibbonIcon.parentNode) this.terminalRibbonIcon.remove();
        } catch (e) {
        }
        this.terminalRibbonIcon = null;
      }
      if (this.configRibbonIcon) {
        try {
          if (this.configRibbonIcon.parentNode) this.configRibbonIcon.remove();
        } catch (e) {
        }
        this.configRibbonIcon = null;
      }
      try {
        const terminalIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]');
        terminalIcons.forEach((icon) => icon.remove());
        const configIcons = document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]');
        configIcons.forEach((icon) => icon.remove());
      } catch (e) {
      }
      return;
    }
    const terminalShouldExist = this.settings.enableTerminalRibbonIcon && this.settings.enableOpenTerminalCommand;
    const configShouldExist = this.settings.enableConfigRibbonIcon && this.settings.enableOpenConfigFileCommand;
    if (this.terminalRibbonIcon) {
      try {
        if (this.terminalRibbonIcon.parentNode) this.terminalRibbonIcon.remove();
      } catch (e) {
      }
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      try {
        if (this.configRibbonIcon.parentNode) this.configRibbonIcon.remove();
      } catch (e) {
      }
      this.configRibbonIcon = null;
    }
    try {
      document.querySelectorAll('.side-dock-ribbon-action[aria-label="Open project terminal"]').forEach((el) => el.remove());
      document.querySelectorAll('.side-dock-ribbon-action[aria-label="Edit astro config"]').forEach((el) => el.remove());
    } catch (e) {
    }
    if (terminalShouldExist) {
      this.terminalRibbonIcon = this.addRibbonIcon("terminal-square", "Open project terminal", () => {
        if (!this.settings.enableOpenTerminalCommand) {
          new import_obsidian15.Notice("Open terminal command is disabled.");
          return;
        }
        openTerminalInProjectRoot(this.app, this.settings);
      });
      if (this.terminalRibbonIcon) this.terminalRibbonIcon.setAttribute("data-astro-composer-terminal-ribbon", "true");
    }
    if (configShouldExist) {
      this.configRibbonIcon = this.addRibbonIcon("rocket", "Edit astro config", async () => {
        if (!this.settings.enableOpenConfigFileCommand) {
          new import_obsidian15.Notice("Edit config file command is disabled.");
          return;
        }
        await openConfigFile(this.app, this.settings);
      });
      if (this.configRibbonIcon) this.configRibbonIcon.setAttribute("data-astro-composer-config-ribbon", "true");
    }
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
  }
  onunload() {
    if (this.terminalRibbonIcon) {
      this.terminalRibbonIcon.remove();
      this.terminalRibbonIcon = null;
    }
    if (this.configRibbonIcon) {
      this.configRibbonIcon.remove();
      this.configRibbonIcon = null;
    }
    if (this.ribbonContextMenuObserver) {
      this.ribbonContextMenuObserver.disconnect();
      this.ribbonContextMenuObserver = void 0;
    }
    document.body.removeClass("astro-composer-hide-terminal-icon");
    document.body.removeClass("astro-composer-hide-config-icon");
    if (this.helpButtonObserver) {
      this.helpButtonObserver.disconnect();
      this.helpButtonObserver = void 0;
    }
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  setupRibbonContextMenuHandling() {
    this.updateRibbonContextMenuCSS();
    this.setupRibbonContextMenuObserver();
  }
  updateRibbonContextMenuCSS() {
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (terminalShouldBeHidden) document.body.addClass("astro-composer-hide-terminal-icon");
    else document.body.removeClass("astro-composer-hide-terminal-icon");
    if (configShouldBeHidden) document.body.addClass("astro-composer-hide-config-icon");
    else document.body.removeClass("astro-composer-hide-config-icon");
  }
  setupRibbonContextMenuObserver() {
    if (this.ribbonContextMenuObserver) this.ribbonContextMenuObserver.disconnect();
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    if (!terminalShouldBeHidden && !configShouldBeHidden) return;
    this.ribbonContextMenuObserver = new MutationObserver((mutations) => {
      for (const mutation of mutations) {
        if (mutation.addedNodes.length > 0) {
          for (const node of Array.from(mutation.addedNodes)) {
            if (node instanceof HTMLElement) {
              if (node.classList.contains("menu") || node.querySelector(".menu")) {
                this.removeRibbonIconsFromContextMenu(node);
              }
            }
          }
        }
      }
    });
    this.ribbonContextMenuObserver.observe(document.body, { childList: true, subtree: true });
  }
  /**
   * Starts a robust monitor that keeps the help button in sync with settings.
   */
  startHelpButtonMonitor() {
    if (this.helpButtonObserver) this.helpButtonObserver.disconnect();
    this.syncHelpButton();
    let timer = null;
    let mutationCount = 0;
    this.helpButtonObserver = new MutationObserver(() => {
      mutationCount++;
      if (timer) window.clearTimeout(timer);
      const delay = mutationCount < 20 ? 0 : 100;
      if (delay === 0) {
        this.syncHelpButton();
      } else {
        timer = window.setTimeout(() => this.syncHelpButton(), delay);
      }
    });
    this.helpButtonObserver.observe(document.body, {
      childList: true,
      subtree: true,
      attributes: true,
      attributeFilter: ["class", "src", "aria-label"]
    });
  }
  /**
   * Synchronizes the help button state based on settings.
   */
  syncHelpButton() {
    var _a, _b, _c, _d;
    const enabled = (_a = this.settings.helpButtonReplacement) == null ? void 0 : _a.enabled;
    if (enabled) document.body.addClass("astro-composer-hide-help-button");
    else document.body.removeClass("astro-composer-hide-help-button");
    if (!enabled) {
      if (this.customHelpButton) {
        this.customHelpButton.remove();
        this.customHelpButton = void 0;
      }
      return;
    }
    const selectors = [
      ".workspace-drawer-vault-actions .clickable-icon svg.help",
      ".workspace-sidedock-vault-profile .clickable-icon svg.help",
      ".workspace-drawer .clickable-icon svg.help",
      ".clickable-icon svg.help"
    ];
    let helpButtonSvg = null;
    for (const selector of selectors) {
      helpButtonSvg = document.querySelector(selector);
      if (helpButtonSvg) break;
    }
    if (!helpButtonSvg) return;
    const originalHelpButton = helpButtonSvg.parentElement;
    if (!originalHelpButton) return;
    const existingReplacement = (_b = originalHelpButton.parentElement) == null ? void 0 : _b.querySelector('[data-astro-composer-help-replacement="true"]');
    if (existingReplacement) {
      this.customHelpButton = existingReplacement;
      return;
    }
    const customButton = originalHelpButton.cloneNode(true);
    customButton.addClass("astro-composer-help-replacement");
    customButton.removeAttribute("aria-label");
    customButton.setAttribute("data-astro-composer-help-replacement", "true");
    customButton.onclick = null;
    const iconContainer = ((_c = customButton.querySelector("svg")) == null ? void 0 : _c.parentElement) || customButton;
    try {
      if (iconContainer instanceof HTMLElement) {
        (0, import_obsidian15.setIcon)(iconContainer, this.settings.helpButtonReplacement.iconId);
      }
    } catch (error) {
      console.warn("[Astro Composer] Error setting replacement icon:", error);
    }
    customButton.addEventListener("click", (evt) => {
      var _a2, _b2;
      evt.preventDefault();
      evt.stopPropagation();
      const commandId = (_a2 = this.settings.helpButtonReplacement) == null ? void 0 : _a2.commandId;
      if (commandId) {
        const appWithCommands = this.app;
        if ((_b2 = appWithCommands.commands) == null ? void 0 : _b2.executeCommandById) {
          void appWithCommands.commands.executeCommandById(commandId);
        }
      }
    }, true);
    (_d = originalHelpButton.parentElement) == null ? void 0 : _d.insertBefore(customButton, originalHelpButton);
    this.customHelpButton = customButton;
  }
  restoreHelpButton() {
    document.body.removeClass("astro-composer-hide-help-button");
    if (this.customHelpButton) {
      this.customHelpButton.remove();
      this.customHelpButton = void 0;
    }
    this.helpButtonElement = void 0;
  }
  removeRibbonIconsFromContextMenu(menuElement) {
    var _a, _b;
    const terminalShouldBeHidden = !this.settings.enableTerminalRibbonIcon || !this.settings.enableOpenTerminalCommand;
    const configShouldBeHidden = !this.settings.enableConfigRibbonIcon || !this.settings.enableOpenConfigFileCommand;
    const menuItems = menuElement.querySelectorAll(".menu-item");
    for (const item of Array.from(menuItems)) {
      const svg = item.querySelector("svg");
      if (svg) {
        let iconName = svg.getAttribute("data-lucide") || svg.getAttribute("xmlns:lucide") || svg.getAttribute("data-icon") || (svg.classList.contains("lucide-terminal-square") ? "terminal-square" : null) || (svg.classList.contains("lucide-rocket") ? "rocket" : null) || (svg.classList.contains("lucide-wrench") ? "wrench" : null);
        if (iconName) iconName = iconName.replace(/^lucide-/, "");
        if (terminalShouldBeHidden && iconName === "terminal-square") {
          if ((_a = item.textContent) == null ? void 0 : _a.toLowerCase().includes("terminal")) item.remove();
        }
        if (configShouldBeHidden && (iconName === "rocket" || iconName === "wrench")) {
          if ((_b = item.textContent) == null ? void 0 : _b.toLowerCase().includes("config")) item.remove();
        }
      }
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3R5cGVzLnRzIiwgInNyYy9zZXR0aW5ncy50cyIsICJzcmMvY29tbWFuZHMvaW5kZXgudHMiLCAic3JjL3V0aWxzL2ZpbGUtb3BlcmF0aW9ucy50cyIsICJzcmMvdXRpbHMvcGF0aC1tYXRjaGluZy50cyIsICJzcmMvdXRpbHMvc3RyaW5nLXV0aWxzLnRzIiwgInNyYy91dGlscy90ZW1wbGF0ZS1wYXJzaW5nLnRzIiwgInNyYy91dGlscy9saW5rLWNvbnZlcnNpb24udHMiLCAic3JjL3VpL3RpdGxlLW1vZGFsLnRzIiwgInNyYy91aS9zZXR0aW5ncy10YWIudHMiLCAic3JjL3VpL2NvbXBvbmVudHMvQ29tbWFuZFBpY2tlck1vZGFsLnRzIiwgInNyYy91aS9jb21wb25lbnRzL0ljb25QaWNrZXJNb2RhbC50cyIsICJzcmMvdWkvY29tcG9uZW50cy9Db25maXJtTW9kYWwudHMiLCAic3JjL3V0aWxzL3NldHRpbmdzLWNvbXBhdC50cyIsICJzcmMvdXRpbHMvaGVhZGluZy1saW5rLWdlbmVyYXRvci50cyIsICJzcmMvc2VydmljZXMvTWlncmF0aW9uU2VydmljZS50cyIsICJzcmMvdWkvY29tcG9uZW50cy9NaWdyYXRpb25Nb2RhbC50cyIsICJzcmMvc2VydmljZXMvQ3JlYXRlRXZlbnRTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9Gcm9udG1hdHRlclNlcnZpY2UudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7XHJcblx0UGx1Z2luLFxyXG5cdFRGaWxlLFxyXG5cdE5vdGljZSxcclxuXHRzZXRJY29uLFxyXG5cdFBsYXRmb3JtLFxyXG5cdEV2ZW50UmVmLFxyXG59IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSBcIi4vc2V0dGluZ3NcIjtcclxuaW1wb3J0IHsgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgQ29udGVudFR5cGUgfSBmcm9tIFwiLi90eXBlc1wiO1xyXG5pbXBvcnQgeyByZWdpc3RlckNvbW1hbmRzLCByZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHMsIHJlbmFtZUNvbnRlbnRCeVBhdGggYXMgcmVuYW1lQ29udGVudEJ5UGF0aEZ1bmN0aW9uLCBvcGVuVGVybWluYWxJblByb2plY3RSb290LCBvcGVuQ29uZmlnRmlsZSB9IGZyb20gXCIuL2NvbW1hbmRzXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiIH0gZnJvbSBcIi4vdWkvc2V0dGluZ3MtdGFiXCI7XHJcbmltcG9ydCB7IEZpbGVPcGVyYXRpb25zIH0gZnJvbSBcIi4vdXRpbHMvZmlsZS1vcGVyYXRpb25zXCI7XHJcbmltcG9ydCB7IFRlbXBsYXRlUGFyc2VyIH0gZnJvbSBcIi4vdXRpbHMvdGVtcGxhdGUtcGFyc2luZ1wiO1xyXG5pbXBvcnQgeyBIZWFkaW5nTGlua0dlbmVyYXRvciB9IGZyb20gXCIuL3V0aWxzL2hlYWRpbmctbGluay1nZW5lcmF0b3JcIjtcclxuaW1wb3J0IHsgTWlncmF0aW9uU2VydmljZSB9IGZyb20gXCIuL3NlcnZpY2VzL01pZ3JhdGlvblNlcnZpY2VcIjtcclxuaW1wb3J0IHsgQ3JlYXRlRXZlbnRTZXJ2aWNlIH0gZnJvbSBcIi4vc2VydmljZXMvQ3JlYXRlRXZlbnRTZXJ2aWNlXCI7XHJcbmltcG9ydCB7IEZyb250bWF0dGVyU2VydmljZSB9IGZyb20gXCIuL3NlcnZpY2VzL0Zyb250bWF0dGVyU2VydmljZVwiO1xyXG5pbXBvcnQgeyB3YWl0Rm9yRWxlbWVudCB9IGZyb20gXCIuL3V0aWxzL2RvbVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXN0cm9Db21wb3NlclBsdWdpbiBleHRlbmRzIFBsdWdpbiBpbXBsZW1lbnRzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2Uge1xyXG5cdHNldHRpbmdzITogQXN0cm9Db21wb3NlclNldHRpbmdzO1xyXG5cdHByaXZhdGUgY3JlYXRlRXZlbnRSZWY/OiBFdmVudFJlZjtcclxuXHRwdWJsaWMgZmlsZU9wcyE6IEZpbGVPcGVyYXRpb25zO1xyXG5cdHB1YmxpYyB0ZW1wbGF0ZVBhcnNlciE6IFRlbXBsYXRlUGFyc2VyO1xyXG5cdHB1YmxpYyBoZWFkaW5nTGlua0dlbmVyYXRvciE6IEhlYWRpbmdMaW5rR2VuZXJhdG9yO1xyXG5cdHB1YmxpYyBwbHVnaW5DcmVhdGVkRmlsZXM6IE1hcDxzdHJpbmcsIG51bWJlcj4gPSBuZXcgTWFwKCk7XHJcblx0cHJpdmF0ZSBwcm9jZXNzZWRGaWxlczogTWFwPHN0cmluZywgbnVtYmVyPiA9IG5ldyBNYXAoKTtcclxuXHRwcml2YXRlIHRlcm1pbmFsUmliYm9uSWNvbjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRwcml2YXRlIGNvbmZpZ1JpYmJvbkljb246IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0cHJpdmF0ZSByaWJib25Db250ZXh0TWVudU9ic2VydmVyPzogTXV0YXRpb25PYnNlcnZlcjtcclxuXHRwcml2YXRlIGhlbHBCdXR0b25PYnNlcnZlcj86IE11dGF0aW9uT2JzZXJ2ZXI7XHJcblx0cHJpdmF0ZSBoZWxwQnV0dG9uRWxlbWVudD86IEhUTUxFbGVtZW50O1xyXG5cdHByaXZhdGUgY3VzdG9tSGVscEJ1dHRvbj86IEhUTUxFbGVtZW50O1xyXG5cdHB1YmxpYyBzZXR0aW5nc1RhYj86IEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiO1xyXG5cclxuXHRwcml2YXRlIG1pZ3JhdGlvblNlcnZpY2UhOiBNaWdyYXRpb25TZXJ2aWNlO1xyXG5cdHByaXZhdGUgY3JlYXRlRXZlbnRTZXJ2aWNlITogQ3JlYXRlRXZlbnRTZXJ2aWNlO1xyXG5cdHB1YmxpYyBmcm9udG1hdHRlclNlcnZpY2UhOiBGcm9udG1hdHRlclNlcnZpY2U7XHJcblxyXG5cdC8qKlxyXG5cdCAqIE1pZ3JhdGUgb2xkIHBvc3RzL3BhZ2VzIHNldHRpbmdzIHRvIHVuaWZpZWQgY29udGVudCB0eXBlc1xyXG5cdCAqL1xyXG5cdHByaXZhdGUgYXN5bmMgbWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0XHRpZiAoIXRoaXMubWlncmF0aW9uU2VydmljZSkge1xyXG5cdFx0XHR0aGlzLm1pZ3JhdGlvblNlcnZpY2UgPSBuZXcgTWlncmF0aW9uU2VydmljZSh0aGlzLmFwcCwgdGhpcyk7XHJcblx0XHR9XHJcblx0XHRhd2FpdCB0aGlzLm1pZ3JhdGlvblNlcnZpY2UubWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTtcclxuXHR9XHJcblxyXG5cdGFzeW5jIG9ubG9hZCgpIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG5cdFx0XHQvLyBJbml0aWFsaXplIHNlcnZpY2VzIChvcmRlciBtYXR0ZXJzOiBmaWxlT3BzIGZpcnN0IGFzIGl0J3MgYSBkZXBlbmRlbmN5KVxyXG5cdFx0XHR0aGlzLmZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnModGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MsIHRoaXMpO1xyXG5cdFx0XHR0aGlzLm1pZ3JhdGlvblNlcnZpY2UgPSBuZXcgTWlncmF0aW9uU2VydmljZSh0aGlzLmFwcCwgdGhpcyk7XHJcblx0XHRcdHRoaXMuY3JlYXRlRXZlbnRTZXJ2aWNlID0gbmV3IENyZWF0ZUV2ZW50U2VydmljZSh0aGlzLmFwcCwgdGhpcyk7XHJcblx0XHRcdHRoaXMuZnJvbnRtYXR0ZXJTZXJ2aWNlID0gbmV3IEZyb250bWF0dGVyU2VydmljZSh0aGlzLmFwcCwgdGhpcyk7XHJcblx0XHRcdHRoaXMudGVtcGxhdGVQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MpO1xyXG5cdFx0XHR0aGlzLmhlYWRpbmdMaW5rR2VuZXJhdG9yID0gbmV3IEhlYWRpbmdMaW5rR2VuZXJhdG9yKHRoaXMuc2V0dGluZ3MpO1xyXG5cclxuXHRcdFx0Ly8gUmVnaXN0ZXIgTURYIGZpbGUgdmlzaWJpbGl0eSBpZiBlbmFibGVkIChzYWZlbHkgaGFuZGxlIGlmIGFscmVhZHkgcmVnaXN0ZXJlZClcclxuXHRcdFx0aWYgKHRoaXMuc2V0dGluZ3Muc2hvd01keEZpbGVzSW5FeHBsb3Jlcikge1xyXG5cdFx0XHRcdHRyeSB7XHJcblx0XHRcdFx0XHR0aGlzLnJlZ2lzdGVyRXh0ZW5zaW9ucyhbXCJtZHhcIl0sIFwibWFya2Rvd25cIik7XHJcblx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdGNvbnNvbGUud2FybihcIltBc3RybyBDb21wb3Nlcl0gTURYIGV4dGVuc2lvbiBhbHJlYWR5IHJlZ2lzdGVyZWQ6XCIsIGVycm9yKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdC8vIEhhbmRsZSBsYXlvdXQtcmVhZHkgaW5pdGlhbGl6YXRpb24gKGRlc2t0b3Agb25seSlcclxuXHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLm9uTGF5b3V0UmVhZHkoKCkgPT4ge1xyXG5cdFx0XHRcdHRoaXMucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cdFx0XHRcdC8vIEluaXRpYWxpemUgaGVscCBidXR0b24gcmVwbGFjZW1lbnQgKGRlc2t0b3Agb25seSlcclxuXHRcdFx0XHRpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdFx0XHR0aGlzLnN0YXJ0SGVscEJ1dHRvbk1vbml0b3IoKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIFJ1biBtaWdyYXRpb24gYWZ0ZXIgcGx1Z2luIGlzIGZ1bGx5IGxvYWRlZCAobm9uLWJsb2NraW5nKVxyXG5cdFx0XHRcdHZvaWQgdGhpcy5taWdyYXRlU2V0dGluZ3NJZk5lZWRlZCgpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFJlZ2lzdGVyIGNvbW1hbmRzXHJcblx0XHRcdHJlZ2lzdGVyQ29tbWFuZHModGhpcywgdGhpcy5zZXR0aW5ncyk7XHJcblx0XHRcdHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyh0aGlzLCB0aGlzLnNldHRpbmdzKTtcclxuXHJcblx0XHRcdC8vIEFkZCBzZXR0aW5ncyB0YWJcclxuXHRcdFx0dGhpcy5zZXR0aW5nc1RhYiA9IG5ldyBBc3Ryb0NvbXBvc2VyU2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcyk7XHJcblx0XHRcdHRoaXMuYWRkU2V0dGluZ1RhYih0aGlzLnNldHRpbmdzVGFiKTtcclxuXHJcblx0XHRcdC8vIFJlZ2lzdGVyIFVJIGVsZW1lbnRzXHJcblx0XHRcdHRoaXMucmVnaXN0ZXJDb250ZXh0TWVudSgpO1xyXG5cdFx0XHR0aGlzLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcclxuXHRcdFx0dGhpcy5zZXR1cFJpYmJvbkNvbnRleHRNZW51SGFuZGxpbmcoKTtcclxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdGNvbnNvbGUuZXJyb3IoXCJbQXN0cm8gQ29tcG9zZXJdIENyaXRpY2FsIGVycm9yIGR1cmluZyBvbmxvYWQ6XCIsIGVycm9yKTtcclxuXHRcdFx0bmV3IE5vdGljZShcIkFzdHJvIENvbXBvc2VyIGZhaWxlZCB0byBsb2FkLiBDaGVjayBjb25zb2xlIChDdHJsK1NoaWZ0K0kpIGZvciBkZXRhaWxzLlwiKTtcclxuXHRcdFx0dGhyb3cgZXJyb3I7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwdWJsaWMgcmVnaXN0ZXJDcmVhdGVFdmVudCgpIHtcclxuXHRcdGlmICh0aGlzLmNyZWF0ZUV2ZW50UmVmKSB7XHJcblx0XHRcdHRoaXMuYXBwLnZhdWx0Lm9mZnJlZih0aGlzLmNyZWF0ZUV2ZW50UmVmKTtcclxuXHRcdFx0dGhpcy5jcmVhdGVFdmVudFJlZiA9IHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBjcmVhdGVFdmVudFJlZiA9IHRoaXMuYXBwLnZhdWx0Lm9uKFwiY3JlYXRlXCIsIChmaWxlKSA9PiB7XHJcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHR0aGlzLmNyZWF0ZUV2ZW50U2VydmljZS5oYW5kbGVDcmVhdGUoZmlsZSk7XHJcblx0XHRcdFx0dGhpcy5jbGVhbnVwUGx1Z2luQ3JlYXRlZEZpbGVzKCk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KGNyZWF0ZUV2ZW50UmVmKTtcclxuXHRcdHRoaXMuY3JlYXRlRXZlbnRSZWYgPSBjcmVhdGVFdmVudFJlZjtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgY2xlYW51cFBsdWdpbkNyZWF0ZWRGaWxlcygpIHtcclxuXHRcdGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblx0XHRjb25zdCB0dGwgPSA1ICogNjAgKiAxMDAwOyAvLyA1IG1pbnV0ZXNcclxuXHRcdGZvciAoY29uc3QgW3BhdGgsIHRpbWVzdGFtcF0gb2YgdGhpcy5wbHVnaW5DcmVhdGVkRmlsZXMuZW50cmllcygpKSB7XHJcblx0XHRcdGlmIChub3cgLSB0aW1lc3RhbXAgPiB0dGwpIHtcclxuXHRcdFx0XHR0aGlzLnBsdWdpbkNyZWF0ZWRGaWxlcy5kZWxldGUocGF0aCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuXHRcdGNvbnN0IGxvYWRlZERhdGEgPSAoYXdhaXQgdGhpcy5sb2FkRGF0YSgpKSBhcyB1bmtub3duO1xyXG5cdFx0dGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGxvYWRlZERhdGEgYXMgUGFydGlhbDxBc3Ryb0NvbXBvc2VyU2V0dGluZ3M+IHwgbnVsbCB8IHVuZGVmaW5lZCk7XHJcblxyXG5cdFx0Ly8gRW5zdXJlIGNvbnRlbnRUeXBlcyBpcyBhbHdheXMgYW4gYXJyYXkgKG5ldmVyIHVuZGVmaW5lZCBvciBudWxsKVxyXG5cdFx0aWYgKCF0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCAhQXJyYXkuaXNBcnJheSh0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcykpIHtcclxuXHRcdFx0dGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgPSBbXTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIXRoaXMuc2V0dGluZ3MubWlncmF0aW9uQ29tcGxldGVkKSB7XHJcblx0XHRcdGNvbnN0IGxlZ2FjeVNldHRpbmdzID0gdGhpcy5zZXR0aW5ncyBhcyB1bmtub3duIGFzIHsgY3VzdG9tQ29udGVudFR5cGVzPzogQ29udGVudFR5cGVbXSB9O1xyXG5cdFx0XHRjb25zdCBoYXNMZWdhY3lUeXBlcyA9IGxlZ2FjeVNldHRpbmdzLmN1c3RvbUNvbnRlbnRUeXBlcyAmJiBBcnJheS5pc0FycmF5KGxlZ2FjeVNldHRpbmdzLmN1c3RvbUNvbnRlbnRUeXBlcykgJiYgbGVnYWN5U2V0dGluZ3MuY3VzdG9tQ29udGVudFR5cGVzLmxlbmd0aCA+IDA7XHJcblx0XHRcdGNvbnN0IGhhc05ld1R5cGVzID0gdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcykgJiYgdGhpcy5zZXR0aW5ncy5jb250ZW50VHlwZXMubGVuZ3RoID4gMDtcclxuXHJcblx0XHRcdGlmIChoYXNMZWdhY3lUeXBlcyAmJiAhaGFzTmV3VHlwZXMpIHtcclxuXHRcdFx0XHR0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyA9IGxlZ2FjeVNldHRpbmdzLmN1c3RvbUNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Y29uc3QgbGVnYWN5RmllbGRzID0gW1xyXG5cdFx0XHRcdCdjdXN0b21Db250ZW50VHlwZXMnLCAnZW5hYmxlVW5kZXJzY29yZVByZWZpeCcsICdwb3N0c0ZvbGRlcicsICdwb3N0c0xpbmtCYXNlUGF0aCcsXHJcblx0XHRcdFx0J2F1dG9tYXRlUG9zdENyZWF0aW9uJywgJ2NyZWF0aW9uTW9kZScsICdpbmRleEZpbGVOYW1lJywgJ2V4Y2x1ZGVkRGlyZWN0b3JpZXMnLFxyXG5cdFx0XHRcdCdvbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyJywgJ2VuYWJsZVBhZ2VzJywgJ3BhZ2VzRm9sZGVyJywgJ3BhZ2VzTGlua0Jhc2VQYXRoJyxcclxuXHRcdFx0XHQncGFnZXNDcmVhdGlvbk1vZGUnLCAncGFnZXNJbmRleEZpbGVOYW1lJywgJ3BhZ2VUZW1wbGF0ZScsICdvbmx5QXV0b21hdGVJblBhZ2VzRm9sZGVyJyxcclxuXHRcdFx0XHQnbGlua0Jhc2VQYXRoJywgJ2VuYWJsZUF1dG9SZW5hbWUnLCAnZW5hYmxlQXV0b0luc2VydEZyb250bWF0dGVyJywgJ2RyYWZ0U3R5bGUnXHJcblx0XHRcdF07XHJcblxyXG5cdFx0XHRjb25zdCBzZXR0aW5nc1JlY29yZCA9IHRoaXMuc2V0dGluZ3MgYXMgdW5rbm93biBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcclxuXHRcdFx0bGV0IGZpZWxkc1JlbW92ZWQgPSBmYWxzZTtcclxuXHRcdFx0Zm9yIChjb25zdCBmaWVsZCBvZiBsZWdhY3lGaWVsZHMpIHtcclxuXHRcdFx0XHRpZiAoc2V0dGluZ3NSZWNvcmRbZmllbGRdICE9PSB1bmRlZmluZWQpIHtcclxuXHRcdFx0XHRcdGRlbGV0ZSBzZXR0aW5nc1JlY29yZFtmaWVsZF07XHJcblx0XHRcdFx0XHRmaWVsZHNSZW1vdmVkID0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0Ly8gT25seSBzYXZlIGlmIHdlIGFjdHVhbGx5IGNsZWFuZWQgdXAgZmllbGRzIHRvIGF2b2lkIHJlZHVuZGFudCB3cml0ZXNcclxuXHRcdFx0aWYgKGZpZWxkc1JlbW92ZWQpIHtcclxuXHRcdFx0XHRhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcblx0XHRhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSByZWdpc3RlckNvbnRleHRNZW51KCkge1xyXG5cdFx0dGhpcy5yZWdpc3RlckV2ZW50KFxyXG5cdFx0XHR0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2VkaXRvci1tZW51JywgKG1lbnUsIGVkaXRvciwgdmlldykgPT4ge1xyXG5cdFx0XHRcdGlmICghdGhpcy5zZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmspIHtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcclxuXHRcdFx0XHRjb25zdCBmaWxlID0gdmlldy5maWxlO1xyXG5cclxuXHRcdFx0XHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjb25zdCBoZWFkaW5nID0gdGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvci5maW5kSGVhZGluZ0F0TGluZSh0aGlzLmFwcCwgZmlsZSwgY3Vyc29yLmxpbmUpO1xyXG5cclxuXHRcdFx0XHRpZiAoaGVhZGluZykge1xyXG5cdFx0XHRcdFx0Y29uc3QgZnVsbExpbmsgPSB0aGlzLmhlYWRpbmdMaW5rR2VuZXJhdG9yLmdlbmVyYXRlTGluayh0aGlzLmFwcCwgZmlsZSwgaGVhZGluZyk7XHJcblx0XHRcdFx0XHRjb25zdCB1cmxPbmx5ID0gdGhpcy5oZWFkaW5nTGlua0dlbmVyYXRvci5leHRyYWN0VXJsKGZ1bGxMaW5rKTtcclxuXHJcblx0XHRcdFx0XHRtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuXHRcdFx0XHRcdFx0aXRlbVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRUaXRsZSgnQ29weSBoZWFkaW5nIGxpbmsnKVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRJY29uKCdsaW5rLTInKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0KHVybE9ubHkpO1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZSgnSGVhZGluZyBsaW5rIGNvcGllZCB0byBjbGlwYm9hcmQnKTtcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRpdGVtXHJcblx0XHRcdFx0XHRcdFx0LnNldFRpdGxlKCdDb3B5IGhlYWRpbmcgbGluayB3aXRoIHRleHQnKVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRJY29uKCdoZWFkaW5nJylcclxuXHRcdFx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCBuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dChmdWxsTGluayk7XHJcblx0XHRcdFx0XHRcdFx0XHRuZXcgTm90aWNlKCdIZWFkaW5nIGxpbmsgd2l0aCB0ZXh0IGNvcGllZCB0byBjbGlwYm9hcmQnKTtcclxuXHRcdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSlcclxuXHRcdCk7XHJcblx0fVxyXG5cclxuXHRyZW5hbWVDb250ZW50QnlQYXRoKGZpbGVQYXRoOiBzdHJpbmcpOiB2b2lkIHtcclxuXHRcdHJlbmFtZUNvbnRlbnRCeVBhdGhGdW5jdGlvbih0aGlzLmFwcCwgZmlsZVBhdGgsIHRoaXMuc2V0dGluZ3MsIHRoaXMpO1xyXG5cdH1cclxuXHJcblx0cHVibGljIHJlZ2lzdGVyUmliYm9uSWNvbnMoKSB7XHJcblx0XHRpZiAoUGxhdGZvcm0uaXNNb2JpbGUpIHtcclxuXHRcdFx0aWYgKHRoaXMudGVybWluYWxSaWJib25JY29uKSB7XHJcblx0XHRcdFx0dHJ5IHsgaWYgKHRoaXMudGVybWluYWxSaWJib25JY29uLnBhcmVudE5vZGUpIHRoaXMudGVybWluYWxSaWJib25JY29uLnJlbW92ZSgpOyB9IGNhdGNoIHsgLyogSWdub3JlICovIH1cclxuXHRcdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKHRoaXMuY29uZmlnUmliYm9uSWNvbikge1xyXG5cdFx0XHRcdHRyeSB7IGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24ucGFyZW50Tm9kZSkgdGhpcy5jb25maWdSaWJib25JY29uLnJlbW92ZSgpOyB9IGNhdGNoIHsgLyogSWdub3JlICovIH1cclxuXHRcdFx0XHR0aGlzLmNvbmZpZ1JpYmJvbkljb24gPSBudWxsO1xyXG5cdFx0XHR9XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Y29uc3QgdGVybWluYWxJY29ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaWRlLWRvY2stcmliYm9uLWFjdGlvblthcmlhLWxhYmVsPVwiT3BlbiBwcm9qZWN0IHRlcm1pbmFsXCJdJyk7XHJcblx0XHRcdFx0dGVybWluYWxJY29ucy5mb3JFYWNoKChpY29uOiBFbGVtZW50KSA9PiBpY29uLnJlbW92ZSgpKTtcclxuXHRcdFx0XHRjb25zdCBjb25maWdJY29ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zaWRlLWRvY2stcmliYm9uLWFjdGlvblthcmlhLWxhYmVsPVwiRWRpdCBhc3RybyBjb25maWdcIl0nKTtcclxuXHRcdFx0XHRjb25maWdJY29ucy5mb3JFYWNoKChpY29uOiBFbGVtZW50KSA9PiBpY29uLnJlbW92ZSgpKTtcclxuXHRcdFx0fSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCB0ZXJtaW5hbFNob3VsZEV4aXN0ID0gdGhpcy5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kO1xyXG5cdFx0Y29uc3QgY29uZmlnU2hvdWxkRXhpc3QgPSB0aGlzLnNldHRpbmdzLmVuYWJsZUNvbmZpZ1JpYmJvbkljb24gJiYgdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ7XHJcblxyXG5cdFx0aWYgKHRoaXMudGVybWluYWxSaWJib25JY29uKSB7XHJcblx0XHRcdHRyeSB7IGlmICh0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5wYXJlbnROb2RlKSB0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5yZW1vdmUoKTsgfSBjYXRjaCB7IC8qIElnbm9yZSAqLyB9XHJcblx0XHRcdHRoaXMudGVybWluYWxSaWJib25JY29uID0gbnVsbDtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAodGhpcy5jb25maWdSaWJib25JY29uKSB7XHJcblx0XHRcdHRyeSB7IGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24ucGFyZW50Tm9kZSkgdGhpcy5jb25maWdSaWJib25JY29uLnJlbW92ZSgpOyB9IGNhdGNoIHsgLyogSWdub3JlICovIH1cclxuXHRcdFx0dGhpcy5jb25maWdSaWJib25JY29uID0gbnVsbDtcclxuXHRcdH1cclxuXHJcblx0XHR0cnkge1xyXG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIk9wZW4gcHJvamVjdCB0ZXJtaW5hbFwiXScpLmZvckVhY2goZWwgPT4gZWwucmVtb3ZlKCkpO1xyXG5cdFx0XHRkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2lkZS1kb2NrLXJpYmJvbi1hY3Rpb25bYXJpYS1sYWJlbD1cIkVkaXQgYXN0cm8gY29uZmlnXCJdJykuZm9yRWFjaChlbCA9PiBlbC5yZW1vdmUoKSk7XHJcblx0XHR9IGNhdGNoIHsgLyogSWdub3JlICovIH1cclxuXHJcblx0XHRpZiAodGVybWluYWxTaG91bGRFeGlzdCkge1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IHRoaXMuYWRkUmliYm9uSWNvbigndGVybWluYWwtc3F1YXJlJywgJ09wZW4gcHJvamVjdCB0ZXJtaW5hbCcsICgpID0+IHtcclxuXHRcdFx0XHRpZiAoIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIk9wZW4gdGVybWluYWwgY29tbWFuZCBpcyBkaXNhYmxlZC5cIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdG9wZW5UZXJtaW5hbEluUHJvamVjdFJvb3QodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0aWYgKHRoaXMudGVybWluYWxSaWJib25JY29uKSB0aGlzLnRlcm1pbmFsUmliYm9uSWNvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtYXN0cm8tY29tcG9zZXItdGVybWluYWwtcmliYm9uJywgJ3RydWUnKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoY29uZmlnU2hvdWxkRXhpc3QpIHtcclxuXHRcdFx0dGhpcy5jb25maWdSaWJib25JY29uID0gdGhpcy5hZGRSaWJib25JY29uKCdyb2NrZXQnLCAnRWRpdCBhc3RybyBjb25maWcnLCBhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0aWYgKCF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCkge1xyXG5cdFx0XHRcdFx0bmV3IE5vdGljZShcIkVkaXQgY29uZmlnIGZpbGUgY29tbWFuZCBpcyBkaXNhYmxlZC5cIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGF3YWl0IG9wZW5Db25maWdGaWxlKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvbkljb24pIHRoaXMuY29uZmlnUmliYm9uSWNvbi5zZXRBdHRyaWJ1dGUoJ2RhdGEtYXN0cm8tY29tcG9zZXItY29uZmlnLXJpYmJvbicsICd0cnVlJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy51cGRhdGVSaWJib25Db250ZXh0TWVudUNTUygpO1xyXG5cdFx0dGhpcy5zZXR1cFJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIoKTtcclxuXHR9XHJcblxyXG5cdG9udW5sb2FkKCkge1xyXG5cdFx0aWYgKHRoaXMudGVybWluYWxSaWJib25JY29uKSB7XHJcblx0XHRcdHRoaXMudGVybWluYWxSaWJib25JY29uLnJlbW92ZSgpO1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uSWNvbiA9IG51bGw7XHJcblx0XHR9XHJcblx0XHRpZiAodGhpcy5jb25maWdSaWJib25JY29uKSB7XHJcblx0XHRcdHRoaXMuY29uZmlnUmliYm9uSWNvbi5yZW1vdmUoKTtcclxuXHRcdFx0dGhpcy5jb25maWdSaWJib25JY29uID0gbnVsbDtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLnJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIpIHtcclxuXHRcdFx0dGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcclxuXHRcdFx0dGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyID0gdW5kZWZpbmVkO1xyXG5cdFx0fVxyXG5cdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS10ZXJtaW5hbC1pY29uJyk7XHJcblx0XHRkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWNvbmZpZy1pY29uJyk7XHJcblx0XHRpZiAodGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIpIHtcclxuXHRcdFx0dGhpcy5oZWxwQnV0dG9uT2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG5cdFx0XHR0aGlzLmhlbHBCdXR0b25PYnNlcnZlciA9IHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHRcdGlmICh0aGlzLmN1c3RvbUhlbHBCdXR0b24pIHtcclxuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uLnJlbW92ZSgpO1xyXG5cdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24gPSB1bmRlZmluZWQ7XHJcblx0XHR9XHJcblx0XHR0aGlzLmhlbHBCdXR0b25FbGVtZW50ID0gdW5kZWZpbmVkO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBzZXR1cFJpYmJvbkNvbnRleHRNZW51SGFuZGxpbmcoKSB7XHJcblx0XHR0aGlzLnVwZGF0ZVJpYmJvbkNvbnRleHRNZW51Q1NTKCk7XHJcblx0XHR0aGlzLnNldHVwUmliYm9uQ29udGV4dE1lbnVPYnNlcnZlcigpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVSaWJib25Db250ZXh0TWVudUNTUygpIHtcclxuXHRcdGNvbnN0IHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4gPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcclxuXHRcdGNvbnN0IGNvbmZpZ1Nob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlQ29uZmlnUmliYm9uSWNvbiB8fCAhdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ7XHJcblxyXG5cdFx0aWYgKHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4pIGRvY3VtZW50LmJvZHkuYWRkQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtdGVybWluYWwtaWNvbicpO1xyXG5cdFx0ZWxzZSBkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLXRlcm1pbmFsLWljb24nKTtcclxuXHJcblx0XHRpZiAoY29uZmlnU2hvdWxkQmVIaWRkZW4pIGRvY3VtZW50LmJvZHkuYWRkQ2xhc3MoJ2FzdHJvLWNvbXBvc2VyLWhpZGUtY29uZmlnLWljb24nKTtcclxuXHRcdGVsc2UgZG9jdW1lbnQuYm9keS5yZW1vdmVDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS1jb25maWctaWNvbicpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBzZXR1cFJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIoKSB7XHJcblx0XHRpZiAodGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyKSB0aGlzLnJpYmJvbkNvbnRleHRNZW51T2JzZXJ2ZXIuZGlzY29ubmVjdCgpO1xyXG5cclxuXHRcdGNvbnN0IHRlcm1pbmFsU2hvdWxkQmVIaWRkZW4gPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24gfHwgIXRoaXMuc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZDtcclxuXHRcdGNvbnN0IGNvbmZpZ1Nob3VsZEJlSGlkZGVuID0gIXRoaXMuc2V0dGluZ3MuZW5hYmxlQ29uZmlnUmliYm9uSWNvbiB8fCAhdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ7XHJcblxyXG5cdFx0aWYgKCF0ZXJtaW5hbFNob3VsZEJlSGlkZGVuICYmICFjb25maWdTaG91bGRCZUhpZGRlbikgcmV0dXJuO1xyXG5cclxuXHRcdHRoaXMucmliYm9uQ29udGV4dE1lbnVPYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKChtdXRhdGlvbnMpID0+IHtcclxuXHRcdFx0Zm9yIChjb25zdCBtdXRhdGlvbiBvZiBtdXRhdGlvbnMpIHtcclxuXHRcdFx0XHRpZiAobXV0YXRpb24uYWRkZWROb2Rlcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdFx0XHRmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbShtdXRhdGlvbi5hZGRlZE5vZGVzKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAobm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKG5vZGUuY2xhc3NMaXN0LmNvbnRhaW5zKCdtZW51JykgfHwgbm9kZS5xdWVyeVNlbGVjdG9yKCcubWVudScpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnJlbW92ZVJpYmJvbkljb25zRnJvbUNvbnRleHRNZW51KG5vZGUpO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0dGhpcy5yaWJib25Db250ZXh0TWVudU9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwgeyBjaGlsZExpc3Q6IHRydWUsIHN1YnRyZWU6IHRydWUgfSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTdGFydHMgYSByb2J1c3QgbW9uaXRvciB0aGF0IGtlZXBzIHRoZSBoZWxwIGJ1dHRvbiBpbiBzeW5jIHdpdGggc2V0dGluZ3MuXHJcblx0ICovXHJcblx0cHJpdmF0ZSBzdGFydEhlbHBCdXR0b25Nb25pdG9yKCkge1xyXG5cdFx0aWYgKHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyKSB0aGlzLmhlbHBCdXR0b25PYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcblxyXG5cdFx0Ly8gSW1tZWRpYXRlIGZpcnN0IHN5bmNcclxuXHRcdHRoaXMuc3luY0hlbHBCdXR0b24oKTtcclxuXHJcblx0XHRsZXQgdGltZXI6IG51bWJlciB8IG51bGwgPSBudWxsO1xyXG5cdFx0bGV0IG11dGF0aW9uQ291bnQgPSAwO1xyXG5cclxuXHRcdHRoaXMuaGVscEJ1dHRvbk9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xyXG5cdFx0XHRtdXRhdGlvbkNvdW50Kys7XHJcblx0XHRcdGlmICh0aW1lcikgd2luZG93LmNsZWFyVGltZW91dCh0aW1lcik7XHJcblxyXG5cdFx0XHQvLyBGb3IgdGhlIGZpcnN0IGZldyBtdXRhdGlvbnMgKGR1cmluZyBzdGFydHVwKSwgYmUgc3VwZXIgYWdncmVzc2l2ZVxyXG5cdFx0XHQvLyBBZnRlciB0aGF0LCB1c2UgYSBzbWFsbCBkZWJvdW5jZSB0byBzdGF5IHBlcmZvcm1hbnRcclxuXHRcdFx0Y29uc3QgZGVsYXkgPSBtdXRhdGlvbkNvdW50IDwgMjAgPyAwIDogMTAwO1xyXG5cclxuXHRcdFx0aWYgKGRlbGF5ID09PSAwKSB7XHJcblx0XHRcdFx0dGhpcy5zeW5jSGVscEJ1dHRvbigpO1xyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHRpbWVyID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5zeW5jSGVscEJ1dHRvbigpLCBkZWxheSk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIE9ic2VydmUgYm9keSB3aXRoIHN1YnRyZWUgYW5kIGF0dHJpYnV0ZXMgKGluIGNhc2UgaWNvbnMvY2xhc3NlcyBjaGFuZ2UpXHJcblx0XHR0aGlzLmhlbHBCdXR0b25PYnNlcnZlci5vYnNlcnZlKGRvY3VtZW50LmJvZHksIHtcclxuXHRcdFx0Y2hpbGRMaXN0OiB0cnVlLFxyXG5cdFx0XHRzdWJ0cmVlOiB0cnVlLFxyXG5cdFx0XHRhdHRyaWJ1dGVzOiB0cnVlLFxyXG5cdFx0XHRhdHRyaWJ1dGVGaWx0ZXI6IFsnY2xhc3MnLCAnc3JjJywgJ2FyaWEtbGFiZWwnXVxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBTeW5jaHJvbml6ZXMgdGhlIGhlbHAgYnV0dG9uIHN0YXRlIGJhc2VkIG9uIHNldHRpbmdzLlxyXG5cdCAqL1xyXG5cdHByaXZhdGUgc3luY0hlbHBCdXR0b24oKSB7XHJcblx0XHRjb25zdCBlbmFibGVkID0gdGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQ7XHJcblxyXG5cdFx0Ly8gMS4gTWFuYWdlIHRoZSBDU1MgY2xhc3MgZm9yIGhpZGluZyB0aGUgb3JpZ2luYWwgYnV0dG9uXHJcblx0XHRpZiAoZW5hYmxlZCkgZG9jdW1lbnQuYm9keS5hZGRDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS1oZWxwLWJ1dHRvbicpO1xyXG5cdFx0ZWxzZSBkb2N1bWVudC5ib2R5LnJlbW92ZUNsYXNzKCdhc3Ryby1jb21wb3Nlci1oaWRlLWhlbHAtYnV0dG9uJyk7XHJcblxyXG5cdFx0Ly8gMi4gQ2xlYXIgY3VzdG9tIGJ1dHRvbiBpZiBkaXNhYmxlZFxyXG5cdFx0aWYgKCFlbmFibGVkKSB7XHJcblx0XHRcdGlmICh0aGlzLmN1c3RvbUhlbHBCdXR0b24pIHtcclxuXHRcdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24ucmVtb3ZlKCk7XHJcblx0XHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gdW5kZWZpbmVkO1xyXG5cdFx0XHR9XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyAzLiBMb29rIGZvciB0aGUgb3JpZ2luYWwgaGVscCBidXR0b25cclxuXHRcdGNvbnN0IHNlbGVjdG9ycyA9IFtcclxuXHRcdFx0Jy53b3Jrc3BhY2UtZHJhd2VyLXZhdWx0LWFjdGlvbnMgLmNsaWNrYWJsZS1pY29uIHN2Zy5oZWxwJyxcclxuXHRcdFx0Jy53b3Jrc3BhY2Utc2lkZWRvY2stdmF1bHQtcHJvZmlsZSAuY2xpY2thYmxlLWljb24gc3ZnLmhlbHAnLFxyXG5cdFx0XHQnLndvcmtzcGFjZS1kcmF3ZXIgLmNsaWNrYWJsZS1pY29uIHN2Zy5oZWxwJyxcclxuXHRcdFx0Jy5jbGlja2FibGUtaWNvbiBzdmcuaGVscCdcclxuXHRcdF07XHJcblxyXG5cdFx0bGV0IGhlbHBCdXR0b25Tdmc6IFNWR0VsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRcdGZvciAoY29uc3Qgc2VsZWN0b3Igb2Ygc2VsZWN0b3JzKSB7XHJcblx0XHRcdGhlbHBCdXR0b25TdmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcclxuXHRcdFx0aWYgKGhlbHBCdXR0b25TdmcpIGJyZWFrO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmICghaGVscEJ1dHRvblN2ZykgcmV0dXJuO1xyXG5cdFx0Y29uc3Qgb3JpZ2luYWxIZWxwQnV0dG9uID0gaGVscEJ1dHRvblN2Zy5wYXJlbnRFbGVtZW50IGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0aWYgKCFvcmlnaW5hbEhlbHBCdXR0b24pIHJldHVybjtcclxuXHJcblx0XHQvLyA0LiBDaGVjayBpZiB3ZSBhbHJlYWR5IGhhdmUgYSB2YWxpZCBjdXN0b20gYnV0dG9uIGluIHRoZSByaWdodCBwbGFjZVxyXG5cdFx0Y29uc3QgZXhpc3RpbmdSZXBsYWNlbWVudCA9IG9yaWdpbmFsSGVscEJ1dHRvbi5wYXJlbnRFbGVtZW50Py5xdWVyeVNlbGVjdG9yKCdbZGF0YS1hc3Ryby1jb21wb3Nlci1oZWxwLXJlcGxhY2VtZW50PVwidHJ1ZVwiXScpO1xyXG5cdFx0aWYgKGV4aXN0aW5nUmVwbGFjZW1lbnQpIHtcclxuXHRcdFx0dGhpcy5jdXN0b21IZWxwQnV0dG9uID0gZXhpc3RpbmdSZXBsYWNlbWVudCBhcyBIVE1MRWxlbWVudDtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIDUuIENyZWF0ZSBhbmQgaW5qZWN0IHRoZSByZXBsYWNlbWVudFxyXG5cdFx0Y29uc3QgY3VzdG9tQnV0dG9uID0gb3JpZ2luYWxIZWxwQnV0dG9uLmNsb25lTm9kZSh0cnVlKSBhcyBIVE1MRWxlbWVudDtcclxuXHRcdGN1c3RvbUJ1dHRvbi5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnRcIik7XHJcblx0XHRjdXN0b21CdXR0b24ucmVtb3ZlQXR0cmlidXRlKCdhcmlhLWxhYmVsJyk7XHJcblx0XHRjdXN0b21CdXR0b24uc2V0QXR0cmlidXRlKCdkYXRhLWFzdHJvLWNvbXBvc2VyLWhlbHAtcmVwbGFjZW1lbnQnLCAndHJ1ZScpO1xyXG5cdFx0Y3VzdG9tQnV0dG9uLm9uY2xpY2sgPSBudWxsO1xyXG5cclxuXHRcdGNvbnN0IGljb25Db250YWluZXIgPSBjdXN0b21CdXR0b24ucXVlcnlTZWxlY3Rvcignc3ZnJyk/LnBhcmVudEVsZW1lbnQgfHwgY3VzdG9tQnV0dG9uO1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0aWYgKGljb25Db250YWluZXIgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG5cdFx0XHRcdHNldEljb24oaWNvbkNvbnRhaW5lciwgdGhpcy5zZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQhLmljb25JZCk7XHJcblx0XHRcdH1cclxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBzZXR0aW5nIHJlcGxhY2VtZW50IGljb246JywgZXJyb3IpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGN1c3RvbUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcclxuXHRcdFx0ZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcblx0XHRcdGV2dC5zdG9wUHJvcGFnYXRpb24oKTtcclxuXHJcblx0XHRcdGNvbnN0IGNvbW1hbmRJZCA9IHRoaXMuc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5jb21tYW5kSWQ7XHJcblx0XHRcdGlmIChjb21tYW5kSWQpIHtcclxuXHRcdFx0XHRjb25zdCBhcHBXaXRoQ29tbWFuZHMgPSB0aGlzLmFwcCBhcyB1bmtub3duIGFzIHsgY29tbWFuZHM/OiB7IGV4ZWN1dGVDb21tYW5kQnlJZD86IChpZDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+IH0gfTtcclxuXHRcdFx0XHRpZiAoYXBwV2l0aENvbW1hbmRzLmNvbW1hbmRzPy5leGVjdXRlQ29tbWFuZEJ5SWQpIHtcclxuXHRcdFx0XHRcdHZvaWQgYXBwV2l0aENvbW1hbmRzLmNvbW1hbmRzLmV4ZWN1dGVDb21tYW5kQnlJZChjb21tYW5kSWQpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSwgdHJ1ZSk7XHJcblxyXG5cdFx0b3JpZ2luYWxIZWxwQnV0dG9uLnBhcmVudEVsZW1lbnQ/Lmluc2VydEJlZm9yZShjdXN0b21CdXR0b24sIG9yaWdpbmFsSGVscEJ1dHRvbik7XHJcblx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24gPSBjdXN0b21CdXR0b247XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlc3RvcmVIZWxwQnV0dG9uKCkge1xyXG5cdFx0ZG9jdW1lbnQuYm9keS5yZW1vdmVDbGFzcygnYXN0cm8tY29tcG9zZXItaGlkZS1oZWxwLWJ1dHRvbicpO1xyXG5cdFx0aWYgKHRoaXMuY3VzdG9tSGVscEJ1dHRvbikge1xyXG5cdFx0XHR0aGlzLmN1c3RvbUhlbHBCdXR0b24ucmVtb3ZlKCk7XHJcblx0XHRcdHRoaXMuY3VzdG9tSGVscEJ1dHRvbiA9IHVuZGVmaW5lZDtcclxuXHRcdH1cclxuXHRcdHRoaXMuaGVscEJ1dHRvbkVsZW1lbnQgPSB1bmRlZmluZWQ7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHJlbW92ZVJpYmJvbkljb25zRnJvbUNvbnRleHRNZW51KG1lbnVFbGVtZW50OiBIVE1MRWxlbWVudCkge1xyXG5cdFx0Y29uc3QgdGVybWluYWxTaG91bGRCZUhpZGRlbiA9ICF0aGlzLnNldHRpbmdzLmVuYWJsZVRlcm1pbmFsUmliYm9uSWNvbiB8fCAhdGhpcy5zZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kO1xyXG5cdFx0Y29uc3QgY29uZmlnU2hvdWxkQmVIaWRkZW4gPSAhdGhpcy5zZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uIHx8ICF0aGlzLnNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZDtcclxuXHJcblx0XHRjb25zdCBtZW51SXRlbXMgPSBtZW51RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubWVudS1pdGVtJyk7XHJcblx0XHRmb3IgKGNvbnN0IGl0ZW0gb2YgQXJyYXkuZnJvbShtZW51SXRlbXMpKSB7XHJcblx0XHRcdGNvbnN0IHN2ZyA9IGl0ZW0ucXVlcnlTZWxlY3Rvcignc3ZnJyk7XHJcblx0XHRcdGlmIChzdmcpIHtcclxuXHRcdFx0XHRsZXQgaWNvbk5hbWUgPSBzdmcuZ2V0QXR0cmlidXRlKCdkYXRhLWx1Y2lkZScpIHx8IHN2Zy5nZXRBdHRyaWJ1dGUoJ3htbG5zOmx1Y2lkZScpIHx8XHJcblx0XHRcdFx0XHRzdmcuZ2V0QXR0cmlidXRlKCdkYXRhLWljb24nKSB8fFxyXG5cdFx0XHRcdFx0KHN2Zy5jbGFzc0xpc3QuY29udGFpbnMoJ2x1Y2lkZS10ZXJtaW5hbC1zcXVhcmUnKSA/ICd0ZXJtaW5hbC1zcXVhcmUnIDogbnVsbCkgfHxcclxuXHRcdFx0XHRcdChzdmcuY2xhc3NMaXN0LmNvbnRhaW5zKCdsdWNpZGUtcm9ja2V0JykgPyAncm9ja2V0JyA6IG51bGwpIHx8XHJcblx0XHRcdFx0XHQoc3ZnLmNsYXNzTGlzdC5jb250YWlucygnbHVjaWRlLXdyZW5jaCcpID8gJ3dyZW5jaCcgOiBudWxsKTtcclxuXHJcblx0XHRcdFx0aWYgKGljb25OYW1lKSBpY29uTmFtZSA9IGljb25OYW1lLnJlcGxhY2UoL15sdWNpZGUtLywgJycpO1xyXG5cclxuXHRcdFx0XHRpZiAodGVybWluYWxTaG91bGRCZUhpZGRlbiAmJiBpY29uTmFtZSA9PT0gJ3Rlcm1pbmFsLXNxdWFyZScpIHtcclxuXHRcdFx0XHRcdGlmIChpdGVtLnRleHRDb250ZW50Py50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKCd0ZXJtaW5hbCcpKSBpdGVtLnJlbW92ZSgpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRpZiAoY29uZmlnU2hvdWxkQmVIaWRkZW4gJiYgKGljb25OYW1lID09PSAncm9ja2V0JyB8fCBpY29uTmFtZSA9PT0gJ3dyZW5jaCcpKSB7XHJcblx0XHRcdFx0XHRpZiAoaXRlbS50ZXh0Q29udGVudD8udG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnY29uZmlnJykpIGl0ZW0ucmVtb3ZlKCk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsICJpbXBvcnQgeyBURmlsZSwgUGx1Z2luU2V0dGluZ1RhYiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBc3Ryb0NvbXBvc2VyU2V0dGluZ3Mge1xyXG5cdGRlZmF1bHRUZW1wbGF0ZTogc3RyaW5nOyAvLyBLZXB0IHRlbXBvcmFyaWx5IGZvciBtaWdyYXRpb25cclxuXHRhdXRvSW5zZXJ0UHJvcGVydGllczogYm9vbGVhbjtcclxuXHRkYXRlRm9ybWF0OiBzdHJpbmc7XHJcblx0ZW5hYmxlQ29weUhlYWRpbmdMaW5rOiBib29sZWFuO1xyXG5cdGNvcHlIZWFkaW5nTGlua0Zvcm1hdDogXCJvYnNpZGlhblwiIHwgXCJhc3Ryb1wiO1xyXG5cdGFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzOiBib29sZWFuO1xyXG5cdGVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQ6IGJvb2xlYW47XHJcblx0dGVybWluYWxQcm9qZWN0Um9vdFBhdGg6IHN0cmluZztcclxuXHR0ZXJtaW5hbEFwcGxpY2F0aW9uTmFtZTogc3RyaW5nO1xyXG5cdGVuYWJsZVRlcm1pbmFsRGVidWdMb2dnaW5nOiBib29sZWFuO1xyXG5cdGVuYWJsZVRlcm1pbmFsUmliYm9uSWNvbjogYm9vbGVhbjtcclxuXHRlbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ6IGJvb2xlYW47XHJcblx0Y29uZmlnRmlsZVBhdGg6IHN0cmluZztcclxuXHRlbmFibGVDb25maWdSaWJib25JY29uOiBib29sZWFuO1xyXG5cdGNvbnRlbnRUeXBlczogQ29udGVudFR5cGVbXTtcclxuXHRoZWxwQnV0dG9uUmVwbGFjZW1lbnQ6IEhlbHBCdXR0b25SZXBsYWNlbWVudFNldHRpbmdzO1xyXG5cdG1pZ3JhdGlvbkNvbXBsZXRlZDogYm9vbGVhbjtcclxuXHRzaG93TWR4RmlsZXNJbkV4cGxvcmVyOiBib29sZWFuO1xyXG5cdHByb2Nlc3NCYWNrZ3JvdW5kRmlsZUNoYW5nZXM6IGJvb2xlYW47XHJcblx0c3luY0RyYWZ0RGF0ZTogYm9vbGVhbjtcclxuXHRkcmFmdFByb3BlcnR5OiBzdHJpbmc7XHJcblx0ZHJhZnRMb2dpYzogJ3RydWUtaXMtZHJhZnQnIHwgJ2ZhbHNlLWlzLWRyYWZ0JztcclxuXHRwdWJsaXNoRGF0ZUZpZWxkOiBzdHJpbmc7XHJcblx0dXBkYXRlTW9kaWZpZWREYXRlOiBib29sZWFuO1xyXG5cdG1vZGlmaWVkRGF0ZUZpZWxkOiBzdHJpbmc7XHJcblx0Ly8gTGVnYWN5IGZpZWxkcyAoa2VwdCBmb3IgbWlncmF0aW9uLCBpZ25vcmVkIGFmdGVyIG1pZ3JhdGlvbilcclxuXHRlbmFibGVVbmRlcnNjb3JlUHJlZml4PzogYm9vbGVhbjtcclxuXHRwb3N0c0ZvbGRlcj86IHN0cmluZztcclxuXHRwb3N0c0xpbmtCYXNlUGF0aD86IHN0cmluZztcclxuXHRhdXRvbWF0ZVBvc3RDcmVhdGlvbj86IGJvb2xlYW47XHJcblx0Y3JlYXRpb25Nb2RlPzogXCJmaWxlXCIgfCBcImZvbGRlclwiO1xyXG5cdGluZGV4RmlsZU5hbWU/OiBzdHJpbmc7XHJcblx0ZXhjbHVkZWREaXJlY3Rvcmllcz86IHN0cmluZztcclxuXHRvbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyPzogYm9vbGVhbjtcclxuXHRlbmFibGVQYWdlcz86IGJvb2xlYW47XHJcblx0cGFnZXNGb2xkZXI/OiBzdHJpbmc7XHJcblx0cGFnZXNMaW5rQmFzZVBhdGg/OiBzdHJpbmc7XHJcblx0cGFnZXNDcmVhdGlvbk1vZGU/OiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XHJcblx0cGFnZXNJbmRleEZpbGVOYW1lPzogc3RyaW5nO1xyXG5cdHBhZ2VUZW1wbGF0ZT86IHN0cmluZztcclxuXHRvbmx5QXV0b21hdGVJblBhZ2VzRm9sZGVyPzogYm9vbGVhbjtcclxuXHRjdXN0b21Db250ZW50VHlwZXM/OiBDb250ZW50VHlwZVtdOyAvLyBMZWdhY3kgbmFtZVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIEhlbHBCdXR0b25SZXBsYWNlbWVudFNldHRpbmdzIHtcclxuXHRlbmFibGVkOiBib29sZWFuO1xyXG5cdGNvbW1hbmRJZDogc3RyaW5nO1xyXG5cdGljb25JZDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBhcnNlZEZyb250bWF0dGVyIHtcclxuXHRwcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT47XHJcblx0cHJvcGVydGllc1RleHQ6IHN0cmluZztcclxuXHRwcm9wZXJ0aWVzRW5kOiBudW1iZXI7XHJcblx0Ym9keUNvbnRlbnQ6IHN0cmluZztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBUZW1wbGF0ZVZhbHVlcyB7XHJcblx0W2tleTogc3RyaW5nXTogc3RyaW5nW10gfCBzdHJpbmc7XHJcbn1cclxuXHJcbi8vIENvbnRlbnRUeXBlIGlzIG5vdyBqdXN0IGEgc3RyaW5nIElEIC0gbm8gZGlzdGluY3Rpb24gYmV0d2VlbiBidWlsdC1pbiBhbmQgY3VzdG9tIHR5cGVzXHJcbmV4cG9ydCB0eXBlIENvbnRlbnRUeXBlSWQgPSBzdHJpbmc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIENvbnRlbnRUeXBlIHtcclxuXHRpZDogc3RyaW5nO1xyXG5cdG5hbWU6IHN0cmluZztcclxuXHRmb2xkZXI6IHN0cmluZztcclxuXHRsaW5rQmFzZVBhdGg6IHN0cmluZztcclxuXHR0ZW1wbGF0ZTogc3RyaW5nO1xyXG5cdGVuYWJsZWQ6IGJvb2xlYW47XHJcblx0Y3JlYXRpb25Nb2RlOiBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XHJcblx0aW5kZXhGaWxlTmFtZTogc3RyaW5nO1xyXG5cdGlnbm9yZVN1YmZvbGRlcnM6IGJvb2xlYW47XHJcblx0ZW5hYmxlVW5kZXJzY29yZVByZWZpeDogYm9vbGVhbjtcclxuXHR1c2VNZHhFeHRlbnNpb246IGJvb2xlYW47XHJcblx0Y29sbGFwc2VkPzogYm9vbGVhbjtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBGaWxlQ3JlYXRpb25PcHRpb25zIHtcclxuXHRmaWxlOiBURmlsZTtcclxuXHR0aXRsZTogc3RyaW5nO1xyXG5cdHR5cGU6IENvbnRlbnRUeXBlSWQ7IC8vIENvbnRlbnQgdHlwZSBJRCAoc3RyaW5nKVxyXG59XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJlbmFtZU9wdGlvbnMge1xyXG5cdGZpbGU6IFRGaWxlO1xyXG5cdHRpdGxlOiBzdHJpbmc7XHJcblx0dHlwZTogQ29udGVudFR5cGVJZDsgLy8gQ29udGVudCB0eXBlIElEIChzdHJpbmcpXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBLTk9XTl9BUlJBWV9LRVlTID0gWyd0YWdzJywgJ2FsaWFzZXMnLCAnY3NzY2xhc3NlcyddIGFzIGNvbnN0O1xyXG5cclxuZXhwb3J0IGNvbnN0IENPTlNUQU5UUyA9IHtcclxuXHRERUJPVU5DRV9NUzogNTAwLFxyXG5cdFNUQVRfTVRJTUVfVEhSRVNIT0xEOiAxMDAwLFxyXG5cdEVESVRPUl9TVEFCSUxJWkVfREVMQVk6IDEwMCxcclxuXHRGSUxFX0VYUExPUkVSX1JFVkVBTF9ERUxBWTogMjAwLFxyXG59IGFzIGNvbnN0O1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIHtcclxuXHRzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzO1xyXG5cdHNhdmVTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+O1xyXG5cdGxvYWRTZXR0aW5ncygpOiBQcm9taXNlPHZvaWQ+O1xyXG5cdHJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTogdm9pZDtcclxuXHRyZWdpc3RlckV2ZW50KGV2ZW50UmVmOiBhbnkpOiB2b2lkO1xyXG5cdHJlZ2lzdGVyRXh0ZW5zaW9ucyhleHRlbnNpb25zOiBzdHJpbmdbXSwgdmlld1R5cGU6IHN0cmluZyk6IHZvaWQ7XHJcblx0aGVhZGluZ0xpbmtHZW5lcmF0b3I6IGFueTtcclxuXHRmcm9udG1hdHRlclNlcnZpY2U6IGFueTtcclxuXHRwbHVnaW5DcmVhdGVkRmlsZXM6IE1hcDxzdHJpbmcsIG51bWJlcj47XHJcblx0ZmlsZU9wczogYW55O1xyXG5cdHNldHRpbmdzVGFiPzogUGx1Z2luU2V0dGluZ1RhYjtcclxuXHRyZWdpc3RlclJpYmJvbkljb25zPygpOiB2b2lkO1xyXG5cdHVwZGF0ZUhlbHBCdXR0b24/KCk6IFByb21pc2U8dm9pZD47XHJcbn0iLCAiaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCB0eXBlIHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuZXhwb3J0IHsgQ09OU1RBTlRTIH0gZnJvbSBcIi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MgPSB7XHJcblx0ZGVmYXVsdFRlbXBsYXRlOlxyXG5cdFx0Jy0tLVxcbnRpdGxlOiBcInt7dGl0bGV9fVwiXFxuZGF0ZToge3tkYXRlfX1cXG50YWdzOiBbXVxcbi0tLVxcbicsXHJcblx0YXV0b0luc2VydFByb3BlcnRpZXM6IHRydWUsXHJcblx0ZGF0ZUZvcm1hdDogXCJZWVlZLU1NLUREXCIsXHJcblx0ZW5hYmxlQ29weUhlYWRpbmdMaW5rOiB0cnVlLFxyXG5cdGNvcHlIZWFkaW5nTGlua0Zvcm1hdDogXCJvYnNpZGlhblwiLFxyXG5cdGFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzOiBmYWxzZSxcclxuXHRlbmFibGVPcGVuVGVybWluYWxDb21tYW5kOiBmYWxzZSxcclxuXHR0ZXJtaW5hbFByb2plY3RSb290UGF0aDogXCJcIixcclxuXHR0ZXJtaW5hbEFwcGxpY2F0aW9uTmFtZTogXCJcIixcclxuXHRlbmFibGVUZXJtaW5hbERlYnVnTG9nZ2luZzogZmFsc2UsXHJcblx0ZW5hYmxlVGVybWluYWxSaWJib25JY29uOiBmYWxzZSxcclxuXHRlbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQ6IGZhbHNlLFxyXG5cdGNvbmZpZ0ZpbGVQYXRoOiBcIlwiLFxyXG5cdGVuYWJsZUNvbmZpZ1JpYmJvbkljb246IGZhbHNlLFxyXG5cdGNvbnRlbnRUeXBlczogW10sXHJcblx0bWlncmF0aW9uQ29tcGxldGVkOiBmYWxzZSxcclxuXHRoZWxwQnV0dG9uUmVwbGFjZW1lbnQ6IHtcclxuXHRcdGVuYWJsZWQ6IGZhbHNlLFxyXG5cdFx0Y29tbWFuZElkOiAnZWRpdC1hc3Ryby1jb25maWcnLFxyXG5cdFx0aWNvbklkOiAncm9ja2V0JyxcclxuXHR9LFxyXG5cdHNob3dNZHhGaWxlc0luRXhwbG9yZXI6IGZhbHNlLFxyXG5cdHByb2Nlc3NCYWNrZ3JvdW5kRmlsZUNoYW5nZXM6IHRydWUsXHJcblx0c3luY0RyYWZ0RGF0ZTogZmFsc2UsXHJcblx0ZHJhZnRQcm9wZXJ0eTogXCJcIixcclxuXHRkcmFmdExvZ2ljOiBcInRydWUtaXMtZHJhZnRcIixcclxuXHRwdWJsaXNoRGF0ZUZpZWxkOiBcIlwiLFxyXG5cdHVwZGF0ZU1vZGlmaWVkRGF0ZTogZmFsc2UsXHJcblx0bW9kaWZpZWREYXRlRmllbGQ6IFwiXCIsXHJcbn07XHJcbiIsICJpbXBvcnQgeyBQbHVnaW4sIEVkaXRvciwgTWFya2Rvd25WaWV3LCBURmlsZSwgTm90aWNlLCBBcHAsIE1hcmtkb3duRmlsZUluZm8sIFBsYXRmb3JtLCBURm9sZGVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBGaWxlT3BlcmF0aW9ucyB9IGZyb20gXCIuLi91dGlscy9maWxlLW9wZXJhdGlvbnNcIjtcclxuaW1wb3J0IHsgVGVtcGxhdGVQYXJzZXIgfSBmcm9tIFwiLi4vdXRpbHMvdGVtcGxhdGUtcGFyc2luZ1wiO1xyXG5pbXBvcnQgeyBMaW5rQ29udmVydGVyIH0gZnJvbSBcIi4uL3V0aWxzL2xpbmstY29udmVyc2lvblwiO1xyXG5pbXBvcnQgeyBUaXRsZU1vZGFsIH0gZnJvbSBcIi4uL3VpL3RpdGxlLW1vZGFsXCI7XHJcbmltcG9ydCB7IHRvS2ViYWJDYXNlIH0gZnJvbSBcIi4uL3V0aWxzL3N0cmluZy11dGlsc1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyQ29tbWFuZHMocGx1Z2luOiBQbHVnaW4sIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiB2b2lkIHtcclxuXHQvLyBUZXJtaW5hbCBhbmQgY29uZmlnIGNvbW1hbmRzIGFyZSBkZXNrdG9wLW9ubHkgLSBORVZFUiByZWdpc3RlciBvbiBtb2JpbGVcclxuXHQvLyBDaGVjayBQbGF0Zm9ybS5pc01vYmlsZSAtIGlmIHRydWUsIHRoZXNlIGNvbW1hbmRzIG11c3QgTkVWRVIgYmUgcmVnaXN0ZXJlZFxyXG5cdGNvbnN0IGlzTW9iaWxlID0gUGxhdGZvcm0uaXNNb2JpbGU7XHJcblxyXG5cdC8vIElmIG9uIG1vYmlsZSwgYWJzb2x1dGVseSBkbyBub3QgcmVnaXN0ZXIgdGVybWluYWwvY29uZmlnIGNvbW1hbmRzXHJcblx0Ly8gVGhleSB1c2UgTm9kZS5qcy9FbGVjdHJvbiBBUElzIHRoYXQgZG9uJ3QgZXhpc3Qgb24gbW9iaWxlXHJcblx0aWYgKGlzTW9iaWxlKSB7XHJcblx0XHQvLyBPbiBtb2JpbGUsIG9ubHkgcmVnaXN0ZXIgdGhlIHNhZmUgY29tbWFuZHMgdGhhdCB3b3JrIG9uIG1vYmlsZVxyXG5cdFx0Y29uc3QgcGx1Z2luSW50ZXJmYWNlID0gcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHRcdGNvbnN0IGZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMocGx1Z2luLmFwcCwgc2V0dGluZ3MsIHBsdWdpbkludGVyZmFjZSk7XHJcblx0XHRjb25zdCBsaW5rQ29udmVydGVyID0gbmV3IExpbmtDb252ZXJ0ZXIoc2V0dGluZ3MsIHBsdWdpbkludGVyZmFjZSk7XHJcblxyXG5cdFx0Ly8gUmVnaXN0ZXIgb25seSBtb2JpbGUtc2FmZSBjb21tYW5kc1xyXG5cdFx0cGx1Z2luLmFkZENvbW1hbmQoe1xyXG5cdFx0XHRpZDogXCJzdGFuZGFyZGl6ZS1wcm9wZXJ0aWVzXCIsXHJcblx0XHRcdG5hbWU6IFwiU3RhbmRhcmRpemUgcHJvcGVydGllc1wiLFxyXG5cdFx0XHRpY29uOiBcImZpbGUtY2hlY2tcIixcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdFx0Ly8gR2V0IGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luXHJcblx0XHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSBwbHVnaW5JbnRlcmZhY2Uuc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHRcdFx0XHR2b2lkIHN0YW5kYXJkaXplUHJvcGVydGllcyhwbHVnaW4uYXBwLCBjdXJyZW50U2V0dGluZ3MsIGZpbGUsIHBsdWdpbkludGVyZmFjZSwgZWRpdG9yKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHJcblx0XHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcImNvbnZlcnQtd2lraWxpbmtzLWFzdHJvXCIsXHJcblx0XHRcdG5hbWU6IFwiQ29udmVydCBpbnRlcm5hbCBsaW5rcyBmb3IgYXN0cm9cIixcclxuXHRcdFx0aWNvbjogXCJsaW5rLTJcIixcclxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdFx0bGlua0NvbnZlcnRlci5jb252ZXJ0V2lraWxpbmtzRm9yQXN0cm8oZWRpdG9yLCBmaWxlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBIZWxwZXIgZnVuY3Rpb24gZm9yIHJlbmFtZSBjb21tYW5kIChtb2JpbGUgdmVyc2lvbilcclxuXHRcdC8vIFVzZXMgdGhlIHNhbWUgbG9naWMgYXMgRmlsZU9wZXJhdGlvbnMuZGV0ZXJtaW5lVHlwZSgpIHRvIGVuc3VyZSBjb25zaXN0ZW5jeVxyXG5cdFx0ZnVuY3Rpb24gaGFzTWF0Y2hpbmdDb250ZW50VHlwZShmaWxlOiBURmlsZSwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IGJvb2xlYW4ge1xyXG5cdFx0XHRjb25zdCB0eXBlID0gZmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFx0XHQvLyBJZiBkZXRlcm1pbmVUeXBlIHJldHVybnMgXCJub3RlXCIsIGl0IG1lYW5zIG5vIGNvbnRlbnQgdHlwZSBtYXRjaGVkXHJcblx0XHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xyXG5cdFx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdFx0fVxyXG5cdFx0XHQvLyBDaGVjayBpZiB0aGUgbWF0Y2hlZCBjb250ZW50IHR5cGUgaXMgZW5hYmxlZFxyXG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IGZpbGVPcHMuZ2V0Q29udGVudFR5cGUodHlwZSk7XHJcblx0XHRcdHJldHVybiBjb250ZW50VHlwZSAhPT0gbnVsbCAmJiBjb250ZW50VHlwZS5lbmFibGVkO1xyXG5cdFx0fVxyXG5cclxuXHRcdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdFx0aWQ6IFwicmVuYW1lLWNvbnRlbnRcIixcclxuXHRcdFx0bmFtZTogXCJSZW5hbWUgY3VycmVudCBjb250ZW50XCIsXHJcblx0XHRcdGljb246IFwicGVuY2lsXCIsXHJcblx0XHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHRcdGlmICghaGFzTWF0Y2hpbmdDb250ZW50VHlwZShmaWxlLCBzZXR0aW5ncykpIHtcclxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHRoaXMgZmlsZSBpcyBub3QgcGFydCBvZiBhIGNvbmZpZ3VyZWQgY29udGVudCB0eXBlIGZvbGRlci5cIik7XHJcblx0XHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRjb25zdCB0eXBlID0gZmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFx0XHRcdFx0Y29uc3QgY2FjaGUgPSBwbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG5cdFx0XHRcdFx0Y29uc3QgdGl0bGVLZXkgPSBmaWxlT3BzLmdldFRpdGxlS2V5KHR5cGUpO1xyXG5cclxuXHRcdFx0XHRcdGlmICghY2FjaGU/LmZyb250bWF0dGVyIHx8ICEodGl0bGVLZXkgaW4gY2FjaGUuZnJvbnRtYXR0ZXIpKSB7XHJcblx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYENhbm5vdCByZW5hbWU6IE5vICR7dGl0bGVLZXl9IGZvdW5kIGluIHByb3BlcnRpZXNgKTtcclxuXHRcdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdG5ldyBUaXRsZU1vZGFsKHBsdWdpbi5hcHAsIGZpbGUsIHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UsIHR5cGUsIHRydWUpLm9wZW4oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBETyBOT1QgcmVnaXN0ZXIgdGVybWluYWwgb3IgY29uZmlnIGNvbW1hbmRzIG9uIG1vYmlsZSAtIHJldHVybiBlYXJseVxyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0Ly8gRGVza3RvcDogcmVnaXN0ZXIgYWxsIGNvbW1hbmRzIGluY2x1ZGluZyB0ZXJtaW5hbCBhbmQgY29uZmlnXHJcblx0Y29uc3QgcGx1Z2luSW50ZXJmYWNlID0gcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHJcblxyXG5cdC8vIEhlbHBlciBmdW5jdGlvbiB0byBjaGVjayBpZiBhIGZpbGUgbWF0Y2hlcyBhbnkgY29uZmlndXJlZCBjb250ZW50IHR5cGVcclxuXHQvLyBVc2VzIHRoZSBzYW1lIGxvZ2ljIGFzIEZpbGVPcGVyYXRpb25zLmRldGVybWluZVR5cGUoKSB0byBlbnN1cmUgY29uc2lzdGVuY3lcclxuXHQvLyBHZXRzIGZyZXNoIHNldHRpbmdzIGZyb20gcGx1Z2luIHRvIGVuc3VyZSB3ZSBjaGVjayBhZ2FpbnN0IGN1cnJlbnQgY29udGVudCB0eXBlc1xyXG5cdGZ1bmN0aW9uIGhhc01hdGNoaW5nQ29udGVudFR5cGUoZmlsZTogVEZpbGUsIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpOiBib29sZWFuIHtcclxuXHRcdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBpZiBhdmFpbGFibGVcclxuXHRcdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IChwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKT8uc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHQvLyBDcmVhdGUgYSB0ZW1wb3JhcnkgRmlsZU9wZXJhdGlvbnMgd2l0aCBmcmVzaCBzZXR0aW5nc1xyXG5cdFx0Y29uc3QgdGVtcEZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMocGx1Z2luLmFwcCwgY3VycmVudFNldHRpbmdzLCBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKTtcclxuXHRcdGNvbnN0IHR5cGUgPSB0ZW1wRmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFx0Ly8gSWYgZGV0ZXJtaW5lVHlwZSByZXR1cm5zIFwibm90ZVwiLCBpdCBtZWFucyBubyBjb250ZW50IHR5cGUgbWF0Y2hlZFxyXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHRcdC8vIENoZWNrIGlmIHRoZSBtYXRjaGVkIGNvbnRlbnQgdHlwZSBpcyBlbmFibGVkXHJcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRlbXBGaWxlT3BzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xyXG5cdFx0cmV0dXJuIGNvbnRlbnRUeXBlICE9PSBudWxsICYmIGNvbnRlbnRUeXBlLmVuYWJsZWQ7XHJcblx0fVxyXG5cclxuXHQvLyBTdGFuZGFyZGl6ZSBQcm9wZXJ0aWVzIGNvbW1hbmRcclxuXHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRpZDogXCJzdGFuZGFyZGl6ZS1wcm9wZXJ0aWVzXCIsXHJcblx0XHRuYW1lOiBcIlN0YW5kYXJkaXplIHByb3BlcnRpZXNcIixcclxuXHRcdGljb246IFwiZmlsZS1jaGVja1wiLFxyXG5cdFx0ZWRpdG9yQ2FsbGJhY2s6IChlZGl0b3I6IEVkaXRvciwgY3R4OiBNYXJrZG93blZpZXcgfCBNYXJrZG93bkZpbGVJbmZvKSA9PiB7XHJcblx0XHRcdGNvbnN0IGZpbGUgPSBjdHggaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgPyBjdHguZmlsZSA6IGN0eC5maWxlO1xyXG5cdFx0XHRpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcblx0XHRcdFx0dm9pZCBzdGFuZGFyZGl6ZVByb3BlcnRpZXMocGx1Z2luLmFwcCwgc2V0dGluZ3MsIGZpbGUsIHBsdWdpbiBhcyB1bmtub3duIGFzIEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UsIGVkaXRvcik7XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0fSk7XHJcblxyXG5cdC8vIENvbnZlcnQgV2lraWxpbmtzIGNvbW1hbmRcclxuXHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRpZDogXCJjb252ZXJ0LXdpa2lsaW5rcy1hc3Ryb1wiLFxyXG5cdFx0bmFtZTogXCJDb252ZXJ0IGludGVybmFsIGxpbmtzIGZvciBhc3Ryb1wiLFxyXG5cdFx0aWNvbjogXCJsaW5rLTJcIixcclxuXHRcdGVkaXRvckNhbGxiYWNrOiAoZWRpdG9yOiBFZGl0b3IsIGN0eDogTWFya2Rvd25WaWV3IHwgTWFya2Rvd25GaWxlSW5mbykgPT4ge1xyXG5cdFx0XHRjb25zdCBmaWxlID0gY3R4IGluc3RhbmNlb2YgTWFya2Rvd25WaWV3ID8gY3R4LmZpbGUgOiBjdHguZmlsZTtcclxuXHRcdFx0aWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBhbmQgY3JlYXRlIExpbmtDb252ZXJ0ZXIgd2l0aCBpdFxyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IHBsdWdpbkludGVyZmFjZS5zZXR0aW5ncyB8fCBzZXR0aW5ncztcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50TGlua0NvbnZlcnRlciA9IG5ldyBMaW5rQ29udmVydGVyKGN1cnJlbnRTZXR0aW5ncywgcGx1Z2luSW50ZXJmYWNlKTtcclxuXHRcdFx0XHRjdXJyZW50TGlua0NvbnZlcnRlci5jb252ZXJ0V2lraWxpbmtzRm9yQXN0cm8oZWRpdG9yLCBmaWxlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHR9KTtcclxuXHJcblx0Ly8gUmVuYW1lIENvbnRlbnQgY29tbWFuZFxyXG5cdHBsdWdpbi5hZGRDb21tYW5kKHtcclxuXHRcdGlkOiBcInJlbmFtZS1jb250ZW50XCIsXHJcblx0XHRuYW1lOiBcIlJlbmFtZSBjdXJyZW50IGNvbnRlbnRcIixcclxuXHRcdGljb246IFwicGVuY2lsXCIsXHJcblx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCBjdHg6IE1hcmtkb3duVmlldyB8IE1hcmtkb3duRmlsZUluZm8pID0+IHtcclxuXHRcdFx0Y29uc3QgZmlsZSA9IGN0eCBpbnN0YW5jZW9mIE1hcmtkb3duVmlldyA/IGN0eC5maWxlIDogY3R4LmZpbGU7XHJcblx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuXHRcdFx0XHQvLyBHZXQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW5cclxuXHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSBwbHVnaW5JbnRlcmZhY2Uuc2V0dGluZ3MgfHwgc2V0dGluZ3M7XHJcblx0XHRcdFx0Ly8gQ3JlYXRlIEZpbGVPcGVyYXRpb25zIHdpdGggZnJlc2ggc2V0dGluZ3NcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50RmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhwbHVnaW4uYXBwLCBjdXJyZW50U2V0dGluZ3MsIHBsdWdpbkludGVyZmFjZSk7XHJcblxyXG5cdFx0XHRcdC8vIENoZWNrIGlmIHRoaXMgZmlsZSBtYXRjaGVzIGFueSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZVxyXG5cdFx0XHRcdGlmICghaGFzTWF0Y2hpbmdDb250ZW50VHlwZShmaWxlLCBjdXJyZW50U2V0dGluZ3MpKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogdGhpcyBmaWxlIGlzIG5vdCBwYXJ0IG9mIGEgY29uZmlndXJlZCBjb250ZW50IHR5cGUgZm9sZGVyLlwiKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgZnJvbSBmb2xkZXIgc3RydWN0dXJlXHJcblx0XHRcdFx0Y29uc3QgdHlwZSA9IGN1cnJlbnRGaWxlT3BzLmRldGVybWluZVR5cGUoZmlsZSk7XHJcblxyXG5cdFx0XHRcdC8vIEFsd2F5cyBvcGVuIHRoZSBtb2RhbCAtIGl0IHdpbGwgaGFuZGxlIGZpbGVzIHdpdGhvdXQgZnJvbnRtYXR0ZXIgb3IgdGl0bGUga2V5XHJcblx0XHRcdFx0Ly8gSWYgdGhlcmUncyBubyB0aXRsZSBpbiBmcm9udG1hdHRlciwgdGhlIG1vZGFsIHdpbGwgdXNlIHRoZSBmaWxlbmFtZSBhcyBmYWxsYmFja1xyXG5cdFx0XHRcdC8vIGFuZCB0aGUgcmVuYW1lIHdpbGwgcHJvY2VlZCB3aXRoIGtlYmFiLWNhc2UgdmVyc2lvbiBvZiB3aGF0IHVzZXIgdHlwZXNcclxuXHRcdFx0XHRuZXcgVGl0bGVNb2RhbChwbHVnaW4uYXBwLCBmaWxlLCBwbHVnaW5JbnRlcmZhY2UsIHR5cGUsIHRydWUpLm9wZW4oKTtcclxuXHRcdFx0fVxyXG5cdFx0fSxcclxuXHR9KTtcclxuXHJcblx0Ly8gT3BlbiBUZXJtaW5hbCBjb21tYW5kIChkZXNrdG9wIG9ubHkgLSBub3QgYXZhaWxhYmxlIG9uIG1vYmlsZSlcclxuXHRpZiAoIWlzTW9iaWxlKSB7XHJcblx0XHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcIm9wZW4tcHJvamVjdC10ZXJtaW5hbFwiLFxyXG5cdFx0XHRuYW1lOiBcIk9wZW4gcHJvamVjdCB0ZXJtaW5hbFwiLFxyXG5cdFx0XHRpY29uOiBcInRlcm1pbmFsLXNxdWFyZVwiLFxyXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRTZXR0aW5ncyA9IChwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKS5zZXR0aW5ncztcclxuXHRcdFx0XHRpZiAoIWN1cnJlbnRTZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiT3BlbiB0ZXJtaW5hbCBjb21tYW5kIGlzIGRpc2FibGVkLiBFbmFibGUgaXQgaW4gc2V0dGluZ3MgdG8gdXNlIHRoaXMgY29tbWFuZC5cIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdG9wZW5UZXJtaW5hbEluUHJvamVjdFJvb3QocGx1Z2luLmFwcCwgY3VycmVudFNldHRpbmdzKTtcclxuXHRcdFx0fSxcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0Ly8gRWRpdCBDb25maWcgRmlsZSBjb21tYW5kIChkZXNrdG9wIG9ubHkgLSBub3QgYXZhaWxhYmxlIG9uIG1vYmlsZSlcclxuXHRpZiAoIWlzTW9iaWxlKSB7XHJcblx0XHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBcImVkaXQtYXN0cm8tY29uZmlnXCIsXHJcblx0XHRcdG5hbWU6IFwiRWRpdCBhc3RybyBjb25maWdcIixcclxuXHRcdFx0aWNvbjogXCJyb2NrZXRcIixcclxuXHRcdFx0Y2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSAocGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSkuc2V0dGluZ3M7XHJcblx0XHRcdFx0aWYgKCFjdXJyZW50U2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKFwiRWRpdCBjb25maWcgZmlsZSBjb21tYW5kIGlzIGRpc2FibGVkLiBFbmFibGUgaXQgaW4gc2V0dGluZ3MgdG8gdXNlIHRoaXMgY29tbWFuZC5cIik7XHJcblx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGF3YWl0IG9wZW5Db25maWdGaWxlKHBsdWdpbi5hcHAsIGN1cnJlbnRTZXR0aW5ncyk7XHJcblx0XHRcdH0sXHJcblx0XHR9KTtcclxuXHR9XHJcbn1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIHN0YW5kYXJkaXplUHJvcGVydGllcyhhcHA6IEFwcCwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgZmlsZTogVEZpbGUsIHBsdWdpbj86IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UsIGVkaXRvcj86IEVkaXRvcik6IFByb21pc2U8dm9pZD4ge1xyXG5cdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBpZiBhdmFpbGFibGVcclxuXHRjb25zdCBjdXJyZW50U2V0dGluZ3MgPSBwbHVnaW4/LnNldHRpbmdzIHx8IHNldHRpbmdzO1xyXG5cdGNvbnN0IHRlbXBsYXRlUGFyc2VyID0gbmV3IFRlbXBsYXRlUGFyc2VyKGFwcCwgY3VycmVudFNldHRpbmdzKTtcclxuXHRjb25zdCBmaWxlT3BzID0gbmV3IEZpbGVPcGVyYXRpb25zKGFwcCwgY3VycmVudFNldHRpbmdzLCBwbHVnaW4pO1xyXG5cclxuXHQvLyBQcmVzZXJ2ZSBjdXJzb3IgcG9zaXRpb24gaWYgZWRpdG9yIGlzIHByb3ZpZGVkXHJcblx0bGV0IGN1cnNvclBvc2l0aW9uOiB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9IHwgbnVsbCA9IG51bGw7XHJcblx0bGV0IG9yaWdpbmFsQ29udGVudCA9IFwiXCI7XHJcblx0aWYgKGVkaXRvcikge1xyXG5cdFx0Y29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xyXG5cdFx0Y3Vyc29yUG9zaXRpb24gPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogY3Vyc29yLmNoIH07XHJcblx0XHRvcmlnaW5hbENvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcclxuXHR9XHJcblxyXG5cdC8vIERldGVybWluZSBjb250ZW50IHR5cGUgdXNpbmcgdGhlIGV4aXN0aW5nIGxvZ2ljXHJcblx0Y29uc3QgdHlwZSA9IGZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHJcblx0Ly8gQ2hlY2sgaWYgdGhpcyBmaWxlIGhhcyBhIHZhbGlkIGNvbnRlbnQgdHlwZSAobm90IGp1c3QgXCJub3RlXCIpXHJcblx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XHJcblx0XHRuZXcgTm90aWNlKFwiTm8gcHJvcGVydGllcyB0ZW1wbGF0ZSBzcGVjaWZpZWQgZm9yIHRoaXMgY29udGVudC4gVGhpcyBmaWxlIGRvZXNuJ3QgbWF0Y2ggYW55IGNvbmZpZ3VyZWQgY29udGVudCB0eXBlIGZvbGRlcnMuXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0bGV0IHRlbXBsYXRlU3RyaW5nOiBzdHJpbmc7XHJcblxyXG5cdC8vIERldGVybWluZSB0ZW1wbGF0ZSBiYXNlZCBvbiBjb250ZW50IHR5cGVcclxuXHRpZiAodHlwZSA9PT0gXCJub3RlXCIpIHtcclxuXHRcdG5ldyBOb3RpY2UoXCJObyBwcm9wZXJ0aWVzIHRlbXBsYXRlIHNwZWNpZmllZCBmb3IgdGhpcyBjb250ZW50LiBUaGlzIGZpbGUgZG9lc24ndCBtYXRjaCBhbnkgY29uZmlndXJlZCBjb250ZW50IHR5cGUgZm9sZGVycy5cIik7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRjb25zdCBjb250ZW50VHlwZSA9IGZpbGVPcHMuZ2V0Q29udGVudFR5cGUodHlwZSk7XHJcblx0aWYgKCFjb250ZW50VHlwZSkge1xyXG5cdFx0bmV3IE5vdGljZShcIkNvbnRlbnQgdHlwZSBub3QgZm91bmQuXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0dGVtcGxhdGVTdHJpbmcgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcclxuXHJcblx0Ly8gV2FpdCBicmllZmx5IHRvIGFsbG93IGVkaXRvciBzdGF0ZSB0byBzdGFiaWxpemVcclxuXHRhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgMTAwKSk7XHJcblxyXG5cdC8vIFJlLXJlYWQgY29udGVudCB0byBlbnN1cmUgbGF0ZXN0IHN0YXRlIGFmdGVyIGVkaXRvciBjaGFuZ2VzXHJcblx0Y29uc3QgY29udGVudCA9IGF3YWl0IGFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG5cdGNvbnN0IHRpdGxlID0gZmlsZS5iYXNlbmFtZS5yZXBsYWNlKC9eXy8sIFwiXCIpO1xyXG5cclxuXHRjb25zdCBwYXJzZWQgPSB0ZW1wbGF0ZVBhcnNlci5wYXJzZUZyb250bWF0dGVyKGNvbnRlbnQpO1xyXG5cdGNvbnN0IHsgdGVtcGxhdGVQcm9wcywgdGVtcGxhdGVWYWx1ZXMgfSA9IHRlbXBsYXRlUGFyc2VyLnBhcnNlVGVtcGxhdGUodGVtcGxhdGVTdHJpbmcsIHRpdGxlKTtcclxuXHJcblx0Ly8gTWVyZ2UgdGVtcGxhdGUgcHJvcGVydGllcyB3aXRoIGV4aXN0aW5nIG9uZXMsIHByZXNlcnZpbmcgYWxsIGV4aXN0aW5nXHJcblx0Y29uc3QgZmluYWxQcm9wczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+ID0geyAuLi5wYXJzZWQucHJvcGVydGllcyB9O1xyXG5cdGNvbnN0IGFycmF5S2V5cyA9IG5ldyBTZXQ8c3RyaW5nPigpOyAvLyBUcmFjayB3aGljaCBrZXlzIGFyZSBhcnJheXNcclxuXHJcblx0Ly8gR2VuZXJhdGUgc2x1ZyBmcm9tIHRpdGxlIGZvciBzbHVnIHByb3BlcnR5IGF1dG8tcG9wdWxhdGlvblxyXG5cdGNvbnN0IHNsdWcgPSB0b0tlYmFiQ2FzZSh0aXRsZSk7XHJcblxyXG5cdGZvciAoY29uc3Qga2V5IG9mIHRlbXBsYXRlUHJvcHMpIHtcclxuXHRcdGlmICghKGtleSBpbiBwYXJzZWQucHJvcGVydGllcykpIHtcclxuXHRcdFx0Ly8gUHJvcGVydHkgZG9lc24ndCBleGlzdCwgYWRkIGl0IGZyb20gdGVtcGxhdGVcclxuXHRcdFx0Y29uc3QgdGVtcGxhdGVWYWx1ZSA9IHRlbXBsYXRlVmFsdWVzW2tleV07XHJcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHRlbXBsYXRlVmFsdWUpKSB7XHJcblx0XHRcdFx0ZmluYWxQcm9wc1trZXldID0gdGVtcGxhdGVWYWx1ZTtcclxuXHRcdFx0XHRhcnJheUtleXMuYWRkKGtleSk7IC8vIE1hcmsgYXMgYXJyYXlcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRmaW5hbFByb3BzW2tleV0gPSBbdGVtcGxhdGVWYWx1ZSB8fCBcIlwiXTtcclxuXHRcdFx0fVxyXG5cdFx0fSBlbHNlIHtcclxuXHRcdFx0Ly8gUHJvcGVydHkgZXhpc3RzLCBjaGVjayBpZiBpdCdzIGFuIGFycmF5IHR5cGVcclxuXHRcdFx0Y29uc3QgdGVtcGxhdGVWYWx1ZSA9IHRlbXBsYXRlVmFsdWVzW2tleV07XHJcblx0XHRcdGNvbnN0IGlzQXJyYXlWYWx1ZSA9IEFycmF5LmlzQXJyYXkodGVtcGxhdGVWYWx1ZSk7XHJcblxyXG5cdFx0XHRpZiAoaXNBcnJheVZhbHVlKSB7XHJcblx0XHRcdFx0Ly8gVGhpcyBpcyBhbiBhcnJheSBwcm9wZXJ0eSAtIHByZXNlcnZlIGV4aXN0aW5nIHZhbHVlcyBhbmQgbWVyZ2Ugd2l0aCB0ZW1wbGF0ZVxyXG5cdFx0XHRcdGNvbnN0IGV4aXN0aW5nSXRlbXMgPSBwYXJzZWQucHJvcGVydGllc1trZXldIHx8IFtdO1xyXG5cdFx0XHRcdGNvbnN0IG5ld0l0ZW1zID0gdGVtcGxhdGVWYWx1ZS5maWx0ZXIoaXRlbSA9PiAhZXhpc3RpbmdJdGVtcy5pbmNsdWRlcyhpdGVtKSk7XHJcblx0XHRcdFx0ZmluYWxQcm9wc1trZXldID0gWy4uLmV4aXN0aW5nSXRlbXMsIC4uLm5ld0l0ZW1zXTtcclxuXHRcdFx0XHRhcnJheUtleXMuYWRkKGtleSk7IC8vIE1hcmsgYXMgYXJyYXlcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBGb3Igbm9uLWFycmF5IHZhbHVlcywgY2hlY2sgaWYgaXQncyBzbHVnIGFuZCBuZWVkcyBhdXRvLXBvcHVsYXRpb25cclxuXHRcdFx0XHRpZiAoa2V5ID09PSBcInNsdWdcIikge1xyXG5cdFx0XHRcdFx0Y29uc3QgZXhpc3RpbmdTbHVnID0gcGFyc2VkLnByb3BlcnRpZXNba2V5XVswXSB8fCBcIlwiO1xyXG5cdFx0XHRcdFx0Ly8gT25seSBhdXRvLXBvcHVsYXRlIGlmIHNsdWcgaXMgZW1wdHkgb3IgbWlzc2luZ1xyXG5cdFx0XHRcdFx0aWYgKCFleGlzdGluZ1NsdWcgfHwgZXhpc3RpbmdTbHVnLnRyaW0oKSA9PT0gXCJcIikge1xyXG5cdFx0XHRcdFx0XHRmaW5hbFByb3BzW2tleV0gPSBbc2x1Z107XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHQvLyBJZiBzbHVnIGhhcyBhIHZhbHVlLCBwcmVzZXJ2ZSBpdCAoZG9uJ3Qgb3ZlcndyaXRlKVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvLyBGb3Igb3RoZXIgbm9uLWFycmF5IHZhbHVlcywga2VlcCBleGlzdGluZyB2YWx1ZSAoZG9uJ3Qgb3ZlcndyaXRlKVxyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHQvLyBBbHNvIGNoZWNrIGlmIHNsdWcgcHJvcGVydHkgZXhpc3RzIGluIGZyb250bWF0dGVyIGJ1dCBpcyBlbXB0eSAoZXZlbiBpZiBub3QgaW4gdGVtcGxhdGUpXHJcblx0Ly8gT25seSBhdXRvLXBvcHVsYXRlIGlmIHRlbXBsYXRlIGhhcyB7e3NsdWd9fSBwbGFjZWhvbGRlclxyXG5cdGlmIChcInNsdWdcIiBpbiBwYXJzZWQucHJvcGVydGllcyAmJiB0ZW1wbGF0ZVN0cmluZy5pbmNsdWRlcyhcInt7c2x1Z319XCIpKSB7XHJcblx0XHRjb25zdCBleGlzdGluZ1NsdWcgPSBwYXJzZWQucHJvcGVydGllc1tcInNsdWdcIl1bMF0gfHwgXCJcIjtcclxuXHRcdGlmICghZXhpc3RpbmdTbHVnIHx8IGV4aXN0aW5nU2x1Zy50cmltKCkgPT09IFwiXCIpIHtcclxuXHRcdFx0Ly8gU2x1ZyBleGlzdHMgYnV0IGlzIGVtcHR5LCBhbmQgdGVtcGxhdGUgaGFzIHt7c2x1Z319IC0gYXV0by1wb3B1bGF0ZSBpdFxyXG5cdFx0XHRmaW5hbFByb3BzW1wic2x1Z1wiXSA9IFtzbHVnXTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8vIEFsc28gYWRkIGFueSBleGlzdGluZyBhcnJheSBrZXlzIHRoYXQgd2VyZW4ndCBpbiB0aGUgdGVtcGxhdGVcclxuXHRmb3IgKGNvbnN0IGtleSBpbiBwYXJzZWQucHJvcGVydGllcykge1xyXG5cdFx0aWYgKHBhcnNlZC5wcm9wZXJ0aWVzW2tleV0ubGVuZ3RoID4gMSkge1xyXG5cdFx0XHRhcnJheUtleXMuYWRkKGtleSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRjb25zdCBuZXdDb250ZW50ID0gdGVtcGxhdGVQYXJzZXIuYnVpbGRGcm9udG1hdHRlckNvbnRlbnQoZmluYWxQcm9wcywgYXJyYXlLZXlzKSArIHBhcnNlZC5ib2R5Q29udGVudDtcclxuXHJcblx0YXdhaXQgYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50KTtcclxuXHJcblx0Ly8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb24gaWYgZWRpdG9yIHdhcyBwcm92aWRlZCBhbmQgZmlsZSBpcyBzdGlsbCBvcGVuXHJcblx0aWYgKGVkaXRvciAmJiBjdXJzb3JQb3NpdGlvbikge1xyXG5cdFx0Ly8gV2FpdCBmb3IgT2JzaWRpYW4gdG8gcmVsb2FkIHRoZSBmaWxlIGluIHRoZSBlZGl0b3JcclxuXHRcdGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCA1MCkpO1xyXG5cclxuXHRcdC8vIFRyeSB0byBnZXQgdGhlIGFjdGl2ZSBlZGl0b3IgZm9yIHRoaXMgZmlsZVxyXG5cdFx0Y29uc3QgYWN0aXZlVmlldyA9IGFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xyXG5cdFx0aWYgKGFjdGl2ZVZpZXcgJiYgYWN0aXZlVmlldy5maWxlID09PSBmaWxlICYmIGFjdGl2ZVZpZXcuZWRpdG9yKSB7XHJcblx0XHRcdGNvbnN0IGFjdGl2ZUVkaXRvciA9IGFjdGl2ZVZpZXcuZWRpdG9yO1xyXG5cdFx0XHRjb25zdCBuZXdMaW5lQ291bnQgPSBuZXdDb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XHJcblx0XHRcdGNvbnN0IG9yaWdpbmFsTGluZUNvdW50ID0gb3JpZ2luYWxDb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XHJcblxyXG5cdFx0XHQvLyBDYWxjdWxhdGUgbmV3IGN1cnNvciBwb3NpdGlvblxyXG5cdFx0XHRsZXQgbmV3TGluZSA9IGN1cnNvclBvc2l0aW9uLmxpbmU7XHJcblx0XHRcdGxldCBuZXdDaCA9IGN1cnNvclBvc2l0aW9uLmNoO1xyXG5cclxuXHRcdFx0Ly8gQWRqdXN0IGZvciBjb250ZW50IGNoYW5nZXNcclxuXHRcdFx0aWYgKG5ld0xpbmVDb3VudCAhPT0gb3JpZ2luYWxMaW5lQ291bnQpIHtcclxuXHRcdFx0XHQvLyBJZiBsaW5lcyB3ZXJlIGFkZGVkL3JlbW92ZWQsIGFkanVzdCBsaW5lIG51bWJlclxyXG5cdFx0XHRcdGlmIChuZXdMaW5lID49IG5ld0xpbmVDb3VudCkge1xyXG5cdFx0XHRcdFx0bmV3TGluZSA9IE1hdGgubWF4KDAsIG5ld0xpbmVDb3VudCAtIDEpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gQWRqdXN0IGNvbHVtbiBwb3NpdGlvbiBpZiBsaW5lIGxlbmd0aCBjaGFuZ2VkXHJcblx0XHRcdGNvbnN0IG5ld0xpbmVMZW5ndGggPSBuZXdDb250ZW50LnNwbGl0KCdcXG4nKVtuZXdMaW5lXT8ubGVuZ3RoIHx8IDA7XHJcblx0XHRcdGlmIChuZXdDaCA+IG5ld0xpbmVMZW5ndGgpIHtcclxuXHRcdFx0XHRuZXdDaCA9IE1hdGgubWF4KDAsIG5ld0xpbmVMZW5ndGgpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBSZXN0b3JlIGN1cnNvciBwb3NpdGlvblxyXG5cdFx0XHRhY3RpdmVFZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbmV3TGluZSwgY2g6IG5ld0NoIH0pO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0bmV3IE5vdGljZShcIlByb3BlcnRpZXMgc3RhbmRhcmRpemVkIHVzaW5nIHRlbXBsYXRlLlwiKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFJlbmFtZSBhIGZpbGUgYnkgcGF0aCAoZm9yIHByb2dyYW1tYXRpYyB1c2UsIGUuZy4sIGZyb20gb3RoZXIgcGx1Z2lucylcclxuICogVGhpcyBhbGxvd3MgdGhlIHJlbmFtZSBtb2RhbCB0byBhcHBlYXIgd2l0aG91dCBvcGVuaW5nIHRoZSBmaWxlIGZpcnN0XHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVuYW1lQ29udGVudEJ5UGF0aChcclxuXHRhcHA6IEFwcCxcclxuXHRmaWxlUGF0aDogc3RyaW5nLFxyXG5cdHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsXHJcblx0cGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlXHJcbik6IHZvaWQge1xyXG5cdGNvbnN0IGZpbGUgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcclxuXHRpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XHJcblx0XHRuZXcgTm90aWNlKGBGaWxlIG5vdCBmb3VuZDogJHtmaWxlUGF0aH1gKTtcclxuXHRcdHJldHVybjtcclxuXHR9XHJcblxyXG5cdGNvbnN0IGZpbGVPcHMgPSBuZXcgRmlsZU9wZXJhdGlvbnMoYXBwLCBzZXR0aW5ncywgcGx1Z2luKTtcclxuXHJcblx0Ly8gSGVscGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIGZpbGUgbWF0Y2hlcyBjb250ZW50IHR5cGVcclxuXHQvLyBVc2VzIHRoZSBzYW1lIGxvZ2ljIGFzIEZpbGVPcGVyYXRpb25zLmRldGVybWluZVR5cGUoKSB0byBlbnN1cmUgY29uc2lzdGVuY3lcclxuXHRmdW5jdGlvbiBoYXNNYXRjaGluZ0NvbnRlbnRUeXBlKGZpbGU6IFRGaWxlLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogYm9vbGVhbiB7XHJcblx0XHRjb25zdCB0eXBlID0gZmlsZU9wcy5kZXRlcm1pbmVUeXBlKGZpbGUpO1xyXG5cdFx0Ly8gSWYgZGV0ZXJtaW5lVHlwZSByZXR1cm5zIFwibm90ZVwiLCBpdCBtZWFucyBubyBjb250ZW50IHR5cGUgbWF0Y2hlZFxyXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XHJcblx0XHRcdHJldHVybiBmYWxzZTtcclxuXHRcdH1cclxuXHRcdC8vIENoZWNrIGlmIHRoZSBtYXRjaGVkIGNvbnRlbnQgdHlwZSBpcyBlbmFibGVkXHJcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IGZpbGVPcHMuZ2V0Q29udGVudFR5cGUodHlwZSk7XHJcblx0XHRyZXR1cm4gY29udGVudFR5cGUgIT09IG51bGwgJiYgY29udGVudFR5cGUuZW5hYmxlZDtcclxuXHR9XHJcblxyXG5cdGlmICghaGFzTWF0Y2hpbmdDb250ZW50VHlwZShmaWxlLCBzZXR0aW5ncykpIHtcclxuXHRcdG5ldyBOb3RpY2UoXCJDYW5ub3QgcmVuYW1lOiB0aGlzIGZpbGUgaXMgbm90IHBhcnQgb2YgYSBjb25maWd1cmVkIGNvbnRlbnQgdHlwZSBmb2xkZXIuXCIpO1xyXG5cdFx0cmV0dXJuO1xyXG5cdH1cclxuXHJcblx0Y29uc3QgdHlwZSA9IGZpbGVPcHMuZGV0ZXJtaW5lVHlwZShmaWxlKTtcclxuXHJcblx0Ly8gQWx3YXlzIG9wZW4gdGhlIG1vZGFsIC0gaXQgd2lsbCBoYW5kbGUgZmlsZXMgd2l0aG91dCBmcm9udG1hdHRlciBvciB0aXRsZSBrZXlcclxuXHQvLyBJZiB0aGVyZSdzIG5vIHRpdGxlIGluIGZyb250bWF0dGVyLCB0aGUgbW9kYWwgd2lsbCB1c2UgdGhlIGZpbGVuYW1lIGFzIGZhbGxiYWNrXHJcblx0Ly8gYW5kIHRoZSByZW5hbWUgd2lsbCBwcm9jZWVkIHdpdGgga2ViYWItY2FzZSB2ZXJzaW9uIG9mIHdoYXQgdXNlciB0eXBlc1xyXG5cdG5ldyBUaXRsZU1vZGFsKGFwcCwgZmlsZSwgcGx1Z2luLCB0eXBlLCB0cnVlKS5vcGVuKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBSZWdpc3RlciBjb21tYW5kcyBmb3IgZWFjaCBlbmFibGVkIGNvbnRlbnQgdHlwZVxyXG4gKiBFYWNoIGNvbW1hbmQgY3JlYXRlcyBhIG5ldyBmaWxlIGluIHRoZSBjb250ZW50IHR5cGUncyBmb2xkZXIgYW5kIG9wZW5zIHRoZSBUaXRsZU1vZGFsXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gcmVnaXN0ZXJDb250ZW50VHlwZUNvbW1hbmRzKHBsdWdpbjogUGx1Z2luLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogdm9pZCB7XHJcblx0Y29uc3QgcGx1Z2luSW50ZXJmYWNlID0gcGx1Z2luIGFzIHVua25vd24gYXMgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcclxuXHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblxyXG5cdC8vIFJlZ2lzdGVyIGEgY29tbWFuZCBmb3IgZWFjaCBlbmFibGVkIGNvbnRlbnQgdHlwZVxyXG5cdGZvciAoY29uc3QgY29udGVudFR5cGUgb2YgY29udGVudFR5cGVzKSB7XHJcblx0XHRpZiAoIWNvbnRlbnRUeXBlLmVuYWJsZWQpIHtcclxuXHRcdFx0Y29udGludWU7IC8vIFNraXAgZGlzYWJsZWQgY29udGVudCB0eXBlc1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IGNvbW1hbmRJZCA9IGBjcmVhdGUtY29udGVudC10eXBlLSR7Y29udGVudFR5cGUuaWR9YDtcclxuXHRcdGNvbnN0IGNvbW1hbmROYW1lID0gYENyZWF0ZSBuZXcgY29udGVudCB0eXBlOiAke2NvbnRlbnRUeXBlLm5hbWV9YDtcclxuXHJcblx0XHRwbHVnaW4uYWRkQ29tbWFuZCh7XHJcblx0XHRcdGlkOiBjb21tYW5kSWQsXHJcblx0XHRcdG5hbWU6IGNvbW1hbmROYW1lLFxyXG5cdFx0XHRjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdC8vIERldGVybWluZSB0YXJnZXQgZm9sZGVyIGZyb20gY29udGVudCB0eXBlIChvciB2YXVsdCByb290IGlmIGJsYW5rKVxyXG5cdFx0XHRcdGxldCB0YXJnZXRGb2xkZXIgPSBjb250ZW50VHlwZS5mb2xkZXIgfHwgXCJcIjtcclxuXHJcblx0XHRcdFx0Ly8gQ3JlYXRlIGZvbGRlciBpZiBpdCBkb2Vzbid0IGV4aXN0IGFuZCBpcyBzcGVjaWZpZWRcclxuXHRcdFx0XHRpZiAodGFyZ2V0Rm9sZGVyICYmIHRhcmdldEZvbGRlci50cmltKCkgIT09IFwiXCIpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGZvbGRlciA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRhcmdldEZvbGRlcik7XHJcblx0XHRcdFx0XHRpZiAoIShmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSkge1xyXG5cdFx0XHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHBsdWdpbi5hcHAudmF1bHQuY3JlYXRlRm9sZGVyKHRhcmdldEZvbGRlcik7XHJcblx0XHRcdFx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xyXG5cdFx0XHRcdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjcmVhdGUgZm9sZGVyOiAke2Vycm9yTWVzc2FnZX1gKTtcclxuXHRcdFx0XHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdC8vIENyZWF0ZSBhIHRlbXBvcmFyeSBmaWxlIGluIHRoZSB0YXJnZXQgZm9sZGVyXHJcblx0XHRcdFx0Y29uc3QgdGVtcEZpbGVOYW1lID0gXCJVbnRpdGxlZC5tZFwiO1xyXG5cdFx0XHRcdGNvbnN0IGZpbGVQYXRoID0gdGFyZ2V0Rm9sZGVyID8gYCR7dGFyZ2V0Rm9sZGVyfS8ke3RlbXBGaWxlTmFtZX1gIDogdGVtcEZpbGVOYW1lO1xyXG5cclxuXHRcdFx0XHQvLyBDaGVjayBpZiBmaWxlIGFscmVhZHkgZXhpc3RzICh1bmxpa2VseSBidXQgcG9zc2libGUpXHJcblx0XHRcdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xyXG5cdFx0XHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG5cdFx0XHRcdFx0Ly8gSWYgZmlsZSBleGlzdHMsIHVzZSBpdCBkaXJlY3RseVxyXG5cdFx0XHRcdFx0bmV3IFRpdGxlTW9kYWwocGx1Z2luLmFwcCwgZXhpc3RpbmdGaWxlLCBwbHVnaW5JbnRlcmZhY2UsIGNvbnRlbnRUeXBlLmlkLCBmYWxzZSwgdHJ1ZSkub3BlbigpO1xyXG5cdFx0XHRcdFx0cmV0dXJuO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0Ly8gTWFyayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpblxyXG5cdFx0XHRcdC8vIFRoaXMgcHJldmVudHMgdGhlIGNyZWF0ZSBldmVudCBmcm9tIHRyaWdnZXJpbmcgYW5vdGhlciBtb2RhbFxyXG5cdFx0XHRcdGlmIChwbHVnaW5JbnRlcmZhY2UgJiYgJ3BsdWdpbkNyZWF0ZWRGaWxlcycgaW4gcGx1Z2luSW50ZXJmYWNlKSB7XHJcblx0XHRcdFx0XHRwbHVnaW5JbnRlcmZhY2UucGx1Z2luQ3JlYXRlZEZpbGVzLnNldChmaWxlUGF0aCwgRGF0ZS5ub3coKSk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0Ly8gQ3JlYXRlIHRoZSB0ZW1wb3JhcnkgZmlsZVxyXG5cdFx0XHRcdFx0Y29uc3QgdGVtcEZpbGUgPSBhd2FpdCBwbHVnaW4uYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgXCJcIik7XHJcblxyXG5cdFx0XHRcdFx0Ly8gT3BlbiB0aGUgVGl0bGVNb2RhbCB3aXRoIHRoZSBmaWxlLCBjb250ZW50IHR5cGUgSUQsIGFuZCBpc05ld05vdGUgZmxhZ1xyXG5cdFx0XHRcdFx0bmV3IFRpdGxlTW9kYWwocGx1Z2luLmFwcCwgdGVtcEZpbGUsIHBsdWdpbkludGVyZmFjZSwgY29udGVudFR5cGUuaWQsIGZhbHNlLCB0cnVlKS5vcGVuKCk7XHJcblx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcclxuXHRcdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byBjcmVhdGUgZmlsZTogJHtlcnJvck1lc3NhZ2V9YCk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gQ2xlYW4gdXAgdGhlIHRyYWNraW5nIGlmIGZpbGUgY3JlYXRpb24gZmFpbGVkXHJcblx0XHRcdFx0XHRpZiAocGx1Z2luSW50ZXJmYWNlICYmICdwbHVnaW5DcmVhdGVkRmlsZXMnIGluIHBsdWdpbkludGVyZmFjZSkge1xyXG5cdFx0XHRcdFx0XHRwbHVnaW5JbnRlcmZhY2UucGx1Z2luQ3JlYXRlZEZpbGVzLmRlbGV0ZShmaWxlUGF0aCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9LFxyXG5cdFx0fSk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogRGVidWcgbG9nZ2VyIGZvciB0ZXJtaW5hbCBjb21tYW5kc1xyXG4gKi9cclxuY29uc3QgdGVybWluYWxMb2dnZXIgPSB7XHJcblx0ZW5hYmxlZDogZmFsc2UsXHJcblx0c2V0RW5hYmxlZCh2YWx1ZTogYm9vbGVhbikge1xyXG5cdFx0dGhpcy5lbmFibGVkID0gdmFsdWU7XHJcblx0fSxcclxuXHRsb2coLi4uYXJnczogdW5rbm93bltdKSB7XHJcblx0XHRpZiAodGhpcy5lbmFibGVkKSB7XHJcblx0XHRcdGNvbnNvbGUuZGVidWcoXCJbYXN0cm8tY29tcG9zZXI6dGVybWluYWxdXCIsIC4uLmFyZ3MpO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgZGVmYXVsdCB0ZXJtaW5hbCBhcHBsaWNhdGlvbiBuYW1lIGJhc2VkIG9uIHBsYXRmb3JtXHJcbiAqL1xyXG5mdW5jdGlvbiBnZXREZWZhdWx0VGVybWluYWxBcHAoKTogc3RyaW5nIHtcclxuXHRpZiAoIVBsYXRmb3JtLmlzRGVza3RvcEFwcCkge1xyXG5cdFx0cmV0dXJuIFwiXCI7XHJcblx0fVxyXG5cdGlmIChQbGF0Zm9ybS5pc01hY09TKSB7XHJcblx0XHRyZXR1cm4gXCJUZXJtaW5hbFwiO1xyXG5cdH1cclxuXHRpZiAoUGxhdGZvcm0uaXNXaW4pIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmIC0tIFJlcXVpcmVkIGZvciBPUyByZWxlYXNlIGRldGVjdGlvbiBvbiBkZXNrdG9wXHJcblx0XHRcdGNvbnN0IG9zID0gcmVxdWlyZSgnb3MnKSBhcyB7IHJlbGVhc2U6ICgpID0+IHN0cmluZyB9O1xyXG5cdFx0XHRjb25zdCByZWxlYXNlID0gb3MucmVsZWFzZSgpO1xyXG5cdFx0XHQvLyBXaW5kb3dzIDExIGJ1aWxkIG51bWJlcnMgc3RhcnQgYXQgMjIwMDBcclxuXHRcdFx0Y29uc3QgbWFqb3JWZXJzaW9uID0gcGFyc2VJbnQocmVsZWFzZS5zcGxpdCgnLicpWzBdKTtcclxuXHRcdFx0Y29uc3QgYnVpbGROdW1iZXIgPSBwYXJzZUludChyZWxlYXNlLnNwbGl0KCcuJylbMl0pO1xyXG5cclxuXHRcdFx0aWYgKG1ham9yVmVyc2lvbiA+IDEwIHx8IChtYWpvclZlcnNpb24gPT09IDEwICYmIGJ1aWxkTnVtYmVyID49IDIyMDAwKSkge1xyXG5cdFx0XHRcdHJldHVybiBcInd0LmV4ZVwiO1xyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIHtcclxuXHRcdFx0Ly8gRmFsbGJhY2sgdG8gY21kLmV4ZSBpZiBPUyBkZXRlY3Rpb24gZmFpbHNcclxuXHRcdH1cclxuXHRcdHJldHVybiBcImNtZC5leGVcIjtcclxuXHR9XHJcblx0aWYgKFBsYXRmb3JtLmlzTGludXgpIHtcclxuXHRcdHJldHVybiBcImdub21lLXRlcm1pbmFsXCI7XHJcblx0fVxyXG5cdHJldHVybiBcIlwiO1xyXG59XHJcblxyXG4vKipcclxuICogU2FuaXRpemUgdGVybWluYWwgYXBwbGljYXRpb24gbmFtZSAodHJpbSB3aGl0ZXNwYWNlKVxyXG4gKi9cclxuZnVuY3Rpb24gc2FuaXRpemVUZXJtaW5hbEFwcCh2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRyZXR1cm4gdmFsdWUudHJpbSgpO1xyXG59XHJcblxyXG4vKipcclxuICogRXNjYXBlIGRvdWJsZSBxdW90ZXMgaW4gYSBzdHJpbmdcclxuICovXHJcbmZ1bmN0aW9uIGVzY2FwZURvdWJsZVF1b3Rlcyh2YWx1ZTogc3RyaW5nKTogc3RyaW5nIHtcclxuXHRyZXR1cm4gdmFsdWUucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpO1xyXG59XHJcblxyXG4vKipcclxuICogT3BlbiB0ZXJtaW5hbCBpbiBwcm9qZWN0IHJvb3QgZGlyZWN0b3J5XHJcbiAqIEV4cG9ydGVkIGZvciB1c2UgYnkgcmliYm9uIGljb25zXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gb3BlblRlcm1pbmFsSW5Qcm9qZWN0Um9vdChhcHA6IEFwcCwgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyk6IHZvaWQge1xyXG5cdC8vIFVwZGF0ZSBsb2dnZXIgc3RhdGVcclxuXHR0ZXJtaW5hbExvZ2dlci5zZXRFbmFibGVkKHNldHRpbmdzLmVuYWJsZVRlcm1pbmFsRGVidWdMb2dnaW5nKTtcclxuXHJcblx0dHJ5IHtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmIC0tIGNoaWxkX3Byb2Nlc3MgaXMgcmVxdWlyZWQgZm9yIHRlcm1pbmFsIGNvbW1hbmRzIG9uIGRlc2t0b3BcclxuXHRcdGNvbnN0IHsgZXhlYyB9ID0gcmVxdWlyZSgnY2hpbGRfcHJvY2VzcycpIGFzIHsgZXhlYzogKGNvbW1hbmQ6IHN0cmluZywgY2FsbGJhY2s6IChlcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB2b2lkKSA9PiB2b2lkIH07XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZiAtLSBwYXRoIGlzIHJlcXVpcmVkIGZvciByZXNvbHZpbmcgcGF0aHMgb24gZGVza3RvcFxyXG5cdFx0Y29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKSBhcyB7IHJlc29sdmU6ICguLi5hcmdzOiBzdHJpbmdbXSkgPT4gc3RyaW5nIH07XHJcblx0XHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLW5vZGVqcy1tb2R1bGVzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZiAtLSBmcyBpcyByZXF1aXJlZCBmb3IgdmVyaWZ5aW5nIHBhdGhzIG9uIGRlc2t0b3BcclxuXHRcdGNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKSBhcyB7IGV4aXN0c1N5bmM6IChwYXRoOiBzdHJpbmcpID0+IGJvb2xlYW4gfTtcclxuXHJcblx0XHQvLyBHZXQgdGhlIGFjdHVhbCB2YXVsdCBwYXRoIHN0cmluZyBmcm9tIHRoZSBhZGFwdGVyXHJcblx0XHRjb25zdCBhZGFwdGVyID0gYXBwLnZhdWx0LmFkYXB0ZXIgYXMgdW5rbm93biBhcyB7IGJhc2VQYXRoPzogc3RyaW5nOyBwYXRoPzogc3RyaW5nIH07XHJcblx0XHRjb25zdCB2YXVsdFBhdGggPSBhZGFwdGVyLmJhc2VQYXRoIHx8IGFkYXB0ZXIucGF0aDtcclxuXHRcdGNvbnN0IHZhdWx0UGF0aFN0cmluZyA9IHR5cGVvZiB2YXVsdFBhdGggPT09ICdzdHJpbmcnID8gdmF1bHRQYXRoIDogU3RyaW5nKHZhdWx0UGF0aCk7XHJcblxyXG5cdFx0Ly8gUmVzb2x2ZSBwcm9qZWN0IHJvb3QgcGF0aFxyXG5cdFx0bGV0IHByb2plY3RQYXRoOiBzdHJpbmc7XHJcblx0XHRpZiAoc2V0dGluZ3MudGVybWluYWxQcm9qZWN0Um9vdFBhdGggJiYgc2V0dGluZ3MudGVybWluYWxQcm9qZWN0Um9vdFBhdGgudHJpbSgpKSB7XHJcblx0XHRcdC8vIFVzZSBjdXN0b20gcGF0aCByZWxhdGl2ZSB0byB2YXVsdFxyXG5cdFx0XHRwcm9qZWN0UGF0aCA9IHBhdGgucmVzb2x2ZSh2YXVsdFBhdGhTdHJpbmcsIHNldHRpbmdzLnRlcm1pbmFsUHJvamVjdFJvb3RQYXRoKTtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIERlZmF1bHQ6IHZhdWx0IGZvbGRlciBpdHNlbGZcclxuXHRcdFx0cHJvamVjdFBhdGggPSB2YXVsdFBhdGhTdHJpbmc7XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVmVyaWZ5IHRoZSBwYXRoIGV4aXN0c1xyXG5cdFx0aWYgKCFmcy5leGlzdHNTeW5jKHByb2plY3RQYXRoKSkge1xyXG5cdFx0XHRuZXcgTm90aWNlKGBQcm9qZWN0IHJvb3QgZGlyZWN0b3J5IG5vdCBmb3VuZCBhdDogJHtwcm9qZWN0UGF0aH1gKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIEdldCB0ZXJtaW5hbCBhcHBsaWNhdGlvbiBuYW1lICh1c2UgY29uZmlndXJlZCBvciBkZWZhdWx0KVxyXG5cdFx0Y29uc3QgY29uZmlndXJlZEFwcCA9IHNhbml0aXplVGVybWluYWxBcHAoc2V0dGluZ3MudGVybWluYWxBcHBsaWNhdGlvbk5hbWUgfHwgXCJcIik7XHJcblx0XHRjb25zdCB0ZXJtaW5hbEFwcCA9IGNvbmZpZ3VyZWRBcHAgfHwgZ2V0RGVmYXVsdFRlcm1pbmFsQXBwKCk7XHJcblxyXG5cdFx0Ly8gV2FybiBpZiB0ZXJtaW5hbCBhcHAgbmFtZSBpcyBlbXB0eSAoYnV0IHN0aWxsIHRyeSB0byB1c2UgZGVmYXVsdHMpXHJcblx0XHRpZiAoIWNvbmZpZ3VyZWRBcHAgJiYgIXRlcm1pbmFsQXBwKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoXCJUZXJtaW5hbCBhcHBsaWNhdGlvbiBuYW1lIGlzIGVtcHR5LiBQbGVhc2UgY29uZmlndXJlIGl0IGluIHNldHRpbmdzLlwiKTtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bmRlZiAtLSBwcm9jZXNzIGlzIGEgZ2xvYmFsIGluIHRoZSBFbGVjdHJvbiByZW5kZXJlciBwcm9jZXNzXHJcblx0XHRjb25zdCBwbGF0Zm9ybSA9IHByb2Nlc3MucGxhdGZvcm07XHJcblx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJPcGVuaW5nIHRlcm1pbmFsXCIsIHsgcGxhdGZvcm0sIHRlcm1pbmFsQXBwLCBwcm9qZWN0UGF0aCB9KTtcclxuXHJcblx0XHRpZiAocGxhdGZvcm0gPT09ICd3aW4zMicpIHtcclxuXHRcdFx0Ly8gV2luZG93czogVXNlIHN0YXJ0IGNvbW1hbmQgd2l0aCBjb25maWd1cmFibGUgdGVybWluYWxcclxuXHRcdFx0Y29uc3QgZXNjYXBlZFBhdGggPSBwcm9qZWN0UGF0aC5yZXBsYWNlKC9cIi9nLCAnXCInKTtcclxuXHRcdFx0Y29uc3QgbG93ZXJBcHAgPSB0ZXJtaW5hbEFwcC50b0xvd2VyQ2FzZSgpO1xyXG5cclxuXHRcdFx0aWYgKGxvd2VyQXBwID09PSBcInd0LmV4ZVwiIHx8IGxvd2VyQXBwID09PSBcInd0XCIgfHwgbG93ZXJBcHAgPT09IFwid2luZG93cyB0ZXJtaW5hbFwiKSB7XHJcblx0XHRcdFx0Ly8gV2luZG93cyBUZXJtaW5hbFxyXG5cdFx0XHRcdGV4ZWMoJ3doZXJlIHd0JywgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdGlmICghZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0Y29uc3QgY29tbWFuZCA9IGBzdGFydCBcIlwiIHd0LmV4ZSAtZCBcIiR7ZXNjYXBlZFBhdGh9XCJgO1xyXG5cdFx0XHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJXaW5kb3dzIGxhdW5jaCAod3QpXCIsIHsgY29tbWFuZCwgcHJvamVjdFBhdGggfSk7XHJcblx0XHRcdFx0XHRcdGV4ZWMoY29tbWFuZCwgKGV4ZWNFcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGV4ZWNFcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiV2luZG93cyBUZXJtaW5hbCBmYWlsZWQsIGZhbGxpbmcgYmFjayB0byBjbWRcIiwgeyBlcnJvcjogZXhlY0Vycm9yLm1lc3NhZ2UgfSk7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBGYWxsYmFjayB0byBjbWRcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGZhbGxiYWNrQ29tbWFuZCA9IGBzdGFydCBcIlwiIGNtZC5leGUgL0sgXCJjZCAvZCBcIiR7ZXNjYXBlZFBhdGh9XCJcImA7XHJcblx0XHRcdFx0XHRcdFx0XHRleGVjKGZhbGxiYWNrQ29tbWFuZCwgKGNtZEVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNtZEVycm9yKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtjbWRFcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8vIFdpbmRvd3MgVGVybWluYWwgbm90IGZvdW5kLCBmYWxsYmFjayB0byBjbWRcclxuXHRcdFx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiV2luZG93cyBUZXJtaW5hbCBub3QgZm91bmQsIHVzaW5nIGNtZFwiLCB7fSk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGZhbGxiYWNrQ29tbWFuZCA9IGBzdGFydCBcIlwiIGNtZC5leGUgL0sgXCJjZCAvZCBcIiR7ZXNjYXBlZFBhdGh9XCJcImA7XHJcblx0XHRcdFx0XHRcdGV4ZWMoZmFsbGJhY2tDb21tYW5kLCAoY21kRXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjbWRFcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtjbWRFcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2UgaWYgKGxvd2VyQXBwID09PSBcInBvd2Vyc2hlbGxcIiB8fCBsb3dlckFwcCA9PT0gXCJwb3dlcnNoZWxsLmV4ZVwiKSB7XHJcblx0XHRcdFx0Ly8gUG93ZXJTaGVsbFxyXG5cdFx0XHRcdGNvbnN0IGVzY2FwZWRQYXRoRm9yUFMgPSBwcm9qZWN0UGF0aC5yZXBsYWNlKC8nL2csIFwiJydcIik7XHJcblx0XHRcdFx0Y29uc3QgY29tbWFuZCA9IGBzdGFydCBcIlwiIHBvd2Vyc2hlbGwgLU5vRXhpdCAtQ29tbWFuZCBcIlNldC1Mb2NhdGlvbiAnJHtlc2NhcGVkUGF0aEZvclBTfSc7XCJgO1xyXG5cdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIldpbmRvd3MgbGF1bmNoIChwb3dlcnNoZWxsKVwiLCB7IGNvbW1hbmQsIHByb2plY3RQYXRoIH0pO1xyXG5cdFx0XHRcdGV4ZWMoY29tbWFuZCwgKGVycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdGlmIChlcnJvcikge1xyXG5cdFx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGVsc2UgaWYgKGxvd2VyQXBwID09PSBcImNtZC5leGVcIiB8fCBsb3dlckFwcCA9PT0gXCJjbWRcIikge1xyXG5cdFx0XHRcdC8vIENvbW1hbmQgUHJvbXB0XHJcblx0XHRcdFx0Y29uc3QgY29tbWFuZCA9IGBzdGFydCBcIlwiIGNtZC5leGUgL0sgXCJjZCAvZCBcIiR7ZXNjYXBlZFBhdGh9XCJcImA7XHJcblx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiV2luZG93cyBsYXVuY2ggKGNtZClcIiwgeyBjb21tYW5kLCBwcm9qZWN0UGF0aCB9KTtcclxuXHRcdFx0XHRleGVjKGNvbW1hbmQsIChlcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtlcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHQvLyBHZW5lcmljIHRlcm1pbmFsIC0gdHJ5IHRvIGxhdW5jaCBpdCBkaXJlY3RseVxyXG5cdFx0XHRcdGNvbnN0IGNvbW1hbmQgPSBgc3RhcnQgXCJcIiBcIiR7dGVybWluYWxBcHB9XCJgO1xyXG5cdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIldpbmRvd3MgbGF1bmNoIChnZW5lcmljKVwiLCB7IGNvbW1hbmQsIHRlcm1pbmFsQXBwLCBwcm9qZWN0UGF0aCB9KTtcclxuXHRcdFx0XHRleGVjKGNvbW1hbmQsIChlcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRpZiAoZXJyb3IpIHtcclxuXHRcdFx0XHRcdFx0Ly8gRmFsbGJhY2sgdG8gY21kIGlmIGdlbmVyaWMgbGF1bmNoIGZhaWxzXHJcblx0XHRcdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIkdlbmVyaWMgdGVybWluYWwgZmFpbGVkLCBmYWxsaW5nIGJhY2sgdG8gY21kXCIsIHsgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IGZhbGxiYWNrQ29tbWFuZCA9IGBzdGFydCBcIlwiIGNtZC5leGUgL0sgXCJjZCAvZCBcIiR7ZXNjYXBlZFBhdGh9XCJcImA7XHJcblx0XHRcdFx0XHRcdGV4ZWMoZmFsbGJhY2tDb21tYW5kLCAoY21kRXJyb3I6IHsgbWVzc2FnZT86IHN0cmluZyB9IHwgbnVsbCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjbWRFcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtjbWRFcnJvci5tZXNzYWdlIHx8ICdVbmtub3duIGVycm9yJ31gKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9IGVsc2UgaWYgKHBsYXRmb3JtID09PSAnZGFyd2luJykge1xyXG5cdFx0XHQvLyBtYWNPUzogVXNlIG9wZW4gLWEgKHNpbXBsZXIgdGhhbiBvc2FzY3JpcHQpXHJcblx0XHRcdGNvbnN0IGVzY2FwZWRBcHAgPSBlc2NhcGVEb3VibGVRdW90ZXModGVybWluYWxBcHApO1xyXG5cdFx0XHRjb25zdCBlc2NhcGVkUGF0aCA9IGVzY2FwZURvdWJsZVF1b3Rlcyhwcm9qZWN0UGF0aCk7XHJcblx0XHRcdGNvbnN0IGNvbW1hbmQgPSBgb3BlbiAtbmEgXCIke2VzY2FwZWRBcHB9XCIgXCIke2VzY2FwZWRQYXRofVwiYDtcclxuXHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwibWFjT1MgbGF1bmNoXCIsIHsgY29tbWFuZCwgdGVybWluYWxBcHAsIHByb2plY3RQYXRoIH0pO1xyXG5cdFx0XHRleGVjKGNvbW1hbmQsIChlcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0aWYgKGVycm9yKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKGBFcnJvciBvcGVuaW5nIHRlcm1pbmFsOiAke2Vycm9yLm1lc3NhZ2UgfHwgJ1Vua25vd24gZXJyb3InfWApO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9IGVsc2Uge1xyXG5cdFx0XHQvLyBMaW51eDogVHJ5IGNvbmZpZ3VyYWJsZSB0ZXJtaW5hbCB3aXRoIGZhbGxiYWNrIGNoYWluXHJcblx0XHRcdGNvbnN0IHRlcm1pbmFscyA9IHRlcm1pbmFsQXBwID8gW3Rlcm1pbmFsQXBwXSA6IFtcImdub21lLXRlcm1pbmFsXCIsIFwia29uc29sZVwiLCBcInh0ZXJtXCJdO1xyXG5cdFx0XHRjb25zdCBwcm9qZWN0UGF0aEVzY2FwZWQgPSBwcm9qZWN0UGF0aC5yZXBsYWNlKC9cIi9nLCAnXFxcXFwiJyk7XHJcblxyXG5cdFx0XHQvLyBUcnkgZWFjaCB0ZXJtaW5hbCB1bnRpbCBvbmUgd29ya3NcclxuXHRcdFx0Y29uc3QgdHJ5VGVybWluYWwgPSAoaW5kZXg6IG51bWJlcikgPT4ge1xyXG5cdFx0XHRcdGlmIChpbmRleCA+PSB0ZXJtaW5hbHMubGVuZ3RoKSB7XHJcblx0XHRcdFx0XHRuZXcgTm90aWNlKCdObyBzdXBwb3J0ZWQgdGVybWluYWwgZm91bmQuIFBsZWFzZSBpbnN0YWxsIGEgdGVybWluYWwgYXBwbGljYXRpb24gb3IgY29uZmlndXJlIG9uZSBpbiBzZXR0aW5ncy4nKTtcclxuXHRcdFx0XHRcdHJldHVybjtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdGNvbnN0IGN1cnJlbnRUZXJtaW5hbCA9IHRlcm1pbmFsc1tpbmRleF07XHJcblx0XHRcdFx0Y29uc3QgdGVybWluYWxOYW1lID0gY3VycmVudFRlcm1pbmFsLnNwbGl0KCcgJylbMF07XHJcblxyXG5cdFx0XHRcdC8vIENoZWNrIGlmIHRlcm1pbmFsIGV4aXN0c1xyXG5cdFx0XHRcdGV4ZWMoYHdoaWNoICR7dGVybWluYWxOYW1lfWAsIChlcnJvcjogeyBtZXNzYWdlPzogc3RyaW5nIH0gfCBudWxsKSA9PiB7XHJcblx0XHRcdFx0XHRpZiAoIWVycm9yKSB7XHJcblx0XHRcdFx0XHRcdC8vIFRlcm1pbmFsIGZvdW5kLCB0cnkgdG8gbGF1bmNoIGl0XHJcblx0XHRcdFx0XHRcdGxldCBjb21tYW5kOiBzdHJpbmc7XHJcblx0XHRcdFx0XHRcdGlmIChjdXJyZW50VGVybWluYWwuaW5jbHVkZXMoXCJnbm9tZS10ZXJtaW5hbFwiKSkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbW1hbmQgPSBgZ25vbWUtdGVybWluYWwgLS13b3JraW5nLWRpcmVjdG9yeT1cIiR7cHJvamVjdFBhdGhFc2NhcGVkfVwiYDtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChjdXJyZW50VGVybWluYWwuaW5jbHVkZXMoXCJrb25zb2xlXCIpKSB7XHJcblx0XHRcdFx0XHRcdFx0Y29tbWFuZCA9IGBrb25zb2xlIC0td29ya2RpciBcIiR7cHJvamVjdFBhdGhFc2NhcGVkfVwiYDtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBHZW5lcmljIHRlcm1pbmFsXHJcblx0XHRcdFx0XHRcdFx0Y29tbWFuZCA9IGAke2N1cnJlbnRUZXJtaW5hbH0gLWUgXCJjZCBcXFxcXCIke3Byb2plY3RQYXRoRXNjYXBlZH1cXFxcXCIgJiYgYmFzaFwiYDtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR0ZXJtaW5hbExvZ2dlci5sb2coXCJMaW51eCBsYXVuY2hcIiwgeyBjb21tYW5kLCB0ZXJtaW5hbDogY3VycmVudFRlcm1pbmFsLCBwcm9qZWN0UGF0aCB9KTtcclxuXHRcdFx0XHRcdFx0ZXhlYyhjb21tYW5kLCAoZXhlY0Vycm9yOiB7IG1lc3NhZ2U/OiBzdHJpbmcgfSB8IG51bGwpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoZXhlY0Vycm9yICYmIGluZGV4IDwgdGVybWluYWxzLmxlbmd0aCAtIDEpIHtcclxuXHRcdFx0XHRcdFx0XHRcdHRlcm1pbmFsTG9nZ2VyLmxvZyhcIlRlcm1pbmFsIGxhdW5jaCBmYWlsZWQsIHRyeWluZyBuZXh0XCIsIHsgdGVybWluYWw6IGN1cnJlbnRUZXJtaW5hbCwgZXJyb3I6IGV4ZWNFcnJvci5tZXNzYWdlIH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0dHJ5VGVybWluYWwoaW5kZXggKyAxKTtcclxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGV4ZWNFcnJvcikge1xyXG5cdFx0XHRcdFx0XHRcdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtleGVjRXJyb3IubWVzc2FnZSB8fCAnVW5rbm93biBlcnJvcid9YCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8vIFRlcm1pbmFsIG5vdCBmb3VuZCwgdHJ5IG5leHRcclxuXHRcdFx0XHRcdFx0dGVybWluYWxMb2dnZXIubG9nKFwiVGVybWluYWwgbm90IGZvdW5kLCB0cnlpbmcgbmV4dFwiLCB7IHRlcm1pbmFsOiBjdXJyZW50VGVybWluYWwgfSk7XHJcblx0XHRcdFx0XHRcdHRyeVRlcm1pbmFsKGluZGV4ICsgMSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHR0cnlUZXJtaW5hbCgwKTtcclxuXHRcdH1cclxuXHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0dGVybWluYWxMb2dnZXIubG9nKFwiVW5leHBlY3RlZCBlcnJvclwiLCB7IGVycm9yIH0pO1xyXG5cdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyB0ZXJtaW5hbDogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XHJcblx0fVxyXG59XHJcblxyXG4vKipcclxuICogT3BlbiBjb25maWcgZmlsZSBpbiBkZWZhdWx0IGVkaXRvclxyXG4gKiBFeHBvcnRlZCBmb3IgdXNlIGJ5IHJpYmJvbiBpY29uc1xyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIG9wZW5Db25maWdGaWxlKGFwcDogQXBwLCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogUHJvbWlzZTx2b2lkPiB7XHJcblx0dHJ5IHtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmIC0tIGZzIGlzIHJlcXVpcmVkIGZvciB2ZXJpZnlpbmcgY29uZmlnIGZpbGUgZXhpc3RzIG9uIGRlc2t0b3BcclxuXHRcdGNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKSBhcyB7IGV4aXN0c1N5bmM6IChwYXRoOiBzdHJpbmcpID0+IGJvb2xlYW4gfTtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tbm9kZWpzLW1vZHVsZXMsIEB0eXBlc2NyaXB0LWVzbGludC9uby1yZXF1aXJlLWltcG9ydHMsIG5vLXVuZGVmIC0tIHBhdGggaXMgcmVxdWlyZWQgZm9yIHJlc29sdmluZyBwYXRocyBvbiBkZXNrdG9wXHJcblx0XHRjb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpIGFzIHsgcmVzb2x2ZTogKC4uLmFyZ3M6IHN0cmluZ1tdKSA9PiBzdHJpbmcgfTtcclxuXHRcdC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tcmVxdWlyZS1pbXBvcnRzLCBuby11bmRlZiAtLSBlbGVjdHJvbiBzaGVsbCBpcyByZXF1aXJlZCB0byBvcGVuIGZpbGVzIGluIGRlZmF1bHQgZWRpdG9yXHJcblx0XHRjb25zdCB7IHNoZWxsIH0gPSByZXF1aXJlKCdlbGVjdHJvbicpIGFzIHsgc2hlbGw6IHsgb3BlblBhdGg6IChwYXRoOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nPiB9IH07XHJcblxyXG5cdFx0Ly8gR2V0IHRoZSBhY3R1YWwgdmF1bHQgcGF0aCBzdHJpbmcgZnJvbSB0aGUgYWRhcHRlclxyXG5cdFx0Y29uc3QgYWRhcHRlciA9IGFwcC52YXVsdC5hZGFwdGVyIGFzIHVua25vd24gYXMgeyBiYXNlUGF0aD86IHN0cmluZzsgcGF0aD86IHN0cmluZyB9O1xyXG5cdFx0Y29uc3QgdmF1bHRQYXRoID0gYWRhcHRlci5iYXNlUGF0aCB8fCBhZGFwdGVyLnBhdGg7XHJcblx0XHRjb25zdCB2YXVsdFBhdGhTdHJpbmcgPSB0eXBlb2YgdmF1bHRQYXRoID09PSAnc3RyaW5nJyA/IHZhdWx0UGF0aCA6IFN0cmluZyh2YXVsdFBhdGgpO1xyXG5cclxuXHRcdC8vIFJlc29sdmUgY29uZmlnIGZpbGUgcGF0aFxyXG5cdFx0aWYgKCFzZXR0aW5ncy5jb25maWdGaWxlUGF0aCB8fCAhc2V0dGluZ3MuY29uZmlnRmlsZVBhdGgudHJpbSgpKSB7XHJcblx0XHRcdG5ldyBOb3RpY2UoXCJQbGVhc2Ugc3BlY2lmeSBhIGNvbmZpZyBmaWxlIHBhdGggaW4gc2V0dGluZ3MuXCIpO1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gVXNlIGN1c3RvbSBwYXRoIHJlbGF0aXZlIHRvIHZhdWx0XHJcblx0XHRjb25zdCBjb25maWdQYXRoID0gcGF0aC5yZXNvbHZlKHZhdWx0UGF0aFN0cmluZywgc2V0dGluZ3MuY29uZmlnRmlsZVBhdGgpO1xyXG5cclxuXHRcdC8vIENoZWNrIGlmIGZpbGUgZXhpc3RzXHJcblx0XHRpZiAoIWZzLmV4aXN0c1N5bmMoY29uZmlnUGF0aCkpIHtcclxuXHRcdFx0bmV3IE5vdGljZShgQ29uZmlnIGZpbGUgbm90IGZvdW5kIGF0OiAke2NvbmZpZ1BhdGh9YCk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQvLyBVc2UgRWxlY3Ryb24ncyBzaGVsbCB0byBvcGVuIHRoZSBmaWxlIHdpdGggdGhlIGRlZmF1bHQgZWRpdG9yXHJcblx0XHRhd2FpdCBzaGVsbC5vcGVuUGF0aChjb25maWdQYXRoKTtcclxuXHR9IGNhdGNoIChlcnJvcikge1xyXG5cdFx0bmV3IE5vdGljZShgRXJyb3Igb3BlbmluZyBjb25maWcgZmlsZTogJHtlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcil9YCk7XHJcblx0fVxyXG59IiwgImltcG9ydCB7IEFwcCwgVEZpbGUsIFRGb2xkZXIsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzLCBGaWxlQ3JlYXRpb25PcHRpb25zLCBSZW5hbWVPcHRpb25zLCBDb250ZW50VHlwZSwgQ29udGVudFR5cGVJZCwgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB9IGZyb20gXCIuLi90eXBlc1wiO1xuaW1wb3J0IHsgbWF0Y2hlc0ZvbGRlclBhdHRlcm4sIHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eSB9IGZyb20gXCIuL3BhdGgtbWF0Y2hpbmdcIjtcbmltcG9ydCB7IHRvS2ViYWJDYXNlIH0gZnJvbSBcIi4vc3RyaW5nLXV0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBGaWxlT3BlcmF0aW9ucyB7XG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIHByaXZhdGUgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgcHJpdmF0ZSBwbHVnaW4/OiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKSB7IH1cblxuXHQvLyBHZXQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgdXNlIHN0b3JlZCBzZXR0aW5nc1xuXHRwcml2YXRlIGdldFNldHRpbmdzKCk6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncyB7XG5cdFx0Ly8gQWx3YXlzIHByZWZlciBwbHVnaW4gc2V0dGluZ3MgKHRoZXkncmUga2VwdCB1cCB0byBkYXRlKVxuXHRcdGlmICh0aGlzLnBsdWdpbj8uc2V0dGluZ3MpIHtcblx0XHRcdHJldHVybiB0aGlzLnBsdWdpbi5zZXR0aW5ncztcblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMuc2V0dGluZ3M7XG5cdH1cblxuXHRnZW5lcmF0ZUZpbGVuYW1lKHRpdGxlOiBzdHJpbmcsIGVuYWJsZVVuZGVyc2NvcmVQcmVmaXg6IGJvb2xlYW4gPSBmYWxzZSk6IHN0cmluZyB7XG5cdFx0Y29uc3Qga2ViYWJUaXRsZSA9IHRvS2ViYWJDYXNlKHRpdGxlKTtcblx0XHQvLyBJZiBrZWJhYiBjYXNlIHJlc3VsdHMgaW4gZW1wdHkgc3RyaW5nLCB1c2UgYSBmYWxsYmFja1xuXHRcdGNvbnN0IHNhZmVLZWJhYlRpdGxlID0ga2ViYWJUaXRsZSB8fCBcInVudGl0bGVkXCI7XG5cdFx0Y29uc3QgcHJlZml4ID0gZW5hYmxlVW5kZXJzY29yZVByZWZpeCA/IFwiX1wiIDogXCJcIjtcblx0XHRyZXR1cm4gYCR7cHJlZml4fSR7c2FmZUtlYmFiVGl0bGV9YDtcblx0fVxuXG5cdGRldGVybWluZVR5cGUoZmlsZTogVEZpbGUpOiBDb250ZW50VHlwZUlkIHtcblx0XHRjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblxuXHRcdC8vIENoZWNrIGFsbCBjb250ZW50IHR5cGVzLCBzb3J0ZWQgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9yZSBzcGVjaWZpYyBmaXJzdClcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3Qgc29ydGVkVHlwZXMgPSBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkoY29udGVudFR5cGVzKTtcblxuXHRcdGZvciAoY29uc3QgY29udGVudFR5cGUgb2Ygc29ydGVkVHlwZXMpIHtcblx0XHRcdGlmICghY29udGVudFR5cGUuZW5hYmxlZCkgY29udGludWU7XG5cblx0XHRcdC8vIEhhbmRsZSBibGFuayBmb2xkZXIgKHJvb3QpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcblx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcblx0XHRcdFx0aWYgKCFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgZmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdHJldHVybiBjb250ZW50VHlwZS5pZDtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChtYXRjaGVzRm9sZGVyUGF0dGVybihmaWxlUGF0aCwgY29udGVudFR5cGUuZm9sZGVyKSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZ25vcmVTdWJmb2xkZXJzIGlmIGZvbGRlciBpcyBzcGVjaWZpZWRcblx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlLmlnbm9yZVN1YmZvbGRlcnMpIHtcblx0XHRcdFx0XHRjb25zdCBwYXRoU2VnbWVudHMgPSBmaWxlUGF0aC5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgcGF0aERlcHRoID0gcGF0aFNlZ21lbnRzLmxlbmd0aDtcblx0XHRcdFx0XHRjb25zdCBwYXR0ZXJuU2VnbWVudHMgPSBjb250ZW50VHlwZS5mb2xkZXIuc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdGNvbnN0IGV4cGVjdGVkRGVwdGggPSBwYXR0ZXJuU2VnbWVudHMubGVuZ3RoO1xuXG5cdFx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0XHRcdFx0Ly8gRm9yIGZvbGRlci1iYXNlZCBjcmVhdGlvbiwgZmlsZXMgYXJlIG9uZSBsZXZlbCBkZWVwZXIgKGUuZy4sIHRlc3QvbXktZmlsZS9pbmRleC5tZClcblx0XHRcdFx0XHRcdC8vIFNvIHdlIG5lZWQgdG8gYWxsb3cgb25lIGV4dHJhIGxldmVsIGJleW9uZCB0aGUgcGF0dGVybiBkZXB0aFxuXHRcdFx0XHRcdFx0Y29uc3QgZm9sZGVyRGVwdGggPSBwYXRoRGVwdGggLSAxOyAvLyBTdWJ0cmFjdCAxIGZvciB0aGUgaW5kZXgubWQgZmlsZVxuXHRcdFx0XHRcdFx0aWYgKGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoIHx8IGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoICsgMSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gY29udGVudFR5cGUuaWQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmaWxlLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgYXQgdGhlIHNhbWUgZGVwdGggYXMgdGhlIHBhdHRlcm5cblx0XHRcdFx0XHRcdGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIGNvbnRlbnRUeXBlLmlkO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gY29udGVudFR5cGUuaWQ7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBJZiBubyBjb250ZW50IHR5cGUgbWF0Y2hlcywgcmV0dXJuIFwibm90ZVwiIGFzIGZhbGxiYWNrXG5cdFx0cmV0dXJuIFwibm90ZVwiO1xuXHR9XG5cblx0Z2V0Q29udGVudFR5cGUodHlwZUlkOiBDb250ZW50VHlwZUlkKTogQ29udGVudFR5cGUgfCBudWxsIHtcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0cmV0dXJuIGNvbnRlbnRUeXBlcy5maW5kKGN0ID0+IGN0LmlkID09PSB0eXBlSWQpIHx8IG51bGw7XG5cdH1cblxuXHQvKipcblx0ICogSGVscGVyIHRvIGdldCBjb250ZW50IHR5cGUgZm9yIGEgZ2l2ZW4gZmlsZSBwYXRoXG5cdCAqL1xuXHRnZXRDb250ZW50VHlwZUJ5UGF0aChmaWxlUGF0aDogc3RyaW5nKTogQ29udGVudFR5cGUgfCBudWxsIHtcblx0XHQvLyBDcmVhdGUgYSBkdW1teSBURmlsZSBmb3IgZGV0ZXJtaW5lVHlwZVxuXHRcdGNvbnN0IGR1bW15RmlsZSA9IHsgcGF0aDogZmlsZVBhdGggfSBhcyBURmlsZTtcblx0XHRjb25zdCB0eXBlSWQgPSB0aGlzLmRldGVybWluZVR5cGUoZHVtbXlGaWxlKTtcblx0XHRpZiAodHlwZUlkID09PSBcIm5vdGVcIikgcmV0dXJuIG51bGw7XG5cdFx0cmV0dXJuIHRoaXMuZ2V0Q29udGVudFR5cGUodHlwZUlkKTtcblx0fVxuXG5cdGdldFRpdGxlS2V5KHR5cGU6IENvbnRlbnRUeXBlSWQpOiBzdHJpbmcge1xuXHRcdC8vIEZvciBnZW5lcmljIG5vdGVzLCBhbHdheXMgdXNlIFwidGl0bGVcIlxuXHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikgcmV0dXJuIFwidGl0bGVcIjtcblxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm4gXCJ0aXRsZVwiO1xuXG5cdFx0Y29uc3QgdGVtcGxhdGUgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcblx0XHRjb25zdCBsaW5lcyA9IHRlbXBsYXRlLnNwbGl0KFwiXFxuXCIpO1xuXHRcdGxldCBpblByb3BlcnRpZXMgPSBmYWxzZTtcblx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcblx0XHRcdGNvbnN0IHRyaW1tZWQgPSBsaW5lLnRyaW0oKTtcblx0XHRcdGlmICh0cmltbWVkID09PSBcIi0tLVwiKSB7XG5cdFx0XHRcdGluUHJvcGVydGllcyA9ICFpblByb3BlcnRpZXM7XG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGluUHJvcGVydGllcykge1xuXHRcdFx0XHRjb25zdCBtYXRjaCA9IHRyaW1tZWQubWF0Y2goL14oXFx3Kyk6XFxzKiguKykkLyk7XG5cdFx0XHRcdGlmIChtYXRjaCkge1xuXHRcdFx0XHRcdGNvbnN0IGtleSA9IG1hdGNoWzFdO1xuXHRcdFx0XHRcdGNvbnN0IHZhbHVlID0gbWF0Y2hbMl07XG5cdFx0XHRcdFx0aWYgKHZhbHVlLmluY2x1ZGVzKFwie3t0aXRsZX19XCIpKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4ga2V5O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gXCJ0aXRsZVwiO1xuXHR9XG5cblx0YXN5bmMgY3JlYXRlRmlsZShvcHRpb25zOiBGaWxlQ3JlYXRpb25PcHRpb25zKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHRjb25zdCB7IGZpbGUsIHRpdGxlLCB0eXBlIH0gPSBvcHRpb25zO1xuXG5cdFx0aWYgKCF0aXRsZSkge1xuXHRcdFx0bmV3IE5vdGljZShgVGl0bGUgaXMgcmVxdWlyZWQgdG8gY3JlYXRlIGEgJHt0eXBlfS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdC8vIEdldCBjb250ZW50IHR5cGUgc2V0dGluZ3Ncblx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZ2V0Q29udGVudFR5cGUodHlwZSk7XG5cdFx0aWYgKCFjb250ZW50VHlwZSAmJiB0eXBlICE9PSBcIm5vdGVcIikge1xuXHRcdFx0bmV3IE5vdGljZShgQ29udGVudCB0eXBlICR7dHlwZX0gbm90IGZvdW5kLmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Y29uc3Qga2ViYWJUaXRsZSA9IHRvS2ViYWJDYXNlKHRpdGxlKTtcblx0XHRjb25zdCBlbmFibGVVbmRlcnNjb3JlUHJlZml4ID0gY29udGVudFR5cGU/LmVuYWJsZVVuZGVyc2NvcmVQcmVmaXggfHwgZmFsc2U7XG5cdFx0Y29uc3QgcHJlZml4ID0gZW5hYmxlVW5kZXJzY29yZVByZWZpeCA/IFwiX1wiIDogXCJcIjtcblxuXHRcdGxldCB0YXJnZXRGb2xkZXIgPSBcIlwiO1xuXHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikge1xuXHRcdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIGtlZXAgdGhlbSBpbiB0aGVpciBjdXJyZW50IGxvY2F0aW9uXG5cdFx0XHR0YXJnZXRGb2xkZXIgPSBcIlwiO1xuXHRcdH0gZWxzZSBpZiAoY29udGVudFR5cGUpIHtcblx0XHRcdC8vIEdldCB0aGUgZGlyZWN0b3J5IHdoZXJlIHRoZSB1c2VyIGNyZWF0ZWQgdGhlIGZpbGVcblx0XHRcdGNvbnN0IG9yaWdpbmFsRGlyID0gZmlsZS5wYXJlbnQ/LnBhdGggfHwgXCJcIjtcblxuXHRcdFx0Ly8gUmVzcGVjdCB0aGUgdXNlcidzIGNob3NlbiBsb2NhdGlvbiAoc3ViZm9sZGVyKVxuXHRcdFx0Ly8gT25seSB1c2UgdGhlIGNvbmZpZ3VyZWQgZm9sZGVyIGlmIHRoZSB1c2VyIGNyZWF0ZWQgdGhlIGZpbGUgaW4gdGhlIHZhdWx0IHJvb3Rcblx0XHRcdGlmIChvcmlnaW5hbERpciA9PT0gXCJcIiB8fCBvcmlnaW5hbERpciA9PT0gXCIvXCIpIHtcblx0XHRcdFx0dGFyZ2V0Rm9sZGVyID0gY29udGVudFR5cGUuZm9sZGVyIHx8IFwiXCI7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0YXJnZXRGb2xkZXIgPSBvcmlnaW5hbERpcjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAodGFyZ2V0Rm9sZGVyKSB7XG5cdFx0XHRjb25zdCBmb2xkZXIgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgodGFyZ2V0Rm9sZGVyKTtcblx0XHRcdGlmICghKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpKSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcih0YXJnZXRGb2xkZXIpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGNvbnN0IGNyZWF0aW9uTW9kZSA9IGNvbnRlbnRUeXBlPy5jcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCI7XG5cdFx0aWYgKGNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0cmV0dXJuIHRoaXMuY3JlYXRlRm9sZGVyU3RydWN0dXJlKGZpbGUsIGtlYmFiVGl0bGUsIHByZWZpeCwgdGFyZ2V0Rm9sZGVyLCB0eXBlLCBjb250ZW50VHlwZSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHJldHVybiB0aGlzLmNyZWF0ZUZpbGVTdHJ1Y3R1cmUoZmlsZSwga2ViYWJUaXRsZSwgcHJlZml4LCB0YXJnZXRGb2xkZXIsIGNvbnRlbnRUeXBlKTtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZUZvbGRlclN0cnVjdHVyZShmaWxlOiBURmlsZSwga2ViYWJUaXRsZTogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgdGFyZ2V0Rm9sZGVyOiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQsIGNvbnRlbnRUeXBlOiBDb250ZW50VHlwZSB8IG51bGwpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdGNvbnN0IGZvbGRlck5hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfWA7XG5cdFx0bGV0IGZvbGRlclBhdGg6IHN0cmluZztcblxuXHRcdGlmICh0YXJnZXRGb2xkZXIpIHtcblx0XHRcdC8vIE1vdmUgdG8gdGFyZ2V0IGZvbGRlclxuXHRcdFx0Zm9sZGVyUGF0aCA9IGAke3RhcmdldEZvbGRlcn0vJHtmb2xkZXJOYW1lfWA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEtlZXAgaW4gY3VycmVudCBsb2NhdGlvblxuXHRcdFx0Y29uc3QgY3VycmVudERpciA9IGZpbGUucGFyZW50ID8gZmlsZS5wYXJlbnQucGF0aCA6IFwiXCI7XG5cdFx0XHRpZiAoY3VycmVudERpciAmJiBjdXJyZW50RGlyICE9PSBcIi9cIikge1xuXHRcdFx0XHRmb2xkZXJQYXRoID0gYCR7Y3VycmVudERpcn0vJHtmb2xkZXJOYW1lfWA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGaWxlIGlzIGluIHZhdWx0IHJvb3QsIGp1c3QgdXNlIGZvbGRlciBuYW1lXG5cdFx0XHRcdGZvbGRlclBhdGggPSBmb2xkZXJOYW1lO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBmb2xkZXIgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZm9sZGVyUGF0aCk7XG5cdFx0XHRpZiAoIShmb2xkZXIgaW5zdGFuY2VvZiBURm9sZGVyKSkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGVGb2xkZXIoZm9sZGVyUGF0aCk7XG5cdFx0XHR9XG5cdFx0fSBjYXRjaCB7XG5cdFx0XHQvLyBGb2xkZXIgbWlnaHQgYWxyZWFkeSBleGlzdCwgcHJvY2VlZFxuXHRcdH1cblxuXHRcdGNvbnN0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZT8uaW5kZXhGaWxlTmFtZSB8fCBcImluZGV4XCI7XG5cdFx0Y29uc3QgZXh0ZW5zaW9uID0gY29udGVudFR5cGU/LnVzZU1keEV4dGVuc2lvbiA/IFwiLm1keFwiIDogXCIubWRcIjtcblx0XHRjb25zdCBmaWxlTmFtZSA9IGAke2luZGV4RmlsZU5hbWV9JHtleHRlbnNpb259YDtcblx0XHRjb25zdCBuZXdQYXRoID0gYCR7Zm9sZGVyUGF0aH0vJHtmaWxlTmFtZX1gO1xuXG5cdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdGlmIChleGlzdGluZ0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xuXHRcdFx0bmV3IE5vdGljZShgRmlsZSBhbHJlYWR5IGV4aXN0cyBhdCAke25ld1BhdGh9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gVHJhY2sgdGhhdCB0aGlzIGZpbGUgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBwbHVnaW4gQkVGT1JFIHJlbmFtaW5nXG5cdFx0Ly8gVGhpcyBwcmV2ZW50cyB0aGUgY3JlYXRlIGV2ZW50IGZyb20gdHJpZ2dlcmluZyBhbm90aGVyIG1vZGFsXG5cdFx0aWYgKHRoaXMucGx1Z2luKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5wbHVnaW5DcmVhdGVkRmlsZXMuc2V0KG5ld1BhdGgsIERhdGUubm93KCkpO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRcdGlmICghKG5ld0ZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBmaWxlRXhwbG9yZXIgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFwiZmlsZS1leHBsb3JlclwiKVswXTtcblx0XHRcdFx0aWYgKGZpbGVFeHBsb3JlciAmJiBmaWxlRXhwbG9yZXIudmlldykge1xuXHRcdFx0XHRcdGNvbnN0IHZpZXcgPSBmaWxlRXhwbG9yZXIudmlldztcblx0XHRcdFx0XHRpZiAodmlldyAmJiB0eXBlb2YgdmlldyA9PT0gJ29iamVjdCcgJiYgJ3RyZWUnIGluIHZpZXcpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGZpbGVUcmVlID0gKHZpZXcgYXMgeyB0cmVlPzogeyByZXZlYWxGaWxlPzogKGZpbGU6IFRGaWxlKSA9PiB2b2lkIH0gfSkudHJlZTtcblx0XHRcdFx0XHRcdGlmIChmaWxlVHJlZSAmJiBuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgdHlwZW9mIGZpbGVUcmVlLnJldmVhbEZpbGUgPT09ICdmdW5jdGlvbicpIHtcblx0XHRcdFx0XHRcdFx0ZmlsZVRyZWUucmV2ZWFsRmlsZShuZXdGaWxlKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH0sIDIwMCk7XG5cblx0XHRcdGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG5cdFx0XHRhd2FpdCBsZWFmLm9wZW5GaWxlKG5ld0ZpbGUpO1xuXG5cdFx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYXQgdGhlIGVuZCBvZiBjb250ZW50IGFmdGVyIGVkaXRvciBpcyByZWFkeVxuXHRcdFx0Y29uc3QgcG9zaXRpb25DdXJzb3IgPSAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IHZpZXcgPSBsZWFmLnZpZXc7XG5cdFx0XHRcdGlmICh2aWV3ICYmICdlZGl0b3InIGluIHZpZXcpIHtcblx0XHRcdFx0XHRjb25zdCBlZGl0b3IgPSAodmlldyBhcyB7IGVkaXRvcj86IHsgc2V0Q3Vyc29yOiAocG9zOiB7IGxpbmU6IG51bWJlcjsgY2g6IG51bWJlciB9KSA9PiB2b2lkOyBnZXRWYWx1ZTogKCkgPT4gc3RyaW5nOyBmb2N1czogKCkgPT4gdm9pZCB9IH0pLmVkaXRvcjtcblx0XHRcdFx0XHRpZiAoZWRpdG9yKSB7XG5cdFx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG5cdFx0XHRcdFx0XHRpZiAoY29udGVudCkge1xuXHRcdFx0XHRcdFx0XHRjb25zdCBsaW5lcyA9IGNvbnRlbnQuc3BsaXQoJ1xcbicpO1xuXHRcdFx0XHRcdFx0XHRjb25zdCBsYXN0TGluZSA9IGxpbmVzLmxlbmd0aCAtIDE7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lTGVuZ3RoID0gbGluZXNbbGFzdExpbmVdPy5sZW5ndGggfHwgMDtcblx0XHRcdFx0XHRcdFx0ZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IGxhc3RMaW5lLCBjaDogbGFzdExpbmVMZW5ndGggfSk7XG5cdFx0XHRcdFx0XHRcdGVkaXRvci5mb2N1cygpO1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fTtcblxuXHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdGlmICghcG9zaXRpb25DdXJzb3IoKSkge1xuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0cG9zaXRpb25DdXJzb3IoKTtcblx0XHRcdFx0XHR9LCAyMDApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCAxMDApO1xuXG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIGNyZWF0ZSBmb2xkZXIgc3RydWN0dXJlOiAke2Vycm9yTWVzc2FnZX0uYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cdH1cblxuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZUZpbGVTdHJ1Y3R1cmUoZmlsZTogVEZpbGUsIGtlYmFiVGl0bGU6IHN0cmluZywgcHJlZml4OiBzdHJpbmcsIHRhcmdldEZvbGRlcjogc3RyaW5nLCBjb250ZW50VHlwZTogQ29udGVudFR5cGUgfCBudWxsKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHRjb25zdCBleHRlbnNpb24gPSBjb250ZW50VHlwZT8udXNlTWR4RXh0ZW5zaW9uID8gXCIubWR4XCIgOiBcIi5tZFwiO1xuXHRcdGNvbnN0IG5ld05hbWUgPSBgJHtwcmVmaXh9JHtrZWJhYlRpdGxlfSR7ZXh0ZW5zaW9ufWA7XG5cdFx0bGV0IG5ld1BhdGg6IHN0cmluZztcblxuXHRcdGlmICh0YXJnZXRGb2xkZXIpIHtcblx0XHRcdC8vIE1vdmUgdG8gdGFyZ2V0IGZvbGRlclxuXHRcdFx0bmV3UGF0aCA9IGAke3RhcmdldEZvbGRlcn0vJHtuZXdOYW1lfWA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEtlZXAgaW4gY3VycmVudCBsb2NhdGlvbiwganVzdCByZW5hbWUgdGhlIGZpbGVcblx0XHRcdGNvbnN0IGN1cnJlbnREaXIgPSBmaWxlLnBhcmVudCA/IGZpbGUucGFyZW50LnBhdGggOiBcIlwiO1xuXHRcdFx0aWYgKGN1cnJlbnREaXIgJiYgY3VycmVudERpciAhPT0gXCIvXCIpIHtcblx0XHRcdFx0bmV3UGF0aCA9IGAke2N1cnJlbnREaXJ9LyR7bmV3TmFtZX1gO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gRmlsZSBpcyBpbiB2YXVsdCByb290LCBqdXN0IHVzZSBuZXcgbmFtZVxuXHRcdFx0XHRuZXdQYXRoID0gbmV3TmFtZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0aWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGV4aXN0aW5nRmlsZSAhPT0gZmlsZSkge1xuXHRcdFx0bmV3IE5vdGljZShgRmlsZSB3aXRoIG5hbWUgXCIke25ld05hbWV9XCIgYWxyZWFkeSBleGlzdHMuYCk7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBCRUZPUkUgcmVuYW1pbmdcblx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRpZiAodGhpcy5wbHVnaW4pIHtcblx0XHRcdHRoaXMucGx1Z2luLnBsdWdpbkNyZWF0ZWRGaWxlcy5zZXQobmV3UGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0fVxuXG5cdFx0dHJ5IHtcblx0XHRcdC8vIFVzZSBmaWxlTWFuYWdlci5yZW5hbWVGaWxlKCkgd2hpY2ggcmVzcGVjdHMgdXNlciBzZXR0aW5ncyBhbmQgaGFuZGxlcyBhbGwgbGluayBmb3JtYXRzXG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xuXG5cdFx0XHRjb25zdCBuZXdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGxvY2F0ZSByZW5hbWVkIGZpbGUuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcblx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUobmV3RmlsZSk7XG5cblx0XHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCB0aGUgZW5kIG9mIGNvbnRlbnQgYWZ0ZXIgZWRpdG9yIGlzIHJlYWR5XG5cdFx0XHRjb25zdCBwb3NpdGlvbkN1cnNvciA9ICgpID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldztcblx0XHRcdFx0aWYgKHZpZXcgJiYgJ2VkaXRvcicgaW4gdmlldykge1xuXHRcdFx0XHRcdGNvbnN0IGVkaXRvciA9ICh2aWV3IGFzIHsgZWRpdG9yPzogeyBzZXRDdXJzb3I6IChwb3M6IHsgbGluZTogbnVtYmVyOyBjaDogbnVtYmVyIH0pID0+IHZvaWQ7IGdldFZhbHVlOiAoKSA9PiBzdHJpbmc7IGZvY3VzOiAoKSA9PiB2b2lkIH0gfSkuZWRpdG9yO1xuXHRcdFx0XHRcdGlmIChlZGl0b3IpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRcdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdFx0XHRcdGNvbnN0IGxhc3RMaW5lID0gbGluZXMubGVuZ3RoIC0gMTtcblx0XHRcdFx0XHRcdFx0Y29uc3QgbGFzdExpbmVMZW5ndGggPSBsaW5lc1tsYXN0TGluZV0/Lmxlbmd0aCB8fCAwO1xuXHRcdFx0XHRcdFx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9KTtcblx0XHRcdFx0XHRcdFx0ZWRpdG9yLmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9O1xuXG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKCFwb3NpdGlvbkN1cnNvcigpKSB7XG5cdFx0XHRcdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRcdFx0XHRwb3NpdGlvbkN1cnNvcigpO1xuXHRcdFx0XHRcdH0sIDIwMCk7XG5cdFx0XHRcdH1cblx0XHRcdH0sIDEwMCk7XG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6IFN0cmluZyhlcnJvcik7XG5cdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmVuYW1lIGZpbGU6ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fVxuXG5cblx0YXN5bmMgcmVuYW1lRmlsZShvcHRpb25zOiBSZW5hbWVPcHRpb25zKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHRjb25zdCB7IGZpbGUsIHRpdGxlLCB0eXBlIH0gPSBvcHRpb25zO1xuXG5cdFx0aWYgKCF0aXRsZSkge1xuXHRcdFx0bmV3IE5vdGljZShgVGl0bGUgaXMgcmVxdWlyZWQgdG8gcmVuYW1lIHRoZSBjb250ZW50LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmdldENvbnRlbnRUeXBlKHR5cGUpO1xuXHRcdGlmICghY29udGVudFR5cGUgJiYgdHlwZSAhPT0gXCJub3RlXCIpIHtcblx0XHRcdG5ldyBOb3RpY2UoYENvbnRlbnQgdHlwZSAke3R5cGV9IG5vdCBmb3VuZC5gKTtcblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblxuXHRcdGNvbnN0IGtlYmFiVGl0bGUgPSB0b0tlYmFiQ2FzZSh0aXRsZSk7XG5cdFx0Y29uc3QgcHJlZml4ID0gXCJcIjtcblxuXHRcdGNvbnN0IGNyZWF0aW9uTW9kZSA9IGNvbnRlbnRUeXBlPy5jcmVhdGlvbk1vZGUgfHwgXCJmaWxlXCI7XG5cdFx0aWYgKGNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0cmV0dXJuIHRoaXMucmVuYW1lRm9sZGVyU3RydWN0dXJlKGZpbGUsIGtlYmFiVGl0bGUsIHByZWZpeCwgdHlwZSwgY29udGVudFR5cGUpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gdGhpcy5yZW5hbWVGaWxlU3RydWN0dXJlKGZpbGUsIGtlYmFiVGl0bGUsIHByZWZpeCwgY29udGVudFR5cGUpO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgcmVuYW1lRm9sZGVyU3RydWN0dXJlKGZpbGU6IFRGaWxlLCBrZWJhYlRpdGxlOiBzdHJpbmcsIHByZWZpeDogc3RyaW5nLCB0eXBlOiBDb250ZW50VHlwZUlkLCBjb250ZW50VHlwZTogQ29udGVudFR5cGUgfCBudWxsKTogUHJvbWlzZTxURmlsZSB8IG51bGw+IHtcblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IHRyZWF0IGFzIGluZGV4IGlmIGZpbGVuYW1lIG1hdGNoZXMgdGhlIGluZGV4IGZpbGUgbmFtZVxuXHRcdC8vIERlZmF1bHQgdG8gXCJpbmRleFwiIHdoZW4gaW5kZXhGaWxlTmFtZSBpcyBibGFua1xuXHRcdGNvbnN0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZT8uaW5kZXhGaWxlTmFtZSB8fCBcImluZGV4XCI7XG5cdFx0Y29uc3QgaXNJbmRleCA9IGZpbGUuYmFzZW5hbWUgPT09IGluZGV4RmlsZU5hbWU7XG5cdFx0aWYgKGlzSW5kZXgpIHtcblx0XHRcdGlmICghZmlsZS5wYXJlbnQpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IGZpbGUgaGFzIG5vIHBhcmVudCBmb2xkZXIuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHRcdHByZWZpeCA9IGZpbGUucGFyZW50Lm5hbWUuc3RhcnRzV2l0aChcIl9cIikgPyBcIl9cIiA6IFwiXCI7XG5cdFx0XHRjb25zdCBuZXdGb2xkZXJOYW1lID0gYCR7cHJlZml4fSR7a2ViYWJUaXRsZX1gO1xuXHRcdFx0Y29uc3QgcGFyZW50Rm9sZGVyID0gZmlsZS5wYXJlbnQucGFyZW50O1xuXHRcdFx0aWYgKCFwYXJlbnRGb2xkZXIpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHBhcmVudCBmb2xkZXIgaGFzIG5vIHBhcmVudC5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0Ly8gRml4IHBhdGggY29uc3RydWN0aW9uIHRvIGF2b2lkIGRvdWJsZSBzbGFzaGVzXG5cdFx0XHRsZXQgbmV3Rm9sZGVyUGF0aDogc3RyaW5nO1xuXHRcdFx0aWYgKHBhcmVudEZvbGRlci5wYXRoID09PSBcIlwiIHx8IHBhcmVudEZvbGRlci5wYXRoID09PSBcIi9cIikge1xuXHRcdFx0XHQvLyBQYXJlbnQgaXMgdmF1bHQgcm9vdFxuXHRcdFx0XHRuZXdGb2xkZXJQYXRoID0gbmV3Rm9sZGVyTmFtZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyBpbiBhIHN1YmZvbGRlclxuXHRcdFx0XHRuZXdGb2xkZXJQYXRoID0gYCR7cGFyZW50Rm9sZGVyLnBhdGh9LyR7bmV3Rm9sZGVyTmFtZX1gO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBleGlzdGluZ0ZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGb2xkZXJQYXRoKTtcblx0XHRcdGlmIChleGlzdGluZ0ZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRm9sZGVyIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3Rm9sZGVyUGF0aH0uYCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHR0cnkge1xuXHRcdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUucGFyZW50LCBuZXdGb2xkZXJQYXRoKTtcblx0XHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcblx0XHRcdFx0bmV3IE5vdGljZShgRmFpbGVkIHRvIHJlbmFtZSBmb2xkZXI6ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IG5ld0ZpbGVQYXRoID0gYCR7bmV3Rm9sZGVyUGF0aH0vJHtmaWxlLm5hbWV9YDtcblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3RmlsZVBhdGgpO1xuXHRcdFx0aWYgKCEobmV3RmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGxvY2F0ZSByZW5hbWVkIGZpbGUuXCIpO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0aWYgKCFmaWxlLnBhcmVudCkge1xuXHRcdFx0XHRuZXcgTm90aWNlKFwiQ2Fubm90IHJlbmFtZTogZmlsZSBoYXMgbm8gcGFyZW50IGZvbGRlci5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0cHJlZml4ID0gZmlsZS5iYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHRcdC8vIFByZXNlcnZlIHRoZSBvcmlnaW5hbCBmaWxlIGV4dGVuc2lvblxuXHRcdFx0Y29uc3QgZXh0ZW5zaW9uID0gZmlsZS5leHRlbnNpb247XG5cdFx0XHRjb25zdCBuZXdOYW1lID0gYCR7cHJlZml4fSR7a2ViYWJUaXRsZX0uJHtleHRlbnNpb259YDtcblx0XHRcdGNvbnN0IG5ld1BhdGggPSBgJHtmaWxlLnBhcmVudC5wYXRofS8ke25ld05hbWV9YDtcblxuXHRcdFx0Y29uc3QgZXhpc3RpbmdGaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKG5ld1BhdGgpO1xuXHRcdFx0aWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGV4aXN0aW5nRmlsZSAhPT0gZmlsZSkge1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGaWxlIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3UGF0aH0uYCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBVc2UgZmlsZU1hbmFnZXIucmVuYW1lRmlsZSgpIHdoaWNoIGF1dG9tYXRpY2FsbHkgdXBkYXRlcyBsaW5rc1xuXHRcdFx0YXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZShmaWxlLCBuZXdQYXRoKTtcblx0XHRcdGNvbnN0IG5ld0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cblx0XHRcdHJldHVybiBuZXdGaWxlO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgcmVuYW1lRmlsZVN0cnVjdHVyZShmaWxlOiBURmlsZSwga2ViYWJUaXRsZTogc3RyaW5nLCBwcmVmaXg6IHN0cmluZywgY29udGVudFR5cGU6IENvbnRlbnRUeXBlIHwgbnVsbCk6IFByb21pc2U8VEZpbGUgfCBudWxsPiB7XG5cdFx0aWYgKCFmaWxlLnBhcmVudCkge1xuXHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IGZpbGUgaGFzIG5vIHBhcmVudCBmb2xkZXIuXCIpO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhbiBpbmRleCBmaWxlIC0gaWYgc28sIHJlbmFtZSB0aGUgcGFyZW50IGZvbGRlciBpbnN0ZWFkXG5cdFx0Ly8gU21hcnQgZGV0ZWN0aW9uOiBvbmx5IHRyZWF0IGFzIGluZGV4IGlmIGluZGV4RmlsZU5hbWUgaXMgc3BlY2lmaWVkIGFuZCBtYXRjaGVzXG5cdFx0Y29uc3QgaW5kZXhGaWxlTmFtZSA9IGNvbnRlbnRUeXBlPy5pbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0Y29uc3QgaXNJbmRleCA9IGluZGV4RmlsZU5hbWUgJiZcblx0XHRcdGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmXG5cdFx0XHRmaWxlLmJhc2VuYW1lID09PSBpbmRleEZpbGVOYW1lO1xuXG5cdFx0aWYgKGlzSW5kZXgpIHtcblx0XHRcdHByZWZpeCA9IGZpbGUucGFyZW50Lm5hbWUuc3RhcnRzV2l0aChcIl9cIikgPyBcIl9cIiA6IFwiXCI7XG5cdFx0XHRjb25zdCBuZXdGb2xkZXJOYW1lID0gYCR7cHJlZml4fSR7a2ViYWJUaXRsZX1gO1xuXHRcdFx0Y29uc3QgcGFyZW50Rm9sZGVyID0gZmlsZS5wYXJlbnQucGFyZW50O1xuXHRcdFx0aWYgKCFwYXJlbnRGb2xkZXIpIHtcblx0XHRcdFx0bmV3IE5vdGljZShcIkNhbm5vdCByZW5hbWU6IHBhcmVudCBmb2xkZXIgaGFzIG5vIHBhcmVudC5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdFx0Ly8gRml4IHBhdGggY29uc3RydWN0aW9uIHRvIGF2b2lkIGRvdWJsZSBzbGFzaGVzXG5cdFx0XHRsZXQgbmV3Rm9sZGVyUGF0aDogc3RyaW5nO1xuXHRcdFx0aWYgKHBhcmVudEZvbGRlci5wYXRoID09PSBcIlwiIHx8IHBhcmVudEZvbGRlci5wYXRoID09PSBcIi9cIikge1xuXHRcdFx0XHQvLyBQYXJlbnQgaXMgdmF1bHQgcm9vdFxuXHRcdFx0XHRuZXdGb2xkZXJQYXRoID0gbmV3Rm9sZGVyTmFtZTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIFBhcmVudCBpcyBpbiBhIHN1YmZvbGRlclxuXHRcdFx0XHRuZXdGb2xkZXJQYXRoID0gYCR7cGFyZW50Rm9sZGVyLnBhdGh9LyR7bmV3Rm9sZGVyTmFtZX1gO1xuXHRcdFx0fVxuXG5cdFx0XHRjb25zdCBleGlzdGluZ0ZvbGRlciA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGb2xkZXJQYXRoKTtcblx0XHRcdGlmIChleGlzdGluZ0ZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcblx0XHRcdFx0bmV3IE5vdGljZShgRm9sZGVyIGFscmVhZHkgZXhpc3RzIGF0ICR7bmV3Rm9sZGVyUGF0aH0uYCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBDYWxjdWxhdGUgdGhlIG5ldyBmaWxlIHBhdGggYmVmb3JlIHJlbmFtaW5nXG5cdFx0XHRjb25zdCBuZXdGaWxlUGF0aCA9IGAke25ld0ZvbGRlclBhdGh9LyR7ZmlsZS5uYW1lfWA7XG5cblx0XHRcdC8vIFRyYWNrIHRoYXQgdGhpcyBmaWxlIHdpbGwgYmUgY3JlYXRlZCBieSB0aGUgcGx1Z2luIEJFRk9SRSByZW5hbWluZ1xuXHRcdFx0Ly8gVGhpcyBwcmV2ZW50cyB0aGUgY3JlYXRlIGV2ZW50IGZyb20gdHJpZ2dlcmluZyBhbm90aGVyIG1vZGFsXG5cdFx0XHRpZiAodGhpcy5wbHVnaW4pIHtcblx0XHRcdFx0dGhpcy5wbHVnaW4ucGx1Z2luQ3JlYXRlZEZpbGVzLnNldChuZXdGaWxlUGF0aCwgRGF0ZS5ub3coKSk7XG5cdFx0XHR9XG5cblx0XHRcdHRyeSB7XG5cdFx0XHRcdGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZS5wYXJlbnQsIG5ld0ZvbGRlclBhdGgpO1xuXHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0Y29uc29sZS5lcnJvcignRmlsZU9wZXJhdGlvbnM6IEZvbGRlciByZW5hbWUgZmFpbGVkOicsIGVycm9yKTtcblx0XHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0XHRuZXcgTm90aWNlKGBGYWlsZWQgdG8gcmVuYW1lIGZvbGRlcjogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblxuXHRcdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdGaWxlUGF0aCk7XG5cdFx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJGYWlsZWQgdG8gbG9jYXRlIHJlbmFtZWQgZmlsZS5cIik7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0fVxuXG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9XG5cblx0XHQvLyBGb3Igbm9uLWluZGV4IGZpbGVzLCByZW5hbWUgdGhlIGZpbGUgaXRzZWxmXG5cdFx0cHJlZml4ID0gZmlsZS5iYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSA/IFwiX1wiIDogXCJcIjtcblx0XHQvLyBQcmVzZXJ2ZSB0aGUgb3JpZ2luYWwgZmlsZSBleHRlbnNpb25cblx0XHRjb25zdCBleHRlbnNpb24gPSBmaWxlLmV4dGVuc2lvbjtcblx0XHRjb25zdCBuZXdOYW1lID0gYCR7cHJlZml4fSR7a2ViYWJUaXRsZX0uJHtleHRlbnNpb259YDtcblxuXHRcdC8vIEZpeCBwYXRoIGNvbnN0cnVjdGlvbiB0byBhdm9pZCBkb3VibGUgc2xhc2hlc1xuXHRcdGxldCBuZXdQYXRoOiBzdHJpbmc7XG5cdFx0aWYgKGZpbGUucGFyZW50LnBhdGggPT09IFwiXCIgfHwgZmlsZS5wYXJlbnQucGF0aCA9PT0gXCIvXCIpIHtcblx0XHRcdC8vIEZpbGUgaXMgaW4gdmF1bHQgcm9vdFxuXHRcdFx0bmV3UGF0aCA9IG5ld05hbWU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEZpbGUgaXMgaW4gYSBzdWJmb2xkZXJcblx0XHRcdG5ld1BhdGggPSBgJHtmaWxlLnBhcmVudC5wYXRofS8ke25ld05hbWV9YDtcblx0XHR9XG5cblx0XHRjb25zdCBleGlzdGluZ0ZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobmV3UGF0aCk7XG5cdFx0aWYgKGV4aXN0aW5nRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGV4aXN0aW5nRmlsZSAhPT0gZmlsZSkge1xuXHRcdFx0bmV3IE5vdGljZShgRmlsZSBhbHJlYWR5IGV4aXN0cyBhdCAke25ld1BhdGh9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Ly8gVHJhY2sgdGhhdCB0aGlzIGZpbGUgd2lsbCBiZSBjcmVhdGVkIGJ5IHRoZSBwbHVnaW4gQkVGT1JFIHJlbmFtaW5nXG5cdFx0Ly8gVGhpcyBwcmV2ZW50cyB0aGUgY3JlYXRlIGV2ZW50IGZyb20gdHJpZ2dlcmluZyBhbm90aGVyIG1vZGFsXG5cdFx0aWYgKHRoaXMucGx1Z2luKSB7XG5cdFx0XHR0aGlzLnBsdWdpbi5wbHVnaW5DcmVhdGVkRmlsZXMuc2V0KG5ld1BhdGgsIERhdGUubm93KCkpO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKCdGaWxlT3BlcmF0aW9uczogRmlsZSByZW5hbWUgZmFpbGVkOicsIGVycm9yKTtcblx0XHRcdGNvbnN0IGVycm9yTWVzc2FnZSA9IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKTtcblx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byByZW5hbWUgZmlsZTogJHtlcnJvck1lc3NhZ2V9LmApO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0Y29uc3QgbmV3RmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChuZXdQYXRoKTtcblx0XHRpZiAoIShuZXdGaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG5cdFx0XHRuZXcgTm90aWNlKFwiRmFpbGVkIHRvIGxvY2F0ZSByZW5hbWVkIGZpbGUuXCIpO1xuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG5ld0ZpbGU7XG5cdH1cbn1cbiIsICIvKipcclxuICogVXRpbGl0eSBmdW5jdGlvbnMgZm9yIG1hdGNoaW5nIGZpbGUgcGF0aHMgYWdhaW5zdCBmb2xkZXIgcGF0dGVybnMgd2l0aCB3aWxkY2FyZCBzdXBwb3J0LlxyXG4gKiBcclxuICogV2lsZGNhcmQgcGF0dGVybnM6XHJcbiAqIC0gYGRvY3NgIG1hdGNoZXMgYGRvY3MvYCBhbmQgYW55dGhpbmcgdW5kZXIgaXRcclxuICogLSBgZG9jcy97YXN0ZXJpc2t9YCBtYXRjaGVzIGBkb2NzL2FueXRoaW5nL2AgYW5kIGFueXRoaW5nIHVuZGVyIGl0IChvbmUgbGV2ZWwgZGVlcClcclxuICogLSBgZG9jcy97YXN0ZXJpc2t9L3thc3Rlcmlza31gIG1hdGNoZXMgYGRvY3MvYW55dGhpbmcvYW55dGhpbmcvYCBhbmQgYW55dGhpbmcgdW5kZXIgaXQgKHR3byBsZXZlbHMgZGVlcClcclxuICogLSBldGMuXHJcbiAqIFxyXG4gKiBOb3RlOiB7YXN0ZXJpc2t9IHJlcHJlc2VudHMgdGhlIHdpbGRjYXJkIGNoYXJhY3RlciAqXHJcbiAqL1xyXG5cclxuLyoqXHJcbiAqIENoZWNrcyBpZiBhIGZpbGUgcGF0aCBtYXRjaGVzIGEgZm9sZGVyIHBhdHRlcm4gKHN1cHBvcnRzIHdpbGRjYXJkcylcclxuICogQHBhcmFtIGZpbGVQYXRoIFRoZSBmaWxlIHBhdGggdG8gY2hlY2sgKGUuZy4sIFwiZG9jcy9leGFtcGxlLWEvZ2V0dGluZy1zdGFydGVkLm1kXCIpXHJcbiAqIEBwYXJhbSBmb2xkZXJQYXR0ZXJuIFRoZSBmb2xkZXIgcGF0dGVybiAtIHVzZSBhc3RlcmlzayBmb3Igd2lsZGNhcmRzIChlLmcuLCBcImRvY3NcIiwgXCJkb2NzL2FzdGVyaXNrXCIsIFwiZG9jcy9hc3Rlcmlzay9hc3Rlcmlza1wiKVxyXG4gKiBAcmV0dXJucyB0cnVlIGlmIHRoZSBmaWxlIHBhdGggbWF0Y2hlcyB0aGUgcGF0dGVyblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoOiBzdHJpbmcsIGZvbGRlclBhdHRlcm46IHN0cmluZyk6IGJvb2xlYW4ge1xyXG5cdC8vIE5vcm1hbGl6ZSBmb3IgY2FzZS1pbnNlbnNpdGl2ZSBtYXRjaGluZ1xyXG5cdGNvbnN0IG5vcm1hbGl6ZWRGaWxlUGF0aCA9IGZpbGVQYXRoLnRvTG93ZXJDYXNlKCk7XHJcblx0Y29uc3Qgbm9ybWFsaXplZFBhdHRlcm4gPSBmb2xkZXJQYXR0ZXJuLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXlxcL3xcXC8kL2csIFwiXCIpO1xyXG5cclxuXHQvLyBIYW5kbGUgZW1wdHkgZm9sZGVyIHBhdHRlcm4gKHJvb3QgZm9sZGVyKSAtIG1hdGNoZXMgZmlsZXMgaW4gdmF1bHQgcm9vdCBvbmx5XHJcblx0aWYgKCFub3JtYWxpemVkUGF0dGVybiB8fCBub3JtYWxpemVkUGF0dGVybi50cmltKCkgPT09IFwiXCIpIHtcclxuXHRcdHJldHVybiAhbm9ybWFsaXplZEZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCAobm9ybWFsaXplZEZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDEpO1xyXG5cdH1cclxuXHJcblx0Ly8gSWYgcGF0dGVybiBkb2Vzbid0IGNvbnRhaW4gd2lsZGNhcmRzLCB1c2Ugc2ltcGxlIHByZWZpeCBtYXRjaGluZ1xyXG5cdGlmICghbm9ybWFsaXplZFBhdHRlcm4uaW5jbHVkZXMoXCIqXCIpKSB7XHJcblx0XHRyZXR1cm4gbm9ybWFsaXplZEZpbGVQYXRoID09PSBub3JtYWxpemVkUGF0dGVybiB8fCBub3JtYWxpemVkRmlsZVBhdGguc3RhcnRzV2l0aChub3JtYWxpemVkUGF0dGVybiArIFwiL1wiKTtcclxuXHR9XHJcblxyXG5cdC8vIENvbnZlcnQgd2lsZGNhcmQgcGF0dGVybiB0byByZWdleFxyXG5cdC8vIEVzY2FwZSBzcGVjaWFsIHJlZ2V4IGNoYXJhY3RlcnMgZXhjZXB0ICpcclxuXHRjb25zdCBlc2NhcGVkUGF0dGVybiA9IG5vcm1hbGl6ZWRQYXR0ZXJuXHJcblx0XHQucmVwbGFjZSgvWy4rP14ke30oKXxbXFxdXFxcXF0vZywgXCJcXFxcJCZcIilcclxuXHRcdC5yZXBsYWNlKC9cXCovZywgXCJbXi9dK1wiKTsgLy8gV2lsZGNhcmQgbWF0Y2hlcyBhbnkgcGF0aCBzZWdtZW50IChub24tc2xhc2ggY2hhcmFjdGVycylcclxuXHJcblx0Ly8gQ3JlYXRlIHJlZ2V4IHRoYXQgbWF0Y2hlcyB0aGUgcGF0dGVybiBhbmQgYW55dGhpbmcgYWZ0ZXIgaXRcclxuXHRjb25zdCByZWdleFBhdHRlcm4gPSBgXiR7ZXNjYXBlZFBhdHRlcm59KD86L3wkKWA7XHJcblx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKHJlZ2V4UGF0dGVybik7XHJcblx0cmV0dXJuIHJlZ2V4LnRlc3Qobm9ybWFsaXplZEZpbGVQYXRoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEdldHMgdGhlIGRlcHRoIG9mIGEgZm9sZGVyIHBhdHRlcm4gKG51bWJlciBvZiBzZWdtZW50cylcclxuICogVXNlZCBmb3IgcHJpb3JpdGl6aW5nIG1vcmUgc3BlY2lmaWMgcGF0dGVybnNcclxuICogQmxhbmsvcm9vdCBmb2xkZXIgaGFzIGRlcHRoIDAgKGxlYXN0IHNwZWNpZmljKVxyXG4gKiBAcGFyYW0gZm9sZGVyUGF0dGVybiBUaGUgZm9sZGVyIHBhdHRlcm5cclxuICogQHJldHVybnMgVGhlIG51bWJlciBvZiBwYXRoIHNlZ21lbnRzIGluIHRoZSBwYXR0ZXJuICgwIGZvciByb290L2JsYW5rKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGdldFBhdHRlcm5EZXB0aChmb2xkZXJQYXR0ZXJuOiBzdHJpbmcpOiBudW1iZXIge1xyXG5cdGlmICghZm9sZGVyUGF0dGVybiB8fCBmb2xkZXJQYXR0ZXJuLnRyaW0oKSA9PT0gXCJcIikgcmV0dXJuIDA7XHJcblx0cmV0dXJuIGZvbGRlclBhdHRlcm4uc3BsaXQoXCIvXCIpLmxlbmd0aDtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNvcnRzIGNvbnRlbnQgdHlwZXMgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9yZSBzcGVjaWZpYyBwYXR0ZXJucyBmaXJzdClcclxuICogVGhpcyBlbnN1cmVzIHRoYXQgbW9yZSBzcGVjaWZpYyBwYXR0ZXJucyBhcmUgY2hlY2tlZCBiZWZvcmUgbGVzcyBzcGVjaWZpYyBvbmVzXHJcbiAqIEJsYW5rL3Jvb3QgZm9sZGVyIHBhdHRlcm5zIChkZXB0aCAwKSBhcmUgc29ydGVkIGxhc3QgKGxlYXN0IHNwZWNpZmljKVxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eTxUIGV4dGVuZHMgeyBmb2xkZXI6IHN0cmluZyB9Pih0eXBlczogVFtdKTogVFtdIHtcclxuXHRyZXR1cm4gWy4uLnR5cGVzXS5zb3J0KChhLCBiKSA9PiB7XHJcblx0XHRjb25zdCBkZXB0aEEgPSBnZXRQYXR0ZXJuRGVwdGgoYS5mb2xkZXIpO1xyXG5cdFx0Y29uc3QgZGVwdGhCID0gZ2V0UGF0dGVybkRlcHRoKGIuZm9sZGVyKTtcclxuXHRcdC8vIE1vcmUgc3BlY2lmaWMgKGRlZXBlcikgcGF0dGVybnMgZmlyc3RcclxuXHRcdC8vIEJsYW5rIHBhdHRlcm5zIChkZXB0aCAwKSB3aWxsIGJlIHNvcnRlZCBsYXN0XHJcblx0XHRyZXR1cm4gZGVwdGhCIC0gZGVwdGhBO1xyXG5cdH0pO1xyXG59XHJcblxyXG4iLCAiLyoqXHJcbiAqIENvbnZlcnRzIGEgc3RyaW5nIHRvIGtlYmFiLWNhc2UuXHJcbiAqIEBwYXJhbSBzdHIgVGhlIHN0cmluZyB0byBjb252ZXJ0XHJcbiAqIEByZXR1cm5zIEtlYmFiLWNhc2Ugc3RyaW5nXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gdG9LZWJhYkNhc2Uoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHN0clxyXG4gICAgICAgIC5yZXBsYWNlKC8oW2EtejAtOV0pKFtBLVpdKS9nLCAnJDEtJDInKVxyXG4gICAgICAgIC5yZXBsYWNlKC8oW0EtWl0pKFtBLVpdW2Etel0pL2csICckMS0kMiQzJylcclxuICAgICAgICAudG9Mb3dlckNhc2UoKVxyXG4gICAgICAgIC5yZXBsYWNlKC9bXmEtejAtOVxccy1dL2csIFwiXCIpXHJcbiAgICAgICAgLnRyaW0oKVxyXG4gICAgICAgIC5yZXBsYWNlKC9cXHMrL2csIFwiLVwiKVxyXG4gICAgICAgIC5yZXBsYWNlKC8tKy9nLCBcIi1cIilcclxuICAgICAgICAucmVwbGFjZSgvXi18LSQvZywgXCJcIik7XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgVEZpbGUsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MsIFBhcnNlZEZyb250bWF0dGVyLCBUZW1wbGF0ZVZhbHVlcywgS05PV05fQVJSQVlfS0VZUywgQ29udGVudFR5cGVJZCB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFRlbXBsYXRlUGFyc2VyIHtcclxuXHRjb25zdHJ1Y3Rvcihwcml2YXRlIGFwcDogQXBwLCBwcml2YXRlIHNldHRpbmdzOiBBc3Ryb0NvbXBvc2VyU2V0dGluZ3MpIHt9XHJcblxyXG5cdC8qKlxyXG5cdCAqIENvbnZlcnQgYSBzdHJpbmcgdG8ga2ViYWItY2FzZSBmb3Igc2x1ZyBnZW5lcmF0aW9uXHJcblx0ICovXHJcblx0cHJpdmF0ZSB0b0tlYmFiQ2FzZShzdHI6IHN0cmluZyk6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gc3RyXHJcblx0XHRcdC50b0xvd2VyQ2FzZSgpXHJcblx0XHRcdC5yZXBsYWNlKC9bXmEtejAtOVxccy1dL2csIFwiXCIpXHJcblx0XHRcdC50cmltKClcclxuXHRcdFx0LnJlcGxhY2UoL1xccysvZywgXCItXCIpXHJcblx0XHRcdC5yZXBsYWNlKC8tKy9nLCBcIi1cIilcclxuXHRcdFx0LnJlcGxhY2UoL14tfC0kL2csIFwiXCIpO1xyXG5cdH1cclxuXHJcblx0cGFyc2VGcm9udG1hdHRlcihjb250ZW50OiBzdHJpbmcpOiBQYXJzZWRGcm9udG1hdHRlciB7XHJcblx0XHRsZXQgcHJvcGVydGllc0VuZCA9IDA7XHJcblx0XHRsZXQgcHJvcGVydGllc1RleHQgPSBcIlwiO1xyXG5cdFx0Y29uc3QgZXhpc3RpbmdQcm9wZXJ0aWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmdbXT4gPSB7fTtcclxuXHJcblx0XHQvLyBQYXJzZSBleGlzdGluZyBwcm9wZXJ0aWVzIHdpdGggZmFsbGJhY2sgZm9yIG1pc3Npbmcgc2Vjb25kIC0tLVxyXG5cdFx0aWYgKGNvbnRlbnQuc3RhcnRzV2l0aChcIi0tLVwiKSkge1xyXG5cdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5pbmRleE9mKFwiXFxuLS0tXCIsIDMpO1xyXG5cdFx0XHRpZiAocHJvcGVydGllc0VuZCA9PT0gLTEpIHtcclxuXHRcdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5sZW5ndGg7IC8vIFRyZWF0IGVudGlyZSBjb250ZW50IGFzIHByb3BlcnRpZXMgaWYgbm8gc2Vjb25kIC0tLVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdHByb3BlcnRpZXNFbmQgKz0gNDsgLy8gTW92ZSBwYXN0IHRoZSBzZWNvbmQgLS0tXHJcblx0XHRcdH1cclxuXHRcdFx0cHJvcGVydGllc1RleHQgPSBjb250ZW50LnNsaWNlKDQsIHByb3BlcnRpZXNFbmQgLSA0KS50cmltKCk7XHJcblx0XHRcdFxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGxldCBjdXJyZW50S2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuXHRcdFx0XHRjb25zdCBhcnJheUtleXMgPSBuZXcgU2V0PHN0cmluZz4oKTsgLy8gVHJhY2sgd2hpY2gga2V5cyBhcmUgYXJyYXlzXHJcblx0XHRcdFx0XHJcblx0XHRcdFx0cHJvcGVydGllc1RleHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSkgPT4ge1xyXG5cdFx0XHRcdFx0Y29uc3QgdHJpbW1lZExpbmUgPSBsaW5lLnRyaW0oKTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly8gTWF0Y2ggcHJvcGVydHkgbGluZXMgLSBtb3JlIGZsZXhpYmxlIHJlZ2V4IHRvIGhhbmRsZSB2YXJpb3VzIHByb3BlcnR5IG5hbWVzXHJcblx0XHRcdFx0XHRjb25zdCBtYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKFthLXpBLVpfXVthLXpBLVowLTlfLV0qKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRcdGlmIChtYXRjaCkge1xyXG5cdFx0XHRcdFx0XHRjb25zdCBbLCBrZXksIHZhbHVlXSA9IG1hdGNoO1xyXG5cdFx0XHRcdFx0XHRjdXJyZW50S2V5ID0ga2V5O1xyXG5cdFx0XHRcdFx0XHRjb25zdCB0cmltbWVkVmFsdWUgPSB2YWx1ZSA/IHZhbHVlLnRyaW0oKSA6IFwiXCI7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHQvLyBDaGVjayBmb3IgYnJhY2tldC1zeW50YXggYXJyYXlzOiBbaXRlbV0gb3IgW1wiaXRlbTFcIiwgXCJpdGVtMlwiXSBvciBbaXRlbTEsIGl0ZW0yXVxyXG5cdFx0XHRcdFx0XHRjb25zdCBicmFja2V0QXJyYXlNYXRjaCA9IHRyaW1tZWRWYWx1ZS5tYXRjaCgvXlxcWyguKilcXF0kLyk7XHJcblx0XHRcdFx0XHRcdGlmIChicmFja2V0QXJyYXlNYXRjaCkge1xyXG5cdFx0XHRcdFx0XHRcdC8vIFRoaXMgaXMgYSBicmFja2V0LWZvcm1hdCBhcnJheVxyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGFycmF5Q29udGVudCA9IGJyYWNrZXRBcnJheU1hdGNoWzFdLnRyaW0oKTtcclxuXHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTsgLy8gTWFyayB0aGlzIGtleSBhcyBhbiBhcnJheVxyXG5cdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdGlmIChhcnJheUNvbnRlbnQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFBhcnNlIGFycmF5IGl0ZW1zIC0gaGFuZGxlIGJvdGggcXVvdGVkIGFuZCB1bnF1b3RlZCB2YWx1ZXNcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFNwbGl0IGJ5IGNvbW1hLCBidXQgcmVzcGVjdCBxdW90ZXNcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IGl0ZW1zOiBzdHJpbmdbXSA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdFx0bGV0IGN1cnJlbnRJdGVtID0gXCJcIjtcclxuXHRcdFx0XHRcdFx0XHRcdGxldCBpblF1b3RlcyA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0bGV0IHF1b3RlQ2hhciA9ICcnO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGFycmF5Q29udGVudC5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRjb25zdCBjaGFyID0gYXJyYXlDb250ZW50W2ldO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFpblF1b3RlcyAmJiAoY2hhciA9PT0gJ1wiJyB8fCBjaGFyID09PSBcIidcIikpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpblF1b3RlcyA9IHRydWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0cXVvdGVDaGFyID0gY2hhcjtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChpblF1b3RlcyAmJiBjaGFyID09PSBxdW90ZUNoYXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGVzY2FwZWRcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoaSA+IDAgJiYgYXJyYXlDb250ZW50W2kgLSAxXSA9PT0gJ1xcXFwnKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjdXJyZW50SXRlbSArPSBjaGFyO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpblF1b3RlcyA9IGZhbHNlO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0cXVvdGVDaGFyID0gJyc7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKCFpblF1b3RlcyAmJiBjaGFyID09PSAnLCcpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBFbmQgb2YgY3VycmVudCBpdGVtXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgdHJpbW1lZEl0ZW0gPSBjdXJyZW50SXRlbS50cmltKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRyaW1tZWRJdGVtKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZW1vdmUgc3Vycm91bmRpbmcgcXVvdGVzIGlmIHByZXNlbnRcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IHVucXVvdGVkID0gdHJpbW1lZEl0ZW0ucmVwbGFjZSgvXltcIiddfFtcIiddJC9nLCAnJyk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpdGVtcy5wdXNoKHVucXVvdGVkKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y3VycmVudEl0ZW0gPSBcIlwiO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGN1cnJlbnRJdGVtICs9IGNoYXI7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gQWRkIHRoZSBsYXN0IGl0ZW1cclxuXHRcdFx0XHRcdFx0XHRcdGlmIChjdXJyZW50SXRlbS50cmltKCkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgdHJpbW1lZEl0ZW0gPSBjdXJyZW50SXRlbS50cmltKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IHVucXVvdGVkID0gdHJpbW1lZEl0ZW0ucmVwbGFjZSgvXltcIiddfFtcIiddJC9nLCAnJyk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGl0ZW1zLnB1c2godW5xdW90ZWQpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IGl0ZW1zO1xyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBOb3QgYSBicmFja2V0IGFycmF5LCBjaGVjayBmb3Igb3RoZXIgYXJyYXkgZm9ybWF0c1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGlzS25vd25BcnJheUtleSA9IEtOT1dOX0FSUkFZX0tFWVMuaW5jbHVkZXMoa2V5IGFzIHR5cGVvZiBLTk9XTl9BUlJBWV9LRVlTW251bWJlcl0pO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGlzRW1wdHlBcnJheSA9ICF0cmltbWVkVmFsdWUgfHwgdHJpbW1lZFZhbHVlID09PSBcIlwiO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IGlzQXJyYXlQcm9wZXJ0eSA9IGlzS25vd25BcnJheUtleSB8fCBpc0VtcHR5QXJyYXk7XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0gPSBbXTtcclxuXHRcdFx0XHRcdFx0XHRcdGFycmF5S2V5cy5hZGQoa2V5KTsgLy8gTWFyayB0aGlzIGtleSBhcyBhbiBhcnJheVxyXG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBTdHJpcCBzdXJyb3VuZGluZyBxdW90ZXMgZnJvbSBzdHJpbmcgdmFsdWVzXHJcblx0XHRcdFx0XHRcdFx0XHRjb25zdCB1bnF1b3RlZFZhbHVlID0gdHJpbW1lZFZhbHVlLnJlcGxhY2UoL15bXCInXXxbXCInXSQvZywgJycpO1xyXG5cdFx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0gPSBbdW5xdW90ZWRWYWx1ZV07XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9IGVsc2UgaWYgKGN1cnJlbnRLZXkgJiYgdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIi0gXCIpKSB7XHJcblx0XHRcdFx0XHRcdC8vIENoZWNrIGlmIGN1cnJlbnQga2V5IGlzIGFuIGFycmF5IHByb3BlcnR5XHJcblx0XHRcdFx0XHRcdGNvbnN0IGlzQXJyYXlQcm9wZXJ0eSA9IGFycmF5S2V5cy5oYXMoY3VycmVudEtleSk7XHJcblx0XHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXRlbSA9IHRyaW1tZWRMaW5lLnJlcGxhY2UoL14tXFxzKi8sIFwiXCIpO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChpdGVtKSBleGlzdGluZ1Byb3BlcnRpZXNbY3VycmVudEtleV0ucHVzaChpdGVtKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fSBlbHNlIGlmICh0cmltbWVkTGluZSAmJiAhdHJpbW1lZExpbmUuc3RhcnRzV2l0aChcIi0gXCIpICYmICF0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiI1wiKSkge1xyXG5cdFx0XHRcdFx0XHQvLyBIYW5kbGUgdW5yZWNvZ25pemVkIHByb3BlcnRpZXMgdGhhdCBkb24ndCBtYXRjaCB0aGUgc3RhbmRhcmQgZm9ybWF0XHJcblx0XHRcdFx0XHRcdC8vIFRoaXMgaXMgYSBmYWxsYmFjayB0byBwcmVzZXJ2ZSBwcm9wZXJ0aWVzIHRoYXQgbWlnaHQgaGF2ZSBzcGVjaWFsIGZvcm1hdHRpbmdcclxuXHRcdFx0XHRcdFx0Y29uc3Qga2V5TWF0Y2ggPSB0cmltbWVkTGluZS5tYXRjaCgvXihbXjpdKyk6XFxzKiguKikkLyk7XHJcblx0XHRcdFx0XHRcdGlmIChrZXlNYXRjaCkge1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0ga2V5TWF0Y2g7XHJcblx0XHRcdFx0XHRcdFx0aWYgKCFleGlzdGluZ1Byb3BlcnRpZXNba2V5XSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0ZXhpc3RpbmdQcm9wZXJ0aWVzW2tleV0gPSBbdmFsdWUgPyB2YWx1ZS50cmltKCkgOiBcIlwiXTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHQvLyBQcmVzZXJ2ZSBhcnJheSBrZXlzIGlmIHRoZXkgZXhpc3Qgd2l0aG91dCB2YWx1ZXNcclxuXHRcdFx0XHRLTk9XTl9BUlJBWV9LRVlTLmZvckVhY2goa2V5ID0+IHtcclxuXHRcdFx0XHRcdGlmIChwcm9wZXJ0aWVzVGV4dC5pbmNsdWRlcyhrZXkgKyAnOicpICYmICFleGlzdGluZ1Byb3BlcnRpZXNba2V5XSkge1xyXG5cdFx0XHRcdFx0XHRleGlzdGluZ1Byb3BlcnRpZXNba2V5XSA9IFtdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9IGNhdGNoIHtcclxuXHRcdFx0XHQvLyBGYWxsYmFjayB0byB0ZW1wbGF0ZSBpZiBwYXJzaW5nIGZhaWxzXHJcblx0XHRcdFx0bmV3IE5vdGljZShcIkZhbGxpbmcgYmFjayB0byB0ZW1wbGF0ZSBkdWUgdG8gcGFyc2luZyBlcnJvci5cIik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRjb25zdCBib2R5Q29udGVudCA9IGNvbnRlbnQuc2xpY2UocHJvcGVydGllc0VuZCk7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRwcm9wZXJ0aWVzOiBleGlzdGluZ1Byb3BlcnRpZXMsXHJcblx0XHRcdHByb3BlcnRpZXNUZXh0LFxyXG5cdFx0XHRwcm9wZXJ0aWVzRW5kLFxyXG5cdFx0XHRib2R5Q29udGVudFxyXG5cdFx0fTtcclxuXHR9XHJcblxyXG5cdHBhcnNlVGVtcGxhdGUodGVtcGxhdGVTdHJpbmc6IHN0cmluZywgdGl0bGU6IHN0cmluZyk6IHsgdGVtcGxhdGVQcm9wczogc3RyaW5nW107IHRlbXBsYXRlVmFsdWVzOiBUZW1wbGF0ZVZhbHVlcyB9IHtcclxuXHRcdGNvbnN0IHRlbXBsYXRlTGluZXMgPSB0ZW1wbGF0ZVN0cmluZy5zcGxpdChcIlxcblwiKTtcclxuXHRcdGNvbnN0IHRlbXBsYXRlUHJvcHM6IHN0cmluZ1tdID0gW107XHJcblx0XHRjb25zdCB0ZW1wbGF0ZVZhbHVlczogVGVtcGxhdGVWYWx1ZXMgPSB7fTtcclxuXHRcdGxldCBpblByb3BlcnRpZXMgPSBmYWxzZTtcclxuXHJcblx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHRlbXBsYXRlTGluZXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0Y29uc3QgbGluZSA9IHRlbXBsYXRlTGluZXNbaV0udHJpbSgpO1xyXG5cdFx0XHRpZiAobGluZSA9PT0gXCItLS1cIikge1xyXG5cdFx0XHRcdGluUHJvcGVydGllcyA9ICFpblByb3BlcnRpZXM7XHJcblx0XHRcdFx0aWYgKCFpblByb3BlcnRpZXMpIHtcclxuXHRcdFx0XHRcdGJyZWFrOyAvLyBTdG9wIGF0IHNlY29uZCAtLS0gdG8gZXhjbHVkZSBwb3N0LXByb3BlcnR5IGNvbnRlbnRcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGluUHJvcGVydGllcykge1xyXG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gbGluZS5tYXRjaCgvXihcXHcrKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRpZiAobWF0Y2gpIHtcclxuXHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0gbWF0Y2g7XHJcblx0XHRcdFx0XHR0ZW1wbGF0ZVByb3BzLnB1c2goa2V5KTtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0Ly8gQ2hlY2sgaWYgdGhpcyBpcyBhbiBhcnJheSBwcm9wZXJ0eSAoa25vd24gYXJyYXkga2V5cyBvciBZQU1MIGxpc3QgZm9ybWF0KVxyXG5cdFx0XHRcdFx0Y29uc3QgaXNLbm93bkFycmF5S2V5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSk7XHJcblx0XHRcdFx0XHQvLyBDaGVjayBpZiBpdCdzIGEgWUFNTCBsaXN0IGZvcm1hdCAobm8gdmFsdWUgYWZ0ZXIgY29sb24sIGVtcHR5IGJyYWNrZXRzLCBvciBlbXB0eSB2YWx1ZSBtZWFucyBpdCdzIGFuIGFycmF5KVxyXG5cdFx0XHRcdFx0Y29uc3QgaXNFbXB0eUFycmF5ID0gIXZhbHVlIHx8IHZhbHVlLnRyaW0oKSA9PT0gXCJcIiB8fCB2YWx1ZS50cmltKCkgPT09IFwiW11cIjtcclxuXHRcdFx0XHRcdGNvbnN0IGlzQXJyYXlQcm9wZXJ0eSA9IGlzS25vd25BcnJheUtleSB8fCBpc0VtcHR5QXJyYXk7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdGlmIChpc0FycmF5UHJvcGVydHkpIHtcclxuXHRcdFx0XHRcdFx0Ly8gSGFuZGxlIGFycmF5IHByb3BlcnRpZXNcclxuXHRcdFx0XHRcdFx0aWYgKHZhbHVlICYmIHZhbHVlLnN0YXJ0c1dpdGgoXCJbXCIpKSB7XHJcblx0XHRcdFx0XHRcdFx0Ly8gSGFuZGxlIGJyYWNrZXQgZm9ybWF0OiBbXCJpdGVtMVwiLCBcIml0ZW0yXCJdXHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgaXRlbXMgPSB2YWx1ZVxyXG5cdFx0XHRcdFx0XHRcdFx0LnJlcGxhY2UoL1tbXFxdXS9nLCBcIlwiKVxyXG5cdFx0XHRcdFx0XHRcdFx0LnNwbGl0KFwiLFwiKVxyXG5cdFx0XHRcdFx0XHRcdFx0Lm1hcCh0ID0+IHQudHJpbSgpKVxyXG5cdFx0XHRcdFx0XHRcdFx0LmZpbHRlcih0ID0+IHQpO1xyXG5cdFx0XHRcdFx0XHRcdHRlbXBsYXRlVmFsdWVzW2tleV0gPSBpdGVtcztcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHQvLyBIYW5kbGUgWUFNTCBsaXN0IGZvcm1hdDogZW1wdHkgb3Igd2l0aCAtIGl0ZW1zXHJcblx0XHRcdFx0XHRcdFx0dGVtcGxhdGVWYWx1ZXNba2V5XSA9IFtdO1xyXG5cdFx0XHRcdFx0XHRcdC8vIExvb2sgYWhlYWQgZm9yIGl0ZW0gbGlzdFxyXG5cdFx0XHRcdFx0XHRcdGZvciAobGV0IGogPSBpICsgMTsgaiA8IHRlbXBsYXRlTGluZXMubGVuZ3RoOyBqKyspIHtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IG5leHRMaW5lID0gdGVtcGxhdGVMaW5lc1tqXS50cmltKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRpZiAobmV4dExpbmUuc3RhcnRzV2l0aChcIi0gXCIpKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNvbnN0IGl0ZW0gPSBuZXh0TGluZS5yZXBsYWNlKC9eLVxccyovLCBcIlwiKS50cmltKCk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChpdGVtKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgYXJyYXlWYWx1ZSA9IHRlbXBsYXRlVmFsdWVzW2tleV07XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKEFycmF5LmlzQXJyYXkoYXJyYXlWYWx1ZSkpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGFycmF5VmFsdWUucHVzaChpdGVtKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAobmV4dExpbmUgPT09IFwiLS0tXCIgfHwgKG5leHRMaW5lICYmICFuZXh0TGluZS5zdGFydHNXaXRoKFwiLSBcIikgJiYgbmV4dExpbmUuaW5jbHVkZXMoXCI6XCIpKSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBTdG9wIGF0IG5leHQgcHJvcGVydHkgb3IgZW5kIG9mIHByb3BlcnRpZXMgc2VjdGlvblxyXG5cdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdC8vIFRoaXMgaXMgYSBzdHJpbmcgcHJvcGVydHksIG5vdCBhbiBhcnJheVxyXG5cdFx0XHRcdFx0XHRjb25zdCBzbHVnID0gdGhpcy50b0tlYmFiQ2FzZSh0aXRsZSk7XHJcblx0XHRcdFx0XHRcdGNvbnN0IHN0cmluZ1ZhbHVlID0gKHZhbHVlIHx8IFwiXCIpXHJcblx0XHRcdFx0XHRcdFx0LnJlcGxhY2UoL1xce1xce3RpdGxlXFx9XFx9L2csIHRpdGxlKVxyXG5cdFx0XHRcdFx0XHRcdC5yZXBsYWNlKC9cXHtcXHtkYXRlXFx9XFx9L2csIHdpbmRvdy5tb21lbnQobmV3IERhdGUoKSkuZm9ybWF0KHRoaXMuc2V0dGluZ3MuZGF0ZUZvcm1hdCkpXHJcblx0XHRcdFx0XHRcdFx0LnJlcGxhY2UoL1xce1xce3NsdWdcXH1cXH0vZywgc2x1Zyk7XHJcblx0XHRcdFx0XHRcdC8vIFN0b3JlIGFzIGEgc2luZ2xlIHN0cmluZyB2YWx1ZSwgbm90IGluIGFuIGFycmF5XHJcblx0XHRcdFx0XHRcdHRlbXBsYXRlVmFsdWVzW2tleV0gPSBzdHJpbmdWYWx1ZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4geyB0ZW1wbGF0ZVByb3BzLCB0ZW1wbGF0ZVZhbHVlcyB9O1xyXG5cdH1cclxuXHJcblx0YnVpbGRGcm9udG1hdHRlckNvbnRlbnQoZmluYWxQcm9wczogUmVjb3JkPHN0cmluZywgc3RyaW5nW10+LCBhcnJheUtleXM/OiBTZXQ8c3RyaW5nPik6IHN0cmluZyB7XHJcblx0XHRsZXQgbmV3Q29udGVudCA9IFwiLS0tXFxuXCI7XHJcblx0XHRmb3IgKGNvbnN0IGtleSBpbiBmaW5hbFByb3BzKSB7XHJcblx0XHRcdC8vIENoZWNrIGlmIHRoaXMgaXMgYW4gYXJyYXkgcHJvcGVydHlcclxuXHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gS05PV05fQVJSQVlfS0VZUy5pbmNsdWRlcyhrZXkgYXMgdHlwZW9mIEtOT1dOX0FSUkFZX0tFWVNbbnVtYmVyXSkgfHwgXHJcblx0XHRcdFx0KGFycmF5S2V5cyAmJiBhcnJheUtleXMuaGFzKGtleSkpO1xyXG5cdFx0XHRcclxuXHRcdFx0aWYgKGlzQXJyYXlQcm9wZXJ0eSkge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTpcXG5gO1xyXG5cdFx0XHRcdGlmIChmaW5hbFByb3BzW2tleV0ubGVuZ3RoID4gMCkge1xyXG5cdFx0XHRcdFx0ZmluYWxQcm9wc1trZXldLmZvckVhY2goaXRlbSA9PiB7XHJcblx0XHRcdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCAgLSAke2l0ZW19XFxuYDtcclxuXHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRuZXdDb250ZW50ICs9IGAke2tleX06ICR7ZmluYWxQcm9wc1trZXldWzBdIHx8IFwiXCJ9XFxuYDtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0bmV3Q29udGVudCArPSBcIi0tLVwiO1xyXG5cdFx0cmV0dXJuIG5ld0NvbnRlbnQ7XHJcblx0fVxyXG5cclxuXHRhc3luYyB1cGRhdGVUaXRsZUluRnJvbnRtYXR0ZXIoZmlsZTogVEZpbGUsIG5ld1RpdGxlOiBzdHJpbmcsIHR5cGU6IENvbnRlbnRUeXBlSWQpOiBQcm9taXNlPHZvaWQ+IHtcclxuXHRcdC8vIENoZWNrIGlmIHRlbXBsYXRlIGhhcyB7e3RpdGxlfX0gLSBpZiBub3QsIGRvbid0IHVwZGF0ZSBmcm9udG1hdHRlciBhdCBhbGxcclxuXHRcdGNvbnN0IHRpdGxlS2V5ID0gdGhpcy5nZXRUaXRsZUtleSh0eXBlKTtcclxuXHRcdGNvbnN0IGhhc1RpdGxlSW5UZW1wbGF0ZSA9IHRoaXMudGVtcGxhdGVIYXNUaXRsZSh0eXBlKTtcclxuXHRcdFxyXG5cdFx0Ly8gSWYgdGVtcGxhdGUgZG9lc24ndCBoYXZlIHt7dGl0bGV9fSwgZG9uJ3QgbW9kaWZ5IGZyb250bWF0dGVyXHJcblx0XHRpZiAoIWhhc1RpdGxlSW5UZW1wbGF0ZSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG5cdFx0bGV0IHByb3BlcnRpZXNFbmQgPSAwO1xyXG5cdFx0bGV0IHByb3BlcnRpZXNUZXh0ID0gXCJcIjtcclxuXHRcdGxldCBoYXNGcm9udG1hdHRlciA9IGZhbHNlO1xyXG5cclxuXHRcdGlmIChjb250ZW50LnN0YXJ0c1dpdGgoXCItLS1cIikpIHtcclxuXHRcdFx0aGFzRnJvbnRtYXR0ZXIgPSB0cnVlO1xyXG5cdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5pbmRleE9mKFwiXFxuLS0tXCIsIDMpO1xyXG5cdFx0XHRpZiAocHJvcGVydGllc0VuZCA9PT0gLTEpIHtcclxuXHRcdFx0XHRwcm9wZXJ0aWVzRW5kID0gY29udGVudC5sZW5ndGg7XHJcblx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0cHJvcGVydGllc0VuZCArPSA0O1xyXG5cdFx0XHR9XHJcblx0XHRcdHByb3BlcnRpZXNUZXh0ID0gY29udGVudC5zbGljZSg0LCBwcm9wZXJ0aWVzRW5kIC0gNCkudHJpbSgpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGNvbnN0IHByb3BPcmRlcjogc3RyaW5nW10gPSBbXTtcclxuXHRcdGNvbnN0IGV4aXN0aW5nOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBzdHJpbmdbXT4gPSB7fTtcclxuXHRcdGxldCBjdXJyZW50S2V5OiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuXHRcdGxldCB0aXRsZUtleVBvc2l0aW9uID0gLTE7IC8vIFRyYWNrIHRoZSBvcmlnaW5hbCBwb3NpdGlvbiBvZiB0aGUgdGl0bGUga2V5XHJcblxyXG5cdFx0Y29uc3QgYXJyYXlLZXlzID0gbmV3IFNldDxzdHJpbmc+KCk7IC8vIFRyYWNrIHdoaWNoIGtleXMgYXJlIGFycmF5c1xyXG5cdFx0XHJcblx0XHRwcm9wZXJ0aWVzVGV4dC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBpbmRleCkgPT4ge1xyXG5cdFx0XHRjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRcclxuXHRcdFx0Ly8gTWF0Y2ggcHJvcGVydHkgbGluZXMgLSBtb3JlIGZsZXhpYmxlIHJlZ2V4IHRvIGhhbmRsZSB2YXJpb3VzIHByb3BlcnR5IG5hbWVzXHJcblx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZExpbmUubWF0Y2goL14oW2EtekEtWl9dW2EtekEtWjAtOV8tXSopOlxccyooLiopJC8pO1xyXG5cdFx0XHRpZiAobWF0Y2gpIHtcclxuXHRcdFx0XHRjb25zdCBbLCBrZXksIHZhbHVlXSA9IG1hdGNoO1xyXG5cdFx0XHRcdHByb3BPcmRlci5wdXNoKGtleSk7XHJcblx0XHRcdFx0Y3VycmVudEtleSA9IGtleTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHQvLyBUcmFjayB0aGUgb3JpZ2luYWwgcG9zaXRpb24gb2YgdGhlIHRpdGxlIGtleVxyXG5cdFx0XHRcdGlmIChrZXkgPT09IHRpdGxlS2V5KSB7XHJcblx0XHRcdFx0XHR0aXRsZUtleVBvc2l0aW9uID0gaW5kZXg7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGNvbnN0IGlzS25vd25BcnJheUtleSA9IEtOT1dOX0FSUkFZX0tFWVMuaW5jbHVkZXMoa2V5IGFzIHR5cGVvZiBLTk9XTl9BUlJBWV9LRVlTW251bWJlcl0pO1xyXG5cdFx0XHRcdGNvbnN0IGlzRW1wdHlBcnJheSA9ICF2YWx1ZSB8fCB2YWx1ZS50cmltKCkgPT09IFwiXCIgfHwgdmFsdWUudHJpbSgpID09PSBcIltdXCI7XHJcblx0XHRcdFx0Y29uc3QgaXNBcnJheVByb3BlcnR5ID0gaXNLbm93bkFycmF5S2V5IHx8IGlzRW1wdHlBcnJheTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRpZiAoaXNBcnJheVByb3BlcnR5KSB7XHJcblx0XHRcdFx0XHRleGlzdGluZ1trZXldID0gW107XHJcblx0XHRcdFx0XHRhcnJheUtleXMuYWRkKGtleSk7IC8vIE1hcmsgdGhpcyBrZXkgYXMgYW4gYXJyYXlcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0ZXhpc3Rpbmdba2V5XSA9IHZhbHVlID8gdmFsdWUudHJpbSgpIDogXCJcIjtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gZWxzZSBpZiAoY3VycmVudEtleSAmJiBhcnJheUtleXMuaGFzKGN1cnJlbnRLZXkpICYmIHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCItIFwiKSkge1xyXG5cdFx0XHRcdC8vIEhhbmRsZSBhcnJheSBpdGVtc1xyXG5cdFx0XHRcdGNvbnN0IGl0ZW0gPSB0cmltbWVkTGluZS5yZXBsYWNlKC9eLVxccyovLCBcIlwiKTtcclxuXHRcdFx0XHRpZiAoaXRlbSkgKGV4aXN0aW5nW2N1cnJlbnRLZXldIGFzIHN0cmluZ1tdKS5wdXNoKGl0ZW0pO1xyXG5cdFx0XHR9IGVsc2UgaWYgKHRyaW1tZWRMaW5lICYmICF0cmltbWVkTGluZS5zdGFydHNXaXRoKFwiLSBcIikgJiYgIXRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoXCIjXCIpKSB7XHJcblx0XHRcdFx0Ly8gSGFuZGxlIHVucmVjb2duaXplZCBwcm9wZXJ0aWVzIHRoYXQgZG9uJ3QgbWF0Y2ggdGhlIHN0YW5kYXJkIGZvcm1hdFxyXG5cdFx0XHRcdC8vIFRoaXMgaXMgYSBmYWxsYmFjayB0byBwcmVzZXJ2ZSBwcm9wZXJ0aWVzIHRoYXQgbWlnaHQgaGF2ZSBzcGVjaWFsIGZvcm1hdHRpbmdcclxuXHRcdFx0XHRjb25zdCBrZXlNYXRjaCA9IHRyaW1tZWRMaW5lLm1hdGNoKC9eKFteOl0rKTpcXHMqKC4qKSQvKTtcclxuXHRcdFx0XHRpZiAoa2V5TWF0Y2gpIHtcclxuXHRcdFx0XHRcdGNvbnN0IFssIGtleSwgdmFsdWVdID0ga2V5TWF0Y2g7XHJcblx0XHRcdFx0XHRpZiAoIXByb3BPcmRlci5pbmNsdWRlcyhrZXkpKSB7XHJcblx0XHRcdFx0XHRcdHByb3BPcmRlci5wdXNoKGtleSk7XHJcblx0XHRcdFx0XHRcdGV4aXN0aW5nW2tleV0gPSB2YWx1ZSA/IHZhbHVlLnRyaW0oKSA6IFwiXCI7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBQcm9wZXJseSBlc2NhcGUgWUFNTCBzdHJpbmcgdmFsdWVzXHJcblx0XHQvLyBZQU1MIHN0cmluZ3Mgd2l0aCBxdW90ZXMgbmVlZCB0byBiZSB3cmFwcGVkIGluIHNpbmdsZSBxdW90ZXMgb3IgZXNjYXBlZCBwcm9wZXJseVxyXG5cdFx0bGV0IHRpdGxlVmFsOiBzdHJpbmc7XHJcblx0XHRpZiAobmV3VGl0bGUuaW5jbHVkZXMoJ1wiJykgfHwgbmV3VGl0bGUuaW5jbHVkZXMoXCInXCIpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKCdcXG4nKSB8fCBuZXdUaXRsZS5pbmNsdWRlcygnXFxcXCcpKSB7XHJcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggcXVvdGVzLCBuZXdsaW5lcywgb3IgYmFja3NsYXNoZXMsIHVzZSBzaW5nbGUgcXVvdGVzIGFuZCBlc2NhcGUgc2luZ2xlIHF1b3Rlc1xyXG5cdFx0XHR0aXRsZVZhbCA9IGAnJHtuZXdUaXRsZS5yZXBsYWNlKC8nL2csIFwiJydcIil9J2A7XHJcblx0XHR9IGVsc2UgaWYgKG5ld1RpdGxlLmluY2x1ZGVzKFwiIFwiKSB8fCBuZXdUaXRsZS5pbmNsdWRlcyhcIjpcIikgfHwgbmV3VGl0bGUuaW5jbHVkZXMoXCIjXCIpIHx8IG5ld1RpdGxlLmluY2x1ZGVzKFwiQFwiKSkge1xyXG5cdFx0XHQvLyBGb3Igc3RyaW5ncyB3aXRoIHNwYWNlcyBvciBzcGVjaWFsIFlBTUwgY2hhcmFjdGVycywgd3JhcCBpbiBkb3VibGUgcXVvdGVzIGFuZCBlc2NhcGUgZG91YmxlIHF1b3Rlc1xyXG5cdFx0XHR0aXRsZVZhbCA9IGBcIiR7bmV3VGl0bGUucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpfVwiYDtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdC8vIEZvciBzaW1wbGUgc3RyaW5ncywgbm8gcXVvdGVzIG5lZWRlZFxyXG5cdFx0XHR0aXRsZVZhbCA9IG5ld1RpdGxlO1xyXG5cdFx0fVxyXG5cdFx0ZXhpc3RpbmdbdGl0bGVLZXldID0gdGl0bGVWYWw7XHJcblx0XHRcclxuXHRcdC8vIEFsc28gdXBkYXRlIHNsdWcgaWYgaXQgZXhpc3RzIGluIGZyb250bWF0dGVyXHJcblx0XHRpZiAoXCJzbHVnXCIgaW4gZXhpc3RpbmcpIHtcclxuXHRcdFx0Y29uc3QgbmV3U2x1ZyA9IHRoaXMudG9LZWJhYkNhc2UobmV3VGl0bGUpO1xyXG5cdFx0XHRleGlzdGluZ1tcInNsdWdcIl0gPSBuZXdTbHVnO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIElmIHRpdGxlIGtleSB3YXMgZm91bmQgaW4gb3JpZ2luYWwgcHJvcGVydGllcywgcHJlc2VydmUgaXRzIHBvc2l0aW9uXHJcblx0XHQvLyBPdGhlcndpc2UsIGFkZCBpdCBhdCB0aGUgZW5kXHJcblx0XHRpZiAodGl0bGVLZXlQb3NpdGlvbiA9PT0gLTEpIHtcclxuXHRcdFx0Ly8gVGl0bGUga2V5IG5vdCBmb3VuZCBpbiBvcmlnaW5hbCBwcm9wZXJ0aWVzLCBhZGQgaXQgYXQgdGhlIGVuZFxyXG5cdFx0XHRwcm9wT3JkZXIucHVzaCh0aXRsZUtleSk7XHJcblx0XHR9XHJcblx0XHQvLyBJZiB0aXRsZUtleVBvc2l0aW9uID49IDAsIHRoZSB0aXRsZSBrZXkgaXMgYWxyZWFkeSBpbiBwcm9wT3JkZXIgYXQgdGhlIGNvcnJlY3QgcG9zaXRpb25cclxuXHJcblx0XHQvLyBPbmx5IGNyZWF0ZS91cGRhdGUgZnJvbnRtYXR0ZXIgaWYgaXQgYWxyZWFkeSBleGlzdHNcclxuXHRcdC8vIERvbid0IGNyZWF0ZSBmcm9udG1hdHRlciBmcm9tIHNjcmF0Y2ggaWYgZmlsZSBoYWQgbm9uZVxyXG5cdFx0aWYgKCFoYXNGcm9udG1hdHRlcikge1xyXG5cdFx0XHQvLyBGaWxlIGhhZCBubyBmcm9udG1hdHRlciAtIGRvbid0IGNyZWF0ZSBpdCwganVzdCByZXR1cm5cclxuXHRcdFx0Ly8gVGhlIHJlbmFtZSBhbHJlYWR5IGhhcHBlbmVkLCB3ZSBqdXN0IGRvbid0IHVwZGF0ZSBmcm9udG1hdHRlclxyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gQnVpbGQgbmV3IGNvbnRlbnQgd2l0aCBmcm9udG1hdHRlclxyXG5cdFx0bGV0IG5ld0NvbnRlbnQgPSBcIi0tLVxcblwiO1xyXG5cdFx0Zm9yIChjb25zdCBrZXkgb2YgcHJvcE9yZGVyKSB7XHJcblx0XHRcdGNvbnN0IHZhbCA9IGV4aXN0aW5nW2tleV07XHJcblx0XHRcdGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcclxuXHRcdFx0XHRuZXdDb250ZW50ICs9IGAke2tleX06XFxuYDtcclxuXHRcdFx0XHRpZiAodmFsLmxlbmd0aCA+IDApIHtcclxuXHRcdFx0XHRcdHZhbC5mb3JFYWNoKChpdGVtOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0bmV3Q29udGVudCArPSBgICAtICR7aXRlbX1cXG5gO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdG5ld0NvbnRlbnQgKz0gYCR7a2V5fTogJHt2YWwgfHwgXCJcIn1cXG5gO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRuZXdDb250ZW50ICs9IFwiLS0tXFxuXCI7XHJcblxyXG5cdFx0Ly8gR2V0IGJvZHkgY29udGVudCAoZnJvbnRtYXR0ZXIgYWxyZWFkeSBleGlzdGVkLCBzbyB3ZSBrbm93IHByb3BlcnRpZXNFbmQgaXMgc2V0KVxyXG5cdFx0Y29uc3QgYm9keUNvbnRlbnQgPSBjb250ZW50LnNsaWNlKHByb3BlcnRpZXNFbmQpO1xyXG5cdFx0bmV3Q29udGVudCArPSBib2R5Q29udGVudDtcclxuXHJcblx0XHRhd2FpdCB0aGlzLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudCk7XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGdldFRpdGxlS2V5KHR5cGU6IENvbnRlbnRUeXBlSWQpOiBzdHJpbmcge1xyXG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSByZXR1cm4gXCJ0aXRsZVwiO1xyXG5cdFx0XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSB0aGlzLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gY29udGVudFR5cGVzLmZpbmQoY3QgPT4gY3QuaWQgPT09IHR5cGUpO1xyXG5cdFx0aWYgKCFjb250ZW50VHlwZSkgcmV0dXJuIFwidGl0bGVcIjtcclxuXHRcdFxyXG5cdFx0Y29uc3QgdGVtcGxhdGUgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcclxuXHRcdGNvbnN0IGxpbmVzID0gdGVtcGxhdGUuc3BsaXQoXCJcXG5cIik7XHJcblx0XHRsZXQgaW5Qcm9wZXJ0aWVzID0gZmFsc2U7XHJcblx0XHRmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcclxuXHRcdFx0Y29uc3QgdHJpbW1lZCA9IGxpbmUudHJpbSgpO1xyXG5cdFx0XHRpZiAodHJpbW1lZCA9PT0gXCItLS1cIikge1xyXG5cdFx0XHRcdGluUHJvcGVydGllcyA9ICFpblByb3BlcnRpZXM7XHJcblx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKGluUHJvcGVydGllcykge1xyXG5cdFx0XHRcdGNvbnN0IG1hdGNoID0gdHJpbW1lZC5tYXRjaCgvXihcXHcrKTpcXHMqKC4rKSQvKTtcclxuXHRcdFx0XHRpZiAobWF0Y2gpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGtleSA9IG1hdGNoWzFdO1xyXG5cdFx0XHRcdFx0Y29uc3QgdmFsdWUgPSBtYXRjaFsyXTtcclxuXHRcdFx0XHRcdGlmICh2YWx1ZS5pbmNsdWRlcyhcInt7dGl0bGV9fVwiKSkge1xyXG5cdFx0XHRcdFx0XHRyZXR1cm4ga2V5O1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0cmV0dXJuIFwidGl0bGVcIjtcclxuXHR9XHJcblx0XHJcblx0Ly8gQ2hlY2sgaWYgdGhlIHRlbXBsYXRlIGZvciB0aGlzIGNvbnRlbnQgdHlwZSBoYXMge3t0aXRsZX19XHJcblx0cHJpdmF0ZSB0ZW1wbGF0ZUhhc1RpdGxlKHR5cGU6IENvbnRlbnRUeXBlSWQpOiBib29sZWFuIHtcclxuXHRcdGlmICh0eXBlID09PSBcIm5vdGVcIikgcmV0dXJuIHRydWU7IC8vIE5vdGVzIGFsd2F5cyBoYXZlIHRpdGxlXHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gdHlwZSk7XHJcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm4gdHJ1ZTsgLy8gRGVmYXVsdCB0byB0cnVlIGZvciBzYWZldHlcclxuXHRcdFxyXG5cdFx0Y29uc3QgdGVtcGxhdGUgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcclxuXHRcdHJldHVybiB0ZW1wbGF0ZS5pbmNsdWRlcyhcInt7dGl0bGV9fVwiKTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IEVkaXRvciwgVEZpbGUsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5cbmltcG9ydCB7IG1hdGNoZXNGb2xkZXJQYXR0ZXJuLCBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkgfSBmcm9tIFwiLi9wYXRoLW1hdGNoaW5nXCI7XG5pbXBvcnQgeyB0b0tlYmFiQ2FzZSB9IGZyb20gXCIuL3N0cmluZy11dGlsc1wiO1xuXG5leHBvcnQgY2xhc3MgTGlua0NvbnZlcnRlciB7XG5cdGNvbnN0cnVjdG9yKHByaXZhdGUgc2V0dGluZ3M6IEFzdHJvQ29tcG9zZXJTZXR0aW5ncywgcHJpdmF0ZSBwbHVnaW4/OiB7IHNldHRpbmdzPzogQXN0cm9Db21wb3NlclNldHRpbmdzIH0pIHsgfVxuXG5cdC8vIEdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBpZiBhdmFpbGFibGUsIG90aGVyd2lzZSB1c2Ugc3RvcmVkIHNldHRpbmdzXG5cdHByaXZhdGUgZ2V0U2V0dGluZ3MoKTogQXN0cm9Db21wb3NlclNldHRpbmdzIHtcblx0XHQvLyBBbHdheXMgcHJlZmVyIHBsdWdpbiBzZXR0aW5ncyAodGhleSdyZSBrZXB0IHVwIHRvIGRhdGUpXG5cdFx0aWYgKHRoaXMucGx1Z2luPy5zZXR0aW5ncykge1xuXHRcdFx0cmV0dXJuIHRoaXMucGx1Z2luLnNldHRpbmdzO1xuXHRcdH1cblx0XHRyZXR1cm4gdGhpcy5zZXR0aW5ncztcblx0fVxuXG5cdC8vIExvY2FsIHRvS2ViYWJDYXNlIHJlbW92ZWQsIHVzaW5nIGltcG9ydGVkIG9uZSBpbnN0ZWFkXG5cblx0Z2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rKGxpbms6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGFzaEluZGV4ID0gbGluay5pbmRleE9mKCcjJyk7XG5cdFx0bGV0IHBhdGggPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoMCwgaGFzaEluZGV4KSA6IGxpbms7XG5cdFx0Y29uc3QgYW5jaG9yID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKGhhc2hJbmRleCkgOiAnJztcblxuXHRcdC8vIFVSTCBkZWNvZGUgdGhlIHBhdGggdG8gaGFuZGxlIGVuY29kZWQgY2hhcmFjdGVycyBsaWtlICUyMFxuXHRcdHBhdGggPSBkZWNvZGVVUklDb21wb25lbnQocGF0aCk7XG5cdFx0cGF0aCA9IHBhdGgucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgXCJcIik7XG5cblx0XHQvLyBEZXRlcm1pbmUgY29udGVudCB0eXBlIGFuZCBhcHByb3ByaWF0ZSBiYXNlIHBhdGggdXNpbmcgcGF0dGVybiBzcGVjaWZpY2l0eVxuXHRcdC8vIFN1cHBvcnQgYm90aCAubWQgYW5kIC5tZHggZXh0ZW5zaW9uc1xuXHRcdGNvbnN0IGZpbGVFeHRlbnNpb24gPSBsaW5rLmVuZHNXaXRoKCcubWR4JykgPyAnLm1keCcgOiAnLm1kJztcblx0XHRjb25zdCBjb250ZW50VHlwZUluZm8gPSB0aGlzLmdldENvbnRlbnRUeXBlRm9yUGF0aChwYXRoICsgZmlsZUV4dGVuc2lvbik7XG5cdFx0bGV0IGJhc2VQYXRoID0gY29udGVudFR5cGVJbmZvLmJhc2VQYXRoIHx8IFwiXCI7XG5cdFx0bGV0IGNvbnRlbnRGb2xkZXIgPSBjb250ZW50VHlwZUluZm8uY29udGVudEZvbGRlciB8fCBcIlwiO1xuXHRcdGxldCBpbmRleEZpbGVOYW1lID0gY29udGVudFR5cGVJbmZvLmluZGV4RmlsZU5hbWUgfHwgXCJcIjtcblxuXG5cdFx0Ly8gU3RyaXAgY29udGVudCBmb2xkZXIgaWYgcHJlc2VudFxuXHRcdGlmIChjb250ZW50Rm9sZGVyKSB7XG5cdFx0XHRwYXRoID0gcGF0aC5zbGljZShjb250ZW50Rm9sZGVyLmxlbmd0aCArIDEpO1xuXHRcdH1cblxuXHRcdGxldCBhZGRUcmFpbGluZ1NsYXNoID0gZmFsc2U7XG5cblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzIHRoZSBpbmRleCBmaWxlIG5hbWUgKHJlZ2FyZGxlc3Mgb2YgY3JlYXRpb24gbW9kZSksXG5cdFx0Ly8gdHJlYXQgaXQgYXMgZm9sZGVyLWJhc2VkIGxvZ2ljXG5cdFx0Ly8gTm90ZTogV2Ugb25seSBzZXQgYWRkVHJhaWxpbmdTbGFzaCBoZXJlOyB0aGUgZmluYWwgY2hlY2sgd2lsbCBwcmV2ZW50IGl0IGlmIHRoZXJlJ3MgYW4gYW5jaG9yXG5cdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0Y29uc3QgbGFzdFBhcnQgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXTtcblxuXHRcdC8vIENoZWNrIGlmIHRoZSBsYXN0IHBhcnQgbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIGluZGV4IGZpbGUgbmFtZVxuXHRcdGlmIChpbmRleEZpbGVOYW1lICYmIGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmIGxhc3RQYXJ0ID09PSBpbmRleEZpbGVOYW1lKSB7XG5cdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHR9XG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGxhc3QgcGFydCBtYXRjaGVzIHRoZSBkZWZhdWx0IFwiaW5kZXhcIiAod2hlbiBubyBpbmRleEZpbGVOYW1lIGlzIHNwZWNpZmllZClcblx0XHRlbHNlIGlmICgoIWluZGV4RmlsZU5hbWUgfHwgaW5kZXhGaWxlTmFtZS50cmltKCkgPT09IFwiXCIpICYmIGxhc3RQYXJ0ID09PSBcImluZGV4XCIpIHtcblx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdH1cblxuXHRcdGNvbnN0IHNsdWdQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKS5tYXAocGFydCA9PiB0b0tlYmFiQ2FzZShwYXJ0KSk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHNsdWdQYXJ0cy5qb2luKCcvJyk7XG5cblx0XHQvLyBGb3JtYXQgYmFzZSBwYXRoXG5cdFx0aWYgKGJhc2VQYXRoKSB7XG5cdFx0XHQvLyBBZGQgbGVhZGluZyBzbGFzaCBpZiBub3QgcHJlc2VudCB0byBtYWtlIGl0IGFic29sdXRlIGZyb20gcm9vdFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5zdGFydHNXaXRoKFwiL1wiKSkge1xuXHRcdFx0XHRiYXNlUGF0aCA9IFwiL1wiICsgYmFzZVBhdGg7XG5cdFx0XHR9XG5cdFx0XHQvLyBBZGQgdHJhaWxpbmcgc2xhc2ggaWYgbm90IHByZXNlbnRcblx0XHRcdGlmICghYmFzZVBhdGguZW5kc1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoICs9IFwiL1wiO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBXaGVuIG5vIGJhc2UgcGF0aCBpcyBzcGVjaWZpZWQsIGFkZCBsZWFkaW5nIHNsYXNoIHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRiYXNlUGF0aCA9IFwiL1wiO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgYWRkIHRyYWlsaW5nIHNsYXNoXG5cdFx0Ly8gQ1JJVElDQUw6IE5ldmVyIGFkZCB0cmFpbGluZyBzbGFzaCBiZWZvcmUgYW4gYW5jaG9yIChlLmcuLCAvYWJvdXQjaGVhZGluZyBub3QgL2Fib3V0LyNoZWFkaW5nKVxuXHRcdC8vIFRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgZm9yIGFuY2hvciBsaW5rcyBmcm9tIGNvcHkgaGVhZGluZyBVUkwgZnVuY3Rpb25hbGl0eVxuXHRcdC8vIEFuY2hvciBsaW5rcyBzaG91bGQgTkVWRVIgaGF2ZSB0cmFpbGluZyBzbGFzaGVzLCByZWdhcmRsZXNzIG9mIHNldHRpbmdzXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3Qgc2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA9IChzZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoKSAmJiAhYW5jaG9yO1xuXG5cdFx0cmV0dXJuIGAke2Jhc2VQYXRofSR7c2x1Z30ke3Nob3VsZEFkZFRyYWlsaW5nU2xhc2ggPyAnLycgOiAnJ30ke2FuY2hvcn1gO1xuXHR9XG5cblx0cHJpdmF0ZSBnZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChsaW5rOiBzdHJpbmcsIGN1cnJlbnRGaWxlUGF0aDogc3RyaW5nLCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlOiB7IGJhc2VQYXRoOiBzdHJpbmc7IGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiOyBpbmRleEZpbGVOYW1lOiBzdHJpbmc7IGNvbnRlbnRGb2xkZXI6IHN0cmluZyB9KTogc3RyaW5nIHtcblxuXHRcdGNvbnN0IGhhc2hJbmRleCA9IGxpbmsuaW5kZXhPZignIycpO1xuXHRcdGxldCBwYXRoID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKDAsIGhhc2hJbmRleCkgOiBsaW5rO1xuXHRcdGNvbnN0IGFuY2hvciA9IGhhc2hJbmRleCA+PSAwID8gbGluay5zbGljZShoYXNoSW5kZXgpIDogJyc7XG5cblx0XHQvLyBVUkwgZGVjb2RlIHRoZSBwYXRoIHRvIGhhbmRsZSBlbmNvZGVkIGNoYXJhY3RlcnMgbGlrZSAlMjBcblx0XHRwYXRoID0gZGVjb2RlVVJJQ29tcG9uZW50KHBhdGgpO1xuXHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLihtZHxtZHgpJC8sIFwiXCIpO1xuXG5cblx0XHQvLyBEZXRlcm1pbmUgY29udGVudCB0eXBlIGFuZCBhcHByb3ByaWF0ZSBiYXNlIHBhdGhcblx0XHRsZXQgYmFzZVBhdGggPSBcIlwiO1xuXHRcdGxldCBjb250ZW50Rm9sZGVyID0gXCJcIjtcblx0XHRsZXQgaW5kZXhGaWxlTmFtZSA9IFwiXCI7XG5cblx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgZ2V0Q29udGVudFR5cGVGb3JQYXRoIGJ1dCBmb3IgdGhlIHRhcmdldCBsaW5rXG5cdFx0Ly8gU3VwcG9ydCBib3RoIC5tZCBhbmQgLm1keCBleHRlbnNpb25zIC0gdHJ5IC5tZHggZmlyc3QgaWYgbGluayBzdWdnZXN0cyBpdFxuXHRcdGNvbnN0IGZpbGVFeHRlbnNpb24gPSBsaW5rLmVuZHNXaXRoKCcubWR4JykgPyAnLm1keCcgOiAnLm1kJztcblx0XHRjb25zdCB0YXJnZXRDb250ZW50VHlwZSA9IHRoaXMuZ2V0Q29udGVudFR5cGVGb3JQYXRoKHBhdGggKyBmaWxlRXh0ZW5zaW9uKTtcblxuXHRcdC8vIElmIHRhcmdldCBsaW5rIGRvZXNuJ3QgaGF2ZSBhIGNsZWFyIGNvbnRlbnQgdHlwZSAobm8gZm9sZGVyIHBhdGgpLCB1c2UgY3VycmVudCBmaWxlJ3MgY29udGVudCB0eXBlXG5cdFx0aWYgKCF0YXJnZXRDb250ZW50VHlwZS5iYXNlUGF0aCAmJiBjdXJyZW50RmlsZUNvbnRlbnRUeXBlLmJhc2VQYXRoKSB7XG5cdFx0XHRiYXNlUGF0aCA9IGN1cnJlbnRGaWxlQ29udGVudFR5cGUuYmFzZVBhdGg7XG5cdFx0XHRpbmRleEZpbGVOYW1lID0gY3VycmVudEZpbGVDb250ZW50VHlwZS5pbmRleEZpbGVOYW1lO1xuXHRcdFx0Y29udGVudEZvbGRlciA9IGN1cnJlbnRGaWxlQ29udGVudFR5cGUuY29udGVudEZvbGRlcjtcblx0XHR9IGVsc2Uge1xuXHRcdFx0YmFzZVBhdGggPSB0YXJnZXRDb250ZW50VHlwZS5iYXNlUGF0aDtcblx0XHRcdGluZGV4RmlsZU5hbWUgPSB0YXJnZXRDb250ZW50VHlwZS5pbmRleEZpbGVOYW1lO1xuXHRcdFx0Y29udGVudEZvbGRlciA9IHRhcmdldENvbnRlbnRUeXBlLmNvbnRlbnRGb2xkZXI7XG5cdFx0fVxuXG5cdFx0Ly8gU3RyaXAgY29udGVudCBmb2xkZXIgaWYgcHJlc2VudFxuXHRcdGlmIChjb250ZW50Rm9sZGVyKSB7XG5cdFx0XHRwYXRoID0gcGF0aC5zbGljZShjb250ZW50Rm9sZGVyLmxlbmd0aCArIDEpO1xuXHRcdH1cblxuXHRcdGxldCBhZGRUcmFpbGluZ1NsYXNoID0gZmFsc2U7XG5cblx0XHQvLyBTbWFydCBkZXRlY3Rpb246IGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzIHRoZSBpbmRleCBmaWxlIG5hbWUgKHJlZ2FyZGxlc3Mgb2YgY3JlYXRpb24gbW9kZSksXG5cdFx0Ly8gdHJlYXQgaXQgYXMgZm9sZGVyLWJhc2VkIGxvZ2ljXG5cdFx0Ly8gTm90ZTogV2Ugb25seSBzZXQgYWRkVHJhaWxpbmdTbGFzaCBoZXJlOyB0aGUgZmluYWwgY2hlY2sgd2lsbCBwcmV2ZW50IGl0IGlmIHRoZXJlJ3MgYW4gYW5jaG9yXG5cdFx0Y29uc3QgcGFydHMgPSBwYXRoLnNwbGl0KCcvJyk7XG5cdFx0Y29uc3QgbGFzdFBhcnQgPSBwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXTtcblxuXHRcdC8vIENoZWNrIGlmIHRoZSBsYXN0IHBhcnQgbWF0Y2hlcyB0aGUgc3BlY2lmaWVkIGluZGV4IGZpbGUgbmFtZVxuXHRcdGlmIChpbmRleEZpbGVOYW1lICYmIGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmIGxhc3RQYXJ0ID09PSBpbmRleEZpbGVOYW1lKSB7XG5cdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdHBhdGggPSBwYXJ0cy5qb2luKCcvJyk7XG5cdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHR9XG5cdFx0Ly8gQ2hlY2sgaWYgdGhlIGxhc3QgcGFydCBtYXRjaGVzIHRoZSBkZWZhdWx0IFwiaW5kZXhcIiAod2hlbiBubyBpbmRleEZpbGVOYW1lIGlzIHNwZWNpZmllZClcblx0XHRlbHNlIGlmICgoIWluZGV4RmlsZU5hbWUgfHwgaW5kZXhGaWxlTmFtZS50cmltKCkgPT09IFwiXCIpICYmIGxhc3RQYXJ0ID09PSBcImluZGV4XCIpIHtcblx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdGFkZFRyYWlsaW5nU2xhc2ggPSB0cnVlO1xuXHRcdH1cblxuXHRcdGNvbnN0IHNsdWdQYXJ0cyA9IHBhdGguc3BsaXQoJy8nKS5tYXAocGFydCA9PiB0b0tlYmFiQ2FzZShwYXJ0KSk7XG5cdFx0Y29uc3Qgc2x1ZyA9IHNsdWdQYXJ0cy5qb2luKCcvJyk7XG5cblx0XHQvLyBGb3JtYXQgYmFzZSBwYXRoXG5cdFx0aWYgKGJhc2VQYXRoKSB7XG5cdFx0XHQvLyBBZGQgbGVhZGluZyBzbGFzaCBpZiBub3QgcHJlc2VudCB0byBtYWtlIGl0IGFic29sdXRlIGZyb20gcm9vdFxuXHRcdFx0aWYgKCFiYXNlUGF0aC5zdGFydHNXaXRoKFwiL1wiKSkge1xuXHRcdFx0XHRiYXNlUGF0aCA9IFwiL1wiICsgYmFzZVBhdGg7XG5cdFx0XHR9XG5cdFx0XHQvLyBBZGQgdHJhaWxpbmcgc2xhc2ggaWYgbm90IHByZXNlbnRcblx0XHRcdGlmICghYmFzZVBhdGguZW5kc1dpdGgoXCIvXCIpKSB7XG5cdFx0XHRcdGJhc2VQYXRoICs9IFwiL1wiO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSB7XG5cdFx0XHQvLyBXaGVuIG5vIGJhc2UgcGF0aCBpcyBzcGVjaWZpZWQsIGFkZCBsZWFkaW5nIHNsYXNoIHRvIG1ha2UgaXQgYWJzb2x1dGUgZnJvbSByb290XG5cdFx0XHRiYXNlUGF0aCA9IFwiL1wiO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgYWRkIHRyYWlsaW5nIHNsYXNoXG5cdFx0Ly8gQ1JJVElDQUw6IE5ldmVyIGFkZCB0cmFpbGluZyBzbGFzaCBiZWZvcmUgYW4gYW5jaG9yIChlLmcuLCAvYWJvdXQjaGVhZGluZyBub3QgL2Fib3V0LyNoZWFkaW5nKVxuXHRcdC8vIFRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgZm9yIGFuY2hvciBsaW5rcyBmcm9tIGNvcHkgaGVhZGluZyBVUkwgZnVuY3Rpb25hbGl0eVxuXHRcdC8vIEFuY2hvciBsaW5rcyBzaG91bGQgTkVWRVIgaGF2ZSB0cmFpbGluZyBzbGFzaGVzLCByZWdhcmRsZXNzIG9mIHNldHRpbmdzXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3Qgc2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA9IChzZXR0aW5ncy5hZGRUcmFpbGluZ1NsYXNoVG9MaW5rcyB8fCBhZGRUcmFpbGluZ1NsYXNoKSAmJiAhYW5jaG9yO1xuXG5cdFx0cmV0dXJuIGAke2Jhc2VQYXRofSR7c2x1Z30ke3Nob3VsZEFkZFRyYWlsaW5nU2xhc2ggPyAnLycgOiAnJ30ke2FuY2hvcn1gO1xuXHR9XG5cblx0cHJpdmF0ZSBpc0luQ29uZmlndXJlZENvbnRlbnREaXJlY3RvcnkoZmlsZVBhdGg6IHN0cmluZyk6IGJvb2xlYW4ge1xuXHRcdC8vIENoZWNrIGFsbCBjb250ZW50IHR5cGVzLCBzb3J0ZWQgYnkgcGF0dGVybiBzcGVjaWZpY2l0eSAobW9yZSBzcGVjaWZpYyBmaXJzdClcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMuZ2V0U2V0dGluZ3MoKTtcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XG5cdFx0Y29uc3Qgc29ydGVkVHlwZXMgPSBzb3J0QnlQYXR0ZXJuU3BlY2lmaWNpdHkoY29udGVudFR5cGVzKTtcblxuXHRcdGZvciAoY29uc3QgY29udGVudFR5cGUgb2Ygc29ydGVkVHlwZXMpIHtcblx0XHRcdGlmICghY29udGVudFR5cGUuZW5hYmxlZCkgY29udGludWU7XG5cblx0XHRcdC8vIEhhbmRsZSBibGFuayBmb2xkZXIgKHJvb3QpIC0gbWF0Y2hlcyBmaWxlcyBpbiB2YXVsdCByb290IG9ubHlcblx0XHRcdGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcblx0XHRcdFx0aWYgKCFmaWxlUGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgZmlsZVBhdGguc3BsaXQoXCIvXCIpLmxlbmd0aCA9PT0gMSkge1xuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKG1hdGNoZXNGb2xkZXJQYXR0ZXJuKGZpbGVQYXRoLCBjb250ZW50VHlwZS5mb2xkZXIpKSB7XG5cdFx0XHRcdC8vIENoZWNrIGlnbm9yZVN1YmZvbGRlcnMgaWYgZm9sZGVyIGlzIHNwZWNpZmllZFxuXHRcdFx0XHRpZiAoY29udGVudFR5cGUuaWdub3JlU3ViZm9sZGVycykge1xuXHRcdFx0XHRcdGNvbnN0IHBhdGhTZWdtZW50cyA9IGZpbGVQYXRoLnNwbGl0KFwiL1wiKTtcblx0XHRcdFx0XHRjb25zdCBwYXRoRGVwdGggPSBwYXRoU2VnbWVudHMubGVuZ3RoO1xuXHRcdFx0XHRcdGNvbnN0IHBhdHRlcm5TZWdtZW50cyA9IGNvbnRlbnRUeXBlLmZvbGRlci5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgZXhwZWN0ZWREZXB0aCA9IHBhdHRlcm5TZWdtZW50cy5sZW5ndGg7XG5cblx0XHRcdFx0XHRpZiAoY29udGVudFR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKSB7XG5cdFx0XHRcdFx0XHQvLyBGb3IgZm9sZGVyLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgb25lIGxldmVsIGRlZXBlciAoZS5nLiwgdGVzdC9teS1maWxlL2luZGV4Lm1kKVxuXHRcdFx0XHRcdFx0Ly8gU28gd2UgbmVlZCB0byBhbGxvdyBvbmUgZXh0cmEgbGV2ZWwgYmV5b25kIHRoZSBwYXR0ZXJuIGRlcHRoXG5cdFx0XHRcdFx0XHRjb25zdCBmb2xkZXJEZXB0aCA9IHBhdGhEZXB0aCAtIDE7IC8vIFN1YnRyYWN0IDEgZm9yIHRoZSBpbmRleC5tZCBmaWxlXG5cdFx0XHRcdFx0XHRpZiAoZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggfHwgZm9sZGVyRGVwdGggPT09IGV4cGVjdGVkRGVwdGggKyAxKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBGb3IgZmlsZS1iYXNlZCBjcmVhdGlvbiwgZmlsZXMgYXJlIGF0IHRoZSBzYW1lIGRlcHRoIGFzIHRoZSBwYXR0ZXJuXG5cdFx0XHRcdFx0XHRpZiAocGF0aERlcHRoID09PSBleHBlY3RlZERlcHRoKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29udGVudFR5cGVGb3JQYXRoKGZpbGVQYXRoOiBzdHJpbmcpOiB7IGJhc2VQYXRoOiBzdHJpbmc7IGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiOyBpbmRleEZpbGVOYW1lOiBzdHJpbmc7IGNvbnRlbnRGb2xkZXI6IHN0cmluZyB9IHtcblx0XHQvLyBDaGVjayBhbGwgY29udGVudCB0eXBlcywgc29ydGVkIGJ5IHBhdHRlcm4gc3BlY2lmaWNpdHkgKG1vcmUgc3BlY2lmaWMgZmlyc3QpXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLmdldFNldHRpbmdzKCk7XG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IHNvcnRlZFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XG5cblx0XHRmb3IgKGNvbnN0IGNvbnRlbnRUeXBlIG9mIHNvcnRlZFR5cGVzKSB7XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmVuYWJsZWQpIGNvbnRpbnVlO1xuXG5cdFx0XHQvLyBIYW5kbGUgYmxhbmsgZm9sZGVyIChyb290KSAtIG1hdGNoZXMgZmlsZXMgaW4gdmF1bHQgcm9vdCBvbmx5XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmZvbGRlciB8fCBjb250ZW50VHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKSB7XG5cdFx0XHRcdGlmICghZmlsZVBhdGguaW5jbHVkZXMoXCIvXCIpIHx8IGZpbGVQYXRoLnNwbGl0KFwiL1wiKS5sZW5ndGggPT09IDEpIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YmFzZVBhdGg6IGNvbnRlbnRUeXBlLmxpbmtCYXNlUGF0aCB8fCBcIlwiLFxuXHRcdFx0XHRcdFx0Y3JlYXRpb25Nb2RlOiBjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUsXG5cdFx0XHRcdFx0XHRpbmRleEZpbGVOYW1lOiBjb250ZW50VHlwZS5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRjb250ZW50Rm9sZGVyOiBcIlwiXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmIChtYXRjaGVzRm9sZGVyUGF0dGVybihmaWxlUGF0aCwgY29udGVudFR5cGUuZm9sZGVyKSkge1xuXHRcdFx0XHQvLyBDaGVjayBpZ25vcmVTdWJmb2xkZXJzIGlmIGZvbGRlciBpcyBzcGVjaWZpZWRcblx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlLmlnbm9yZVN1YmZvbGRlcnMpIHtcblx0XHRcdFx0XHRjb25zdCBwYXRoU2VnbWVudHMgPSBmaWxlUGF0aC5zcGxpdChcIi9cIik7XG5cdFx0XHRcdFx0Y29uc3QgcGF0aERlcHRoID0gcGF0aFNlZ21lbnRzLmxlbmd0aDtcblx0XHRcdFx0XHRjb25zdCBwYXR0ZXJuU2VnbWVudHMgPSBjb250ZW50VHlwZS5mb2xkZXIuc3BsaXQoXCIvXCIpO1xuXHRcdFx0XHRcdGNvbnN0IGV4cGVjdGVkRGVwdGggPSBwYXR0ZXJuU2VnbWVudHMubGVuZ3RoO1xuXG5cdFx0XHRcdFx0aWYgKGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xuXHRcdFx0XHRcdFx0Ly8gRm9yIGZvbGRlci1iYXNlZCBjcmVhdGlvbiwgZmlsZXMgYXJlIG9uZSBsZXZlbCBkZWVwZXIgKGUuZy4sIHRlc3QvbXktZmlsZS9pbmRleC5tZClcblx0XHRcdFx0XHRcdC8vIFNvIHdlIG5lZWQgdG8gYWxsb3cgb25lIGV4dHJhIGxldmVsIGJleW9uZCB0aGUgcGF0dGVybiBkZXB0aFxuXHRcdFx0XHRcdFx0Y29uc3QgZm9sZGVyRGVwdGggPSBwYXRoRGVwdGggLSAxOyAvLyBTdWJ0cmFjdCAxIGZvciB0aGUgaW5kZXgubWQgZmlsZVxuXHRcdFx0XHRcdFx0aWYgKGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoIHx8IGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoICsgMSkge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0XHRcdGJhc2VQYXRoOiBjb250ZW50VHlwZS5saW5rQmFzZVBhdGggfHwgXCJcIixcblx0XHRcdFx0XHRcdFx0XHRjcmVhdGlvbk1vZGU6IGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSxcblx0XHRcdFx0XHRcdFx0XHRpbmRleEZpbGVOYW1lOiBjb250ZW50VHlwZS5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRcdFx0Y29udGVudEZvbGRlcjogY29udGVudFR5cGUuZm9sZGVyXG5cdFx0XHRcdFx0XHRcdH07XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIEZvciBmaWxlLWJhc2VkIGNyZWF0aW9uLCBmaWxlcyBhcmUgYXQgdGhlIHNhbWUgZGVwdGggYXMgdGhlIHBhdHRlcm5cblx0XHRcdFx0XHRcdGlmIChwYXRoRGVwdGggPT09IGV4cGVjdGVkRGVwdGgpIHtcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtcblx0XHRcdFx0XHRcdFx0XHRiYXNlUGF0aDogY29udGVudFR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRcdFx0Y3JlYXRpb25Nb2RlOiBjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUsXG5cdFx0XHRcdFx0XHRcdFx0aW5kZXhGaWxlTmFtZTogY29udGVudFR5cGUuaW5kZXhGaWxlTmFtZSB8fCBcIlwiLFxuXHRcdFx0XHRcdFx0XHRcdGNvbnRlbnRGb2xkZXI6IGNvbnRlbnRUeXBlLmZvbGRlclxuXHRcdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRyZXR1cm4ge1xuXHRcdFx0XHRcdFx0YmFzZVBhdGg6IGNvbnRlbnRUeXBlLmxpbmtCYXNlUGF0aCB8fCBcIlwiLFxuXHRcdFx0XHRcdFx0Y3JlYXRpb25Nb2RlOiBjb250ZW50VHlwZS5jcmVhdGlvbk1vZGUsXG5cdFx0XHRcdFx0XHRpbmRleEZpbGVOYW1lOiBjb250ZW50VHlwZS5pbmRleEZpbGVOYW1lIHx8IFwiXCIsXG5cdFx0XHRcdFx0XHRjb250ZW50Rm9sZGVyOiBjb250ZW50VHlwZS5mb2xkZXJcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gRGVmYXVsdCBmYWxsYmFja1xuXHRcdHJldHVybiB7XG5cdFx0XHRiYXNlUGF0aDogXCJcIixcblx0XHRcdGNyZWF0aW9uTW9kZTogXCJmaWxlXCIsXG5cdFx0XHRpbmRleEZpbGVOYW1lOiBcIlwiLFxuXHRcdFx0Y29udGVudEZvbGRlcjogXCJcIlxuXHRcdH07XG5cdH1cblxuXHRjb252ZXJ0V2lraWxpbmtzRm9yQXN0cm8oZWRpdG9yOiBFZGl0b3IsIGZpbGU6IFRGaWxlIHwgbnVsbCk6IHZvaWQge1xuXHRcdGlmICghKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcblx0XHRcdG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgZmlsZS5cIik7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXG5cdFx0Ly8gUHJlc2VydmUgY3Vyc29yIHBvc2l0aW9uIGJlZm9yZSBtb2RpZnlpbmcgY29udGVudFxuXHRcdGNvbnN0IGN1cnNvciA9IGVkaXRvci5nZXRDdXJzb3IoKTtcblx0XHRjb25zdCBvcmlnaW5hbExpbmUgPSBjdXJzb3IubGluZTtcblx0XHRjb25zdCBvcmlnaW5hbENoID0gY3Vyc29yLmNoO1xuXHRcdGNvbnN0IG9yaWdpbmFsQ29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuXHRcdGNvbnN0IG9yaWdpbmFsTGluZUNvdW50ID0gb3JpZ2luYWxDb250ZW50LnNwbGl0KCdcXG4nKS5sZW5ndGg7XG5cdFx0Y29uc3Qgb3JpZ2luYWxMaW5lTGVuZ3RoID0gb3JpZ2luYWxDb250ZW50LnNwbGl0KCdcXG4nKVtvcmlnaW5hbExpbmVdPy5sZW5ndGggfHwgMDtcblxuXHRcdGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcblx0XHRsZXQgbmV3Q29udGVudCA9IGNvbnRlbnQ7XG5cdFx0bGV0IGNvbnZlcnRlZENvdW50ID0gMDtcblx0XHRsZXQgc2tpcHBlZENvdW50ID0gMDtcblx0XHRjb25zdCBza2lwcGVkTGlua3M6IHN0cmluZ1tdID0gW107XG5cblx0XHQvLyBEZXRlcm1pbmUgdGhlIGN1cnJlbnQgZmlsZSdzIGNvbnRlbnQgdHlwZSBmb3IgcmVsYXRpdmUgbGlua3Ncblx0XHRjb25zdCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlID0gdGhpcy5nZXRDb250ZW50VHlwZUZvclBhdGgoZmlsZS5wYXRoKTtcblxuXHRcdC8vIERlZmluZSBjb21tb24gaW1hZ2UgZXh0ZW5zaW9uc1xuXHRcdGNvbnN0IGltYWdlRXh0ZW5zaW9ucyA9IC9cXC4ocG5nfGpwZ3xqcGVnfGdpZnxzdmcpJC9pO1xuXG5cdFx0Ly8gSGVscGVyIGZ1bmN0aW9uIHRvIGNoZWNrIGlmIGEgbGluayBjYW4gYmUgcmVsaWFibHkgY29udmVydGVkXG5cdFx0Y29uc3QgY2FuQ29udmVydExpbmsgPSAobGlua1RleHQ6IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xuXHRcdFx0Ly8gRG9uJ3QgY29udmVydCBpZiBpdCdzIGFuIGltYWdlXG5cdFx0XHRpZiAoaW1hZ2VFeHRlbnNpb25zLnRlc3QobGlua1RleHQpKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRG9uJ3QgY29udmVydCBleHRlcm5hbCBsaW5rc1xuXHRcdFx0aWYgKGxpbmtUZXh0Lm1hdGNoKC9eaHR0cHM/OlxcL1xcLy8pKSB7XG5cdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gRG9uJ3QgY29udmVydCBpZiBpdCdzIG5vdCBhIC5tZCBvciAubWR4IGZpbGUgYW5kIGRvZXNuJ3QgbG9vayBsaWtlIGEgdmFsaWQgaW50ZXJuYWwgbGlua1xuXHRcdFx0aWYgKCFsaW5rVGV4dC5pbmNsdWRlcygnLm1kJykgJiYgIWxpbmtUZXh0LmluY2x1ZGVzKCcubWR4JykgJiYgIWxpbmtUZXh0Lm1hdGNoKC9eW2EtekEtWjAtOV8tXSsoXFwvW2EtekEtWjAtOV8tXSspKiQvKSkge1xuXHRcdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGlmIHRoZSB0YXJnZXQgZmlsZSBpcyBpbiBhbnkgY29uZmlndXJlZCBjb250ZW50IGRpcmVjdG9yeVxuXHRcdFx0Ly8gU3VwcG9ydCBib3RoIC5tZCBhbmQgLm1keCBleHRlbnNpb25zXG5cdFx0XHRsZXQgdGFyZ2V0UGF0aDogc3RyaW5nO1xuXHRcdFx0aWYgKGxpbmtUZXh0LmVuZHNXaXRoKCcubWQnKSB8fCBsaW5rVGV4dC5lbmRzV2l0aCgnLm1keCcpKSB7XG5cdFx0XHRcdHRhcmdldFBhdGggPSBsaW5rVGV4dDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIERlZmF1bHQgdG8gLm1kIGlmIG5vIGV4dGVuc2lvbiBzcGVjaWZpZWRcblx0XHRcdFx0dGFyZ2V0UGF0aCA9IGxpbmtUZXh0ICsgJy5tZCc7XG5cdFx0XHR9XG5cblx0XHRcdC8vIENoZWNrIGlmIGl0J3MgaW4gYSBjb25maWd1cmVkIGNvbnRlbnQgZGlyZWN0b3J5XG5cdFx0XHRjb25zdCBpc0luQ29uZmlndXJlZERpcmVjdG9yeSA9IHRoaXMuaXNJbkNvbmZpZ3VyZWRDb250ZW50RGlyZWN0b3J5KHRhcmdldFBhdGgpO1xuXG5cdFx0XHQvLyBBbHNvIGNoZWNrIGlmIGl0J3MgYSBzaW1wbGUgZmlsZW5hbWUgKG5vIHBhdGgpIGFuZCBjdXJyZW50IGZpbGUgaGFzIGEgY29udGVudCB0eXBlXG5cdFx0XHRjb25zdCBpc1NpbXBsZUZpbGVuYW1lID0gIXRhcmdldFBhdGguaW5jbHVkZXMoJy8nKTtcblx0XHRcdGNvbnN0IGhhc0N1cnJlbnRDb250ZW50VHlwZSA9IGN1cnJlbnRGaWxlQ29udGVudFR5cGUuYmFzZVBhdGggIT09IFwiXCIgfHwgY3VycmVudEZpbGVDb250ZW50VHlwZS5jcmVhdGlvbk1vZGUgIT09IFwiZmlsZVwiIHx8IGN1cnJlbnRGaWxlQ29udGVudFR5cGUuaW5kZXhGaWxlTmFtZSAhPT0gXCJcIjtcblxuXHRcdFx0cmV0dXJuIGlzSW5Db25maWd1cmVkRGlyZWN0b3J5IHx8IChpc1NpbXBsZUZpbGVuYW1lICYmIGhhc0N1cnJlbnRDb250ZW50VHlwZSk7XG5cdFx0fTtcblxuXHRcdC8vIEhhbmRsZSByZWd1bGFyIFdpa2lsaW5rcyAobm9uLWltYWdlKVxuXHRcdG5ld0NvbnRlbnQgPSBuZXdDb250ZW50LnJlcGxhY2UoXG5cdFx0XHQvXFxbXFxbKFteXFxdfF0rKShcXHwoW15cXF1dKykpP1xcXVxcXS9nLFxuXHRcdFx0KG1hdGNoOiBzdHJpbmcsIGxpbmtUZXh0OiBzdHJpbmcsIF9waXBlOiBzdHJpbmcgfCB1bmRlZmluZWQsIGRpc3BsYXlUZXh0OiBzdHJpbmcgfCB1bmRlZmluZWQpID0+IHtcblx0XHRcdFx0Ly8gQ2hlY2sgaWYgaXQncyBhbiBpbWFnZSBXaWtpbGlua1xuXHRcdFx0XHRpZiAoaW1hZ2VFeHRlbnNpb25zLnRlc3QobGlua1RleHQpKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGlua1RleHQpO1xuXHRcdFx0XHRcdHJldHVybiBtYXRjaDsgLy8gSWdub3JlIGFuZCByZXR1cm4gb3JpZ2luYWwgaW1hZ2UgV2lraWxpbmtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrIGlmIHdlIGNhbiByZWxpYWJseSBjb252ZXJ0IHRoaXMgbGlua1xuXHRcdFx0XHRpZiAoIWNhbkNvbnZlcnRMaW5rKGxpbmtUZXh0KSkge1xuXHRcdFx0XHRcdHNraXBwZWRDb3VudCsrO1xuXHRcdFx0XHRcdHNraXBwZWRMaW5rcy5wdXNoKGxpbmtUZXh0KTtcblx0XHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIFJldHVybiBvcmlnaW5hbCBpZiB3ZSBjYW4ndCBjb252ZXJ0IHJlbGlhYmx5XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRjb25zdCBkaXNwbGF5ID0gZGlzcGxheVRleHQgfHwgbGlua1RleHQucmVwbGFjZSgvXFwuKG1kfG1keCkkLywgXCJcIik7XG5cblx0XHRcdFx0Ly8gRm9yIHJlbGF0aXZlIGxpbmtzIChubyBmb2xkZXIgcGF0aCksIHVzZSBjdXJyZW50IGZpbGUncyBjb250ZW50IHR5cGVcblx0XHRcdFx0Y29uc3QgdXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChsaW5rVGV4dCwgZmlsZS5wYXRoLCBjdXJyZW50RmlsZUNvbnRlbnRUeXBlKTtcblxuXHRcdFx0XHRjb252ZXJ0ZWRDb3VudCsrO1xuXHRcdFx0XHRyZXR1cm4gYFske2Rpc3BsYXl9XSgke3VybH0pYDtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0Ly8gSGFuZGxlIHN0YW5kYXJkIE1hcmtkb3duIGxpbmtzIChub24taW1hZ2UsIG5vbi1leHRlcm5hbClcblx0XHQvLyBPbmx5IHByb2Nlc3MgbGlua3MgdGhhdCBjb250YWluIC5tZCBvciAubWR4IHRvIGF2b2lkIHByb2Nlc3NpbmcgYWxyZWFkeS1jb252ZXJ0ZWQgbGlua3Ncblx0XHRuZXdDb250ZW50ID0gbmV3Q29udGVudC5yZXBsYWNlKFxuXHRcdFx0L1xcWyhbXlxcXV0rKVxcXVxcKChbXildK1xcLihtZHxtZHgpW14pXSopXFwpL2csXG5cdFx0XHQobWF0Y2g6IHN0cmluZywgZGlzcGxheVRleHQ6IHN0cmluZywgbGluazogc3RyaW5nKSA9PiB7XG5cdFx0XHRcdC8vIENoZWNrIGlmIGl0J3MgYW4gaW1hZ2UgbGluayBvciBleHRlcm5hbCBsaW5rXG5cdFx0XHRcdGlmIChsaW5rLm1hdGNoKC9eaHR0cHM/OlxcL1xcLy8pIHx8IGltYWdlRXh0ZW5zaW9ucy50ZXN0KGxpbmspKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGluayk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgZXh0ZXJuYWwgb3IgaW1hZ2UgbGlua3Ncblx0XHRcdFx0fVxuXG5cdFx0XHRcdC8vIENoZWNrIGlmIHdlIGNhbiByZWxpYWJseSBjb252ZXJ0IHRoaXMgbGlua1xuXHRcdFx0XHRpZiAoIWNhbkNvbnZlcnRMaW5rKGxpbmspKSB7XG5cdFx0XHRcdFx0c2tpcHBlZENvdW50Kys7XG5cdFx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2gobGluayk7XG5cdFx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBSZXR1cm4gb3JpZ2luYWwgaWYgd2UgY2FuJ3QgY29udmVydCByZWxpYWJseVxuXHRcdFx0XHR9XG5cblx0XHRcdFx0Y29uc3QgdXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmtXaXRoQ29udGV4dChsaW5rLCBmaWxlLnBhdGgsIGN1cnJlbnRGaWxlQ29udGVudFR5cGUpO1xuXG5cdFx0XHRcdGNvbnZlcnRlZENvdW50Kys7XG5cdFx0XHRcdHJldHVybiBgWyR7ZGlzcGxheVRleHR9XSgke3VybH0pYDtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0Ly8gSGFuZGxlIGltYWdlIGxpbmtzIGluIE1hcmtkb3duIGZvcm1hdCAoZS5nLiwgIVtJbWFnZV0obW91bnRhaW5zLnBuZykpXG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZShcblx0XHRcdC8hXFxbKC4qPylcXF1cXCgoW14pXSspXFwpL2csXG5cdFx0XHQobWF0Y2g6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0cmV0dXJuIG1hdGNoOyAvLyBJZ25vcmUgYWxsIGltYWdlIGxpbmtzXG5cdFx0XHR9XG5cdFx0KTtcblxuXHRcdC8vIEhhbmRsZSB7e2VtYmVkfX0gc3ludGF4XG5cdFx0bmV3Q29udGVudCA9IG5ld0NvbnRlbnQucmVwbGFjZSgvXFx7XFx7KFtefV0rKVxcfVxcfS9nLCAobWF0Y2g6IHN0cmluZywgZmlsZU5hbWU6IHN0cmluZykgPT4ge1xuXHRcdFx0aWYgKGltYWdlRXh0ZW5zaW9ucy50ZXN0KGZpbGVOYW1lKSkge1xuXHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2goZmlsZU5hbWUpO1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIElnbm9yZSBlbWJlZGRlZCBpbWFnZXNcblx0XHRcdH1cblxuXHRcdFx0Ly8gQ2hlY2sgaWYgd2UgY2FuIHJlbGlhYmx5IGNvbnZlcnQgdGhpcyBsaW5rXG5cdFx0XHRpZiAoIWNhbkNvbnZlcnRMaW5rKGZpbGVOYW1lKSkge1xuXHRcdFx0XHRza2lwcGVkQ291bnQrKztcblx0XHRcdFx0c2tpcHBlZExpbmtzLnB1c2goZmlsZU5hbWUpO1xuXHRcdFx0XHRyZXR1cm4gbWF0Y2g7IC8vIFJldHVybiBvcmlnaW5hbCBpZiB3ZSBjYW4ndCBjb252ZXJ0IHJlbGlhYmx5XG5cdFx0XHR9XG5cblx0XHRcdGNvbnN0IHVybCA9IHRoaXMuZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rV2l0aENvbnRleHQoZmlsZU5hbWUsIGZpbGUucGF0aCwgY3VycmVudEZpbGVDb250ZW50VHlwZSk7XG5cblx0XHRcdGNvbnZlcnRlZENvdW50Kys7XG5cdFx0XHRyZXR1cm4gYFtFbWJlZGRlZDogJHtmaWxlTmFtZX1dKCR7dXJsfSlgO1xuXHRcdH0pO1xuXG5cdFx0ZWRpdG9yLnNldFZhbHVlKG5ld0NvbnRlbnQpO1xuXG5cdFx0Ly8gUmVzdG9yZSBjdXJzb3IgcG9zaXRpb24sIGFkanVzdGluZyBmb3IgY29udGVudCBjaGFuZ2VzXG5cdFx0Y29uc3QgbmV3TGluZUNvdW50ID0gbmV3Q29udGVudC5zcGxpdCgnXFxuJykubGVuZ3RoO1xuXHRcdGNvbnN0IG5ld0xpbmVMZW5ndGggPSBuZXdDb250ZW50LnNwbGl0KCdcXG4nKVtvcmlnaW5hbExpbmVdPy5sZW5ndGggfHwgMDtcblxuXHRcdC8vIENhbGN1bGF0ZSBuZXcgY3Vyc29yIHBvc2l0aW9uXG5cdFx0bGV0IG5ld0xpbmUgPSBvcmlnaW5hbExpbmU7XG5cdFx0bGV0IG5ld0NoID0gb3JpZ2luYWxDaDtcblxuXHRcdC8vIElmIGNvbnRlbnQgbGVuZ3RoIGNoYW5nZWQsIGFkanVzdCBjdXJzb3IgcG9zaXRpb25cblx0XHRpZiAobmV3TGluZUNvdW50ICE9PSBvcmlnaW5hbExpbmVDb3VudCkge1xuXHRcdFx0Ly8gSWYgbGluZXMgd2VyZSBhZGRlZC9yZW1vdmVkIGJlZm9yZSBjdXJzb3IsIGFkanVzdCBsaW5lIG51bWJlclxuXHRcdFx0Ly8gRm9yIHNpbXBsaWNpdHksIGtlZXAgc2FtZSBsaW5lIGlmIGl0IHN0aWxsIGV4aXN0cywgb3RoZXJ3aXNlIGNsYW1wIHRvIGVuZFxuXHRcdFx0aWYgKG5ld0xpbmUgPj0gbmV3TGluZUNvdW50KSB7XG5cdFx0XHRcdG5ld0xpbmUgPSBNYXRoLm1heCgwLCBuZXdMaW5lQ291bnQgLSAxKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBBZGp1c3QgY29sdW1uIHBvc2l0aW9uIGlmIGxpbmUgbGVuZ3RoIGNoYW5nZWRcblx0XHRpZiAobmV3TGluZUxlbmd0aCAhPT0gb3JpZ2luYWxMaW5lTGVuZ3RoKSB7XG5cdFx0XHQvLyBJZiBsaW5lIGdvdCBzaG9ydGVyLCBjbGFtcCB0byBlbmQgb2YgbGluZVxuXHRcdFx0aWYgKG5ld0NoID4gbmV3TGluZUxlbmd0aCkge1xuXHRcdFx0XHRuZXdDaCA9IE1hdGgubWF4KDAsIG5ld0xpbmVMZW5ndGgpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFJlc3RvcmUgY3Vyc29yIHBvc2l0aW9uXG5cdFx0ZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IG5ld0xpbmUsIGNoOiBuZXdDaCB9KTtcblxuXHRcdC8vIFNob3cgYXBwcm9wcmlhdGUgbm90aWNlIGJhc2VkIG9uIHJlc3VsdHNcblx0XHRpZiAoY29udmVydGVkQ291bnQgPiAwICYmIHNraXBwZWRDb3VudCA9PT0gMCkge1xuXHRcdFx0bmV3IE5vdGljZShgQ29udmVydGVkICR7Y29udmVydGVkQ291bnR9IGludGVybmFsIGxpbmske2NvbnZlcnRlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBmb3IgQXN0cm8uYCk7XG5cdFx0fSBlbHNlIGlmIChjb252ZXJ0ZWRDb3VudCA+IDAgJiYgc2tpcHBlZENvdW50ID4gMCkge1xuXHRcdFx0bmV3IE5vdGljZShgQ29udmVydGVkICR7Y29udmVydGVkQ291bnR9IGxpbmske2NvbnZlcnRlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBmb3IgQXN0cm8uIFNraXBwZWQgJHtza2lwcGVkQ291bnR9IGxpbmske3NraXBwZWRDb3VudCA+IDEgPyAncycgOiAnJ30gb3V0c2lkZSBjb25maWd1cmVkIGNvbnRlbnQgZGlyZWN0b3JpZXMuYCk7XG5cdFx0fSBlbHNlIGlmIChza2lwcGVkQ291bnQgPiAwKSB7XG5cdFx0XHRuZXcgTm90aWNlKGBObyBsaW5rcyBjb252ZXJ0ZWQuIEFsbCAke3NraXBwZWRDb3VudH0gbGluayR7c2tpcHBlZENvdW50ID4gMSA/ICdzJyA6ICcnfSBhcmUgb3V0c2lkZSBjb25maWd1cmVkIGNvbnRlbnQgZGlyZWN0b3JpZXMgb3IgYXJlIGltYWdlcy9leHRlcm5hbCBsaW5rcy5gKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV3IE5vdGljZShcIk5vIGludGVybmFsIGxpbmtzIGZvdW5kIHRvIGNvbnZlcnQuXCIpO1xuXHRcdH1cblx0fVxufVxuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFRGaWxlLCBOb3RpY2UsIFBsYXRmb3JtLCBNYXJrZG93blZpZXcgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UsIENvbnRlbnRUeXBlSWQgfSBmcm9tIFwiLi4vdHlwZXNcIjtcbmltcG9ydCB7IEZpbGVPcGVyYXRpb25zIH0gZnJvbSBcIi4uL3V0aWxzL2ZpbGUtb3BlcmF0aW9uc1wiO1xuaW1wb3J0IHsgVGVtcGxhdGVQYXJzZXIgfSBmcm9tIFwiLi4vdXRpbHMvdGVtcGxhdGUtcGFyc2luZ1wiO1xuaW1wb3J0IHsgdG9LZWJhYkNhc2UgfSBmcm9tIFwiLi4vdXRpbHMvc3RyaW5nLXV0aWxzXCI7XG5cbmV4cG9ydCBjbGFzcyBUaXRsZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRmaWxlOiBURmlsZSB8IG51bGw7XG5cdHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZTtcblx0dHlwZTogQ29udGVudFR5cGVJZDtcblx0aXNSZW5hbWU6IGJvb2xlYW47XG5cdGlzTmV3Tm90ZTogYm9vbGVhbjtcblx0dGl0bGVJbnB1dCE6IEhUTUxJbnB1dEVsZW1lbnQ7XG5cdHByaXZhdGUgZmlsZU9wczogRmlsZU9wZXJhdGlvbnM7XG5cdHByaXZhdGUgdGVtcGxhdGVQYXJzZXI6IFRlbXBsYXRlUGFyc2VyO1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBmaWxlOiBURmlsZSB8IG51bGwsIHBsdWdpbjogQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgdHlwZTogQ29udGVudFR5cGVJZCwgaXNSZW5hbWUgPSBmYWxzZSwgaXNOZXdOb3RlID0gZmFsc2UpIHtcblx0XHRzdXBlcihhcHApO1xuXHRcdHRoaXMuZmlsZSA9IGZpbGU7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy50eXBlID0gdHlwZTtcblx0XHR0aGlzLmlzUmVuYW1lID0gaXNSZW5hbWU7XG5cdFx0dGhpcy5pc05ld05vdGUgPSBpc05ld05vdGU7XG5cblx0XHQvLyBJbml0aWFsaXplIHV0aWxpdGllcyB3aXRoIGN1cnJlbnQgc2V0dGluZ3Ncblx0XHQvLyBGaWxlT3BlcmF0aW9ucyB3aWxsIGdldCBmcmVzaCBzZXR0aW5ncyBmcm9tIHBsdWdpbiBkeW5hbWljYWxseVxuXHRcdGNvbnN0IHNldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzO1xuXHRcdHRoaXMuZmlsZU9wcyA9IG5ldyBGaWxlT3BlcmF0aW9ucyhhcHAsIHNldHRpbmdzLCBwbHVnaW4pO1xuXHRcdHRoaXMudGVtcGxhdGVQYXJzZXIgPSBuZXcgVGVtcGxhdGVQYXJzZXIoYXBwLCBzZXR0aW5ncyk7XG5cdH1cblxuXHRhc3luYyBnZXRDdXJyZW50VGl0bGVBc3luYygpOiBQcm9taXNlPHN0cmluZz4ge1xuXHRcdGlmICghdGhpcy5maWxlKSB7XG5cdFx0XHRyZXR1cm4gXCJcIjtcblx0XHR9XG5cblx0XHQvLyBSZWFkIHRoZSBmaWxlIGNvbnRlbnQgZGlyZWN0bHkgdG8gZW5zdXJlIHdlIGhhdmUgdGhlIGxhdGVzdCB0aXRsZVxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZCh0aGlzLmZpbGUpO1xuXHRcdFx0Y29uc3QgdGl0bGVLZXkgPSB0aGlzLmZpbGVPcHMuZ2V0VGl0bGVLZXkodGhpcy50eXBlKTtcblx0XHRcdGNvbnN0IHsgcHJvcGVydGllcyB9ID0gdGhpcy50ZW1wbGF0ZVBhcnNlci5wYXJzZUZyb250bWF0dGVyKGNvbnRlbnQpO1xuXG5cdFx0XHRpZiAodGl0bGVLZXkgaW4gcHJvcGVydGllcykge1xuXHRcdFx0XHRjb25zdCB0aXRsZVZhbHVlID0gcHJvcGVydGllc1t0aXRsZUtleV07XG5cdFx0XHRcdGlmIChBcnJheS5pc0FycmF5KHRpdGxlVmFsdWUpICYmIHRpdGxlVmFsdWUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdHJldHVybiBTdHJpbmcodGl0bGVWYWx1ZVswXSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHRpdGxlVmFsdWUgIT09IG51bGwgJiYgdGl0bGVWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0cmV0dXJuIFN0cmluZyh0aXRsZVZhbHVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0gY2F0Y2ggKGVycm9yKSB7XG5cdFx0XHRjb25zb2xlLmVycm9yKFwiRXJyb3IgcmVhZGluZyBmaWxlIGZvciB0aXRsZTpcIiwgZXJyb3IpO1xuXHRcdH1cblxuXHRcdC8vIEZhbGwgYmFjayB0byBmaWxlbmFtZS1iYXNlZCB0aXRsZVxuXHRcdHJldHVybiB0aGlzLmdldEZhbGxiYWNrVGl0bGUoKTtcblx0fVxuXG5cdGdldEN1cnJlbnRUaXRsZSgpOiBzdHJpbmcge1xuXHRcdGlmICghdGhpcy5maWxlKSB7XG5cdFx0XHRyZXR1cm4gXCJcIjtcblx0XHR9XG5cblx0XHRjb25zdCB0aXRsZUtleSA9IHRoaXMuZmlsZU9wcy5nZXRUaXRsZUtleSh0aGlzLnR5cGUpO1xuXHRcdGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUodGhpcy5maWxlKTtcblxuXHRcdGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIgJiYgdGl0bGVLZXkgaW4gY2FjaGUuZnJvbnRtYXR0ZXIpIHtcblx0XHRcdGNvbnN0IHRpdGxlVmFsdWUgPSBjYWNoZS5mcm9udG1hdHRlclt0aXRsZUtleV0gYXMgdW5rbm93bjtcblx0XHRcdGlmICh0eXBlb2YgdGl0bGVWYWx1ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0cmV0dXJuIHRpdGxlVmFsdWU7XG5cdFx0XHR9XG5cdFx0XHRpZiAoQXJyYXkuaXNBcnJheSh0aXRsZVZhbHVlKSAmJiB0aXRsZVZhbHVlLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0Y29uc3QgZmlyc3RWYWx1ZSA9IHRpdGxlVmFsdWVbMF0gYXMgdW5rbm93bjtcblx0XHRcdFx0aWYgKHR5cGVvZiBmaXJzdFZhbHVlID09PSAnc3RyaW5nJykge1xuXHRcdFx0XHRcdHJldHVybiBmaXJzdFZhbHVlO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChmaXJzdFZhbHVlICE9IG51bGwpIHtcblx0XHRcdFx0XHRpZiAodHlwZW9mIGZpcnN0VmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiBmaXJzdFZhbHVlID09PSAnYm9vbGVhbicpIHtcblx0XHRcdFx0XHRcdHJldHVybiBTdHJpbmcoZmlyc3RWYWx1ZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmICh0eXBlb2YgZmlyc3RWYWx1ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0XHRcdHJldHVybiBmaXJzdFZhbHVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKHRpdGxlVmFsdWUgPT0gbnVsbCkge1xuXHRcdFx0XHRyZXR1cm4gJyc7XG5cdFx0XHR9XG5cdFx0XHRpZiAodHlwZW9mIHRpdGxlVmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiB0aXRsZVZhbHVlID09PSAnYm9vbGVhbicpIHtcblx0XHRcdFx0cmV0dXJuIFN0cmluZyh0aXRsZVZhbHVlKTtcblx0XHRcdH1cblx0XHRcdGlmICh0eXBlb2YgdGl0bGVWYWx1ZSA9PT0gJ3N0cmluZycpIHtcblx0XHRcdFx0cmV0dXJuIHRpdGxlVmFsdWU7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gJyc7XG5cdFx0fVxuXHRcdHJldHVybiB0aGlzLmdldEZhbGxiYWNrVGl0bGUoKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0RmFsbGJhY2tUaXRsZSgpOiBzdHJpbmcge1xuXHRcdGlmICghdGhpcy5maWxlKSB7XG5cdFx0XHRyZXR1cm4gXCJcIjtcblx0XHR9XG5cblx0XHRsZXQgYmFzZW5hbWUgPSB0aGlzLmZpbGUuYmFzZW5hbWU7XG5cdFx0aWYgKHRoaXMuZmlsZS5wYXJlbnQgJiYgdGhpcy50eXBlICE9PSBcIm5vdGVcIikge1xuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRcdGNvbnN0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZT8uaW5kZXhGaWxlTmFtZSB8fCBcIlwiO1xuXHRcdFx0aWYgKGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmIGJhc2VuYW1lID09PSBpbmRleEZpbGVOYW1lKSB7XG5cdFx0XHRcdGJhc2VuYW1lID0gdGhpcy5maWxlLnBhcmVudC5uYW1lO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoYmFzZW5hbWUuc3RhcnRzV2l0aChcIl9cIikpIHtcblx0XHRcdGJhc2VuYW1lID0gYmFzZW5hbWUuc2xpY2UoMSk7XG5cdFx0fVxuXHRcdHJldHVybiBiYXNlbmFtZS5yZXBsYWNlKC8tL2csIFwiIFwiKS5zcGxpdChcIiBcIikubWFwKHdvcmQgPT4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkpLmpvaW4oXCIgXCIpO1xuXHR9XG5cblx0LyoqXG5cdCAqIEV4dHJhY3RzIGEgc3VnZ2VzdGVkIHRpdGxlIGZyb20gdGhlIGZpbGUgYmFzZW5hbWUgZm9yIG5ld2x5IGNyZWF0ZWQgZmlsZXMuXG5cdCAqIFRoaXMgaXMgdXNlZCB3aGVuIGEgZmlsZSBpcyBjcmVhdGVkIGZyb20gYSBsaW5rIChlLmcuLCBbW3NFZnNsZWlmXV0pLlxuXHQgKiBQcmVzZXJ2ZXMgdGhlIG9yaWdpbmFsIHRleHQgYXMgbXVjaCBhcyBwb3NzaWJsZS5cblx0ICovXG5cdGdldFN1Z2dlc3RlZFRpdGxlRnJvbUJhc2VuYW1lKCk6IHN0cmluZyB7XG5cdFx0aWYgKCF0aGlzLmZpbGUpIHtcblx0XHRcdHJldHVybiBcIlwiO1xuXHRcdH1cblxuXHRcdGxldCBiYXNlbmFtZSA9IHRoaXMuZmlsZS5iYXNlbmFtZTtcblxuXHRcdC8vIEhhbmRsZSBpbmRleCBmaWxlIG5hbWVzIC0gdXNlIHBhcmVudCBmb2xkZXIgbmFtZSBpbnN0ZWFkXG5cdFx0aWYgKHRoaXMuZmlsZS5wYXJlbnQgJiYgdGhpcy50eXBlICE9PSBcIm5vdGVcIikge1xuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRcdGNvbnN0IGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZT8uaW5kZXhGaWxlTmFtZSB8fCBcIlwiO1xuXHRcdFx0aWYgKGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiICYmIGJhc2VuYW1lID09PSBpbmRleEZpbGVOYW1lKSB7XG5cdFx0XHRcdGJhc2VuYW1lID0gdGhpcy5maWxlLnBhcmVudC5uYW1lO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFJlbW92ZSBsZWFkaW5nIHVuZGVyc2NvcmUgaWYgcHJlc2VudFxuXHRcdGlmIChiYXNlbmFtZS5zdGFydHNXaXRoKFwiX1wiKSkge1xuXHRcdFx0YmFzZW5hbWUgPSBiYXNlbmFtZS5zbGljZSgxKTtcblx0XHR9XG5cblx0XHQvLyBSZXR1cm4gdGhlIGJhc2VuYW1lIGFzLWlzIHRvIHByZXNlcnZlIHVzZXIncyBvcmlnaW5hbCBpbnB1dFxuXHRcdC8vIChlLmcuLCBcInNFZnNsZWlmXCIgc3RheXMgYXMgXCJzRWZzbGVpZlwiKVxuXHRcdHJldHVybiBiYXNlbmFtZTtcblx0fVxuXG5cdG9uT3BlbigpIHtcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcblxuXHRcdC8vIEFkZCBtb2JpbGUtZnJpZW5kbHkgcG9zaXRpb25pbmcgY2xhc3MgLSBjaGVjayBib3RoIHdpZHRoIGFuZCBwbGF0Zm9ybVxuXHRcdGNvbnN0IGlzTW9iaWxlID0gd2luZG93LmlubmVyV2lkdGggPD0gNzY4IHx8IFBsYXRmb3JtLmlzTW9iaWxlO1xuXHRcdGlmIChpc01vYmlsZSkge1xuXHRcdFx0dGhpcy5tb2RhbEVsLmFkZENsYXNzKCdhc3Ryby1jb21wb3Nlci1tb2JpbGUtbW9kYWwnKTtcblx0XHR9XG5cblx0XHRpZiAodGhpcy5pc1JlbmFtZSkge1xuXHRcdFx0Y29uc3QgdHlwZU5hbWUgPSB0aGlzLmdldFR5cGVEaXNwbGF5TmFtZSgpO1xuXG5cdFx0XHRpZiAodGhpcy50eXBlID09PSBcIm5vdGVcIikge1xuXHRcdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3RlcyBvdXRzaWRlIG9mIGFueSBrbm93biBjb250ZW50IHR5cGVcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBcIlJlbmFtZSBjb250ZW50XCIgfSk7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiBcIkVudGVyIGEgdGl0bGUgZm9yIHRoaXMgY29udGVudDpcIiB9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogYFJlbmFtZSAke3R5cGVOYW1lfSBjb250ZW50YCB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IGBFbnRlciBuZXcgdGl0bGUgZm9yIHlvdXIgJHt0eXBlTmFtZX0gY29udGVudDpgIH0pO1xuXHRcdFx0fVxuXG5cdFx0XHR0aGlzLnRpdGxlSW5wdXQgPSBjb250ZW50RWwuY3JlYXRlRWwoXCJpbnB1dFwiLCB7XG5cdFx0XHRcdHR5cGU6IFwidGV4dFwiLFxuXHRcdFx0XHRwbGFjZWhvbGRlcjogXCJOZXcgVGl0bGVcIixcblx0XHRcdFx0Y2xzOiBcImFzdHJvLWNvbXBvc2VyLXRpdGxlLWlucHV0XCJcblx0XHRcdH0pO1xuXG5cdFx0XHQvLyBBc3luYyBsb2FkIHRoZSBjdXJyZW50IHRpdGxlIGZyb20gZmlsZVxuXHRcdFx0dm9pZCB0aGlzLmdldEN1cnJlbnRUaXRsZUFzeW5jKCkudGhlbih0aXRsZSA9PiB7XG5cdFx0XHRcdHRoaXMudGl0bGVJbnB1dC52YWx1ZSA9IHRpdGxlO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmICh0aGlzLmlzTmV3Tm90ZSkge1xuXHRcdFx0Y29uc3QgdHlwZU5hbWUgPSB0aGlzLmdldFR5cGVEaXNwbGF5TmFtZSgpO1xuXG5cdFx0XHRpZiAodGhpcy50eXBlID09PSBcIm5vdGVcIikge1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IFwiTmV3IGNvbnRlbnRcIiB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IFwiRW50ZXIgYSB0aXRsZSBmb3IgdGhpcyBjb250ZW50OlwiIH0pO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwiaDJcIiwgeyB0ZXh0OiBgQ3JlYXRlIG5ldyAke3R5cGVOYW1lfSBjb250ZW50YCB9KTtcblx0XHRcdFx0Y29udGVudEVsLmNyZWF0ZUVsKFwicFwiLCB7IHRleHQ6IGBFbnRlciBhIHRpdGxlIGZvciB5b3VyIG5ldyAke3R5cGVOYW1lfSBjb250ZW50OmAgfSk7XG5cdFx0XHR9XG5cblx0XHRcdHRoaXMudGl0bGVJbnB1dCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcImlucHV0XCIsIHtcblx0XHRcdFx0dHlwZTogXCJ0ZXh0XCIsXG5cdFx0XHRcdHBsYWNlaG9sZGVyOiBcIk5ldyBUaXRsZVwiLFxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItdGl0bGUtaW5wdXRcIlxuXHRcdFx0fSk7XG5cdFx0XHQvLyBMZWF2ZSBpbnB1dCBlbXB0eSBmb3IgbmV3IG5vdGVzIC0gdXNlciBjYW4gdHlwZSBkaXJlY3RseVxuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCB0eXBlTmFtZSA9IHRoaXMuZ2V0VHlwZURpc3BsYXlOYW1lKCk7XG5cblx0XHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJOZXcgY29udGVudFwiIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogXCJFbnRlciBhIHRpdGxlIGZvciB0aGlzIGNvbnRlbnQ6XCIgfSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJoMlwiLCB7IHRleHQ6IGBDcmVhdGUgbmV3ICR7dHlwZU5hbWV9IGNvbnRlbnRgIH0pO1xuXHRcdFx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHsgdGV4dDogYEVudGVyIGEgdGl0bGUgZm9yIHlvdXIgbmV3ICR7dHlwZU5hbWV9IGNvbnRlbnQ6YCB9KTtcblx0XHRcdH1cblxuXHRcdFx0dGhpcy50aXRsZUlucHV0ID0gY29udGVudEVsLmNyZWF0ZUVsKFwiaW5wdXRcIiwge1xuXHRcdFx0XHR0eXBlOiBcInRleHRcIixcblx0XHRcdFx0cGxhY2Vob2xkZXI6IFwiTmV3IFRpdGxlXCIsXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci10aXRsZS1pbnB1dFwiXG5cdFx0XHR9KTtcblx0XHRcdC8vIFByZS1wb3B1bGF0ZSB3aXRoIHN1Z2dlc3RlZCB0aXRsZSBmcm9tIGJhc2VuYW1lIGlmIGF2YWlsYWJsZVxuXHRcdFx0Ly8gVGhpcyBoYW5kbGVzIGZpbGVzIGNyZWF0ZWQgZnJvbSBsaW5rcyAoZS5nLiwgW1tzRWZzbGVpZl1dKVxuXHRcdFx0aWYgKHRoaXMuZmlsZSkge1xuXHRcdFx0XHRjb25zdCBzdWdnZXN0ZWRUaXRsZSA9IHRoaXMuZ2V0U3VnZ2VzdGVkVGl0bGVGcm9tQmFzZW5hbWUoKTtcblx0XHRcdFx0aWYgKHN1Z2dlc3RlZFRpdGxlKSB7XG5cdFx0XHRcdFx0dGhpcy50aXRsZUlucHV0LnZhbHVlID0gc3VnZ2VzdGVkVGl0bGU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy50aXRsZUlucHV0LmZvY3VzKCk7XG5cdFx0Ly8gRm9yIG5ldyBub3RlcywgZW5zdXJlIGN1cnNvciBpcyBhdCB0aGUgc3RhcnQgKHBvc2l0aW9uIDApXG5cdFx0aWYgKHRoaXMuaXNOZXdOb3RlKSB7XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0dGhpcy50aXRsZUlucHV0LnNldFNlbGVjdGlvblJhbmdlKDAsIDApO1xuXHRcdFx0fSwgMCk7XG5cdFx0fVxuXG5cdFx0Y29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1idXR0b24tY29udGFpbmVyXCIgfSk7XG5cblx0XHRjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwgeyB0ZXh0OiBcIkNhbmNlbFwiLCBjbHM6IFwiYXN0cm8tY29tcG9zZXItY2FuY2VsLWJ1dHRvblwiIH0pO1xuXHRcdGNhbmNlbEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gdGhpcy5jbG9zZSgpO1xuXG5cdFx0Y29uc3Qgc3VibWl0QnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHsgdGV4dDogdGhpcy5pc1JlbmFtZSA/IFwiUmVuYW1lXCIgOiBcIkNyZWF0ZVwiLCBjbHM6IFtcImFzdHJvLWNvbXBvc2VyLWNyZWF0ZS1idXR0b25cIiwgXCJtb2QtY3RhXCJdIH0pO1xuXHRcdHN1Ym1pdEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4gdGhpcy5zdWJtaXQoKTtcblxuXHRcdHRoaXMudGl0bGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKFwia2V5cHJlc3NcIiwgKGUpID0+IHtcblx0XHRcdGlmIChlLmtleSA9PT0gXCJFbnRlclwiKSB2b2lkIHRoaXMuc3VibWl0KCk7XG5cdFx0fSk7XG5cdH1cblxuXHRhc3luYyBzdWJtaXQoKSB7XG5cdFx0Y29uc3QgdGl0bGUgPSB0aGlzLnRpdGxlSW5wdXQudmFsdWUudHJpbSgpO1xuXG5cdFx0aWYgKCF0aXRsZSkge1xuXHRcdFx0bmV3IE5vdGljZShcIlBsZWFzZSBlbnRlciBhIHRpdGxlLlwiKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0cnkge1xuXHRcdFx0bGV0IG5ld0ZpbGU6IFRGaWxlIHwgbnVsbCA9IG51bGw7XG5cdFx0XHRpZiAodGhpcy5pc1JlbmFtZSkge1xuXHRcdFx0XHRuZXdGaWxlID0gYXdhaXQgdGhpcy5maWxlT3BzLnJlbmFtZUZpbGUoeyBmaWxlOiB0aGlzLmZpbGUhLCB0aXRsZSwgdHlwZTogdGhpcy50eXBlIH0pO1xuXG5cdFx0XHRcdGlmIChuZXdGaWxlKSB7XG5cdFx0XHRcdFx0YXdhaXQgdGhpcy50ZW1wbGF0ZVBhcnNlci51cGRhdGVUaXRsZUluRnJvbnRtYXR0ZXIobmV3RmlsZSwgdGl0bGUsIHRoaXMudHlwZSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0Ly8gcmVuYW1lRmlsZSBhbHJlYWR5IHNob3dlZCBhbiBlcnJvciBub3RpY2UsIGNsb3NlIG1vZGFsIGFuZCByZXR1cm5cblx0XHRcdFx0XHR0aGlzLmNsb3NlKCk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2UgaWYgKHRoaXMuaXNOZXdOb3RlKSB7XG5cdFx0XHRcdC8vIFByb2Nlc3MgdGhlIFwiVW50aXRsZWRcIiBmaWxlIC0gcmVuYW1lIGl0IGFuZCBhZGQgcHJvcGVydGllc1xuXHRcdFx0XHQvLyBUaGlzIHJlc3BlY3RzIGNyZWF0aW9uTW9kZSAoZm9sZGVyIHZzIGZpbGUpIGFuZCBkb2Vzbid0IHJlcXVpcmUgZGVsZXRpb25cblx0XHRcdFx0aWYgKHRoaXMuZmlsZSkge1xuXHRcdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmZpbGVPcHMuY3JlYXRlRmlsZSh7IGZpbGU6IHRoaXMuZmlsZSwgdGl0bGUsIHR5cGU6IHRoaXMudHlwZSB9KTtcblx0XHRcdFx0XHQvLyBBbHdheXMgaW5zZXJ0IHByb3BlcnRpZXMgd2hlbiBhdXRvSW5zZXJ0UHJvcGVydGllcyBpcyBlbmFibGVkXG5cdFx0XHRcdFx0Y29uc3Qgc2hvdWxkSW5zZXJ0UHJvcGVydGllcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzO1xuXG5cdFx0XHRcdFx0aWYgKG5ld0ZpbGUgJiYgc2hvdWxkSW5zZXJ0UHJvcGVydGllcykge1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5hZGRQcm9wZXJ0aWVzVG9GaWxlKG5ld0ZpbGUsIHRpdGxlLCB0aGlzLnR5cGUpO1xuXHRcdFx0XHRcdFx0Ly8gUG9zaXRpb24gY3Vyc29yIGF0IGVuZCBhZnRlciBwcm9wZXJ0aWVzIGFyZSBhZGRlZFxuXHRcdFx0XHRcdFx0dGhpcy5wb3NpdGlvbkN1cnNvckF0RW5kKG5ld0ZpbGUpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIGlmICh0aGlzLmZpbGUpIHtcblx0XHRcdFx0Ly8gV2UgaGF2ZSBhbiBleGlzdGluZyBmaWxlLCBwcm9jZXNzIGl0XG5cdFx0XHRcdG5ld0ZpbGUgPSBhd2FpdCB0aGlzLmZpbGVPcHMuY3JlYXRlRmlsZSh7IGZpbGU6IHRoaXMuZmlsZSwgdGl0bGUsIHR5cGU6IHRoaXMudHlwZSB9KTtcblx0XHRcdFx0Ly8gQWx3YXlzIGluc2VydCBwcm9wZXJ0aWVzIHdoZW4gYXV0b0luc2VydFByb3BlcnRpZXMgaXMgZW5hYmxlZFxuXHRcdFx0XHRjb25zdCBzaG91bGRJbnNlcnRQcm9wZXJ0aWVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXM7XG5cblx0XHRcdFx0aWYgKG5ld0ZpbGUgJiYgc2hvdWxkSW5zZXJ0UHJvcGVydGllcykge1xuXHRcdFx0XHRcdGF3YWl0IHRoaXMuYWRkUHJvcGVydGllc1RvRmlsZShuZXdGaWxlLCB0aXRsZSwgdGhpcy50eXBlKTtcblx0XHRcdFx0XHQvLyBQb3NpdGlvbiBjdXJzb3IgYXQgZW5kIGFmdGVyIHByb3BlcnRpZXMgYXJlIGFkZGVkXG5cdFx0XHRcdFx0dGhpcy5wb3NpdGlvbkN1cnNvckF0RW5kKG5ld0ZpbGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBGYWxsYmFjayAtIGNyZWF0ZSBuZXcgZmlsZVxuXHRcdFx0XHRuZXdGaWxlID0gYXdhaXQgdGhpcy5jcmVhdGVOZXdGaWxlKHRpdGxlKTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKCFuZXdGaWxlKSB7XG5cdFx0XHRcdG5ldyBOb3RpY2UoYEZhaWxlZCB0byAke3RoaXMuaXNSZW5hbWUgPyBcInJlbmFtZVwiIDogXCJjcmVhdGVcIn0gJHt0aGlzLnR5cGV9LmApO1xuXHRcdFx0XHR0aGlzLmNsb3NlKCk7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc29sZS5lcnJvcignVGl0bGVNb2RhbDogRXJyb3IgZHVyaW5nIHByb2Nlc3M6JywgZXJyb3IpO1xuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0bmV3IE5vdGljZShgRXJyb3IgJHt0aGlzLmlzUmVuYW1lID8gXCJyZW5hbWluZ1wiIDogXCJjcmVhdGluZ1wifSAke3RoaXMudHlwZX06ICR7ZXJyb3JNZXNzYWdlfS5gKTtcblx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR0aGlzLmNsb3NlKCk7XG5cdH1cblxuXHRwcml2YXRlIGdldFR5cGVEaXNwbGF5TmFtZSgpOiBzdHJpbmcge1xuXHRcdGlmICh0aGlzLnR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHRyZXR1cm4gXCJDb250ZW50XCI7XG5cdFx0fVxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5maWxlT3BzLmdldENvbnRlbnRUeXBlKHRoaXMudHlwZSk7XG5cdFx0cmV0dXJuIGNvbnRlbnRUeXBlID8gY29udGVudFR5cGUubmFtZSA6IFwiQ29udGVudFwiO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBjcmVhdGVOZXdGaWxlKHRpdGxlOiBzdHJpbmcpOiBQcm9taXNlPFRGaWxlIHwgbnVsbD4ge1xuXHRcdC8vIERldGVybWluZSB0aGUgYXBwcm9wcmlhdGUgZm9sZGVyIGJhc2VkIG9uIHdoZXJlIHRoZSB1c2VyIGNyZWF0ZWQgdGhlIGZpbGVcblx0XHRsZXQgdGFyZ2V0Rm9sZGVyOiBzdHJpbmc7XG5cblx0XHQvLyBHZXQgdGhlIGRpcmVjdG9yeSB3aGVyZSB0aGUgdXNlciBjcmVhdGVkIHRoZSBmaWxlXG5cdFx0Y29uc3Qgb3JpZ2luYWxEaXIgPSB0aGlzLmZpbGU/LnBhcmVudD8ucGF0aCB8fCBcIlwiO1xuXG5cdFx0aWYgKHRoaXMudHlwZSAhPT0gXCJub3RlXCIpIHtcblx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5maWxlT3BzLmdldENvbnRlbnRUeXBlKHRoaXMudHlwZSk7XG5cdFx0XHQvLyBGb3IgY29udGVudCB0eXBlcywgcmVzcGVjdCB0aGUgdXNlcidzIGNob3NlbiBsb2NhdGlvbiAoc3ViZm9sZGVyKVxuXHRcdFx0Ly8gT25seSB1c2UgdGhlIGNvbmZpZ3VyZWQgZm9sZGVyIGlmIHRoZSB1c2VyIGNyZWF0ZWQgdGhlIGZpbGUgaW4gdGhlIHZhdWx0IHJvb3Rcblx0XHRcdGlmIChvcmlnaW5hbERpciA9PT0gXCJcIiB8fCBvcmlnaW5hbERpciA9PT0gXCIvXCIpIHtcblx0XHRcdFx0dGFyZ2V0Rm9sZGVyID0gY29udGVudFR5cGU/LmZvbGRlciB8fCBcIlwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGFyZ2V0Rm9sZGVyID0gb3JpZ2luYWxEaXI7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIEZvciBub3RlcywgdXNlIHRoZSBvcmlnaW5hbCBkaXJlY3Rvcnlcblx0XHRcdHRhcmdldEZvbGRlciA9IG9yaWdpbmFsRGlyO1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSB0aGUgZmlsZW5hbWUgZnJvbSB0aGUgdGl0bGVcblx0XHRjb25zdCBmaWxlbmFtZSA9IHRoaXMuZmlsZU9wcy5nZW5lcmF0ZUZpbGVuYW1lKHRpdGxlKTtcblx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0aGlzLnR5cGUpO1xuXHRcdGNvbnN0IGV4dGVuc2lvbiA9IGNvbnRlbnRUeXBlPy51c2VNZHhFeHRlbnNpb24gPyBcIi5tZHhcIiA6IFwiLm1kXCI7XG5cdFx0Y29uc3QgZmlsZVBhdGggPSB0YXJnZXRGb2xkZXIgPyBgJHt0YXJnZXRGb2xkZXJ9LyR7ZmlsZW5hbWV9JHtleHRlbnNpb259YCA6IGAke2ZpbGVuYW1lfSR7ZXh0ZW5zaW9ufWA7XG5cblx0XHQvLyBUcmFjayB0aGF0IHRoaXMgZmlsZSB3aWxsIGJlIGNyZWF0ZWQgYnkgdGhlIHBsdWdpbiBCRUZPUkUgY3JlYXRpbmcgaXRcblx0XHQvLyBUaGlzIHByZXZlbnRzIHRoZSBjcmVhdGUgZXZlbnQgZnJvbSB0cmlnZ2VyaW5nIGFub3RoZXIgbW9kYWxcblx0XHRpZiAodGhpcy5wbHVnaW4pIHtcblx0XHRcdHRoaXMucGx1Z2luLnBsdWdpbkNyZWF0ZWRGaWxlcy5zZXQoZmlsZVBhdGgsIERhdGUubm93KCkpO1xuXHRcdH1cblxuXHRcdC8vIENyZWF0ZSB0aGUgZmlsZSB3aXRoIGluaXRpYWwgY29udGVudFxuXHRcdGxldCBpbml0aWFsQ29udGVudCA9IFwiXCI7XG5cdFx0Ly8gQWx3YXlzIGluc2VydCBwcm9wZXJ0aWVzIHdoZW4gYXV0b0luc2VydFByb3BlcnRpZXMgaXMgZW5hYmxlZFxuXHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5hdXRvSW5zZXJ0UHJvcGVydGllcykge1xuXHRcdFx0aW5pdGlhbENvbnRlbnQgPSB0aGlzLmdlbmVyYXRlSW5pdGlhbENvbnRlbnQodGl0bGUpO1xuXHRcdH1cblxuXHRcdHRyeSB7XG5cdFx0XHRjb25zdCBuZXdGaWxlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKGZpbGVQYXRoLCBpbml0aWFsQ29udGVudCk7XG5cblx0XHRcdC8vIE9wZW4gdGhlIG5ldyBmaWxlXG5cdFx0XHRjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKTtcblx0XHRcdGF3YWl0IGxlYWYub3BlbkZpbGUobmV3RmlsZSk7XG5cblx0XHRcdC8vIFBvc2l0aW9uIGN1cnNvciBhdCB0aGUgZW5kIG9mIGNvbnRlbnQgYWZ0ZXIgZWRpdG9yIGlzIHJlYWR5XG5cdFx0XHQvLyBVc2UgbXVsdGlwbGUgYXR0ZW1wdHMgdG8gZW5zdXJlIGl0IHdvcmtzIGV2ZW4gaWYgZWRpdG9yIGlzbid0IHJlYWR5IGltbWVkaWF0ZWx5XG5cdFx0XHRjb25zdCBwb3NpdGlvbkN1cnNvciA9ICgpID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IGxlYWYudmlldztcblx0XHRcdFx0aWYgKHZpZXcgaW5zdGFuY2VvZiBNYXJrZG93blZpZXcgJiYgdmlldy5lZGl0b3IpIHtcblx0XHRcdFx0XHRjb25zdCBlZGl0b3IgPSB2aWV3LmVkaXRvcjtcblx0XHRcdFx0XHRjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG5cdFx0XHRcdFx0aWYgKGNvbnRlbnQpIHtcblx0XHRcdFx0XHRcdGNvbnN0IGxpbmVzID0gY29udGVudC5zcGxpdCgnXFxuJyk7XG5cdFx0XHRcdFx0XHRjb25zdCBsYXN0TGluZSA9IGxpbmVzLmxlbmd0aCAtIDE7XG5cdFx0XHRcdFx0XHRjb25zdCBsYXN0TGluZUxlbmd0aCA9IGxpbmVzW2xhc3RMaW5lXT8ubGVuZ3RoIHx8IDA7XG5cdFx0XHRcdFx0XHRlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogbGFzdExpbmUsIGNoOiBsYXN0TGluZUxlbmd0aCB9KTtcblx0XHRcdFx0XHRcdC8vIEZvY3VzIHRoZSBlZGl0b3IgdG8gZW5zdXJlIGN1cnNvciBpcyB2aXNpYmxlIGFuZCBmaWxlbmFtZSBpc24ndCBzZWxlY3RlZFxuXHRcdFx0XHRcdFx0ZWRpdG9yLmZvY3VzKCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0fTtcblxuXHRcdFx0Ly8gVHJ5IGltbWVkaWF0ZWx5XG5cdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0aWYgKCFwb3NpdGlvbkN1cnNvcigpKSB7XG5cdFx0XHRcdFx0Ly8gSWYgaXQgZGlkbid0IHdvcmssIHRyeSBhZ2FpbiBhZnRlciBhIGxvbmdlciBkZWxheVxuXHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xuXHRcdFx0XHRcdFx0cG9zaXRpb25DdXJzb3IoKTtcblx0XHRcdFx0XHR9LCAyMDApO1xuXHRcdFx0XHR9XG5cdFx0XHR9LCAxMDApO1xuXG5cdFx0XHRyZXR1cm4gbmV3RmlsZTtcblx0XHR9IGNhdGNoIChlcnJvcikge1xuXHRcdFx0Y29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gY3JlYXRlIGZpbGU6ICR7ZXJyb3JNZXNzYWdlfWApO1xuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgZ2VuZXJhdGVJbml0aWFsQ29udGVudCh0aXRsZTogc3RyaW5nKTogc3RyaW5nIHtcblx0XHRjb25zdCBub3cgPSBuZXcgRGF0ZSgpO1xuXHRcdGNvbnN0IGRhdGVTdHJpbmcgPSB3aW5kb3cubW9tZW50KG5vdykuZm9ybWF0KHRoaXMucGx1Z2luLnNldHRpbmdzLmRhdGVGb3JtYXQpO1xuXHRcdGNvbnN0IHNsdWcgPSB0b0tlYmFiQ2FzZSh0aXRsZSk7XG5cblx0XHRsZXQgdGVtcGxhdGU6IHN0cmluZztcblx0XHRpZiAodGhpcy50eXBlID09PSBcIm5vdGVcIikge1xuXHRcdFx0Ly8gRm9yIGdlbmVyaWMgbm90ZXMsIHVzZSBhIHNpbXBsZSB0ZW1wbGF0ZVxuXHRcdFx0Ly8gUHJvcGVybHkgZXNjYXBlIHRoZSB0aXRsZSBmb3IgWUFNTFxuXHRcdFx0Y29uc3QgZXNjYXBlZFRpdGxlID0gdGhpcy5lc2NhcGVZYW1sU3RyaW5nKHRpdGxlKTtcblx0XHRcdHRlbXBsYXRlID0gYC0tLVxcbnRpdGxlOiAke2VzY2FwZWRUaXRsZX1cXG5kYXRlOiAke2RhdGVTdHJpbmd9XFxuLS0tXFxuYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLmZpbGVPcHMuZ2V0Q29udGVudFR5cGUodGhpcy50eXBlKTtcblx0XHRcdGlmICghY29udGVudFR5cGUpIHtcblx0XHRcdFx0Y29uc3QgZXNjYXBlZFRpdGxlID0gdGhpcy5lc2NhcGVZYW1sU3RyaW5nKHRpdGxlKTtcblx0XHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGVtcGxhdGUgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3RpdGxlXFx9XFx9L2csIHRpdGxlKTtcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce2RhdGVcXH1cXH0vZywgZGF0ZVN0cmluZyk7XG5cdFx0dGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHtzbHVnXFx9XFx9L2csIHNsdWcpO1xuXG5cdFx0cmV0dXJuIHRlbXBsYXRlO1xuXHR9XG5cblx0cHJpdmF0ZSBhc3luYyBhZGRQcm9wZXJ0aWVzVG9GaWxlKGZpbGU6IFRGaWxlLCB0aXRsZTogc3RyaW5nLCB0eXBlOiBDb250ZW50VHlwZUlkKSB7XG5cdFx0Y29uc3Qgbm93ID0gbmV3IERhdGUoKTtcblx0XHRjb25zdCBkYXRlU3RyaW5nID0gd2luZG93Lm1vbWVudChub3cpLmZvcm1hdCh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kYXRlRm9ybWF0KTtcblx0XHRjb25zdCBzbHVnID0gdG9LZWJhYkNhc2UodGl0bGUpO1xuXG5cdFx0bGV0IHRlbXBsYXRlOiBzdHJpbmc7XG5cdFx0aWYgKHR5cGUgPT09IFwibm90ZVwiKSB7XG5cdFx0XHQvLyBGb3IgZ2VuZXJpYyBub3RlcywgdXNlIGEgc2ltcGxlIHRlbXBsYXRlXG5cdFx0XHQvLyBQcm9wZXJseSBlc2NhcGUgdGhlIHRpdGxlIGZvciBZQU1MXG5cdFx0XHRjb25zdCBlc2NhcGVkVGl0bGUgPSB0aGlzLmVzY2FwZVlhbWxTdHJpbmcodGl0bGUpO1xuXHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zdCBjb250ZW50VHlwZSA9IHRoaXMuZmlsZU9wcy5nZXRDb250ZW50VHlwZSh0eXBlKTtcblx0XHRcdGlmICghY29udGVudFR5cGUpIHtcblx0XHRcdFx0Y29uc3QgZXNjYXBlZFRpdGxlID0gdGhpcy5lc2NhcGVZYW1sU3RyaW5nKHRpdGxlKTtcblx0XHRcdFx0dGVtcGxhdGUgPSBgLS0tXFxudGl0bGU6ICR7ZXNjYXBlZFRpdGxlfVxcbmRhdGU6ICR7ZGF0ZVN0cmluZ31cXG4tLS1cXG5gO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGVtcGxhdGUgPSBjb250ZW50VHlwZS50ZW1wbGF0ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce3RpdGxlXFx9XFx9L2csIHRpdGxlKTtcblx0XHR0ZW1wbGF0ZSA9IHRlbXBsYXRlLnJlcGxhY2UoL1xce1xce2RhdGVcXH1cXH0vZywgZGF0ZVN0cmluZyk7XG5cdFx0dGVtcGxhdGUgPSB0ZW1wbGF0ZS5yZXBsYWNlKC9cXHtcXHtzbHVnXFx9XFx9L2csIHNsdWcpO1xuXG5cdFx0Ly8gRW5zdXJlIG5vIGV4dHJhIG5ld2xpbmVzIG9yIC0tLSBhcmUgYWRkZWQgYmV5b25kIHRoZSB0ZW1wbGF0ZVxuXHRcdGF3YWl0IHRoaXMuYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCB0ZW1wbGF0ZSk7XG5cdH1cblxuXHRwcml2YXRlIHBvc2l0aW9uQ3Vyc29yQXRFbmQoZmlsZTogVEZpbGUpIHtcblx0XHRjb25zdCBwb3NpdGlvbkN1cnNvciA9ICgpID0+IHtcblx0XHRcdGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuXHRcdFx0aWYgKHZpZXcgJiYgdmlldy5maWxlID09PSBmaWxlICYmIHZpZXcuZWRpdG9yKSB7XG5cdFx0XHRcdGNvbnN0IGVkaXRvciA9IHZpZXcuZWRpdG9yO1xuXHRcdFx0XHRjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG5cdFx0XHRcdGlmIChjb250ZW50KSB7XG5cdFx0XHRcdFx0Y29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcblx0XHRcdFx0XHRjb25zdCBsYXN0TGluZSA9IGxpbmVzLmxlbmd0aCAtIDE7XG5cdFx0XHRcdFx0Y29uc3QgbGFzdExpbmVMZW5ndGggPSBsaW5lc1tsYXN0TGluZV0/Lmxlbmd0aCB8fCAwO1xuXHRcdFx0XHRcdGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBsYXN0TGluZSwgY2g6IGxhc3RMaW5lTGVuZ3RoIH0pO1xuXHRcdFx0XHRcdC8vIEZvY3VzIHRoZSBlZGl0b3IgdG8gZW5zdXJlIGN1cnNvciBpcyB2aXNpYmxlXG5cdFx0XHRcdFx0ZWRpdG9yLmZvY3VzKCk7XG5cdFx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9O1xuXG5cdFx0c2V0VGltZW91dCgoKSA9PiB7XG5cdFx0XHRpZiAoIXBvc2l0aW9uQ3Vyc29yKCkpIHtcblx0XHRcdFx0Ly8gSWYgaXQgZGlkbid0IHdvcmssIHRyeSBhZ2FpbiBhZnRlciBhIGxvbmdlciBkZWxheVxuXHRcdFx0XHRzZXRUaW1lb3V0KCgpID0+IHtcblx0XHRcdFx0XHRwb3NpdGlvbkN1cnNvcigpO1xuXHRcdFx0XHR9LCAyMDApO1xuXHRcdFx0fVxuXHRcdH0sIDEwMCk7XG5cdH1cblxuXHRwcml2YXRlIGVzY2FwZVlhbWxTdHJpbmcoc3RyOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdC8vIFByb3Blcmx5IGVzY2FwZSBZQU1MIHN0cmluZyB2YWx1ZXNcblx0XHQvLyBZQU1MIHN0cmluZ3Mgd2l0aCBxdW90ZXMgbmVlZCB0byBiZSB3cmFwcGVkIGluIHNpbmdsZSBxdW90ZXMgb3IgZXNjYXBlZCBwcm9wZXJseVxuXHRcdGlmIChzdHIuaW5jbHVkZXMoJ1wiJykgfHwgc3RyLmluY2x1ZGVzKFwiJ1wiKSB8fCBzdHIuaW5jbHVkZXMoJ1xcbicpIHx8IHN0ci5pbmNsdWRlcygnXFxcXCcpKSB7XG5cdFx0XHQvLyBGb3Igc3RyaW5ncyB3aXRoIHF1b3RlcywgbmV3bGluZXMsIG9yIGJhY2tzbGFzaGVzLCB1c2Ugc2luZ2xlIHF1b3RlcyBhbmQgZXNjYXBlIHNpbmdsZSBxdW90ZXNcblx0XHRcdHJldHVybiBgJyR7c3RyLnJlcGxhY2UoLycvZywgXCInJ1wiKX0nYDtcblx0XHR9IGVsc2UgaWYgKHN0ci5pbmNsdWRlcyhcIiBcIikgfHwgc3RyLmluY2x1ZGVzKFwiOlwiKSB8fCBzdHIuaW5jbHVkZXMoXCIjXCIpIHx8IHN0ci5pbmNsdWRlcyhcIkBcIikpIHtcblx0XHRcdC8vIEZvciBzdHJpbmdzIHdpdGggc3BhY2VzIG9yIHNwZWNpYWwgWUFNTCBjaGFyYWN0ZXJzLCB3cmFwIGluIGRvdWJsZSBxdW90ZXMgYW5kIGVzY2FwZSBkb3VibGUgcXVvdGVzXG5cdFx0XHRyZXR1cm4gYFwiJHtzdHIucmVwbGFjZSgvXCIvZywgJ1xcXFxcIicpfVwiYDtcblx0XHR9IGVsc2Uge1xuXHRcdFx0Ly8gRm9yIHNpbXBsZSBzdHJpbmdzLCBubyBxdW90ZXMgbmVlZGVkXG5cdFx0XHRyZXR1cm4gc3RyO1xuXHRcdH1cblx0fVxuXG5cdG9uQ2xvc2UoKSB7XG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XG5cdH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFBsYXRmb3JtLCBzZXRJY29uIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IFBsdWdpbiB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBDb250ZW50VHlwZSwgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSwgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IENvbW1hbmRQaWNrZXJNb2RhbCB9IGZyb20gXCIuL2NvbXBvbmVudHMvQ29tbWFuZFBpY2tlck1vZGFsXCI7XHJcbmltcG9ydCB7IEljb25QaWNrZXJNb2RhbCB9IGZyb20gXCIuL2NvbXBvbmVudHMvSWNvblBpY2tlck1vZGFsXCI7XHJcbmltcG9ydCB7IENvbmZpcm1Nb2RhbCB9IGZyb20gXCIuL2NvbXBvbmVudHMvQ29uZmlybU1vZGFsXCI7XHJcbmltcG9ydCB7IGNyZWF0ZVNldHRpbmdzR3JvdXAgfSBmcm9tIFwiLi4vdXRpbHMvc2V0dGluZ3MtY29tcGF0XCI7XHJcbmltcG9ydCB7IHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyB9IGZyb20gXCIuLi9jb21tYW5kc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIEFzdHJvQ29tcG9zZXJTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcblx0cGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xyXG5cdHB1YmxpYyBpY29uID0gJ2x1Y2lkZS1wZW5jaWwtbGluZSc7XHJcblx0YXV0b1JlbmFtZUNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRwb3N0c0ZvbGRlckNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRvbmx5QXV0b21hdGVDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0Y3JlYXRpb25Nb2RlQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGluZGV4RmlsZUNvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRleGNsdWRlZERpcnNDb250YWluZXI6IEhUTUxFbGVtZW50IHwgbnVsbCA9IG51bGw7XHJcblx0dW5kZXJzY29yZVByZWZpeENvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRhdXRvSW5zZXJ0Q29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHBhZ2VzRmllbGRzQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHBhZ2VzSW5kZXhGaWxlQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHBhZ2VzT25seUF1dG9tYXRlQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdHRlcm1pbmFsQ29tbWFuZENvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHRjb25maWdDb21tYW5kQ29udGFpbmVyOiBIVE1MRWxlbWVudCB8IG51bGwgPSBudWxsO1xyXG5cdGN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcjogSFRNTEVsZW1lbnQgfCBudWxsID0gbnVsbDtcclxuXHR0ZXJtaW5hbFJpYmJvblRvZ2dsZTogU2V0dGluZyB8IG51bGwgPSBudWxsO1xyXG5cdGNvbmZpZ1JpYmJvblRvZ2dsZTogU2V0dGluZyB8IG51bGwgPSBudWxsO1xyXG5cdHByaXZhdGUgdGVybWluYWxSaWJib25Ub2dnbGVDb21wb25lbnQ6IHsgc2V0RGlzYWJsZWQ6IChkaXNhYmxlZDogYm9vbGVhbikgPT4gdm9pZCB9IHwgbnVsbCA9IG51bGw7XHJcblx0cHJpdmF0ZSBjb25maWdSaWJib25Ub2dnbGVDb21wb25lbnQ6IHsgc2V0RGlzYWJsZWQ6IChkaXNhYmxlZDogYm9vbGVhbikgPT4gdm9pZCB9IHwgbnVsbCA9IG51bGw7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IFBsdWdpbikge1xyXG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xyXG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW4gYXMgdW5rbm93biBhcyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogUmVmcmVzaCBqdXN0IHRoZSBjb250ZW50IHR5cGVzIHNlY3Rpb25cclxuXHQgKiBNb3JlIGVmZmljaWVudCB0aGFuIHJlZnJlc2hpbmcgdGhlIGVudGlyZSBzZXR0aW5ncyB0YWJcclxuXHQgKi9cclxuXHRwdWJsaWMgcmVmcmVzaENvbnRlbnRUeXBlcygpOiB2b2lkIHtcclxuXHRcdGlmICh0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0ZGlzcGxheSgpOiB2b2lkIHtcclxuXHRcdGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcblx0XHRjb250YWluZXJFbC5lbXB0eSgpO1xyXG5cclxuXHRcdC8vIFVzZSBjdXJyZW50IHBsdWdpbiBzZXR0aW5ncyAoYWxyZWFkeSBsb2FkZWQgYW5kIHVwLXRvLWRhdGUpXHJcblx0XHQvLyBBbHdheXMgcmVhZCBmcmVzaCBzZXR0aW5ncyB0byBlbnN1cmUgd2Ugc2hvdyBtaWdyYXRlZCBjb250ZW50IHR5cGVzIGltbWVkaWF0ZWx5XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cclxuXHRcdC8vIFJlbmRlciB0aGUgc2V0dGluZ3MgdGFiIHdpdGggY3VycmVudCBzZXR0aW5nc1xyXG5cdFx0Ly8gVGhpcyB3aWxsIHNob3cgYWxsIGNvbnRlbnQgdHlwZXMgaW5jbHVkaW5nIG5ld2x5IG1pZ3JhdGVkIG9uZXNcclxuXHRcdHRoaXMucmVuZGVyU2V0dGluZ3NUYWIoY29udGFpbmVyRWwsIHNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVuZGVyU2V0dGluZ3NUYWIoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKTogdm9pZCB7XHJcblxyXG5cdFx0Ly8gR2xvYmFsIHNldHRpbmdzIChmaXJzdCBncm91cCAtIG5vIGhlYWRpbmcpXHJcblx0XHRjb25zdCBnZW5lcmFsR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsLCB1bmRlZmluZWQsICdhc3Ryby1jb21wb3NlcicpO1xyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiRGF0ZSBmb3JtYXRcIilcclxuXHRcdFx0XHQvLyBEYXRlIGZvcm1hdCBjb2RlcyAoTU1NTSwgeXl5eSwgZXRjLikgYXJlIHRlY2huaWNhbCBub3RhdGlvbiwgbm90IFVJIHRleHRcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkZvcm1hdCBmb3IgdGhlIGRhdGUgaW4gcHJvcGVydGllcyAoZS5nLiwgeXl5eS1tbS1kZCwgTU1NTSBELCB5eXl5LCB5eXl5LW1tLWRkIEhIOm1tKVwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQvLyBcIllZWVktTU0tRERcIiBpcyBhIGRhdGUgZm9ybWF0IHBsYWNlaG9sZGVyLCBub3QgVUkgdGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJZWVlZLU1NLUREXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5kYXRlRm9ybWF0KVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5kYXRlRm9ybWF0ID0gdmFsdWUgfHwgXCJZWVlZLU1NLUREXCI7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBjb3B5IGhlYWRpbmcgbGlua3NcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCByaWdodC1jbGljayBjb250ZXh0IG1lbnUgb3B0aW9uIHRvIGNvcHkgaGVhZGluZyBsaW5rcyBpbiB2YXJpb3VzIGZvcm1hdHMuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmspXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmsgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvcHlIZWFkaW5nRmllbGRzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZShcIkRlZmF1bHQgaGVhZGluZyBsaW5rIGZvcm1hdFwiKVxyXG5cdFx0XHRcdC8vIFwiQXN0cm9cIiBpcyBhIHByb3BlciBub3VuIChmcmFtZXdvcmsgbmFtZSkgYW5kIHNob3VsZCBiZSBjYXBpdGFsaXplZFxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQ2hvb3NlIHRoZSBkZWZhdWx0IGZvcm1hdCBmb3IgY29waWVkIGhlYWRpbmcgbGlua3MuIE9ic2lkaWFuIGZvcm1hdCByZXNwZWN0cyB5b3VyIE9ic2lkaWFuIHNldHRpbmdzIGZvciB3aWtpbGluayB2cyBtYXJrZG93biBwcmVmZXJlbmNlLiBBc3RybyBsaW5rIHVzZXMgeW91ciBsaW5rIGJhc2UgcGF0aCBmcm9tIGFib3ZlIGFuZCBjb252ZXJ0cyB0aGUgaGVhZGluZyBpbnRvIGtlYmFiLWNhc2UgZm9ybWF0IGFzIGFuIGFuY2hvciBsaW5rXCIpXHJcblx0XHRcdFx0LmFkZERyb3Bkb3duKChkcm9wZG93bikgPT5cclxuXHRcdFx0XHRcdGRyb3Bkb3duXHJcblx0XHRcdFx0XHRcdC5hZGRPcHRpb24oXCJvYnNpZGlhblwiLCBcIk9ic2lkaWFuIGxpbmtcIilcclxuXHRcdFx0XHRcdFx0LmFkZE9wdGlvbihcImFzdHJvXCIsIFwiQXN0cm8gbGlua1wiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuY29weUhlYWRpbmdMaW5rRm9ybWF0KVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5jb3B5SGVhZGluZ0xpbmtGb3JtYXQgPSB2YWx1ZSBhcyBcIm9ic2lkaWFuXCIgfCBcImFzdHJvXCI7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdFx0Ly8gQWRkIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgY2xhc3NlcyAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxyXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmspO1xyXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVDb3B5SGVhZGluZ0xpbmspO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiQWRkIHRyYWlsaW5nIHNsYXNoIHRvIGxpbmtzXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJBZGQgdHJhaWxpbmcgc2xhc2hlcyB0byBhbGwgY29udmVydGVkIGludGVybmFsIGxpbmtzIChlLmcuLCAvYWJvdXQvIGluc3RlYWQgb2YgL2Fib3V0KS5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuYWRkVHJhaWxpbmdTbGFzaFRvTGlua3MgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Z2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiUHJvY2VzcyBiYWNrZ3JvdW5kIGZpbGUgY2hhbmdlc1wiKVxyXG5cdFx0XHRcdC8vIFRlY2huaWNhbCB0ZXJtcyBsaWtlIFwiT2JzaWRpYW5cIiwgXCJnaXRcIiBhcmUgcHJvcGVyIG5vdW5zIGluIHRoaXMgY29udGV4dFxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQXV0b21hdGljYWxseSBwcm9jZXNzIG5ldyBmaWxlcyB3aGVuIHRoZXkncmUgY2hhbmdlZCBpbiB0aGUgYmFja2dyb3VuZCAoYnkgR2l0IG9yIG90aGVyIHBsdWdpbnMpLiBEaXNhYmxlIHRvIHByZXZlbnQgbW9kYWwgc3BhbSB3aGVuIGZpbGVzIGFyZSBhbHJlYWR5IHByb2Nlc3NlZCBvbiBvdGhlciBkZXZpY2VzIGR1cmluZyBhIHN5bmMuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5wcm9jZXNzQmFja2dyb3VuZEZpbGVDaGFuZ2VzKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MucHJvY2Vzc0JhY2tncm91bmRGaWxlQ2hhbmdlcyA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0Ly8gXCJNRFhcIiBpcyBhIHByb3BlciBub3VuIChmaWxlIGZvcm1hdCkgYW5kIHNob3VsZCBiZSBjYXBpdGFsaXplZFxyXG5cdFx0XHRcdC5zZXROYW1lKFwiU2hvdyBNRFggZmlsZXMgaW4gZmlsZSBleHBsb3JlclwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiTWFrZSAubWR4IGZpbGVzIHZpc2libGUgaW4gT2JzaWRpYW4ncyBmaWxlIGV4cGxvcmVyLiBSZXF1aXJlcyByZWxvYWQgdG8gdGFrZSBlZmZlY3QuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5zaG93TWR4RmlsZXNJbkV4cGxvcmVyKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3Muc2hvd01keEZpbGVzSW5FeHBsb3JlciA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHQvLyBQcm9wZXJ0eSBhdXRvbWF0aW9uXHJcblx0XHRjb25zdCBhdXRvbWF0aW9uR3JvdXAgPSBjcmVhdGVTZXR0aW5nc0dyb3VwKGNvbnRhaW5lckVsLCBcIlByb3BlcnR5IGF1dG9tYXRpb25cIiwgJ2FzdHJvLWNvbXBvc2VyJyk7XHJcblxyXG5cdFx0Ly8gQXV0by1pbnNlcnQgcHJvcGVydGllcyAobW92ZWQgZnJvbSBnZW5lcmFsR3JvdXApXHJcblx0XHRhdXRvbWF0aW9uR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJBdXRvLWluc2VydCBwcm9wZXJ0aWVzXCIpXHJcblx0XHRcdFx0LnNldERlc2MoXCJBdXRvbWF0aWNhbGx5IGluc2VydCB0aGUgcHJvcGVydGllcyB0ZW1wbGF0ZSB3aGVuIGNyZWF0aW5nIG5ldyBmaWxlcy5cIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmF1dG9JbnNlcnRQcm9wZXJ0aWVzKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuYXV0b0luc2VydFByb3BlcnRpZXMgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0bGV0IGRyYWZ0UHJvcGVydHlTZXR0aW5nOiBTZXR0aW5nO1xyXG5cdFx0bGV0IGRyYWZ0TG9naWNTZXR0aW5nOiBTZXR0aW5nO1xyXG5cdFx0bGV0IHB1Ymxpc2hEYXRlRmllbGRTZXR0aW5nOiBTZXR0aW5nO1xyXG5cclxuXHRcdGF1dG9tYXRpb25Hcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZShcIlVwZGF0ZSBkYXRlIG9uIHB1Ymxpc2hcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIlVwZGF0ZSAnZGF0ZScgcHJvcGVydHkgd2hlbiBzd2l0Y2hpbmcgZnJvbSBkcmFmdCB0byBwdWJsaXNoZWQgc3RhdHVzLlwiKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3Muc3luY0RyYWZ0RGF0ZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLnN5bmNEcmFmdERhdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHJcblx0XHRcdFx0XHRcdFx0Ly8gRml4IGZvciBqdW1waW5nOiB1c2UgaW5kaXZpZHVhbCBjbGFzcy1iYXNlZCB0b2dnbGluZ1xyXG5cdFx0XHRcdFx0XHRcdGlmIChkcmFmdFByb3BlcnR5U2V0dGluZykgZHJhZnRQcm9wZXJ0eVNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoJ2FzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlbicsICF2YWx1ZSk7XHJcblx0XHRcdFx0XHRcdFx0aWYgKGRyYWZ0TG9naWNTZXR0aW5nKSBkcmFmdExvZ2ljU2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZSgnYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuJywgIXZhbHVlKTtcclxuXHRcdFx0XHRcdFx0XHRpZiAocHVibGlzaERhdGVGaWVsZFNldHRpbmcpIHB1Ymxpc2hEYXRlRmllbGRTZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKCdhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW4nLCAhdmFsdWUpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRhdXRvbWF0aW9uR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRkcmFmdFByb3BlcnR5U2V0dGluZyA9IHNldHRpbmc7XHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoJ2FzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlbicsICFzZXR0aW5ncy5zeW5jRHJhZnREYXRlKTtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiRHJhZnQgcHJvcGVydHkgbmFtZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiVGhlIHByb3BlcnR5IGZpZWxkIHRvIHVzZSBmb3IgZHJhZnQgc3RhdHVzLlwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJkcmFmdFwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZHJhZnRQcm9wZXJ0eSB8fCBcIlwiKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5kcmFmdFByb3BlcnR5ID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmVmcmVzaCBtYXAgd2l0aCBuZXcgcHJvcGVydHlcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5mcm9udG1hdHRlclNlcnZpY2U/LmluaXRpYWxpemVEcmFmdFN0YXR1c01hcCgpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblx0XHR9KTtcclxuXHJcblx0XHRhdXRvbWF0aW9uR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRkcmFmdExvZ2ljU2V0dGluZyA9IHNldHRpbmc7XHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoJ2FzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlbicsICFzZXR0aW5ncy5zeW5jRHJhZnREYXRlKTtcclxuXHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdC5zZXROYW1lKFwiRHJhZnQgbG9naWNcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIldoZXRoZXIgdGhlIHByb3BlcnR5IHZhbHVlICd0cnVlJyBtZWFucyBpdCBpcyBhIGRyYWZ0IG9yIHB1Ymxpc2hlZC5cIilcclxuXHRcdFx0XHQuYWRkRHJvcGRvd24oKGRyb3Bkb3duKSA9PlxyXG5cdFx0XHRcdFx0ZHJvcGRvd25cclxuXHRcdFx0XHRcdFx0LmFkZE9wdGlvbihcInRydWUtaXMtZHJhZnRcIiwgXCJUcnVlID0gRHJhZnRcIilcclxuXHRcdFx0XHRcdFx0LmFkZE9wdGlvbihcImZhbHNlLWlzLWRyYWZ0XCIsIFwiVHJ1ZSA9IFB1Ymxpc2hlZFwiKVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZHJhZnRMb2dpYyB8fCBcInRydWUtaXMtZHJhZnRcIilcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLmRyYWZ0TG9naWMgPSB2YWx1ZSBhcyAndHJ1ZS1pcy1kcmFmdCcgfCAnZmFsc2UtaXMtZHJhZnQnO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIFJlZnJlc2ggbWFwIHdpdGggbmV3IGxvZ2ljXHJcblx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uZnJvbnRtYXR0ZXJTZXJ2aWNlPy5pbml0aWFsaXplRHJhZnRTdGF0dXNNYXAoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0YXV0b21hdGlvbkdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0cHVibGlzaERhdGVGaWVsZFNldHRpbmcgPSBzZXR0aW5nO1xyXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKCdhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW4nLCAhc2V0dGluZ3Muc3luY0RyYWZ0RGF0ZSk7XHJcblx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHQuc2V0TmFtZShcIlB1Ymxpc2hlZCBkYXRlIHByb3BlcnR5IG5hbWVcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIlRoZSBwcm9wZXJ0eSBmaWVsZCB0byB1cGRhdGUgd2hlbiBwdWJsaXNoZWQgKGUuZy4sICdkYXRlJyBvciAncHViRGF0ZScpLlwiKVxyXG5cdFx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJkYXRlXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5wdWJsaXNoRGF0ZUZpZWxkIHx8IFwiXCIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLnB1Ymxpc2hEYXRlRmllbGQgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0bGV0IG1vZGlmaWVkRGF0ZUZpZWxkU2V0dGluZzogU2V0dGluZztcclxuXHJcblx0XHRhdXRvbWF0aW9uR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJVcGRhdGUgbW9kaWZpZWQgZGF0ZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQXV0b21hdGljYWxseSB1cGRhdGUgYSBwcm9wZXJ0eSB3aXRoIGN1cnJlbnQgZGF0ZSB3aGVuIGEgZmlsZSBpcyBlZGl0ZWQuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy51cGRhdGVNb2RpZmllZERhdGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRzZXR0aW5ncy51cGRhdGVNb2RpZmllZERhdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBGaXggZm9yIGp1bXBpbmc6IHVzZSBDU1MgY2xhc3MgaW5zdGVhZCBvZiB0aGlzLmRpc3BsYXkoKVxyXG5cdFx0XHRcdFx0XHRcdGlmIChtb2RpZmllZERhdGVGaWVsZFNldHRpbmcpIHtcclxuXHRcdFx0XHRcdFx0XHRcdG1vZGlmaWVkRGF0ZUZpZWxkU2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZSgnYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuJywgIXZhbHVlKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdGF1dG9tYXRpb25Hcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdG1vZGlmaWVkRGF0ZUZpZWxkU2V0dGluZyA9IHNldHRpbmc7XHJcblx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoJ2FzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlbicsICFzZXR0aW5ncy51cGRhdGVNb2RpZmllZERhdGUpO1xyXG5cdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0LnNldE5hbWUoXCJNb2RpZmllZCBkYXRlIHByb3BlcnR5IG5hbWVcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIlRoZSBwcm9wZXJ0eSBmaWVsZCB0byB1cGRhdGUgd2l0aCB0aGUgbW9kaWZpZWQgZGF0ZS5cIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwibW9kaWZpZWRcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLm1vZGlmaWVkRGF0ZUZpZWxkIHx8IFwiXCIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdHNldHRpbmdzLm1vZGlmaWVkRGF0ZUZpZWxkID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0KTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIENvbnRlbnQgdHlwZXNcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlc0dyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCwgXCJDb250ZW50IHR5cGVzXCIsICdhc3Ryby1jb21wb3NlcicpO1xyXG5cclxuXHRcdC8vIEFkZCBjb250YWluZXIgYXMgYSBzZXR0aW5nIC0gaGlkZSB0aGUgc2V0dGluZydzIGRlZmF1bHQgVUksIGFkZCBvdXIgY29udGFpbmVyIGluc2lkZVxyXG5cdFx0Y29udGVudFR5cGVzR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHQvLyBIaWRlIHRoZSBzZXR0aW5nJ3MgZGVmYXVsdCBVSSBlbGVtZW50cyB1c2luZyBDU1MgY2xhc3Nlc1xyXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctaGlkZGVuLWVsZW1lbnRzXCIpO1xyXG5cdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5hZGRDbGFzcyhcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWZ1bGwtd2lkdGhcIik7XHJcblx0XHRcdC8vIEFkZCBvdXIgY29udGFpbmVyIGluc2lkZSB0aGUgc2V0dGluZyBlbGVtZW50IC0gZW5zdXJlIGl0J3MgdmlzaWJsZVxyXG5cdFx0XHR0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lciA9IHNldHRpbmcuc2V0dGluZ0VsLmNyZWF0ZURpdih7XHJcblx0XHRcdFx0Y2xzOiBcImN1c3RvbS1jb250ZW50LXR5cGVzLWNvbnRhaW5lciBhc3Ryby1jb21wb3Nlci1jdXN0b20tdHlwZXMtY29udGFpbmVyLXZpc2libGVcIlxyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdFx0Ly8gUmVuZGVyIGNvbnRlbnQgdHlwZXMgYWZ0ZXIgY29udGFpbmVyIGlzIGNyZWF0ZWRcclxuXHRcdGlmICh0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIERldmVsb3BlciBjb21tYW5kcyAoZGVza3RvcCBvbmx5IC0gbm90IGF2YWlsYWJsZSBvbiBtb2JpbGUpXHJcblx0XHRpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdGNvbnN0IGRldmVsb3Blckdyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCwgXCJEZXZlbG9wZXIgY29tbWFuZHNcIiwgJ2FzdHJvLWNvbXBvc2VyJyk7XHJcblxyXG5cdFx0XHQvLyBUZXJtaW5hbCBjb21tYW5kIHNldHRpbmdzXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBvcGVuIHRlcm1pbmFsIGNvbW1hbmRcIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKFwiRW5hYmxlIGNvbW1hbmQgdG8gb3BlbiB0ZXJtaW5hbCBpbiBwcm9qZWN0IHJvb3QgZGlyZWN0b3J5LlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZClcclxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMudXBkYXRlVGVybWluYWxDb21tYW5kRmllbGRzKCk7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyByZWdpc3RlclJpYmJvbkljb25zIGNoZWNrcyBib3RoIGNvbW1hbmQgYW5kIGljb24gc2V0dGluZ3NcclxuXHRcdFx0XHRcdFx0XHRcdC8vIElmIGNvbW1hbmQgaXMgZW5hYmxlZCBBTkQgaWNvbiBpcyBlbmFibGVkLCBpdCB3aWxsIHNob3c7IG90aGVyd2lzZSBpdCB3aWxsIGhpZGVcclxuXHRcdFx0XHRcdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5yZWdpc3RlclJpYmJvbkljb25zKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0KTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBDcmVhdGUgY29udGFpbmVyIGZvciB0ZXJtaW5hbCBjb21tYW5kIGZpZWxkcyAtIGtlZXAgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCB1cGRhdGUgbWV0aG9kc1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lciA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdih7IGNsczogXCJ0ZXJtaW5hbC1jb21tYW5kLWZpZWxkc1wiIH0pO1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0dGhpcy50ZXJtaW5hbENvbW1hbmRDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblxyXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0Y29uc3QgZGVzY0ZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cdFx0XHRcdC8vIFRleHQgaXMgYWxyZWFkeSBpbiBzZW50ZW5jZSBjYXNlOyBcIk9ic2lkaWFuXCIgaXMgYSBwcm9wZXIgbm91blxyXG5cdFx0XHRcdGRlc2NGcmFnbWVudC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiUGF0aCByZWxhdGl2ZSB0byB0aGUgT2JzaWRpYW4gdmF1bHQgcm9vdCBmb2xkZXIuIFVzZSAuLi8uLiBmb3IgdHdvIGxldmVscyB1cC4gTGVhdmUgYmxhbmsgdG8gdXNlIHRoZSB2YXVsdCBmb2xkZXJcIiB9KTtcclxuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlRoaXMgaXMgd2hlcmUgdGhlIHRlcm1pbmFsIHdpbGwgb3Blbi4gQWJzb2x1dGUgcGF0aHMgd29yayBhbHNvLlwiIH0pO1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiUHJvamVjdCByb290IGRpcmVjdG9yeSBwYXRoXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhkZXNjRnJhZ21lbnQpXHJcblx0XHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIi4uLy4uXCIpXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnRlcm1pbmFsUHJvamVjdFJvb3RQYXRoKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MudGVybWluYWxQcm9qZWN0Um9vdFBhdGggPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdC8vIEFkZCBjbGFzcyBmb3IgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRjb25zdCBkZXNjRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblx0XHRcdFx0Ly8gVGV4dCBpcyBhbHJlYWR5IGluIHNlbnRlbmNlIGNhc2U7IHByb3BlciBub3VucyBvciBwcm9kdWN0IG5hbWVzIGxpa2UgXCJtYWNPU1wiLCBcIldpbmRvd3NcIiwgXCJMaW51eFwiXHJcblx0XHRcdFx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJMZWF2ZSBibGFuayB0byB1c2UgcGxhdGZvcm0gZGVmYXVsdHMuIE9uIG1hY09TLCB0aGUgZGVmYXVsdCBpcyBUZXJtaW5hbC4gT24gV2luZG93cywgaXQncyBXaW5kb3dzIFRlcm1pbmFsIChXaW4gMTEpIG9yIGNtZC5leGUgKFdpbiAxMCkuIE9uIExpbnV4LCBpdCdzIGdub21lLXRlcm1pbmFsLCBrb25zb2xlLCBvciB4dGVybVwiIH0pO1xyXG5cdFx0XHRcdC8vIFRleHQgaXMgYWxyZWFkeSBpbiBzZW50ZW5jZSBjYXNlOyBwcm9wZXIgbm91bnMgbGlrZSBcIlRlcm1pbmFsXCIsIFwiaVRlcm1cIiwgXCJQb3dlclNoZWxsXCJcclxuXHRcdFx0XHRkZXNjRnJhZ21lbnQuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIkV4YW1wbGVzIGluY2x1ZGUgVGVybWluYWwsIGlUZXJtLCBQb3dlclNoZWxsLCBhbmQgQWxhY3JpdHR5XCIgfSk7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJUZXJtaW5hbCBhcHBsaWNhdGlvbiBuYW1lXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhkZXNjRnJhZ21lbnQpXHJcblx0XHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT5cclxuXHRcdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIlRlcm1pbmFsXCIpXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLnRlcm1pbmFsQXBwbGljYXRpb25OYW1lKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MudGVybWluYWxBcHBsaWNhdGlvbk5hbWUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHRcdC8vIEFkZCBjbGFzcyBmb3IgY29uZGl0aW9uYWwgdmlzaWJpbGl0eSAtIGtlZXAgc2V0dGluZyBpbiBncm91cFxyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHRcdHNldHRpbmcuc2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNldHRpbmdzLmVuYWJsZU9wZW5UZXJtaW5hbENvbW1hbmQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIkVuYWJsZSBkZWJ1ZyBsb2dnaW5nXCIpXHJcblx0XHRcdFx0XHQuc2V0RGVzYyhcIkxvZyB0ZXJtaW5hbCBsYXVuY2ggY29tbWFuZHMgYW5kIHBsYXRmb3JtIGRlY2lzaW9ucyB0byB0aGUgZGV2ZWxvcGVyIGNvbnNvbGUgZm9yIHRyb3VibGVzaG9vdGluZy5cIilcclxuXHRcdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdFx0LnNldFZhbHVlKHNldHRpbmdzLmVuYWJsZVRlcm1pbmFsRGVidWdMb2dnaW5nKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZVRlcm1pbmFsRGVidWdMb2dnaW5nID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdFx0KTtcclxuXHRcdFx0XHQvLyBBZGQgY2xhc3MgZm9yIGNvbmRpdGlvbmFsIHZpc2liaWxpdHkgLSBrZWVwIHNldHRpbmcgaW4gZ3JvdXBcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHRkZXZlbG9wZXJHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcblx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0LnNldE5hbWUoXCJTaG93IG9wZW4gdGVybWluYWwgcmliYm9uIGljb25cIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKFwiQWRkIGEgcmliYm9uIGljb24gdG8gbGF1bmNoIHRoZSB0ZXJtaW5hbCBjb21tYW5kLlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMudGVybWluYWxSaWJib25Ub2dnbGVDb21wb25lbnQgPSB0b2dnbGU7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5lbmFibGVUZXJtaW5hbFJpYmJvbkljb24pXHJcblx0XHRcdFx0XHRcdFx0LnNldERpc2FibGVkKCFzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBzZXR0aW5ncyBkaXJlY3RseSBvbiBwbHVnaW4gaW5zdGFuY2VcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZVRlcm1pbmFsUmliYm9uSWNvbiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuZW5hYmxlVGVybWluYWxSaWJib25JY29uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBzZXR0aW5ncyBhcmUgc2F2ZWQsIHRoZW4gcmUtcmVnaXN0ZXJcclxuXHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSwgNTApO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlblRlcm1pbmFsQ29tbWFuZCk7XHJcblx0XHRcdFx0Ly8gU3RvcmUgcmVmZXJlbmNlIGZvciB1cGRhdGluZyBkaXNhYmxlZCBzdGF0ZVxyXG5cdFx0XHRcdHRoaXMudGVybWluYWxSaWJib25Ub2dnbGUgPSBzZXR0aW5nO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIENvbmZpZyBmaWxlIGNvbW1hbmQgc2V0dGluZ3NcclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiRW5hYmxlIGVkaXQgY29uZmlnIGZpbGUgY29tbWFuZFwiKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoXCJFbmFibGUgY29tbWFuZCB0byBvcGVuIGFzdHJvIGNvbmZpZyBmaWxlIGluIGRlZmF1bHQgZWRpdG9yLlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUNvbmZpZ0NvbW1hbmRGaWVsZHMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIHJlZ2lzdGVyUmliYm9uSWNvbnMgY2hlY2tzIGJvdGggY29tbWFuZCBhbmQgaWNvbiBzZXR0aW5nc1xyXG5cdFx0XHRcdFx0XHRcdFx0Ly8gSWYgY29tbWFuZCBpcyBlbmFibGVkIEFORCBpY29uIGlzIGVuYWJsZWQsIGl0IHdpbGwgc2hvdzsgb3RoZXJ3aXNlIGl0IHdpbGwgaGlkZVxyXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH0pXHJcblx0XHRcdFx0XHQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIENyZWF0ZSBjb250YWluZXIgZm9yIGNvbmZpZyBjb21tYW5kIGZpZWxkcyAtIGtlZXAgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgd2l0aCB1cGRhdGUgbWV0aG9kc1xyXG5cdFx0XHR0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoeyBjbHM6IFwiY29uZmlnLWNvbW1hbmQtZmllbGRzXCIgfSk7XHJcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHR0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRjb25zdCBkZXNjRnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XHJcblx0XHRcdFx0ZGVzY0ZyYWdtZW50LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJQYXRoIHRvIHRoZSBjb25maWcgZmlsZSByZWxhdGl2ZSB0byB0aGUgdmF1bHQgcm9vdC4gVXNlIC4uL2NvbmZpZy50cyBvciAuLi8uLi9hc3Ryby5jb25maWcubWpzLlwiIH0pO1xyXG5cdFx0XHRcdGRlc2NGcmFnbWVudC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiQWJzb2x1dGUgcGF0aHMgd29yayBhbHNvLlwiIH0pO1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKFwiQ29uZmlnIGZpbGUgcGF0aFwiKVxyXG5cdFx0XHRcdFx0LnNldERlc2MoZGVzY0ZyYWdtZW50KVxyXG5cdFx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCIuLi9jb25maWcudHNcIilcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuY29uZmlnRmlsZVBhdGgpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5jb25maWdGaWxlUGF0aCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGRldmVsb3Blckdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuXHRcdFx0XHRzZXR0aW5nXHJcblx0XHRcdFx0XHQuc2V0TmFtZShcIlNob3cgb3BlbiBjb25maWcgcmliYm9uIGljb25cIilcclxuXHRcdFx0XHRcdC5zZXREZXNjKFwiQWRkIGEgcmliYm9uIGljb24gdG8gbGF1bmNoIHRoZSBjb25maWcgZmlsZSBjb21tYW5kLlwiKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PiB7XHJcblx0XHRcdFx0XHRcdHRoaXMuY29uZmlnUmliYm9uVG9nZ2xlQ29tcG9uZW50ID0gdG9nZ2xlO1xyXG5cdFx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0XHQuc2V0VmFsdWUoc2V0dGluZ3MuZW5hYmxlQ29uZmlnUmliYm9uSWNvbilcclxuXHRcdFx0XHRcdFx0XHQuc2V0RGlzYWJsZWQoIXNldHRpbmdzLmVuYWJsZU9wZW5Db25maWdGaWxlQ29tbWFuZClcclxuXHRcdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBib29sZWFuKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHQvLyBVcGRhdGUgc2V0dGluZ3MgZGlyZWN0bHkgb24gcGx1Z2luIGluc3RhbmNlXHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5lbmFibGVDb25maWdSaWJib25JY29uID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdC8vIFNtYWxsIGRlbGF5IHRvIGVuc3VyZSBzZXR0aW5ncyBhcmUgc2F2ZWQsIHRoZW4gcmUtcmVnaXN0ZXJcclxuXHRcdFx0XHRcdFx0XHRcdHNldFRpbWVvdXQoKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4ucmVnaXN0ZXJSaWJib25JY29ucykge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyUmliYm9uSWNvbnMoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdFx0fSwgNTApO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0Ly8gQWRkIGNsYXNzIGZvciBjb25kaXRpb25hbCB2aXNpYmlsaXR5IC0ga2VlcCBzZXR0aW5nIGluIGdyb3VwXHJcblx0XHRcdFx0c2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHRcdFx0XHRzZXR0aW5nLnNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFzZXR0aW5ncy5lbmFibGVPcGVuQ29uZmlnRmlsZUNvbW1hbmQpO1xyXG5cdFx0XHRcdC8vIFN0b3JlIHJlZmVyZW5jZSBmb3IgdXBkYXRpbmcgZGlzYWJsZWQgc3RhdGVcclxuXHRcdFx0XHR0aGlzLmNvbmZpZ1JpYmJvblRvZ2dsZSA9IHNldHRpbmc7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gSGVscCBidXR0b24gcmVwbGFjZW1lbnQgdG9nZ2xlIChwYXJ0IG9mIGRldmVsb3BlciBjb21tYW5kcyBncm91cClcclxuXHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdHNldHRpbmdcclxuXHRcdFx0XHRcdC5zZXROYW1lKCdTd2FwIG91dCBoZWxwIGJ1dHRvbiBmb3IgY3VzdG9tIGFjdGlvbicpXHJcblx0XHRcdFx0XHQuc2V0RGVzYygnUmVwbGFjZSB0aGUgaGVscCBidXR0b24gaW4gdGhlIHZhdWx0IHByb2ZpbGUgYXJlYSB3aXRoIGEgY3VzdG9tIGFjdGlvbi4nKVxyXG5cdFx0XHRcdFx0LmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQ/LmVuYWJsZWQgPz8gZmFsc2UpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoIXNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50ID0ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRlbmFibGVkOiBmYWxzZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0Y29tbWFuZElkOiAnZWRpdC1hc3Ryby1jb25maWcnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRpY29uSWQ6ICdyb2NrZXQnLFxyXG5cdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50LmVuYWJsZWQgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHQvLyBUcmlnZ2VyIGhlbHAgYnV0dG9uIHJlcGxhY2VtZW50IHVwZGF0ZSAoaXQgd2lsbCByZWxvYWQgc2V0dGluZ3MpXHJcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24pIHtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVuZGVyIHRvIHNob3cvaGlkZSBvcHRpb25zXHJcblx0XHRcdFx0XHRcdFx0dGhpcy5kaXNwbGF5KCk7XHJcblx0XHRcdFx0XHRcdH0pKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBTaG93IGNvbW1hbmQgYW5kIGljb24gcGlja2VycyBvbmx5IGlmIGVuYWJsZWQgKHBhcnQgb2YgZGV2ZWxvcGVyIGNvbW1hbmRzIGdyb3VwKVxyXG5cdFx0XHRpZiAoc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Py5lbmFibGVkKSB7XHJcblx0XHRcdFx0Ly8gQ29tbWFuZCBwaWNrZXJcclxuXHRcdFx0XHRjb25zdCBjb21tYW5kTmFtZSA9IHRoaXMuZ2V0Q29tbWFuZE5hbWUoc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50LmNvbW1hbmRJZCk7XHJcblx0XHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0XHQuc2V0TmFtZSgnQ29tbWFuZCcpXHJcblx0XHRcdFx0XHRcdC5zZXREZXNjKCdTZWxlY3QgdGhlIGNvbW1hbmQgdG8gZXhlY3V0ZSB3aGVuIHRoZSBidXR0b24gaXMgY2xpY2tlZC4nKVxyXG5cdFx0XHRcdFx0XHQuYWRkQnV0dG9uKGJ1dHRvbiA9PiBidXR0b25cclxuXHRcdFx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChjb21tYW5kTmFtZSB8fCAnU2VsZWN0IGNvbW1hbmQnKVxyXG5cdFx0XHRcdFx0XHRcdC5vbkNsaWNrKCgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdGNvbnN0IG1vZGFsID0gbmV3IENvbW1hbmRQaWNrZXJNb2RhbCh0aGlzLmFwcCwgKGNvbW1hbmRJZCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR2b2lkIChhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCA9IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZW5hYmxlZDogdHJ1ZSxcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y29tbWFuZElkOiAnZWRpdC1hc3Ryby1jb25maWcnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpY29uSWQ6ICdyb2NrZXQnLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50LmNvbW1hbmRJZCA9IGNvbW1hbmRJZDtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBUcmlnZ2VyIGhlbHAgYnV0dG9uIHJlcGxhY2VtZW50IHVwZGF0ZSBpbW1lZGlhdGVseSAoaXQgd2lsbCByZWxvYWQgc2V0dGluZ3MpXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24pIHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnVwZGF0ZUhlbHBCdXR0b24oKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVuZGVyIHRvIHNob3cgdXBkYXRlZCBjb21tYW5kIG5hbWVcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHR0aGlzLmRpc3BsYXkoKTtcclxuXHRcdFx0XHRcdFx0XHRcdFx0fSkoKTtcclxuXHRcdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xyXG5cdFx0XHRcdFx0XHRcdH0pKTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdFx0Ly8gSWNvbiBwaWNrZXJcclxuXHRcdFx0XHRjb25zdCBpY29uTmFtZSA9IHRoaXMuZ2V0SWNvbk5hbWUoc2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50Lmljb25JZCk7XHJcblx0XHRcdFx0ZGV2ZWxvcGVyR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdFx0c2V0dGluZ1xyXG5cdFx0XHRcdFx0XHQuc2V0TmFtZSgnSWNvbicpXHJcblx0XHRcdFx0XHRcdC5zZXREZXNjKCdTZWxlY3QgdGhlIGljb24gdG8gZGlzcGxheSBvbiB0aGUgYnV0dG9uLicpXHJcblx0XHRcdFx0XHRcdC5hZGRCdXR0b24oYnV0dG9uID0+IGJ1dHRvblxyXG5cdFx0XHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KGljb25OYW1lIHx8ICdTZWxlY3QgaWNvbi4uLicpXHJcblx0XHRcdFx0XHRcdFx0Lm9uQ2xpY2soKCkgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgbW9kYWwgPSBuZXcgSWNvblBpY2tlck1vZGFsKHRoaXMuYXBwLCAoaWNvbklkKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdHZvaWQgKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAoIXNldHRpbmdzLmhlbHBCdXR0b25SZXBsYWNlbWVudCkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0c2V0dGluZ3MuaGVscEJ1dHRvblJlcGxhY2VtZW50ID0ge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbmFibGVkOiB0cnVlLFxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjb21tYW5kSWQ6ICdlZGl0LWFzdHJvLWNvbmZpZycsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGljb25JZDogJ3JvY2tldCcsXHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9O1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRzZXR0aW5ncy5oZWxwQnV0dG9uUmVwbGFjZW1lbnQuaWNvbklkID0gaWNvbklkO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdC8vIFRyaWdnZXIgaGVscCBidXR0b24gcmVwbGFjZW1lbnQgdXBkYXRlIGltbWVkaWF0ZWx5IChpdCB3aWxsIHJlbG9hZCBzZXR0aW5ncylcclxuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbikge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4udXBkYXRlSGVscEJ1dHRvbigpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0XHQvLyBSZS1yZW5kZXIgdG8gc2hvdyB1cGRhdGVkIGljb24gbmFtZVxyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdHRoaXMuZGlzcGxheSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0XHR9KSgpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XHJcblx0XHRcdFx0XHRcdFx0fSkpO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy51cGRhdGVDb3B5SGVhZGluZ0ZpZWxkcygpO1xyXG5cdFx0Ly8gT25seSB1cGRhdGUgdGVybWluYWwvY29uZmlnIGZpZWxkcyBpZiBub3Qgb24gbW9iaWxlXHJcblx0XHRpZiAoIVBsYXRmb3JtLmlzTW9iaWxlKSB7XHJcblx0XHRcdHRoaXMudXBkYXRlVGVybWluYWxDb21tYW5kRmllbGRzKCk7XHJcblx0XHRcdHRoaXMudXBkYXRlQ29uZmlnQ29tbWFuZEZpZWxkcygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblxyXG5cdHVwZGF0ZUNvcHlIZWFkaW5nRmllbGRzKCkge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGlzVmlzaWJsZSA9IHNldHRpbmdzLmVuYWJsZUNvcHlIZWFkaW5nTGluaztcclxuXHJcblx0XHQvLyBVcGRhdGUgdGhlIFwiRGVmYXVsdCBoZWFkaW5nIGxpbmsgZm9ybWF0XCIgc2V0dGluZyBlbGVtZW50IHZpc2liaWxpdHlcclxuXHRcdGNvbnN0IGNvbnRhaW5lckVsID0gdGhpcy5jb250YWluZXJFbDtcclxuXHRcdGNvbnN0IGFsbFNldHRpbmdzID0gY29udGFpbmVyRWwucXVlcnlTZWxlY3RvckFsbCgnLnNldHRpbmctaXRlbScpO1xyXG5cdFx0YWxsU2V0dGluZ3MuZm9yRWFjaCgoc2V0dGluZ0VsKSA9PiB7XHJcblx0XHRcdGNvbnN0IG5hbWVFbCA9IHNldHRpbmdFbC5xdWVyeVNlbGVjdG9yKCcuc2V0dGluZy1pdGVtLW5hbWUnKTtcclxuXHRcdFx0aWYgKG5hbWVFbCAmJiBuYW1lRWwudGV4dENvbnRlbnQ/LnRyaW0oKSA9PT0gXCJEZWZhdWx0IGhlYWRpbmcgbGluayBmb3JtYXRcIikge1xyXG5cdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBpc1Zpc2libGUpO1xyXG5cdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9XHJcblxyXG5cdHVwZGF0ZVRlcm1pbmFsQ29tbWFuZEZpZWxkcygpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBpc1Zpc2libGUgPSBzZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSBjb250YWluZXIgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuXHRcdGlmICh0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lcikge1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiLCBpc1Zpc2libGUpO1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFVwZGF0ZSBpbmRpdmlkdWFsIHNldHRpbmcgZWxlbWVudHMgdGhhdCBhcmUgaW4gdGhlIGdyb3VwXHJcblx0XHQvLyBGaW5kIHNldHRpbmdzIGJ5IHRoZWlyIG5hbWUgdGV4dCBjb250ZW50XHJcblx0XHRjb25zdCBjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWw7XHJcblx0XHRjb25zdCBhbGxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZXR0aW5nLWl0ZW0nKTtcclxuXHRcdGFsbFNldHRpbmdzLmZvckVhY2goKHNldHRpbmdFbCkgPT4ge1xyXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBzZXR0aW5nRWwucXVlcnlTZWxlY3RvcignLnNldHRpbmctaXRlbS1uYW1lJyk7XHJcblx0XHRcdGlmIChuYW1lRWwpIHtcclxuXHRcdFx0XHRjb25zdCBuYW1lID0gbmFtZUVsLnRleHRDb250ZW50Py50cmltKCk7XHJcblx0XHRcdFx0aWYgKG5hbWUgPT09IFwiUHJvamVjdCByb290IGRpcmVjdG9yeSBwYXRoXCIgfHwgbmFtZSA9PT0gXCJTaG93IG9wZW4gdGVybWluYWwgcmliYm9uIGljb25cIikge1xyXG5cdFx0XHRcdFx0c2V0dGluZ0VsLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGlzVmlzaWJsZSk7XHJcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhaXNWaXNpYmxlKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSByaWJib24gdG9nZ2xlIGRpc2FibGVkIHN0YXRlIHVzaW5nIHRoZSB0b2dnbGUgY29tcG9uZW50XHJcblx0XHRpZiAodGhpcy50ZXJtaW5hbFJpYmJvblRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aGlzLnRlcm1pbmFsUmliYm9uVG9nZ2xlQ29tcG9uZW50LnNldERpc2FibGVkKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVPcGVuVGVybWluYWxDb21tYW5kKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdHVwZGF0ZUNvbmZpZ0NvbW1hbmRGaWVsZHMoKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgaXNWaXNpYmxlID0gc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kO1xyXG5cclxuXHRcdC8vIFVwZGF0ZSBjb250YWluZXIgZm9yIGJhY2t3YXJkIGNvbXBhdGliaWxpdHlcclxuXHRcdGlmICh0aGlzLmNvbmZpZ0NvbW1hbmRDb250YWluZXIpIHtcclxuXHRcdFx0dGhpcy5jb25maWdDb21tYW5kQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGlzVmlzaWJsZSk7XHJcblx0XHRcdHRoaXMuY29uZmlnQ29tbWFuZENvbnRhaW5lci5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdC8vIFVwZGF0ZSBpbmRpdmlkdWFsIHNldHRpbmcgZWxlbWVudHMgdGhhdCBhcmUgaW4gdGhlIGdyb3VwXHJcblx0XHQvLyBGaW5kIHNldHRpbmdzIGJ5IHRoZWlyIG5hbWUgdGV4dCBjb250ZW50XHJcblx0XHRjb25zdCBjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWw7XHJcblx0XHRjb25zdCBhbGxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZXR0aW5nLWl0ZW0nKTtcclxuXHRcdGFsbFNldHRpbmdzLmZvckVhY2goKHNldHRpbmdFbCkgPT4ge1xyXG5cdFx0XHRjb25zdCBuYW1lRWwgPSBzZXR0aW5nRWwucXVlcnlTZWxlY3RvcignLnNldHRpbmctaXRlbS1uYW1lJyk7XHJcblx0XHRcdGlmIChuYW1lRWwpIHtcclxuXHRcdFx0XHRjb25zdCBuYW1lID0gbmFtZUVsLnRleHRDb250ZW50Py50cmltKCk7XHJcblx0XHRcdFx0aWYgKG5hbWUgPT09IFwiQ29uZmlnIGZpbGUgcGF0aFwiIHx8IG5hbWUgPT09IFwiU2hvdyBvcGVuIGNvbmZpZyByaWJib24gaWNvblwiKSB7XHJcblx0XHRcdFx0XHRzZXR0aW5nRWwuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgaXNWaXNpYmxlKTtcclxuXHRcdFx0XHRcdHNldHRpbmdFbC5jbGFzc0xpc3QudG9nZ2xlKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIsICFpc1Zpc2libGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIHJpYmJvbiB0b2dnbGUgZGlzYWJsZWQgc3RhdGUgdXNpbmcgdGhlIHRvZ2dsZSBjb21wb25lbnRcclxuXHRcdGlmICh0aGlzLmNvbmZpZ1JpYmJvblRvZ2dsZUNvbXBvbmVudCkge1xyXG5cdFx0XHR0aGlzLmNvbmZpZ1JpYmJvblRvZ2dsZUNvbXBvbmVudC5zZXREaXNhYmxlZCghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlT3BlbkNvbmZpZ0ZpbGVDb21tYW5kKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGNoZWNrRm9yRm9sZGVyQ29uZmxpY3RzKCkge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGJsYW5rRm9sZGVyczogc3RyaW5nW10gPSBbXTtcclxuXHRcdGNvbnN0IGZvbGRlckNvbmZsaWN0czogeyBbZm9sZGVyOiBzdHJpbmddOiBzdHJpbmdbXSB9ID0ge307XHJcblxyXG5cdFx0Ly8gQ2hlY2sgY29udGVudCB0eXBlc1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Zm9yIChjb25zdCBjb250ZW50VHlwZSBvZiBjb250ZW50VHlwZXMpIHtcclxuXHRcdFx0aWYgKGNvbnRlbnRUeXBlLmVuYWJsZWQpIHtcclxuXHRcdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmZvbGRlciB8fCBjb250ZW50VHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKSB7XHJcblx0XHRcdFx0XHRibGFua0ZvbGRlcnMucHVzaChjb250ZW50VHlwZS5uYW1lIHx8IFwiQ29udGVudFwiKTtcclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0aWYgKCFmb2xkZXJDb25mbGljdHNbY29udGVudFR5cGUuZm9sZGVyXSkge1xyXG5cdFx0XHRcdFx0XHRmb2xkZXJDb25mbGljdHNbY29udGVudFR5cGUuZm9sZGVyXSA9IFtdO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Zm9sZGVyQ29uZmxpY3RzW2NvbnRlbnRUeXBlLmZvbGRlcl0ucHVzaChjb250ZW50VHlwZS5uYW1lIHx8IFwiQ29udGVudFwiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHQvLyBDaGVjayBmb3IgY29uZmxpY3RzXHJcblx0XHQvLyBXYXJuaW5nIGJveCByZW1vdmVkIC0gY29uZmxpY3RzIGFyZSBzdGlsbCBkZXRlY3RlZCBhdCBydW50aW1lXHJcblx0fVxyXG5cclxuXHRwcml2YXRlIGFkZEN1c3RvbUNvbnRlbnRUeXBlKCkge1xyXG5cdFx0Y29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IG5ld1R5cGU6IENvbnRlbnRUeXBlID0ge1xyXG5cdFx0XHRpZDogYGNvbnRlbnQtJHtEYXRlLm5vdygpfWAsXHJcblx0XHRcdG5hbWU6IGBDb250ZW50ICR7Y29udGVudFR5cGVzLmxlbmd0aCArIDF9YCxcclxuXHRcdFx0Zm9sZGVyOiBcIlwiLFxyXG5cdFx0XHRsaW5rQmFzZVBhdGg6IFwiXCIsXHJcblx0XHRcdHRlbXBsYXRlOiAnLS0tXFxudGl0bGU6IFwie3t0aXRsZX19XCJcXG5kYXRlOiB7e2RhdGV9fVxcbi0tLVxcbicsXHJcblx0XHRcdGVuYWJsZWQ6IHRydWUsXHJcblx0XHRcdGNyZWF0aW9uTW9kZTogXCJmaWxlXCIsXHJcblx0XHRcdGluZGV4RmlsZU5hbWU6IFwiXCIsXHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnM6IGZhbHNlLFxyXG5cdFx0XHRlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBmYWxzZSxcclxuXHRcdFx0dXNlTWR4RXh0ZW5zaW9uOiBmYWxzZSxcclxuXHRcdH07XHJcblx0XHRjb250ZW50VHlwZXMucHVzaChuZXdUeXBlKTtcclxuXHRcdHNldHRpbmdzLmNvbnRlbnRUeXBlcyA9IGNvbnRlbnRUeXBlcztcclxuXHRcdHZvaWQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIGluY2x1ZGUgdGhlIG5ldyB0eXBlXHJcblx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcy5wbHVnaW4gYXMgdW5rbm93biBhcyBQbHVnaW4sIHNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgcmVuZGVyQ3VzdG9tQ29udGVudFR5cGVzKCkge1xyXG5cdFx0aWYgKCF0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcikgcmV0dXJuO1xyXG5cclxuXHRcdHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyLmVtcHR5KCk7XHJcblxyXG5cdFx0Ly8gQWx3YXlzIHJlYWQgZnJlc2ggc2V0dGluZ3MgZnJvbSBwbHVnaW4gdG8gZW5zdXJlIHdlIGhhdmUgbGF0ZXN0IGRhdGFcclxuXHRcdC8vIFRoaXMgaXMgY3JpdGljYWwgYWZ0ZXIgbWlncmF0aW9uXHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29udGVudFR5cGVzLmZvckVhY2goKGN1c3RvbVR5cGU6IENvbnRlbnRUeXBlLCBpbmRleDogbnVtYmVyKSA9PiB7XHJcblx0XHRcdGlmICghdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXIpIHJldHVybjtcclxuXHRcdFx0Y29uc3QgdHlwZUNvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyLmNyZWF0ZURpdih7XHJcblx0XHRcdFx0Y2xzOiBcImN1c3RvbS1jb250ZW50LXR5cGUtaXRlbVwiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gSGVhZGVyIHdpdGggY29udHJvbHNcclxuXHRcdFx0Y29uc3QgaGVhZGVyID0gdHlwZUNvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZS1oZWFkZXJcIiB9KTtcclxuXHRcdFx0aGVhZGVyLmNsYXNzTGlzdC5hZGQoXCJhc3Ryby1jb21wb3Nlci1jdXN0b20tdHlwZS1oZWFkZXJcIik7XHJcblxyXG5cdFx0XHQvLyBMZWZ0IHNpZGUgLSBjb2xsYXBzZS9leHBhbmQgYnV0dG9uXHJcblx0XHRcdGNvbnN0IGNvbGxhcHNlQnV0dG9uID0gaGVhZGVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0XHRjbHM6IFwiYXN0cm8tY29tcG9zZXItY29sbGFwc2UtYnV0dG9uXCIsXHJcblx0XHRcdFx0YXR0cjogeyBcImFyaWEtbGFiZWxcIjogXCJDb2xsYXBzZS9leHBhbmRcIiB9XHJcblx0XHRcdH0pO1xyXG5cdFx0XHRjb25zdCBpc0NvbGxhcHNlZCA9IGN1c3RvbVR5cGUuY29sbGFwc2VkID8/IGZhbHNlO1xyXG5cdFx0XHQvLyBBbHdheXMgdXNlIGNoZXZyb24tZG93biwgcm90YXRlIGl0IHdoZW4gY29sbGFwc2VkIHRvIHBvaW50IHJpZ2h0XHJcblx0XHRcdHNldEljb24oY29sbGFwc2VCdXR0b24sIFwiY2hldnJvbi1kb3duXCIpO1xyXG5cdFx0XHRpZiAoaXNDb2xsYXBzZWQpIHtcclxuXHRcdFx0XHRjb2xsYXBzZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiaXMtY29sbGFwc2VkXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGNvbGxhcHNlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRcdFx0dm9pZCB0aGlzLnRvZ2dsZUNvbnRlbnRUeXBlQ29sbGFwc2UoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0Ly8gVXBkYXRlIGNsYXNzIGFmdGVyIHRvZ2dsZSAoaWNvbiBzdGF5cyB0aGUgc2FtZSwganVzdCByb3RhdGVzKVxyXG5cdFx0XHRcdGNvbnN0IHVwZGF0ZWRUeXBlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzLmZpbmQoKGN0OiBDb250ZW50VHlwZSkgPT4gY3QuaWQgPT09IGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHRcdGlmICh1cGRhdGVkVHlwZSkge1xyXG5cdFx0XHRcdFx0aWYgKHVwZGF0ZWRUeXBlLmNvbGxhcHNlZCkge1xyXG5cdFx0XHRcdFx0XHRjb2xsYXBzZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiaXMtY29sbGFwc2VkXCIpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0Y29sbGFwc2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImlzLWNvbGxhcHNlZFwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gTWlkZGxlIGxlZnQgLSBjb250ZW50IHR5cGUgbmFtZVxyXG5cdFx0XHRjb25zdCBoZWFkZXJOYW1lID0gaGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1oZWFkZXItbmFtZVwiIH0pO1xyXG5cdFx0XHRoZWFkZXJOYW1lLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogY3VzdG9tVHlwZS5uYW1lIHx8IGBDb250ZW50ICR7aW5kZXggKyAxfWAsIGNsczogXCJzZXR0aW5nLWl0ZW0tbmFtZVwiIH0pO1xyXG5cclxuXHRcdFx0Ly8gTWlkZGxlIHJpZ2h0IC0gdXAvZG93biBidXR0b25zIChzaWRlLWJ5LXNpZGUpXHJcblx0XHRcdGNvbnN0IHJlb3JkZXJDb250YWluZXIgPSBoZWFkZXIuY3JlYXRlRGl2KHsgY2xzOiBcImFzdHJvLWNvbXBvc2VyLXJlb3JkZXItYnV0dG9uc1wiIH0pO1xyXG5cdFx0XHRjb25zdCB1cEJ1dHRvbiA9IHJlb3JkZXJDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci1yZW9yZGVyLWJ1dHRvblwiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTW92ZSB1cFwiIH1cclxuXHRcdFx0fSk7XHJcblx0XHRcdHNldEljb24odXBCdXR0b24sIFwiY2hldnJvbi11cFwiKTtcclxuXHRcdFx0dXBCdXR0b24uZGlzYWJsZWQgPSBpbmRleCA9PT0gMDtcclxuXHRcdFx0dXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuXHRcdFx0XHR2b2lkIHRoaXMubW92ZUNvbnRlbnRUeXBlVXAoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Y29uc3QgZG93bkJ1dHRvbiA9IHJlb3JkZXJDb250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHRcdGNsczogXCJhc3Ryby1jb21wb3Nlci1yZW9yZGVyLWJ1dHRvblwiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJhcmlhLWxhYmVsXCI6IFwiTW92ZSBkb3duXCIgfVxyXG5cdFx0XHR9KTtcclxuXHRcdFx0c2V0SWNvbihkb3duQnV0dG9uLCBcImNoZXZyb24tZG93blwiKTtcclxuXHRcdFx0ZG93bkJ1dHRvbi5kaXNhYmxlZCA9IGluZGV4ID09PSBjb250ZW50VHlwZXMubGVuZ3RoIC0gMTtcclxuXHRcdFx0ZG93bkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG5cdFx0XHRcdHZvaWQgdGhpcy5tb3ZlQ29udGVudFR5cGVEb3duKGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIFJpZ2h0IHNpZGUgLSB0b2dnbGVcclxuXHRcdFx0Y29uc3QgdG9nZ2xlQ29udGFpbmVyID0gaGVhZGVyLmNyZWF0ZURpdih7IGNsczogXCJjaGVja2JveC1jb250YWluZXJcIiB9KTtcclxuXHRcdFx0aWYgKGN1c3RvbVR5cGUuZW5hYmxlZCkge1xyXG5cdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Y29uc3QgdG9nZ2xlID0gdG9nZ2xlQ29udGFpbmVyLmNyZWF0ZUVsKFwiaW5wdXRcIiwgeyB0eXBlOiBcImNoZWNrYm94XCIsIGNsczogXCJjaGVja2JveC1pbnB1dFwiIH0pO1xyXG5cdFx0XHR0b2dnbGUuY2hlY2tlZCA9IGN1c3RvbVR5cGUuZW5hYmxlZDtcclxuXHJcblx0XHRcdC8vIEFkZCBjbGljayBldmVudCB0byB0aGUgY29udGFpbmVyIGFzIHdlbGxcclxuXHRcdFx0dG9nZ2xlQ29udGFpbmVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG5cdFx0XHRcdHZvaWQgKGFzeW5jICgpID0+IHtcclxuXHRcdFx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0XHRcdGNvbnN0IG5ld1ZhbHVlID0gIWN1c3RvbVR5cGUuZW5hYmxlZDtcclxuXHRcdFx0XHRcdGN1c3RvbVR5cGUuZW5hYmxlZCA9IG5ld1ZhbHVlO1xyXG5cdFx0XHRcdFx0dG9nZ2xlLmNoZWNrZWQgPSBuZXdWYWx1ZTtcclxuXHJcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHJcblx0XHRcdFx0XHQvLyBVcGRhdGUgdGhlIGNvbnRhaW5lciBjbGFzcyBmb3IgdmlzdWFsIGZlZWRiYWNrXHJcblx0XHRcdFx0XHRpZiAobmV3VmFsdWUpIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5hZGQoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0dG9nZ2xlQ29udGFpbmVyLmNsYXNzTGlzdC5yZW1vdmUoXCJpcy1lbmFibGVkXCIpO1xyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdC8vIFVwZGF0ZSB2aXNpYmlsaXR5XHJcblx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCBuZXdWYWx1ZSk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIHJlZmxlY3QgZW5hYmxlZC9kaXNhYmxlZCBzdGF0ZVxyXG5cdFx0XHRcdFx0cmVnaXN0ZXJDb250ZW50VHlwZUNvbW1hbmRzKHRoaXMucGx1Z2luIGFzIHVua25vd24gYXMgUGx1Z2luLCB0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gQ29uZmxpY3QgY2hlY2tpbmcgcmVtb3ZlZCBmcm9tIHNldHRpbmdzIFVJXHJcblx0XHRcdFx0fSkoKTtcclxuXHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBBbHNvIGFkZCBjaGFuZ2UgZXZlbnQgYXMgYmFja3VwXHJcblx0XHRcdHRvZ2dsZS5hZGRFdmVudExpc3RlbmVyKFwiY2hhbmdlXCIsIChlKSA9PiB7XHJcblx0XHRcdFx0dm9pZCAoYXN5bmMgKCkgPT4ge1xyXG5cdFx0XHRcdFx0Y29uc3QgdmFsdWUgPSAoZS50YXJnZXQgYXMgSFRNTElucHV0RWxlbWVudCkuY2hlY2tlZDtcclxuXHRcdFx0XHRcdGN1c3RvbVR5cGUuZW5hYmxlZCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckNyZWF0ZUV2ZW50KCk7XHJcblxyXG5cdFx0XHRcdFx0Ly8gVXBkYXRlIHRoZSBjb250YWluZXIgY2xhc3MgZm9yIHZpc3VhbCBmZWVkYmFja1xyXG5cdFx0XHRcdFx0aWYgKHZhbHVlKSB7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdHRvZ2dsZUNvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKFwiaXMtZW5hYmxlZFwiKTtcclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHQvLyBVcGRhdGUgdmlzaWJpbGl0eVxyXG5cdFx0XHRcdFx0dGhpcy51cGRhdGVDdXN0b21Db250ZW50VHlwZVZpc2liaWxpdHkoY3VzdG9tVHlwZS5pZCwgdmFsdWUpO1xyXG5cclxuXHRcdFx0XHRcdC8vIFJlLXJlZ2lzdGVyIGNvbnRlbnQgdHlwZSBjb21tYW5kcyB0byByZWZsZWN0IGVuYWJsZWQvZGlzYWJsZWQgc3RhdGVcclxuXHRcdFx0XHRcdHJlZ2lzdGVyQ29udGVudFR5cGVDb21tYW5kcyh0aGlzLnBsdWdpbiBhcyB1bmtub3duIGFzIFBsdWdpbiwgdGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG5cdFx0XHRcdH0pKCk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gU2V0dGluZ3MgY29udGFpbmVyIHRoYXQgY2FuIGJlIGNvbGxhcHNlZFxyXG5cdFx0XHRjb25zdCBzZXR0aW5nc0NvbnRhaW5lciA9IHR5cGVDb250YWluZXIuY3JlYXRlRGl2KHtcclxuXHRcdFx0XHRjbHM6IFwiY3VzdG9tLWNvbnRlbnQtdHlwZS1zZXR0aW5nc1wiLFxyXG5cdFx0XHRcdGF0dHI6IHsgXCJkYXRhLXR5cGUtaWRcIjogY3VzdG9tVHlwZS5pZCB9XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gU2V0IGluaXRpYWwgdmlzaWJpbGl0eSBzdGF0ZSBiYXNlZCBvbiBlbmFibGVkIGFuZCBjb2xsYXBzZWQgc3RhdGVcclxuXHRcdFx0Y29uc3QgaW5pdGlhbGx5Q29sbGFwc2VkID0gY3VzdG9tVHlwZS5jb2xsYXBzZWQgPz8gZmFsc2U7XHJcblx0XHRcdGNvbnN0IGluaXRpYWxseVZpc2libGUgPSBjdXN0b21UeXBlLmVuYWJsZWQgJiYgIWluaXRpYWxseUNvbGxhcHNlZDtcclxuXHRcdFx0aWYgKGluaXRpYWxseVZpc2libGUpIHtcclxuXHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItdmlzaWJsZVwiKTtcclxuXHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRzZXR0aW5nc0NvbnRhaW5lci5jbGFzc0xpc3QuYWRkKFwiYXN0cm8tY29tcG9zZXItc2V0dGluZy1jb250YWluZXItaGlkZGVuXCIpO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBDb250ZW50IHR5cGUgbmFtZVxyXG5cdFx0XHRjb25zdCBuYW1lQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdG5ldyBTZXR0aW5nKG5hbWVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJDb250ZW50IHR5cGUgbmFtZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiRGlzcGxheSBuYW1lIGZvciB0aGlzIGNvbnRlbnQgdHlwZSAoZS5nLiwgJ3Byb2plY3RzJywgJ25vdGVzJywgJ3R1dG9yaWFscycpXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgY29udGVudCB0eXBlIG5hbWVcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUubmFtZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5uYW1lID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIHVwZGF0ZSBjb21tYW5kIG5hbWVcclxuXHRcdFx0XHRcdFx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcy5wbHVnaW4gYXMgdW5rbm93biBhcyBQbHVnaW4sIHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBGb2xkZXIgbG9jYXRpb25cclxuXHRcdFx0Y29uc3QgZm9sZGVyQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdGNvbnN0IGZvbGRlclNldHRpbmcgPSBuZXcgU2V0dGluZyhmb2xkZXJDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJGb2xkZXIgbG9jYXRpb25cIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkZvbGRlciBwYXRoIHdoZXJlIHRoaXMgY29udGVudCB0eXBlIHdpbGwgYmUgY3JlYXRlZC4gTGVhdmUgYmxhbmsgdG8gdXNlIHRoZSB2YXVsdCBmb2xkZXIuIFN1cHBvcnRzIHdpbGRjYXJkcyBsaWtlIGRpcmVjdG9yeS8qIG9yIGRpcmVjdG9yeS8qLyogdG8gbWF0Y2ggc3BlY2lmaWMgZm9sZGVyIGRlcHRocy5cIilcclxuXHRcdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xyXG5cdFx0XHRcdFx0dGV4dFxyXG5cdFx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoXCJFbnRlciBmb2xkZXIgcGF0aCAoZS5nLiwgJ2RvY3MnLCAnZG9jcy8qJywgJ2RvY3MvKi8qJykgb3IgbGVhdmUgYmxhbmsgZm9yIHZhdWx0IHJvb3RcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuZm9sZGVyKVxyXG5cdFx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlOiBzdHJpbmcpID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmZvbGRlciA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnJlZ2lzdGVyQ3JlYXRlRXZlbnQoKTtcclxuXHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSWdub3JlU3ViZm9sZGVyc0ZpZWxkKGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHRcdFx0XHRcdC8vIFVwZGF0ZSBjb25mbGljdCB3YXJuaW5ncyBmb3IgYWxsIGNvbnRlbnQgdHlwZXMgKGZvbGRlciBjaGFuZ2UgbWF5IGFmZmVjdCBvdGhlcnMpXHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgYWxsQ29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0XHRcdFx0XHRcdGZvciAoY29uc3QgY3Qgb2YgYWxsQ29udGVudFR5cGVzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHR0aGlzLnVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyhjdC5pZCwgbnVsbCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEFkZCBjb25mbGljdCB3YXJuaW5nIGVsZW1lbnRcclxuXHRcdFx0Zm9sZGVyQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1jb25mbGljdC13YXJuaW5nIGhpZGRlblwiLCBhdHRyOiB7IFwiZGF0YS10eXBlLWlkXCI6IGN1c3RvbVR5cGUuaWQgfSB9KTtcclxuXHRcdFx0dGhpcy51cGRhdGVGb2xkZXJDb25mbGljdFdhcm5pbmcoY3VzdG9tVHlwZS5pZCwgZm9sZGVyU2V0dGluZyk7XHJcblxyXG5cdFx0XHQvLyBJZ25vcmUgc3ViZm9sZGVycyAob25seSBzaG93IHdoZW4gZm9sZGVyIGlzIHNldClcclxuXHRcdFx0Y29uc3QgaWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJjdXN0b20taWdub3JlLXN1YmZvbGRlcnMtZmllbGRcIiB9KTtcclxuXHRcdFx0aWdub3JlU3ViZm9sZGVyc0NvbnRhaW5lci5zZXRBdHRyaWJ1dGUoXCJkYXRhLXR5cGUtaWRcIiwgY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgISFjdXN0b21UeXBlLmZvbGRlcik7XHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLWhpZGRlblwiLCAhY3VzdG9tVHlwZS5mb2xkZXIpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyhpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiSWdub3JlIHN1YmZvbGRlcnNcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIldoZW4gZW5hYmxlZCwgYXV0b21hdGlvbiB3aWxsIG9ubHkgdHJpZ2dlciBmb3IgbmV3IC5tZCBmaWxlcyB3aXRoaW4gdGhpcyBjb250ZW50IHR5cGUncyBmb2xkZXIgYW5kIG9uZSBsZXZlbCBkb3duIChmb3IgZm9sZGVyLWJhc2VkIGNvbnRlbnQpLiBGaWxlcyBpbiBkZWVwZXIgc3ViZm9sZGVycyB3aWxsIGJlIGlnbm9yZWQuXCIpXHJcblx0XHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG5cdFx0XHRcdFx0dG9nZ2xlXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmlnbm9yZVN1YmZvbGRlcnMgfHwgZmFsc2UpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLmlnbm9yZVN1YmZvbGRlcnMgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSlcclxuXHRcdFx0XHQpO1xyXG5cclxuXHRcdFx0Ly8gVW5kZXJzY29yZSBwcmVmaXhcclxuXHRcdFx0Y29uc3QgdW5kZXJzY29yZVByZWZpeENvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyh1bmRlcnNjb3JlUHJlZml4Q29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiVXNlIHVuZGVyc2NvcmUgcHJlZml4IGZvciBkcmFmdHNcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIkFkZCBhbiB1bmRlcnNjb3JlIHByZWZpeCAoX2NvbnRlbnQtdGl0bGUpIHRvIG5ldyBub3RlcyBieSBkZWZhdWx0IHdoZW4gZW5hYmxlZC4gVGhpcyBoaWRlcyB0aGVtIGZyb20gYXN0cm8sIHdoaWNoIGNhbiBiZSBoZWxwZnVsIGZvciBkcmFmdHNcIilcclxuXHRcdFx0XHQuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcblx0XHRcdFx0XHR0b2dnbGVcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUuZW5hYmxlVW5kZXJzY29yZVByZWZpeCB8fCBmYWxzZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogYm9vbGVhbikgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuZW5hYmxlVW5kZXJzY29yZVByZWZpeCA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBMaW5rIGJhc2UgcGF0aFxyXG5cdFx0XHRjb25zdCBsaW5rQ29udGFpbmVyID0gc2V0dGluZ3NDb250YWluZXIuY3JlYXRlRGl2KCk7XHJcblx0XHRcdG5ldyBTZXR0aW5nKGxpbmtDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJMaW5rIGJhc2UgcGF0aFwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQmFzZSBwYXRoIGZvciBjb252ZXJ0ZWQgbGlua3MgKGUuZy4sICcvcHJvamVjdHMvJywgJy9ub3Rlcy90dXRvcmlhbHMvJywgbGVhdmUgYmxhbmsgZm9yIHJvb3QgLykuXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgbGluayBiYXNlIHBhdGhcIilcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUubGlua0Jhc2VQYXRoIHx8IFwiXCIpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUubGlua0Jhc2VQYXRoID0gdmFsdWU7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly8gQ3JlYXRpb24gbW9kZVxyXG5cdFx0XHRjb25zdCBjcmVhdGlvbk1vZGVDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcoY3JlYXRpb25Nb2RlQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiQ3JlYXRpb24gbW9kZVwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiSG93IHRvIGNyZWF0ZSBuZXcgZW50cmllczogZmlsZS1iYXNlZCBvciBmb2xkZXItYmFzZWQgd2l0aCBhbiBpbmRleCBmaWxlLlwiKVxyXG5cdFx0XHRcdC5hZGREcm9wZG93bigoZHJvcGRvd24pID0+XHJcblx0XHRcdFx0XHRkcm9wZG93blxyXG5cdFx0XHRcdFx0XHQuYWRkT3B0aW9uKFwiZmlsZVwiLCBcIkZpbGUtYmFzZWQgKGNvbnRlbnQtdGl0bGUubWQpXCIpXHJcblx0XHRcdFx0XHRcdC5hZGRPcHRpb24oXCJmb2xkZXJcIiwgXCJGb2xkZXItYmFzZWQgKGNvbnRlbnQtdGl0bGUvaW5kZXgubWQpXCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmNyZWF0aW9uTW9kZSlcclxuXHRcdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZTogc3RyaW5nKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgPSB2YWx1ZSBhcyBcImZpbGVcIiB8IFwiZm9sZGVyXCI7XHJcblx0XHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHRcdFx0XHRcdFx0dGhpcy51cGRhdGVDdXN0b21Db250ZW50VHlwZUluZGV4RmlsZUZpZWxkKGN1c3RvbVR5cGUuaWQpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBVc2UgTURYIGV4dGVuc2lvblxyXG5cdFx0XHRjb25zdCB1c2VNZHhDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoKTtcclxuXHRcdFx0bmV3IFNldHRpbmcodXNlTWR4Q29udGFpbmVyKVxyXG5cdFx0XHRcdC8vIFwiTURYXCIgaXMgYSBwcm9wZXIgbm91biAoZmlsZSBmb3JtYXQpIGFuZCBzaG91bGQgYmUgY2FwaXRhbGl6ZWRcclxuXHRcdFx0XHQuc2V0TmFtZShcIlVzZSBNRFggaW5zdGVhZCBvZiBNRFwiKVxyXG5cdFx0XHRcdC5zZXREZXNjKFwiQ3JlYXRlIGZpbGVzIHdpdGggLm1keCBleHRlbnNpb24gaW5zdGVhZCBvZiAubWQgZXh0ZW5zaW9uLlwiKVxyXG5cdFx0XHRcdC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuXHRcdFx0XHRcdHRvZ2dsZVxyXG5cdFx0XHRcdFx0XHQuc2V0VmFsdWUoY3VzdG9tVHlwZS51c2VNZHhFeHRlbnNpb24gfHwgZmFsc2UpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IGJvb2xlYW4pID0+IHtcclxuXHRcdFx0XHRcdFx0XHRjdXN0b21UeXBlLnVzZU1keEV4dGVuc2lvbiA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBJbmRleCBmaWxlIG5hbWUgKG9ubHkgc2hvdyBmb3IgZm9sZGVyLWJhc2VkKVxyXG5cdFx0XHRjb25zdCBpbmRleEZpbGVDb250YWluZXIgPSBzZXR0aW5nc0NvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6IFwiY3VzdG9tLWluZGV4LWZpbGUtZmllbGRcIiB9KTtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKTtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgIT09IFwiZm9sZGVyXCIpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyhpbmRleEZpbGVDb250YWluZXIpXHJcblx0XHRcdFx0LnNldE5hbWUoXCJJbmRleCBmaWxlIG5hbWVcIilcclxuXHRcdFx0XHQuc2V0RGVzYyhcIk5hbWUgZm9yIGluZGV4IGZpbGVzIGluIGZvbGRlci1iYXNlZCBjb250ZW50ICh3aXRob3V0IC5tZCBleHRlbnNpb24pLiBEZWZhdWx0cyB0byAnaW5kZXgnIGlmIGxlZnQgYmxhbmsuXCIpXHJcblx0XHRcdFx0LmFkZFRleHQoKHRleHQpID0+XHJcblx0XHRcdFx0XHR0ZXh0XHJcblx0XHRcdFx0XHRcdC5zZXRQbGFjZWhvbGRlcihcIkluZGV4XCIpXHJcblx0XHRcdFx0XHRcdC5zZXRWYWx1ZShjdXN0b21UeXBlLmluZGV4RmlsZU5hbWUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUuaW5kZXhGaWxlTmFtZSA9IHZhbHVlO1xyXG5cdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0XHRcdFx0XHR9KVxyXG5cdFx0XHRcdCk7XHJcblxyXG5cdFx0XHQvLyBUZW1wbGF0ZVxyXG5cdFx0XHRjb25zdCB0ZW1wbGF0ZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRuZXcgU2V0dGluZyh0ZW1wbGF0ZUNvbnRhaW5lcilcclxuXHRcdFx0XHQuc2V0TmFtZShcIlByb3BlcnRpZXMgdGVtcGxhdGVcIilcclxuXHRcdFx0XHQuYWRkVGV4dEFyZWEoKHRleHQpID0+IHtcclxuXHRcdFx0XHRcdHRleHRcclxuXHRcdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKCctLS1cXG50aXRsZTogXCJ7e3RpdGxlfX1cIlxcbmRhdGU6IHt7ZGF0ZX19XFxuLS0tXFxuJylcclxuXHRcdFx0XHRcdFx0LnNldFZhbHVlKGN1c3RvbVR5cGUudGVtcGxhdGUpXHJcblx0XHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWU6IHN0cmluZykgPT4ge1xyXG5cdFx0XHRcdFx0XHRcdGN1c3RvbVR5cGUudGVtcGxhdGUgPSB2YWx1ZTtcclxuXHRcdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR0ZXh0LmlucHV0RWwuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXRlbXBsYXRlLXRleHRhcmVhXCIpO1xyXG5cdFx0XHRcdFx0cmV0dXJuIHRleHQ7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQudGhlbigoc2V0dGluZykgPT4ge1xyXG5cdFx0XHRcdFx0c2V0dGluZy5kZXNjRWwuZW1wdHkoKTtcclxuXHRcdFx0XHRcdGNvbnN0IGRlc2NEaXYgPSBzZXR0aW5nLmRlc2NFbC5jcmVhdGVFbChcImRpdlwiKTtcclxuXHRcdFx0XHRcdGRlc2NEaXYuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIlRlbXBsYXRlIGZvciBuZXcgZmlsZXMgb2YgdGhpcyBjb250ZW50IHR5cGUuXCIgfSk7XHJcblx0XHRcdFx0XHRkZXNjRGl2LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJWYXJpYWJsZXMgaW5jbHVkZSB7e3RpdGxlfX0sIHt7ZGF0ZX19LCBhbmQge3tzbHVnfX0uXCIgfSk7XHJcblx0XHRcdFx0XHRkZXNjRGl2LmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogXCJEbyBub3Qgd3JhcCB7e2RhdGV9fSBpbiBxdW90ZXMgYXMgaXQgcmVwcmVzZW50cyBhIGRhdGV0aW1lIHZhbHVlLCBub3QgYSBzdHJpbmcuXCIgfSk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cdFx0XHQvLyBSZW1vdmUgYnV0dG9uIGF0IHRoZSBib3R0b20gKG5vIGRpdmlkZXIpXHJcblx0XHRcdGNvbnN0IHJlbW92ZUNvbnRhaW5lciA9IHNldHRpbmdzQ29udGFpbmVyLmNyZWF0ZURpdigpO1xyXG5cdFx0XHRjb25zdCByZW1vdmVTZXR0aW5nID0gbmV3IFNldHRpbmcocmVtb3ZlQ29udGFpbmVyKVxyXG5cdFx0XHRcdC5zZXROYW1lKFwiXCIpXHJcblx0XHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uKSA9PiB7XHJcblx0XHRcdFx0XHRidXR0b25cclxuXHRcdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCJSZW1vdmVcIilcclxuXHRcdFx0XHRcdFx0LnNldFdhcm5pbmcoKVxyXG5cdFx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jb250ZW50VHlwZXMuZmluZChjdCA9PiBjdC5pZCA9PT0gY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgdHlwZU5hbWUgPSBjb250ZW50VHlwZT8ubmFtZSB8fCBcImNvbnRlbnQgdHlwZVwiO1xyXG5cdFx0XHRcdFx0XHRcdGNvbnN0IG1vZGFsID0gbmV3IENvbmZpcm1Nb2RhbChcclxuXHRcdFx0XHRcdFx0XHRcdHRoaXMuYXBwLFxyXG5cdFx0XHRcdFx0XHRcdFx0YEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byByZW1vdmUgXCIke3R5cGVOYW1lfVwiPyBUaGlzIGFjdGlvbiBjYW5ub3QgYmUgdW5kb25lLmAsXHJcblx0XHRcdFx0XHRcdFx0XHRcIlJlbW92ZVwiLFxyXG5cdFx0XHRcdFx0XHRcdFx0XCJDYW5jZWxcIlxyXG5cdFx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdFx0Y29uc3QgY29uZmlybWVkID0gYXdhaXQgbW9kYWwud2FpdEZvclJlc3VsdCgpO1xyXG5cdFx0XHRcdFx0XHRcdGlmIChjb25maXJtZWQpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucmVtb3ZlQ3VzdG9tQ29udGVudFR5cGUoY3VzdG9tVHlwZS5pZCk7XHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHR9KTtcclxuXHJcblx0XHRcdC8vIEhpZGUgdGhlIGRpdmlkZXIgbGluZSBmb3IgdGhlIHJlbW92ZSBidXR0b25cclxuXHRcdFx0cmVtb3ZlU2V0dGluZy5zZXR0aW5nRWwuY2xhc3NMaXN0LmFkZChcImFzdHJvLWNvbXBvc2VyLXJlbW92ZS1zZXR0aW5nXCIpO1xyXG5cclxuXHRcdFx0Ly8gU2V0IGluaXRpYWwgdmlzaWJpbGl0eSAoY2hlY2tzIGJvdGggZW5hYmxlZCBhbmQgY29sbGFwc2VkIHN0YXRlKVxyXG5cdFx0XHR0aGlzLnVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlVmlzaWJpbGl0eShjdXN0b21UeXBlLmlkLCBjdXN0b21UeXBlLmVuYWJsZWQpO1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0Ly8gVXBkYXRlIGNvbmZsaWN0IHdhcm5pbmdzIGZvciBhbGwgdHlwZXMgYWZ0ZXIgcmVuZGVyaW5nIChmb2xkZXIgY2hhbmdlcyBtYXkgYWZmZWN0IG90aGVycylcclxuXHRcdGNvbnRlbnRUeXBlcy5mb3JFYWNoKChjdXN0b21UeXBlOiBDb250ZW50VHlwZSkgPT4ge1xyXG5cdFx0XHR0aGlzLnVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyhjdXN0b21UeXBlLmlkLCBudWxsKTtcclxuXHRcdH0pO1xyXG5cclxuXHRcdC8vIEFkZCBmbG9hdGluZyBidXR0b24gZm9yIGNyZWF0aW5nIG5ldyBjdXN0b20gY29udGVudCB0eXBlcyAobm8gc2V0dGluZ3MgYmFja2dyb3VuZClcclxuXHRcdGNvbnN0IGFkZEJ1dHRvbkNvbnRhaW5lciA9IHRoaXMuY3VzdG9tQ29udGVudFR5cGVzQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJhc3Ryby1jb21wb3Nlci1hZGQtYnV0dG9uLWNvbnRhaW5lclwiIH0pO1xyXG5cdFx0Y29uc3QgYWRkQnV0dG9uID0gYWRkQnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0Y2xzOiBcIm1vZC1jdGFcIixcclxuXHRcdFx0dGV4dDogXCJBZGQgY29udGVudCB0eXBlXCJcclxuXHRcdH0pO1xyXG5cdFx0YWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcblx0XHRcdHRoaXMuYWRkQ3VzdG9tQ29udGVudFR5cGUoKTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVDdXN0b21Db250ZW50VHlwZVZpc2liaWxpdHkodHlwZUlkOiBzdHJpbmcsIGVuYWJsZWQ6IGJvb2xlYW4pIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzQ29udGFpbmVyID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXR5cGUtaWQ9XCIke3R5cGVJZH1cIl0uY3VzdG9tLWNvbnRlbnQtdHlwZS1zZXR0aW5nc2ApIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0aWYgKHNldHRpbmdzQ29udGFpbmVyKSB7XHJcblx0XHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gdHlwZUlkKTtcclxuXHRcdFx0Y29uc3QgaXNDb2xsYXBzZWQgPSBjb250ZW50VHlwZT8uY29sbGFwc2VkID8/IGZhbHNlO1xyXG5cdFx0XHRjb25zdCBzaG91bGRCZVZpc2libGUgPSBlbmFibGVkICYmICFpc0NvbGxhcHNlZDtcclxuXHJcblx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIHNob3VsZEJlVmlzaWJsZSk7XHJcblx0XHRcdHNldHRpbmdzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIXNob3VsZEJlVmlzaWJsZSk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHVwZGF0ZUN1c3RvbUNvbnRlbnRUeXBlSW5kZXhGaWxlRmllbGQodHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IGN1c3RvbVR5cGUgPSBjb250ZW50VHlwZXMuZmluZCh0eXBlID0+IHR5cGUuaWQgPT09IHR5cGVJZCk7XHJcblx0XHRpZiAoIWN1c3RvbVR5cGUpIHJldHVybjtcclxuXHJcblx0XHRjb25zdCBpbmRleEZpbGVDb250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcj8ucXVlcnlTZWxlY3RvcihgW2RhdGEtdHlwZS1pZD1cIiR7dHlwZUlkfVwiXSAuY3VzdG9tLWluZGV4LWZpbGUtZmllbGRgKSBhcyBIVE1MRWxlbWVudDtcclxuXHRcdGlmIChpbmRleEZpbGVDb250YWluZXIpIHtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci12aXNpYmxlXCIsIGN1c3RvbVR5cGUuY3JlYXRpb25Nb2RlID09PSBcImZvbGRlclwiKTtcclxuXHRcdFx0aW5kZXhGaWxlQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgY3VzdG9tVHlwZS5jcmVhdGlvbk1vZGUgIT09IFwiZm9sZGVyXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSB1cGRhdGVDdXN0b21Db250ZW50VHlwZUlnbm9yZVN1YmZvbGRlcnNGaWVsZCh0eXBlSWQ6IHN0cmluZykge1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY3VzdG9tVHlwZSA9IGNvbnRlbnRUeXBlcy5maW5kKHR5cGUgPT4gdHlwZS5pZCA9PT0gdHlwZUlkKTtcclxuXHRcdGlmICghY3VzdG9tVHlwZSkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIgPSB0aGlzLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lcj8ucXVlcnlTZWxlY3RvcihgW2RhdGEtdHlwZS1pZD1cIiR7dHlwZUlkfVwiXS5jdXN0b20taWdub3JlLXN1YmZvbGRlcnMtZmllbGRgKSBhcyBIVE1MRWxlbWVudDtcclxuXHRcdGlmIChpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyKSB7XHJcblx0XHRcdGlnbm9yZVN1YmZvbGRlcnNDb250YWluZXIuY2xhc3NMaXN0LnRvZ2dsZShcImFzdHJvLWNvbXBvc2VyLXNldHRpbmctY29udGFpbmVyLXZpc2libGVcIiwgISFjdXN0b21UeXBlLmZvbGRlciAmJiBjdXN0b21UeXBlLmZvbGRlci50cmltKCkgIT09IFwiXCIpO1xyXG5cdFx0XHRpZ25vcmVTdWJmb2xkZXJzQ29udGFpbmVyLmNsYXNzTGlzdC50b2dnbGUoXCJhc3Ryby1jb21wb3Nlci1zZXR0aW5nLWNvbnRhaW5lci1oaWRkZW5cIiwgIWN1c3RvbVR5cGUuZm9sZGVyIHx8IGN1c3RvbVR5cGUuZm9sZGVyLnRyaW0oKSA9PT0gXCJcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRwcml2YXRlIHVwZGF0ZUZvbGRlckNvbmZsaWN0V2FybmluZyh0eXBlSWQ6IHN0cmluZywgc2V0dGluZzogU2V0dGluZyB8IG51bGwpIHtcclxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuXHRcdGNvbnN0IGN1cnJlbnRUeXBlID0gY29udGVudFR5cGVzLmZpbmQodHlwZSA9PiB0eXBlLmlkID09PSB0eXBlSWQpO1xyXG5cdFx0aWYgKCFjdXJyZW50VHlwZSkgcmV0dXJuO1xyXG5cclxuXHRcdGNvbnN0IGNvbmZsaWN0V2FybmluZ0VsID0gdGhpcy5jdXN0b21Db250ZW50VHlwZXNDb250YWluZXI/LnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXR5cGUtaWQ9XCIke3R5cGVJZH1cIl0uYXN0cm8tY29tcG9zZXItY29uZmxpY3Qtd2FybmluZ2ApIGFzIEhUTUxFbGVtZW50O1xyXG5cdFx0aWYgKCFjb25mbGljdFdhcm5pbmdFbCkgcmV0dXJuO1xyXG5cclxuXHRcdC8vIEZpbmQgY29uZmxpY3RzIC0gb3RoZXIgY29udGVudCB0eXBlcyB3aXRoIHRoZSBzYW1lIGZvbGRlciBwYXR0ZXJuXHJcblx0XHRjb25zdCBjdXJyZW50Rm9sZGVyID0gKGN1cnJlbnRUeXBlLmZvbGRlciB8fCBcIlwiKS50cmltKCk7XHJcblx0XHRjb25zdCBjb25mbGljdGluZ1R5cGVzOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuXHRcdGZvciAoY29uc3Qgb3RoZXJUeXBlIG9mIGNvbnRlbnRUeXBlcykge1xyXG5cdFx0XHRpZiAob3RoZXJUeXBlLmlkID09PSB0eXBlSWQgfHwgIW90aGVyVHlwZS5lbmFibGVkKSBjb250aW51ZTtcclxuXHJcblx0XHRcdGNvbnN0IG90aGVyRm9sZGVyID0gKG90aGVyVHlwZS5mb2xkZXIgfHwgXCJcIikudHJpbSgpO1xyXG5cclxuXHRcdFx0Ly8gQ2hlY2sgaWYgZm9sZGVycyBjb25mbGljdFxyXG5cdFx0XHQvLyBCb3RoIGJsYW5rID0gY29uZmxpY3QgKGJvdGggbWF0Y2ggdmF1bHQgcm9vdClcclxuXHRcdFx0aWYgKGN1cnJlbnRGb2xkZXIgPT09IFwiXCIgJiYgb3RoZXJGb2xkZXIgPT09IFwiXCIpIHtcclxuXHRcdFx0XHRjb25mbGljdGluZ1R5cGVzLnB1c2gob3RoZXJUeXBlLm5hbWUgfHwgXCJVbm5hbWVkXCIpO1xyXG5cdFx0XHR9XHJcblx0XHRcdC8vIFNhbWUgZm9sZGVyID0gY29uZmxpY3RcclxuXHRcdFx0ZWxzZSBpZiAoY3VycmVudEZvbGRlciA9PT0gb3RoZXJGb2xkZXIgJiYgY3VycmVudEZvbGRlciAhPT0gXCJcIikge1xyXG5cdFx0XHRcdGNvbmZsaWN0aW5nVHlwZXMucHVzaChvdGhlclR5cGUubmFtZSB8fCBcIlVubmFtZWRcIik7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoY29uZmxpY3RpbmdUeXBlcy5sZW5ndGggPiAwKSB7XHJcblx0XHRcdGNvbmZsaWN0V2FybmluZ0VsLnJlbW92ZUNsYXNzKFwiaGlkZGVuXCIpO1xyXG5cdFx0XHRjb25mbGljdFdhcm5pbmdFbC50ZXh0Q29udGVudCA9IGBDb25mbGljdDogJHtjb25mbGljdGluZ1R5cGVzLmpvaW4oXCIsIFwiKX0gYWxzbyB1c2Uke2NvbmZsaWN0aW5nVHlwZXMubGVuZ3RoID09PSAxID8gXCJzXCIgOiBcIlwifSB0aGlzIGZvbGRlci4gTW9yZSBzcGVjaWZpYyBwYXR0ZXJucyB3aWxsIHRha2UgcHJpb3JpdHkuYDtcclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdGNvbmZsaWN0V2FybmluZ0VsLmFkZENsYXNzKFwiaGlkZGVuXCIpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblxyXG5cdHByaXZhdGUgYXN5bmMgbW92ZUNvbnRlbnRUeXBlVXAodHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRjb25zdCBjdXJyZW50SW5kZXggPSBjb250ZW50VHlwZXMuZmluZEluZGV4KChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkID09PSB0eXBlSWQpO1xyXG5cclxuXHRcdGlmIChjdXJyZW50SW5kZXggPD0gMCkgcmV0dXJuOyAvLyBBbHJlYWR5IGF0IHRoZSB0b3BcclxuXHJcblx0XHQvLyBTd2FwIHdpdGggcHJldmlvdXMgaXRlbVxyXG5cdFx0W2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXhdLCBjb250ZW50VHlwZXNbY3VycmVudEluZGV4IC0gMV1dID0gW2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXggLSAxXSwgY29udGVudFR5cGVzW2N1cnJlbnRJbmRleF1dO1xyXG5cdFx0c2V0dGluZ3MuY29udGVudFR5cGVzID0gY29udGVudFR5cGVzO1xyXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyBtb3ZlQ29udGVudFR5cGVEb3duKHR5cGVJZDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY3VycmVudEluZGV4ID0gY29udGVudFR5cGVzLmZpbmRJbmRleCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gdHlwZUlkKTtcclxuXHJcblx0XHRpZiAoY3VycmVudEluZGV4IDwgMCB8fCBjdXJyZW50SW5kZXggPj0gY29udGVudFR5cGVzLmxlbmd0aCAtIDEpIHJldHVybjsgLy8gQWxyZWFkeSBhdCB0aGUgYm90dG9tXHJcblxyXG5cdFx0Ly8gU3dhcCB3aXRoIG5leHQgaXRlbVxyXG5cdFx0W2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXhdLCBjb250ZW50VHlwZXNbY3VycmVudEluZGV4ICsgMV1dID0gW2NvbnRlbnRUeXBlc1tjdXJyZW50SW5kZXggKyAxXSwgY29udGVudFR5cGVzW2N1cnJlbnRJbmRleF1dO1xyXG5cdFx0c2V0dGluZ3MuY29udGVudFR5cGVzID0gY29udGVudFR5cGVzO1xyXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdH1cclxuXHJcblx0cHJpdmF0ZSBhc3luYyB0b2dnbGVDb250ZW50VHlwZUNvbGxhcHNlKHR5cGVJZDogc3RyaW5nKSB7XHJcblx0XHRjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xyXG5cdFx0Y29uc3QgY29udGVudFR5cGUgPSBjb250ZW50VHlwZXMuZmluZCgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5pZCA9PT0gdHlwZUlkKTtcclxuXHJcblx0XHRpZiAoIWNvbnRlbnRUeXBlKSByZXR1cm47XHJcblxyXG5cdFx0Y29udGVudFR5cGUuY29sbGFwc2VkID0gIWNvbnRlbnRUeXBlLmNvbGxhcHNlZDtcclxuXHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG5cdFx0dGhpcy51cGRhdGVDdXN0b21Db250ZW50VHlwZVZpc2liaWxpdHkodHlwZUlkLCBjb250ZW50VHlwZS5lbmFibGVkKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgYXN5bmMgcmVtb3ZlQ3VzdG9tQ29udGVudFR5cGUodHlwZUlkOiBzdHJpbmcpIHtcclxuXHRcdGNvbnN0IHNldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XHJcblx0XHRjb25zdCBjb250ZW50VHlwZXMgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcblx0XHRzZXR0aW5ncy5jb250ZW50VHlwZXMgPSBjb250ZW50VHlwZXMuZmlsdGVyKChjdDogQ29udGVudFR5cGUpID0+IGN0LmlkICE9PSB0eXBlSWQpO1xyXG5cdFx0Ly8gQ1JJVElDQUw6IEF3YWl0IHRoZSBzYXZlIHRvIGVuc3VyZSBkZWxldGlvbiBpcyBwZXJzaXN0ZWQgYmVmb3JlIGFueSByZWxvYWRzIGhhcHBlblxyXG5cdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcblx0XHR0aGlzLnJlbmRlckN1c3RvbUNvbnRlbnRUeXBlcygpO1xyXG5cdFx0dGhpcy5wbHVnaW4ucmVnaXN0ZXJDcmVhdGVFdmVudCgpO1xyXG5cdFx0Ly8gUmUtcmVnaXN0ZXIgY29udGVudCB0eXBlIGNvbW1hbmRzIHRvIHJlbW92ZSB0aGUgZGVsZXRlZCB0eXBlXHJcblx0XHRyZWdpc3RlckNvbnRlbnRUeXBlQ29tbWFuZHModGhpcy5wbHVnaW4gYXMgdW5rbm93biBhcyBQbHVnaW4sIHNldHRpbmdzKTtcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0Q29tbWFuZE5hbWUoY29tbWFuZElkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdFx0aWYgKCFjb21tYW5kSWQpIHJldHVybiAnJztcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IGNvbW1hbmRSZWdpc3RyeSA9ICh0aGlzLmFwcCBhcyB1bmtub3duIGFzIHsgY29tbWFuZHM/OiB7IGxpc3RDb21tYW5kcz86ICgpID0+IEFycmF5PHsgaWQ6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0+OyBjb21tYW5kcz86IFJlY29yZDxzdHJpbmcsIHsgaWQ6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0+IH0gfSkuY29tbWFuZHM7XHJcblxyXG5cdFx0XHQvLyBNZXRob2QgMTogVHJ5IGxpc3RDb21tYW5kcygpXHJcblx0XHRcdGlmIChjb21tYW5kUmVnaXN0cnkgJiYgdHlwZW9mIGNvbW1hbmRSZWdpc3RyeS5saXN0Q29tbWFuZHMgPT09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHR0cnkge1xyXG5cdFx0XHRcdFx0Y29uc3QgYWxsQ29tbWFuZHMgPSBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzKCk7XHJcblx0XHRcdFx0XHRjb25zdCBjb21tYW5kID0gYWxsQ29tbWFuZHMuZmluZCgoY21kOiB7IGlkOiBzdHJpbmc7IG5hbWU/OiBzdHJpbmcgfSkgPT4gY21kLmlkID09PSBjb21tYW5kSWQpO1xyXG5cdFx0XHRcdFx0aWYgKGNvbW1hbmQ/Lm5hbWUpIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIGNvbW1hbmQubmFtZTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kIG5hbWUgdmlhIGxpc3RDb21tYW5kcygpOicsIGUpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0Ly8gTWV0aG9kIDI6IFRyeSBhY2Nlc3NpbmcgdGhlIGludGVybmFsIGNvbW1hbmRzIHJlZ2lzdHJ5IGRpcmVjdGx5XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Y29uc3QgcmVnaXN0cnkgPSBjb21tYW5kUmVnaXN0cnk/LmNvbW1hbmRzO1xyXG5cdFx0XHRcdGlmIChyZWdpc3RyeSAmJiB0eXBlb2YgcmVnaXN0cnkgPT09ICdvYmplY3QnKSB7XHJcblx0XHRcdFx0XHRjb25zdCBjb21tYW5kID0gKHJlZ2lzdHJ5IGFzIFJlY29yZDxzdHJpbmcsIHsgbmFtZT86IHN0cmluZyB9PilbY29tbWFuZElkXTtcclxuXHRcdFx0XHRcdGlmIChjb21tYW5kPy5uYW1lKSB7XHJcblx0XHRcdFx0XHRcdHJldHVybiBjb21tYW5kLm5hbWU7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdFx0Y29uc29sZS53YXJuKCdbQXN0cm8gQ29tcG9zZXJdIEVycm9yIGdldHRpbmcgY29tbWFuZCBuYW1lIHZpYSByZWdpc3RyeTonLCBlKTtcclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kIG5hbWU6JywgZSk7XHJcblx0XHR9XHJcblx0XHQvLyBSZXR1cm4gZW1wdHkgc3RyaW5nIGlmIGNvbW1hbmQgbm90IGZvdW5kLCBzbyBpdCBzaG93cyBcIlNlbGVjdCBjb21tYW5kLi4uXCIgcGxhY2Vob2xkZXJcclxuXHRcdHJldHVybiAnJztcclxuXHR9XHJcblxyXG5cdHByaXZhdGUgZ2V0SWNvbk5hbWUoaWNvbklkOiBzdHJpbmcpOiBzdHJpbmcge1xyXG5cdFx0aWYgKCFpY29uSWQpIHJldHVybiAnJztcclxuXHRcdC8vIENvbnZlcnQgaWNvbiBJRCB0byBhIHJlYWRhYmxlIG5hbWUsIHJlbW92aW5nIGx1Y2lkZS0gcHJlZml4IGlmIHByZXNlbnRcclxuXHRcdHJldHVybiBpY29uSWRcclxuXHRcdFx0LnJlcGxhY2UoL15sdWNpZGUtLywgJycpIC8vIFJlbW92ZSBsdWNpZGUtIHByZWZpeFxyXG5cdFx0XHQuc3BsaXQoJy0nKVxyXG5cdFx0XHQubWFwKHdvcmQgPT4gd29yZC5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHdvcmQuc2xpY2UoMSkpXHJcblx0XHRcdC5qb2luKCcgJyk7XHJcblx0fVxyXG59XHJcbiIsICIvKipcclxuICogQ29tbWFuZCBQaWNrZXIgTW9kYWxcclxuICogU2VhcmNoYWJsZSBtb2RhbCBmb3Igc2VsZWN0aW5nIGFuIE9ic2lkaWFuIGNvbW1hbmRcclxuICovXHJcblxyXG5pbXBvcnQgeyBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW50ZXJmYWNlIENvbW1hbmRPcHRpb24ge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ29tbWFuZFBpY2tlck1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8Q29tbWFuZE9wdGlvbj4ge1xyXG5cdHByaXZhdGUgb25TZWxlY3Q6IChjb21tYW5kSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoY29tbWFuZElkOiBzdHJpbmcpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtcygpOiBDb21tYW5kT3B0aW9uW10ge1xyXG5cdFx0Ly8gR2V0IGFsbCBhdmFpbGFibGUgY29tbWFuZHNcclxuXHRcdC8vIFRyeSBtdWx0aXBsZSBtZXRob2RzIHRvIGVuc3VyZSB3ZSBnZXQgQUxMIGNvbW1hbmRzLCBub3QganVzdCBjb250ZXh0LWZpbHRlcmVkIG9uZXNcclxuXHRcdGNvbnN0IGNvbW1hbmRSZWdpc3RyeSA9ICh0aGlzLmFwcCBhcyB7IGNvbW1hbmRzPzogeyBsaXN0Q29tbWFuZHM/OiAoKSA9PiBDb21tYW5kT3B0aW9uW107IGNvbW1hbmRzPzogUmVjb3JkPHN0cmluZywgQ29tbWFuZE9wdGlvbj47IGNvbW1hbmRSZWdpc3RyeT86IFJlY29yZDxzdHJpbmcsIENvbW1hbmRPcHRpb24+IH0gfSkuY29tbWFuZHM7XHJcblx0XHRcclxuXHRcdC8vIFVzZSBhIFNldCB0byBkZWR1cGxpY2F0ZSBieSBjb21tYW5kIElEXHJcblx0XHRjb25zdCBjb21tYW5kTWFwID0gbmV3IE1hcDxzdHJpbmcsIENvbW1hbmRPcHRpb24+KCk7XHJcblx0XHRcclxuXHRcdC8vIE1ldGhvZCAxOiBUcnkgbGlzdENvbW1hbmRzKCkgLSBidXQgdGhpcyBtaWdodCBiZSBjb250ZXh0LWZpbHRlcmVkXHJcblx0XHRpZiAoY29tbWFuZFJlZ2lzdHJ5ICYmIHR5cGVvZiBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzID09PSAnZnVuY3Rpb24nKSB7XHJcblx0XHRcdHRyeSB7XHJcblx0XHRcdFx0Y29uc3QgY29tbWFuZHMgPSBjb21tYW5kUmVnaXN0cnkubGlzdENvbW1hbmRzKCk7XHJcblx0XHRcdFx0Zm9yIChjb25zdCBjb21tYW5kIG9mIGNvbW1hbmRzKSB7XHJcblx0XHRcdFx0XHRpZiAoY29tbWFuZCAmJiBjb21tYW5kLmlkICYmIGNvbW1hbmQubmFtZSAmJiAhY29tbWFuZE1hcC5oYXMoY29tbWFuZC5pZCkpIHtcclxuXHRcdFx0XHRcdFx0Y29tbWFuZE1hcC5zZXQoY29tbWFuZC5pZCwge1xyXG5cdFx0XHRcdFx0XHRcdGlkOiBjb21tYW5kLmlkLFxyXG5cdFx0XHRcdFx0XHRcdG5hbWU6IGNvbW1hbmQubmFtZVxyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kcyB2aWEgbGlzdENvbW1hbmRzKCk6JywgZSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gTWV0aG9kIDI6IFRyeSBhY2Nlc3NpbmcgdGhlIGludGVybmFsIGNvbW1hbmRzIHJlZ2lzdHJ5IGRpcmVjdGx5XHJcblx0XHQvLyBUaGlzIHNob3VsZCBnaXZlIHVzIEFMTCBjb21tYW5kcyByZWdhcmRsZXNzIG9mIGNvbnRleHRcclxuXHRcdHRyeSB7XHJcblx0XHRcdGNvbnN0IHJlZ2lzdHJ5ID0gY29tbWFuZFJlZ2lzdHJ5Py5jb21tYW5kcztcclxuXHRcdFx0aWYgKHJlZ2lzdHJ5ICYmIHR5cGVvZiByZWdpc3RyeSA9PT0gJ29iamVjdCcpIHtcclxuXHRcdFx0XHRjb25zdCBhbGxDb21tYW5kcyA9IE9iamVjdC52YWx1ZXMocmVnaXN0cnkpO1xyXG5cdFx0XHRcdGZvciAoY29uc3QgY29tbWFuZCBvZiBhbGxDb21tYW5kcykge1xyXG5cdFx0XHRcdFx0aWYgKGNvbW1hbmQgJiYgY29tbWFuZC5pZCAmJiBjb21tYW5kLm5hbWUgJiYgIWNvbW1hbmRNYXAuaGFzKGNvbW1hbmQuaWQpKSB7XHJcblx0XHRcdFx0XHRcdGNvbW1hbmRNYXAuc2V0KGNvbW1hbmQuaWQsIHtcclxuXHRcdFx0XHRcdFx0XHRpZDogY29tbWFuZC5pZCxcclxuXHRcdFx0XHRcdFx0XHRuYW1lOiBjb21tYW5kLm5hbWVcclxuXHRcdFx0XHRcdFx0fSk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9IGNhdGNoIChlKSB7XHJcblx0XHRcdGNvbnNvbGUud2FybignW0FzdHJvIENvbXBvc2VyXSBFcnJvciBnZXR0aW5nIGNvbW1hbmRzIHZpYSByZWdpc3RyeTonLCBlKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0Ly8gTWV0aG9kIDM6IFRyeSBhY2Nlc3NpbmcgdmlhIGludGVybmFsIHN0cnVjdHVyZSAoZmFsbGJhY2spXHJcblx0XHR0cnkge1xyXG5cdFx0XHRjb25zdCBpbnRlcm5hbFJlZ2lzdHJ5ID0gY29tbWFuZFJlZ2lzdHJ5Py5jb21tYW5kUmVnaXN0cnk7XHJcblx0XHRcdGlmIChpbnRlcm5hbFJlZ2lzdHJ5ICYmIHR5cGVvZiBpbnRlcm5hbFJlZ2lzdHJ5ID09PSAnb2JqZWN0Jykge1xyXG5cdFx0XHRcdGNvbnN0IGFsbENvbW1hbmRzID0gT2JqZWN0LnZhbHVlcyhpbnRlcm5hbFJlZ2lzdHJ5KTtcclxuXHRcdFx0XHRmb3IgKGNvbnN0IGNvbW1hbmQgb2YgYWxsQ29tbWFuZHMpIHtcclxuXHRcdFx0XHRcdGlmIChjb21tYW5kICYmIGNvbW1hbmQuaWQgJiYgY29tbWFuZC5uYW1lICYmICFjb21tYW5kTWFwLmhhcyhjb21tYW5kLmlkKSkge1xyXG5cdFx0XHRcdFx0XHRjb21tYW5kTWFwLnNldChjb21tYW5kLmlkLCB7XHJcblx0XHRcdFx0XHRcdFx0aWQ6IGNvbW1hbmQuaWQsXHJcblx0XHRcdFx0XHRcdFx0bmFtZTogY29tbWFuZC5uYW1lXHJcblx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSBjYXRjaCAoZSkge1xyXG5cdFx0XHRjb25zb2xlLndhcm4oJ1tBc3RybyBDb21wb3Nlcl0gRXJyb3IgZ2V0dGluZyBjb21tYW5kcyB2aWEgaW50ZXJuYWwgcmVnaXN0cnk6JywgZSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGNvbnN0IGNvbW1hbmRPcHRpb25zID0gQXJyYXkuZnJvbShjb21tYW5kTWFwLnZhbHVlcygpKTtcclxuXHRcdFxyXG5cdFx0Ly8gU29ydCBhbHBoYWJldGljYWxseSBieSBuYW1lXHJcblx0XHRjb21tYW5kT3B0aW9ucy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcclxuXHRcdFxyXG5cdFx0cmV0dXJuIGNvbW1hbmRPcHRpb25zO1xyXG5cdH1cclxuXHJcblx0Z2V0SXRlbVRleHQoaXRlbTogQ29tbWFuZE9wdGlvbik6IHN0cmluZyB7XHJcblx0XHRyZXR1cm4gaXRlbS5uYW1lO1xyXG5cdH1cclxuXHJcblx0b25DaG9vc2VJdGVtKGl0ZW06IENvbW1hbmRPcHRpb24sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcclxuXHRcdHRoaXMub25TZWxlY3QoaXRlbS5pZCk7XHJcblx0fVxyXG5cclxuXHQvLyBPdmVycmlkZSB0byBzaG93IGNvbW1hbmQgbmFtZSBvbmx5XHJcblx0cmVuZGVyU3VnZ2VzdGlvbihtYXRjaDogeyBpdGVtOiBDb21tYW5kT3B0aW9uIH0sIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xyXG5cdFx0Y29uc3QgaXRlbSA9IG1hdGNoLml0ZW07XHJcblx0XHRlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJywgdGV4dDogaXRlbS5uYW1lIH0pO1xyXG5cdH1cclxufVxyXG5cclxuIiwgIi8qKlxyXG4gKiBJY29uIFBpY2tlciBNb2RhbFxyXG4gKiBTZWFyY2hhYmxlIG1vZGFsIGZvciBzZWxlY3RpbmcgYSBMdWNpZGUgaWNvblxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgRnV6enlTdWdnZXN0TW9kYWwsIHNldEljb24sIGdldEljb25JZHMsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5cclxuaW50ZXJmYWNlIEljb25PcHRpb24ge1xyXG5cdGlkOiBzdHJpbmc7XHJcblx0bmFtZTogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBHZXQgaWNvbiBsaXN0IGZyb20gT2JzaWRpYW4gQVBJIGlmIGF2YWlsYWJsZSwgb3RoZXJ3aXNlIHVzZSBmYWxsYmFjayBsaXN0XHJcbmNvbnN0IGdldEljb25MaXN0ID0gKCk6IHN0cmluZ1tdID0+IHtcclxuXHRpZiAocmVxdWlyZUFwaVZlcnNpb24gJiYgcmVxdWlyZUFwaVZlcnNpb24oJzEuNy4zJykgJiYgZ2V0SWNvbklkcykge1xyXG5cdFx0dHJ5IHtcclxuXHRcdFx0cmV0dXJuIGdldEljb25JZHMoKTtcclxuXHRcdH0gY2F0Y2ggKGUpIHtcclxuXHRcdFx0Y29uc29sZS53YXJuKCdbQXN0cm8gQ29tcG9zZXJdIEVycm9yIGdldHRpbmcgaWNvbiBJRHMgZnJvbSBPYnNpZGlhbjonLCBlKTtcclxuXHRcdH1cclxuXHR9XHJcblx0Ly8gRmFsbGJhY2sgdG8gYSBiYXNpYyBsaXN0IGlmIEFQSSBpcyBub3QgYXZhaWxhYmxlXHJcblx0cmV0dXJuIFtcclxuXHRcdCdzZXR0aW5ncy0yJywgJ3NldHRpbmdzJywgJ2hlbHAtY2lyY2xlJywgJ2luZm8nLCAnc3RhcicsICdoZWFydCcsICdib29rbWFyaycsXHJcblx0XHQnaG9tZScsICdzZWFyY2gnLCAnYmVsbCcsICdtYWlsJywgJ3VzZXInLCAndXNlcnMnLCAnZm9sZGVyJywgJ2ZpbGUnLCAnZmlsZS10ZXh0JyxcclxuXHRcdCdpbWFnZScsICd2aWRlbycsICdtdXNpYycsICdjYWxlbmRhcicsICdjbG9jaycsICdlZGl0JywgJ3BlbmNpbCcsICd0cmFzaCcsXHJcblx0XHQnY29weScsICdjdXQnLCAncGFzdGUnLCAnZG93bmxvYWQnLCAndXBsb2FkJywgJ3NhdmUnLCAnc2hhcmUnLCAnbGluaycsXHJcblx0XHQnZXh0ZXJuYWwtbGluaycsICdsb2NrJywgJ3VubG9jaycsICdleWUnLCAnZXllLW9mZicsICdrZXknLCAnc2hpZWxkJyxcclxuXHRcdCdjaGVjaycsICd4JywgJ3BsdXMnLCAnbWludXMnLCAnYXJyb3ctbGVmdCcsICdhcnJvdy1yaWdodCcsICdhcnJvdy11cCcsXHJcblx0XHQnYXJyb3ctZG93bicsICdjaGV2cm9uLWxlZnQnLCAnY2hldnJvbi1yaWdodCcsICdjaGV2cm9uLXVwJywgJ2NoZXZyb24tZG93bicsXHJcblx0XHQnbWVudScsICdtb3JlLWhvcml6b250YWwnLCAnbW9yZS12ZXJ0aWNhbCcsICdncmlkJywgJ2xpc3QnLCAnbGF5b3V0JyxcclxuXHRcdCdjb2x1bW5zJywgJ3Jvd3MnLCAnbWF4aW1pemUnLCAnbWluaW1pemUnLCAnem9vbS1pbicsICd6b29tLW91dCcsXHJcblx0XHQncmVmcmVzaC1jdycsICdwbGF5JywgJ3BhdXNlJywgJ3N0b3AnLCAnc3VuJywgJ21vb24nLCAnY2xvdWQnLCAnemFwJyxcclxuXHRcdCd3YW5kLTInLCAnd2FuZCcsICd3YW5kLXNwYXJrbGVzJywgJ3BhbGV0dGUnLCAnYnJ1c2gnLCAnc2xpZGVycycsXHJcblx0XHQncG93ZXInLCAnd2lmaScsICdibHVldG9vdGgnLCAnbW9uaXRvcicsICdsYXB0b3AnLCAnc21hcnRwaG9uZScsXHJcblx0XHQnY2FtZXJhJywgJ21pYycsICdoZWFkcGhvbmVzJywgJ2NvZGUnLCAndGVybWluYWwnLCAndGVybWluYWwtc3F1YXJlJyxcclxuXHRcdCdnaXRodWInLCAnZ2l0bGFiJywgJ2dpdC1icmFuY2gnLCAnZ2l0LWNvbW1pdCcsICdkYXRhYmFzZScsICdzZXJ2ZXInLFxyXG5cdFx0J2Nsb3VkLWRvd25sb2FkJywgJ2Nsb3VkLXVwbG9hZCcsICd0YWcnLCAndGFncycsICdmbGFnJywgJ3BpbicsXHJcblx0XHQnbWFwLXBpbicsICdjb21wYXNzJywgJ2dsb2JlJywgJ3JvY2tldCcsICdjYXInLCAnYmlrZScsICdyb2JvdCcsXHJcblx0XHQnYXBwbGUnLCAnd2luZG93cycsICdsaW51eCcsICdjaHJvbWUnLCAnZmlyZWZveCcsICdzYWZhcmknLFxyXG5cdFx0J2NyZWRpdC1jYXJkJywgJ3dhbGxldCcsICdjb2lucycsICdib29rJywgJ2Jvb2stb3BlbicsICdhd2FyZCcsXHJcblx0XHQndHJvcGh5JywgJ2JhZGdlJywgJ3dyZW5jaCcsICd0b29sJywgJ3BhY2thZ2UnLCAnYm94JywgJ2FyY2hpdmUnLFxyXG5cdFx0J3NlbmQnLCAncmVwbHknLCAnZm9yd2FyZCcsICdtYWlsLW9wZW4nLCAndGFnLXBsdXMnLCAndGFnLW1pbnVzJyxcclxuXHRcdCdmbGFnLW9mZicsICdwaW4tb2ZmJywgJ21hcC1waW4tb2ZmJywgJ25hdmlnYXRpb24nLCAnbWFwJywgJ2VhcnRoJyxcclxuXHRcdCdwbGFuZScsICdzaGlwJywgJ2FuY2hvcicsICdoZWxpY29wdGVyJywgJ2Ryb25lJywgJ2FuZHJvaWQnLFxyXG5cdFx0J2tleWhvbGUnLCAna2V5cycsICdmaW5nZXJwcmludCcsICdzY2FuJywgJ3FyLWNvZGUnLCAnYmFyY29kZScsXHJcblx0XHQncmVjZWlwdCcsICdwaWdneS1iYW5rJywgJ2Jhbmtub3RlJ1xyXG5cdF07XHJcbn07XHJcblxyXG4vLyBDb252ZXJ0IGljb24gSURzIHRvIEljb25PcHRpb24gZm9ybWF0XHJcbmNvbnN0IExVQ0lERV9JQ09OUzogSWNvbk9wdGlvbltdID0gZ2V0SWNvbkxpc3QoKS5tYXAoaWQgPT4gKHtcclxuXHRpZDogaWQsXHJcblx0bmFtZTogaWRcclxuXHRcdC5yZXBsYWNlKC9ebHVjaWRlLS8sICcnKSAvLyBSZW1vdmUgbHVjaWRlLSBwcmVmaXggZm9yIGRpc3BsYXlcclxuXHRcdC5yZXBsYWNlKC8tL2csICcgJylcclxuXHRcdC5yZXBsYWNlKC8oXlxcd3sxfSl8KFxccytcXHd7MX0pL2csIChsZXR0ZXIpID0+IGxldHRlci50b1VwcGVyQ2FzZSgpKVxyXG59KSkuc29ydCgoYSwgYikgPT4gYS5uYW1lLmxvY2FsZUNvbXBhcmUoYi5uYW1lKSk7XHJcblxyXG5leHBvcnQgY2xhc3MgSWNvblBpY2tlck1vZGFsIGV4dGVuZHMgRnV6enlTdWdnZXN0TW9kYWw8SWNvbk9wdGlvbj4ge1xyXG5cdHByaXZhdGUgb25TZWxlY3Q6IChpY29uSWQ6IHN0cmluZykgPT4gdm9pZDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU2VsZWN0OiAoaWNvbklkOiBzdHJpbmcpID0+IHZvaWQpIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0XHR0aGlzLm9uU2VsZWN0ID0gb25TZWxlY3Q7XHJcblx0fVxyXG5cclxuXHRnZXRJdGVtcygpOiBJY29uT3B0aW9uW10ge1xyXG5cdFx0cmV0dXJuIExVQ0lERV9JQ09OUztcclxuXHR9XHJcblxyXG5cdGdldEl0ZW1UZXh0KGl0ZW06IEljb25PcHRpb24pOiBzdHJpbmcge1xyXG5cdFx0cmV0dXJuIGl0ZW0ubmFtZTtcclxuXHR9XHJcblxyXG5cdG9uQ2hvb3NlSXRlbShpdGVtOiBJY29uT3B0aW9uLCBldnQ6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50KTogdm9pZCB7XHJcblx0XHQvLyBTdGFuZGFyZGl6ZSBpY29uIElEIGJ5IHJlbW92aW5nIGx1Y2lkZS0gcHJlZml4XHJcblx0XHRjb25zdCBub3JtYWxpemVkSWQgPSBpdGVtLmlkLnJlcGxhY2UoL15sdWNpZGUtLywgJycpO1xyXG5cdFx0dGhpcy5vblNlbGVjdChub3JtYWxpemVkSWQpO1xyXG5cdH1cclxuXHJcblx0Ly8gT3ZlcnJpZGUgdG8gc2hvdyBpY29uIHByZXZpZXdcclxuXHRyZW5kZXJTdWdnZXN0aW9uKG1hdGNoOiB7IGl0ZW06IEljb25PcHRpb24gfSwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XHJcblx0XHRjb25zdCBpdGVtID0gbWF0Y2guaXRlbTtcclxuXHRcdGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xyXG5cdFx0Y29uc3QgY29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XHJcblx0XHRjb250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnLCB0ZXh0OiBpdGVtLm5hbWUgfSk7XHJcblxyXG5cdFx0Ly8gQ3JlYXRlIGljb24gcHJldmlldyB1c2luZyBPYnNpZGlhbidzIHNldEljb25cclxuXHRcdGNvbnN0IGF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcclxuXHRcdHNldEljb24oYXV4LmNyZWF0ZVNwYW4oeyBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJyB9KSwgaXRlbS5pZCk7XHJcblx0fVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIENvbmZpcm1Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuXHRyZXN1bHQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHRyZXNvbHZlUHJvbWlzZTogKChyZXN1bHQ6IGJvb2xlYW4pID0+IHZvaWQpIHwgbnVsbCA9IG51bGw7XHJcblxyXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwcml2YXRlIG1lc3NhZ2U6IHN0cmluZywgcHJpdmF0ZSBjb25maXJtVGV4dDogc3RyaW5nID0gXCJDb25maXJtXCIsIHByaXZhdGUgY2FuY2VsVGV4dDogc3RyaW5nID0gXCJDYW5jZWxcIikge1xyXG5cdFx0c3VwZXIoYXBwKTtcclxuXHR9XHJcblxyXG5cdG9uT3BlbigpIHtcclxuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG5cdFx0Y29udGVudEVsLmVtcHR5KCk7XHJcblx0XHRjb250ZW50RWwuYWRkQ2xhc3MoXCJhc3Ryby1jb21wb3Nlci1jb25maXJtLW1vZGFsXCIpO1xyXG5cclxuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcInBcIiwgeyB0ZXh0OiB0aGlzLm1lc3NhZ2UgfSk7XHJcblxyXG5cdFx0Y29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtb2RhbC1idXR0b24tY29udGFpbmVyXCIgfSk7XHJcblxyXG5cdFx0Y29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0dGV4dDogdGhpcy5jYW5jZWxUZXh0LFxyXG5cdFx0fSk7XHJcblx0XHRjYW5jZWxCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5yZXN1bHQgPSBmYWxzZTtcclxuXHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRjb25zdCBjb25maXJtQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0dGV4dDogdGhpcy5jb25maXJtVGV4dCxcclxuXHRcdFx0Y2xzOiBcIm1vZC1jdGEgbW9kLXdhcm5pbmdcIixcclxuXHRcdH0pO1xyXG5cdFx0Y29uZmlybUJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xyXG5cdFx0XHR0aGlzLnJlc3VsdCA9IHRydWU7XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHRvbkNsb3NlKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcclxuXHRcdGlmICh0aGlzLnJlc29sdmVQcm9taXNlKSB7XHJcblx0XHRcdHRoaXMucmVzb2x2ZVByb21pc2UodGhpcy5yZXN1bHQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgd2FpdEZvclJlc3VsdCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuXHRcdHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG5cdFx0XHR0aGlzLnJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcclxuXHRcdFx0dGhpcy5vcGVuKCk7XHJcblx0XHR9KTtcclxuXHR9XHJcbn1cclxuXHJcbiIsICIvKipcclxuICogQ29tcGF0aWJpbGl0eSB1dGlsaXRpZXMgZm9yIHNldHRpbmdzXHJcbiAqIFByb3ZpZGVzIGJhY2t3YXJkIGNvbXBhdGliaWxpdHkgZm9yIFNldHRpbmdHcm91cCAocmVxdWlyZXMgQVBJIDEuMTEuMCspXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgU2V0dGluZywgcmVxdWlyZUFwaVZlcnNpb24gfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCAqIGFzIE9ic2lkaWFuTW9kdWxlIGZyb20gJ29ic2lkaWFuJztcclxuXHJcbi8qKlxyXG4gKiBJbnRlcmZhY2UgdGhhdCB3b3JrcyB3aXRoIGJvdGggU2V0dGluZ0dyb3VwIGFuZCBmYWxsYmFjayBjb250YWluZXJcclxuICovXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2V0dGluZ3NDb250YWluZXIge1xyXG5cdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZXMgYSBzZXR0aW5ncyBjb250YWluZXIgdGhhdCB1c2VzIFNldHRpbmdHcm91cCBpZiBhdmFpbGFibGUgKEFQSSAxLjExLjArKSxcclxuICogb3RoZXJ3aXNlIGZhbGxzIGJhY2sgdG8gY3JlYXRpbmcgYSBoZWFkaW5nIGFuZCB1c2luZyB0aGUgY29udGFpbmVyIGRpcmVjdGx5LlxyXG4gKiBcclxuICogVXNlcyByZXF1aXJlQXBpVmVyc2lvbignMS4xMS4wJykgdG8gY2hlY2sgaWYgU2V0dGluZ0dyb3VwIGlzIGF2YWlsYWJsZS5cclxuICogVGhpcyBpcyB0aGUgb2ZmaWNpYWwgT2JzaWRpYW4gQVBJIG1ldGhvZCBmb3IgdmVyc2lvbiBjaGVja2luZy5cclxuICogXHJcbiAqIEBwYXJhbSBjb250YWluZXJFbCAtIFRoZSBjb250YWluZXIgZWxlbWVudCBmb3Igc2V0dGluZ3NcclxuICogQHBhcmFtIGhlYWRpbmcgLSBUaGUgaGVhZGluZyB0ZXh0IGZvciB0aGUgc2V0dGluZ3MgZ3JvdXAgKG9wdGlvbmFsKVxyXG4gKiBAcGFyYW0gbWFuaWZlc3RJZCAtIFRoZSBwbHVnaW4ncyBtYW5pZmVzdCBJRCBmb3IgQ1NTIHNjb3BpbmcgKHJlcXVpcmVkIGZvciBmYWxsYmFjayBtb2RlKVxyXG4gKiBAcmV0dXJucyBBIGNvbnRhaW5lciB0aGF0IGNhbiBiZSB1c2VkIHRvIGFkZCBzZXR0aW5nc1xyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVNldHRpbmdzR3JvdXAoXHJcblx0Y29udGFpbmVyRWw6IEhUTUxFbGVtZW50LFxyXG5cdGhlYWRpbmc/OiBzdHJpbmcsXHJcblx0bWFuaWZlc3RJZD86IHN0cmluZ1xyXG4pOiBTZXR0aW5nc0NvbnRhaW5lciB7XHJcblx0Ly8gQ2hlY2sgaWYgU2V0dGluZ0dyb3VwIGlzIGF2YWlsYWJsZSAoQVBJIDEuMTEuMCspXHJcblx0Ly8gcmVxdWlyZUFwaVZlcnNpb24gaXMgdGhlIG9mZmljaWFsIE9ic2lkaWFuIEFQSSBtZXRob2QgZm9yIHZlcnNpb24gY2hlY2tpbmdcclxuXHRpZiAocmVxdWlyZUFwaVZlcnNpb24oJzEuMTEuMCcpKSB7XHJcblx0XHQvLyBVc2UgU2V0dGluZ0dyb3VwIC0gaXQncyBndWFyYW50ZWVkIHRvIGV4aXN0IGlmIHJlcXVpcmVBcGlWZXJzaW9uIHJldHVybnMgdHJ1ZVxyXG5cdFx0Ly8gQWNjZXNzIFNldHRpbmdHcm91cCB2aWEgdHlwZSBhc3NlcnRpb24gc2luY2UgaXQgbWF5IG5vdCBiZSBpbiB0eXBlIGRlZmluaXRpb25zXHJcblx0XHQvLyBmb3Igb2xkZXIgVHlwZVNjcmlwdCB2ZXJzaW9ucywgYnV0IGV4aXN0cyBhdCBydW50aW1lIGluIE9ic2lkaWFuIDEuMTEuMCtcclxuXHRcdC8vIFVzaW5nIHVua25vd24gaW5zdGVhZCBvZiBhbnkgdG8gc2F0aXNmeSBlc2xpbnQgd2hpbGUgbWFpbnRhaW5pbmcgdHlwZSBzYWZldHlcclxuXHRcdGNvbnN0IFNldHRpbmdHcm91cENsYXNzID0gKE9ic2lkaWFuTW9kdWxlIGFzIHVua25vd24gYXMgeyBTZXR0aW5nR3JvdXA/OiBuZXcgKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCkgPT4ge1xyXG5cdFx0XHRzZXRIZWFkaW5nKGhlYWRpbmc6IHN0cmluZyk6IHtcclxuXHRcdFx0XHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCk6IHZvaWQ7XHJcblx0XHRcdH07XHJcblx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcclxuXHRcdH0gfSkuU2V0dGluZ0dyb3VwO1xyXG5cdFx0XHJcblx0XHRpZiAoU2V0dGluZ0dyb3VwQ2xhc3MpIHtcclxuXHRcdFx0Y29uc3QgZ3JvdXAgPSBoZWFkaW5nIFxyXG5cdFx0XHRcdD8gbmV3IFNldHRpbmdHcm91cENsYXNzKGNvbnRhaW5lckVsKS5zZXRIZWFkaW5nKGhlYWRpbmcpXHJcblx0XHRcdFx0OiBuZXcgU2V0dGluZ0dyb3VwQ2xhc3MoY29udGFpbmVyRWwpO1xyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKSB7XHJcblx0XHRcdFx0XHRncm91cC5hZGRTZXR0aW5nKGNiKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH07XHJcblx0XHR9XHJcblx0fVxyXG5cdFxyXG5cdC8vIEZhbGxiYWNrIHBhdGggKGVpdGhlciBBUEkgPCAxLjExLjAgb3IgU2V0dGluZ0dyb3VwIG5vdCBmb3VuZClcclxuXHQvLyBBZGQgc2NvcGluZyBjbGFzcyB0byBjb250YWluZXJFbCB0byBzY29wZSBDU1MgdG8gb25seSB0aGlzIHBsdWdpbidzIHNldHRpbmdzXHJcblx0aWYgKG1hbmlmZXN0SWQpIHtcclxuXHRcdGNvbnRhaW5lckVsLmFkZENsYXNzKGAke21hbmlmZXN0SWR9LXNldHRpbmdzLWNvbXBhdGApO1xyXG5cdH1cclxuXHRcclxuXHR7XHJcblx0XHQvLyBGYWxsYmFjazogQ3JlYXRlIGEgaGVhZGluZyBtYW51YWxseSBmb3Igb2xkZXIgQVBJIHZlcnNpb25zXHJcblx0XHQvLyBOb3RlOiBXaGlsZSBiZXN0IHByYWN0aWNlIHByZWZlcnMgU2V0dGluZy5zZXRIZWFkaW5nKCksIHRoZSBmYWxsYmFjayBwYXRoXHJcblx0XHQvLyBpcyBmb3IgdmVyc2lvbnMgdGhhdCBtYXkgbm90IHN1cHBvcnQgaXQsIHNvIG1hbnVhbCBoZWFkaW5nIGlzIGFwcHJvcHJpYXRlIGhlcmVcclxuXHRcdGlmIChoZWFkaW5nKSB7XHJcblx0XHRcdGNvbnN0IGhlYWRpbmdFbCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdignc2V0dGluZy1ncm91cC1oZWFkaW5nJyk7XHJcblx0XHRcdGhlYWRpbmdFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6IGhlYWRpbmcgfSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKSB7XHJcblx0XHRcdFx0Y29uc3Qgc2V0dGluZyA9IG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKTtcclxuXHRcdFx0XHRjYihzZXR0aW5nKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlLCBIZWFkaW5nQ2FjaGUsIEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQXN0cm9Db21wb3NlclNldHRpbmdzIH0gZnJvbSBcIi4uL3R5cGVzXCI7XG5pbXBvcnQgeyBtYXRjaGVzRm9sZGVyUGF0dGVybiwgc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5IH0gZnJvbSBcIi4vcGF0aC1tYXRjaGluZ1wiO1xuaW1wb3J0IHsgdG9LZWJhYkNhc2UgfSBmcm9tIFwiLi9zdHJpbmctdXRpbHNcIjtcblxuZXhwb3J0IGNsYXNzIEhlYWRpbmdMaW5rR2VuZXJhdG9yIHtcblx0Y29uc3RydWN0b3IocHJpdmF0ZSBzZXR0aW5nczogQXN0cm9Db21wb3NlclNldHRpbmdzKSB7IH1cblxuXHQvKipcblx0ICogQ29udmVydHMgdGV4dCB0byBrZWJhYi1jYXNlIHNsdWcgZm9yIFVSTHNcblx0ICovXG5cdC8vIExvY2FsIHRvS2ViYWJDYXNlIHJlbW92ZWQsIHVzaW5nIGltcG9ydGVkIG9uZSBpbnN0ZWFkXG5cblx0LyoqXG5cdCAqIEdldHMgdGhlIEFzdHJvLWNvbXBhdGlibGUgVVJMIGZyb20gYW4gaW50ZXJuYWwgbGluayAoY29waWVkIGZyb20gTGlua0NvbnZlcnRlcilcblx0ICovXG5cdHByaXZhdGUgZ2V0QXN0cm9VcmxGcm9tSW50ZXJuYWxMaW5rKGxpbms6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGFzaEluZGV4ID0gbGluay5pbmRleE9mKCcjJyk7XG5cdFx0bGV0IHBhdGggPSBoYXNoSW5kZXggPj0gMCA/IGxpbmsuc2xpY2UoMCwgaGFzaEluZGV4KSA6IGxpbms7XG5cdFx0Y29uc3QgYW5jaG9yID0gaGFzaEluZGV4ID49IDAgPyBsaW5rLnNsaWNlKGhhc2hJbmRleCkgOiAnJztcblxuXHRcdHBhdGggPSBwYXRoLnJlcGxhY2UoL1xcLm1kJC8sIFwiXCIpO1xuXG5cdFx0Ly8gRGV0ZXJtaW5lIGNvbnRlbnQgdHlwZSBhbmQgYXBwcm9wcmlhdGUgYmFzZSBwYXRoXG5cdFx0bGV0IGJhc2VQYXRoID0gXCJcIjtcblx0XHRsZXQgY29udGVudEZvbGRlciA9IFwiXCI7XG5cdFx0bGV0IGNyZWF0aW9uTW9kZTogXCJmaWxlXCIgfCBcImZvbGRlclwiID0gXCJmaWxlXCI7XG5cdFx0bGV0IGluZGV4RmlsZU5hbWUgPSBcIlwiO1xuXG5cdFx0Ly8gQ2hlY2sgYWxsIGNvbnRlbnQgdHlwZXMsIHNvcnRlZCBieSBwYXR0ZXJuIHNwZWNpZmljaXR5IChtb3JlIHNwZWNpZmljIGZpcnN0KVxuXHRcdGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMuc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IFtdO1xuXHRcdGNvbnN0IHNvcnRlZFR5cGVzID0gc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5KGNvbnRlbnRUeXBlcyk7XG5cblx0XHRmb3IgKGNvbnN0IGNvbnRlbnRUeXBlIG9mIHNvcnRlZFR5cGVzKSB7XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmVuYWJsZWQpIGNvbnRpbnVlO1xuXG5cdFx0XHRsZXQgbWF0Y2hlcyA9IGZhbHNlO1xuXG5cdFx0XHQvLyBIYW5kbGUgYmxhbmsgZm9sZGVyIChyb290KSAtIG1hdGNoZXMgZmlsZXMgaW4gdmF1bHQgcm9vdCBvbmx5XG5cdFx0XHRpZiAoIWNvbnRlbnRUeXBlLmZvbGRlciB8fCBjb250ZW50VHlwZS5mb2xkZXIudHJpbSgpID09PSBcIlwiKSB7XG5cdFx0XHRcdGlmICghcGF0aC5pbmNsdWRlcyhcIi9cIikgfHwgcGF0aC5zcGxpdChcIi9cIikubGVuZ3RoID09PSAxKSB7XG5cdFx0XHRcdFx0bWF0Y2hlcyA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAobWF0Y2hlc0ZvbGRlclBhdHRlcm4ocGF0aCwgY29udGVudFR5cGUuZm9sZGVyKSkge1xuXHRcdFx0XHRtYXRjaGVzID0gdHJ1ZTtcblx0XHRcdH1cblxuXHRcdFx0aWYgKG1hdGNoZXMpIHtcblx0XHRcdFx0Y29udGVudEZvbGRlciA9IGNvbnRlbnRUeXBlLmZvbGRlciB8fCBcIlwiO1xuXHRcdFx0XHRiYXNlUGF0aCA9IGNvbnRlbnRUeXBlLmxpbmtCYXNlUGF0aCB8fCBcIlwiO1xuXHRcdFx0XHRjcmVhdGlvbk1vZGUgPSBjb250ZW50VHlwZS5jcmVhdGlvbk1vZGU7XG5cdFx0XHRcdGluZGV4RmlsZU5hbWUgPSBjb250ZW50VHlwZS5pbmRleEZpbGVOYW1lIHx8IFwiXCI7XG5cdFx0XHRcdGJyZWFrOyAvLyBNb3N0IHNwZWNpZmljIHBhdHRlcm4gd2luc1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIFN0cmlwIGNvbnRlbnQgZm9sZGVyIGlmIHByZXNlbnRcblx0XHRpZiAoY29udGVudEZvbGRlcikge1xuXHRcdFx0cGF0aCA9IHBhdGguc2xpY2UoY29udGVudEZvbGRlci5sZW5ndGggKyAxKTtcblx0XHR9XG5cblx0XHRsZXQgYWRkVHJhaWxpbmdTbGFzaCA9IGZhbHNlO1xuXG5cdFx0Ly8gU21hcnQgZGV0ZWN0aW9uOiBpZiB0aGUgZmlsZW5hbWUgbWF0Y2hlcyB0aGUgaW5kZXggZmlsZSBuYW1lIChyZWdhcmRsZXNzIG9mIGNyZWF0aW9uIG1vZGUpLFxuXHRcdC8vIHRyZWF0IGl0IGFzIGZvbGRlci1iYXNlZCBsb2dpY1xuXHRcdC8vIE5vdGU6IFdlIG9ubHkgc2V0IGFkZFRyYWlsaW5nU2xhc2ggaGVyZTsgdGhlIGZpbmFsIGNoZWNrIHdpbGwgcHJldmVudCBpdCBpZiB0aGVyZSdzIGFuIGFuY2hvclxuXHRcdGlmIChpbmRleEZpbGVOYW1lICYmIGluZGV4RmlsZU5hbWUudHJpbSgpICE9PSBcIlwiKSB7XG5cdFx0XHRjb25zdCBwYXJ0cyA9IHBhdGguc3BsaXQoJy8nKTtcblx0XHRcdGlmIChwYXJ0c1twYXJ0cy5sZW5ndGggLSAxXSA9PT0gaW5kZXhGaWxlTmFtZSkge1xuXHRcdFx0XHRwYXJ0cy5wb3AoKTtcblx0XHRcdFx0cGF0aCA9IHBhcnRzLmpvaW4oJy8nKTtcblx0XHRcdFx0YWRkVHJhaWxpbmdTbGFzaCA9IHRydWU7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChjcmVhdGlvbk1vZGUgPT09IFwiZm9sZGVyXCIpIHtcblx0XHRcdC8vIEZhbGxiYWNrIHRvIG9yaWdpbmFsIGxvZ2ljIGlmIG5vIGluZGV4IGZpbGUgbmFtZSBpcyBzcGVjaWZpZWRcblx0XHRcdC8vIERlZmF1bHQgdG8gXCJpbmRleFwiIHdoZW4gaW5kZXhGaWxlTmFtZSBpcyBibGFua1xuXHRcdFx0Y29uc3QgZGVmYXVsdEluZGV4TmFtZSA9IFwiaW5kZXhcIjtcblx0XHRcdGNvbnN0IHBhcnRzID0gcGF0aC5zcGxpdCgnLycpO1xuXHRcdFx0aWYgKHBhcnRzW3BhcnRzLmxlbmd0aCAtIDFdID09PSBkZWZhdWx0SW5kZXhOYW1lKSB7XG5cdFx0XHRcdHBhcnRzLnBvcCgpO1xuXHRcdFx0XHRwYXRoID0gcGFydHMuam9pbignLycpO1xuXHRcdFx0XHRhZGRUcmFpbGluZ1NsYXNoID0gdHJ1ZTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRjb25zdCBzbHVnUGFydHMgPSBwYXRoLnNwbGl0KCcvJykubWFwKHBhcnQgPT4gdG9LZWJhYkNhc2UocGFydCkpO1xuXHRcdGNvbnN0IHNsdWcgPSBzbHVnUGFydHMuam9pbignLycpO1xuXG5cdFx0Ly8gRm9ybWF0IGJhc2UgcGF0aFxuXHRcdGlmIChiYXNlUGF0aCkge1xuXHRcdFx0aWYgKCFiYXNlUGF0aC5zdGFydHNXaXRoKFwiL1wiKSkgYmFzZVBhdGggPSBcIi9cIiArIGJhc2VQYXRoO1xuXHRcdFx0aWYgKCFiYXNlUGF0aC5lbmRzV2l0aChcIi9cIikpIGJhc2VQYXRoICs9IFwiL1wiO1xuXHRcdH1cblxuXHRcdC8vIERldGVybWluZSBpZiB3ZSBzaG91bGQgYWRkIHRyYWlsaW5nIHNsYXNoXG5cdFx0Ly8gQ1JJVElDQUw6IE5ldmVyIGFkZCB0cmFpbGluZyBzbGFzaCBiZWZvcmUgYW4gYW5jaG9yIChlLmcuLCAvYWJvdXQjaGVhZGluZyBub3QgL2Fib3V0LyNoZWFkaW5nKVxuXHRcdC8vIFRoaXMgaXMgZXNwZWNpYWxseSBpbXBvcnRhbnQgZm9yIGFuY2hvciBsaW5rcyBmcm9tIGNvcHkgaGVhZGluZyBVUkwgZnVuY3Rpb25hbGl0eVxuXHRcdC8vIEFuY2hvciBsaW5rcyBzaG91bGQgTkVWRVIgaGF2ZSB0cmFpbGluZyBzbGFzaGVzLCByZWdhcmRsZXNzIG9mIHNldHRpbmdzXG5cdFx0Y29uc3Qgc2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA9ICh0aGlzLnNldHRpbmdzLmFkZFRyYWlsaW5nU2xhc2hUb0xpbmtzIHx8IGFkZFRyYWlsaW5nU2xhc2gpICYmICFhbmNob3I7XG5cblx0XHRyZXR1cm4gYCR7YmFzZVBhdGh9JHtzbHVnfSR7c2hvdWxkQWRkVHJhaWxpbmdTbGFzaCA/ICcvJyA6ICcnfSR7YW5jaG9yfWA7XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIGEgc3RhbmRhcmQgT2JzaWRpYW4gbGluayB0byBhIGhlYWRpbmcsIHJlc3BlY3RpbmcgdXNlcidzIGxpbmsgZm9ybWF0IHByZWZlcmVuY2Vcblx0ICovXG5cdGdlbmVyYXRlT2JzaWRpYW5MaW5rKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgaGVhZGluZzogSGVhZGluZ0NhY2hlKTogc3RyaW5nIHtcblx0XHRjb25zdCBoZWFkaW5nVGV4dCA9IGhlYWRpbmcuaGVhZGluZztcblxuXHRcdC8vIENoZWNrIGlmIHVzZXIgcHJlZmVycyB3aWtpbGlua3MgYnkgdGVzdGluZyBPYnNpZGlhbidzIGRlZmF1bHQgYmVoYXZpb3Jcblx0XHRjb25zdCB0ZXN0TGluayA9IGFwcC5maWxlTWFuYWdlci5nZW5lcmF0ZU1hcmtkb3duTGluayhmaWxlLCAnJywgJycpO1xuXHRcdGlmICh0ZXN0TGluay5zdGFydHNXaXRoKCdbWycpKSB7XG5cdFx0XHQvLyBVc2VyIHByZWZlcnMgd2lraWxpbmtzIC0gdXNlIGp1c3QgdGhlIGZpbGVuYW1lIChiYXNlbmFtZSkgd2l0aG91dCBwYXRoXG5cdFx0XHRjb25zdCBmaWxlTmFtZSA9IGZpbGUuYmFzZW5hbWU7XG5cdFx0XHRyZXR1cm4gYFtbJHtmaWxlTmFtZX0jJHtoZWFkaW5nVGV4dH18JHtoZWFkaW5nVGV4dH1dXWA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFVzZXIgcHJlZmVycyBtYXJrZG93biBsaW5rcyAtIHVzZSBPYnNpZGlhbidzIG1ldGhvZCB3aXRoIGhlYWRpbmcgdGV4dCBhcy1pcyAoVVJMLWVuY29kZWQpXG5cdFx0XHQvLyBHZXQgdGhlIGJhc2UgbGluayBmcm9tIE9ic2lkaWFuIChyZXNwZWN0cyB1c2VyJ3MgcGF0aCBzZXR0aW5ncylcblx0XHRcdGNvbnN0IGJhc2VMaW5rID0gYXBwLmZpbGVNYW5hZ2VyLmdlbmVyYXRlTWFya2Rvd25MaW5rKGZpbGUsICcnLCAnJyk7XG5cdFx0XHQvLyBFeHRyYWN0IHRoZSBwYXRoIHBhcnQgYW5kIGFkZCBvdXIgYW5jaG9yIHdpdGggcHJvcGVyIGRpc3BsYXkgdGV4dFxuXHRcdFx0aWYgKGJhc2VMaW5rLnN0YXJ0c1dpdGgoJ1tbJykpIHtcblx0XHRcdFx0Ly8gVGhpcyBzaG91bGRuJ3QgaGFwcGVuIHNpbmNlIHdlJ3JlIGluIHRoZSBtYXJrZG93biBicmFuY2gsIGJ1dCBqdXN0IGluIGNhc2Vcblx0XHRcdFx0Y29uc3QgZmlsZU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuXHRcdFx0XHRyZXR1cm4gYFtbJHtmaWxlTmFtZX0jJHtoZWFkaW5nVGV4dH18JHtoZWFkaW5nVGV4dH1dXWA7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBFeHRyYWN0IHRoZSBwYXRoIGZyb20gdGhlIGdlbmVyYXRlZCBsaW5rIGFuZCByZWNvbnN0cnVjdCB3aXRoIHByb3BlciBkaXNwbGF5IHRleHRcblx0XHRcdFx0Y29uc3QgbWF0Y2ggPSBiYXNlTGluay5tYXRjaCgvXFxbKFteXFxdXSspXFxdXFwoKFteKV0rKVxcKS8pO1xuXHRcdFx0XHRpZiAobWF0Y2gpIHtcblx0XHRcdFx0XHRjb25zdCBbLCAsIHBhdGhdID0gbWF0Y2g7XG5cdFx0XHRcdFx0Ly8gRm9yIE9ic2lkaWFuLCB1c2UgdGhlIGhlYWRpbmcgdGV4dCBhcy1pcyAoVVJMLWVuY29kZWQpLCBub3Qga2ViYWItY2FzZVxuXHRcdFx0XHRcdHJldHVybiBgWyR7aGVhZGluZ1RleHR9XSgke3BhdGh9IyR7ZW5jb2RlVVJJQ29tcG9uZW50KGhlYWRpbmdUZXh0KX0pYDtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBGYWxsYmFjayB0byBtYW51YWwgY29uc3RydWN0aW9uXG5cdFx0XHRcdFx0Y29uc3QgZW5jb2RlZEZpbGVuYW1lID0gZW5jb2RlVVJJQ29tcG9uZW50KGZpbGUubmFtZSk7XG5cdFx0XHRcdFx0Ly8gRm9yIE9ic2lkaWFuLCB1c2UgdGhlIGhlYWRpbmcgdGV4dCBhcy1pcyAoVVJMLWVuY29kZWQpXG5cdFx0XHRcdFx0cmV0dXJuIGBbJHtoZWFkaW5nVGV4dH1dKCR7ZW5jb2RlZEZpbGVuYW1lfSMke2VuY29kZVVSSUNvbXBvbmVudChoZWFkaW5nVGV4dCl9KWA7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cblxuXHQvKipcblx0ICogR2VuZXJhdGVzIGEgc3RhbmRhcmQgT2JzaWRpYW4gd2lraWxpbmsgdG8gYSBoZWFkaW5nXG5cdCAqL1xuXHRnZW5lcmF0ZU9ic2lkaWFuV2lraWxpbmsoZmlsZTogVEZpbGUsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XG5cdFx0Ly8gVXNlIGp1c3QgdGhlIGZpbGVuYW1lIChiYXNlbmFtZSksIG5vdCB0aGUgZnVsbCBwYXRoXG5cdFx0Y29uc3QgZmlsZU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuXHRcdHJldHVybiBgW1ske2ZpbGVOYW1lfSMke2hlYWRpbmdUZXh0fXwke2hlYWRpbmdUZXh0fV1dYDtcblx0fVxuXG5cdC8qKlxuXHQgKiBHZW5lcmF0ZXMgYW4gQXN0cm8tY29tcGF0aWJsZSBtYXJrZG93biBsaW5rIHRvIGEgaGVhZGluZ1xuXHQgKi9cblx0Z2VuZXJhdGVBc3Ryb0xpbmsoZmlsZTogVEZpbGUsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IHN0cmluZyB7XG5cdFx0Y29uc3QgaGVhZGluZ1RleHQgPSBoZWFkaW5nLmhlYWRpbmc7XG5cdFx0Y29uc3QgYW5jaG9yID0gdG9LZWJhYkNhc2UoaGVhZGluZ1RleHQpO1xuXHRcdC8vIFVzZSB0aGUgc2FtZSBsb2dpYyBhcyB0aGUgZXhpc3RpbmcgbGluayBjb252ZXJ0ZXJcblx0XHRjb25zdCBpbnRlcm5hbExpbmsgPSBgJHtmaWxlLnBhdGh9IyR7YW5jaG9yfWA7XG5cdFx0Y29uc3QgYXN0cm9VcmwgPSB0aGlzLmdldEFzdHJvVXJsRnJvbUludGVybmFsTGluayhpbnRlcm5hbExpbmspO1xuXHRcdHJldHVybiBgWyR7aGVhZGluZ1RleHR9XSgke2FzdHJvVXJsfSlgO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyBhbiBBc3Ryby1jb21wYXRpYmxlIHdpa2lsaW5rIHRvIGEgaGVhZGluZ1xuXHQgKi9cblx0Z2VuZXJhdGVBc3Ryb1dpa2lsaW5rKGZpbGU6IFRGaWxlLCBoZWFkaW5nOiBIZWFkaW5nQ2FjaGUpOiBzdHJpbmcge1xuXHRcdGNvbnN0IGhlYWRpbmdUZXh0ID0gaGVhZGluZy5oZWFkaW5nO1xuXHRcdGNvbnN0IGFuY2hvciA9IHRvS2ViYWJDYXNlKGhlYWRpbmdUZXh0KTtcblx0XHQvLyBVc2UgdGhlIHNhbWUgbG9naWMgYXMgdGhlIGV4aXN0aW5nIGxpbmsgY29udmVydGVyXG5cdFx0Y29uc3QgaW50ZXJuYWxMaW5rID0gYCR7ZmlsZS5wYXRofSMke2FuY2hvcn1gO1xuXHRcdGNvbnN0IGFzdHJvVXJsID0gdGhpcy5nZXRBc3Ryb1VybEZyb21JbnRlcm5hbExpbmsoaW50ZXJuYWxMaW5rKTtcblx0XHQvLyBDcmVhdGUgYSB3aWtpbGluayB3aXRoIHRoZSBBc3RybyBVUkwgYXMgdGhlIHRhcmdldFxuXHRcdHJldHVybiBgW1ske2hlYWRpbmdUZXh0fXwke2FzdHJvVXJsfV1dYDtcblx0fVxuXG5cdC8qKlxuXHQgKiBFeHRyYWN0cyB0aGUgVVJMIGZyb20gYSBtYXJrZG93biBsaW5rIG9yIHdpa2lsaW5rXG5cdCAqL1xuXHRleHRyYWN0VXJsKGxpbms6IHN0cmluZyk6IHN0cmluZyB7XG5cdFx0Ly8gSGFuZGxlIG1hcmtkb3duIGxpbmtzOiBbdGV4dF0odXJsKVxuXHRcdGNvbnN0IG1hcmtkb3duTWF0Y2ggPSBsaW5rLm1hdGNoKC9cXFsoW15cXF1dKylcXF1cXCgoW14pXSspXFwpLyk7XG5cdFx0aWYgKG1hcmtkb3duTWF0Y2gpIHtcblx0XHRcdHJldHVybiBtYXJrZG93bk1hdGNoWzJdO1xuXHRcdH1cblxuXHRcdC8vIEhhbmRsZSB3aWtpbGlua3M6IFtbcGF0aCNoZWFkaW5nfHRleHRdXSBvciBbW3BhdGgjaGVhZGluZ11dXG5cdFx0Y29uc3Qgd2lraWxpbmtNYXRjaCA9IGxpbmsubWF0Y2goL1xcW1xcWyhbXlxcXV0rKVxcXVxcXS8pO1xuXHRcdGlmICh3aWtpbGlua01hdGNoKSB7XG5cdFx0XHRjb25zdCBjb250ZW50ID0gd2lraWxpbmtNYXRjaFsxXTtcblx0XHRcdC8vIEV4dHJhY3QgdGhlIHBhdGggcGFydCAoYmVmb3JlIHwgaWYgcHJlc2VudClcblx0XHRcdGNvbnN0IHBhdGhQYXJ0ID0gY29udGVudC5zcGxpdCgnfCcpWzBdO1xuXHRcdFx0cmV0dXJuIHBhdGhQYXJ0O1xuXHRcdH1cblxuXHRcdC8vIElmIGl0IGRvZXNuJ3QgbWF0Y2ggZWl0aGVyIGZvcm1hdCwgcmV0dXJuIGFzLWlzIChtaWdodCBhbHJlYWR5IGJlIGEgVVJMKVxuXHRcdHJldHVybiBsaW5rO1xuXHR9XG5cblx0LyoqXG5cdCAqIEdlbmVyYXRlcyB0aGUgYXBwcm9wcmlhdGUgbGluayBmb3JtYXQgYmFzZWQgb24gc2V0dGluZ3Ncblx0ICovXG5cdGdlbmVyYXRlTGluayhhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGhlYWRpbmc6IEhlYWRpbmdDYWNoZSk6IHN0cmluZyB7XG5cdFx0aWYgKHRoaXMuc2V0dGluZ3MuY29weUhlYWRpbmdMaW5rRm9ybWF0ID09PSBcImFzdHJvXCIpIHtcblx0XHRcdC8vIEFzdHJvIGZvcm1hdCBhbHdheXMgdXNlcyBtYXJrZG93biBsaW5rcyAod2lraWxpbmtzIHdpdGggQXN0cm8gVVJMcyBkb24ndCBtYWtlIHNlbnNlKVxuXHRcdFx0cmV0dXJuIHRoaXMuZ2VuZXJhdGVBc3Ryb0xpbmsoZmlsZSwgaGVhZGluZyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdC8vIFVzZSBPYnNpZGlhbidzIGJ1aWx0LWluIG1ldGhvZCB3aGljaCByZXNwZWN0cyB1c2VyIHNldHRpbmdzXG5cdFx0XHRyZXR1cm4gdGhpcy5nZW5lcmF0ZU9ic2lkaWFuTGluayhhcHAsIGZpbGUsIGhlYWRpbmcpO1xuXHRcdH1cblx0fVxuXG5cdC8qKlxuXHQgKiBGaW5kcyB0aGUgaGVhZGluZyBhdCBhIHNwZWNpZmljIGxpbmUgaW4gYSBmaWxlXG5cdCAqL1xuXHRmaW5kSGVhZGluZ0F0TGluZShhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGxpbmU6IG51bWJlcik6IEhlYWRpbmdDYWNoZSB8IG51bGwge1xuXHRcdGNvbnN0IGNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuXHRcdGlmICghY2FjaGUgfHwgIWNhY2hlLmhlYWRpbmdzKSB7XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHQvLyBGaW5kIHRoZSBoZWFkaW5nIHRoYXQgY29udGFpbnMgdGhpcyBsaW5lXG5cdFx0Zm9yIChsZXQgaSA9IGNhY2hlLmhlYWRpbmdzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdFx0XHRjb25zdCBoZWFkaW5nID0gY2FjaGUuaGVhZGluZ3NbaV07XG5cdFx0XHRpZiAoaGVhZGluZy5wb3NpdGlvbi5zdGFydC5saW5lIDw9IGxpbmUpIHtcblx0XHRcdFx0cmV0dXJuIGhlYWRpbmc7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cmV0dXJuIG51bGw7XG5cdH1cbn1cbiIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBDb250ZW50VHlwZSwgQXN0cm9Db21wb3NlclBsdWdpbkludGVyZmFjZSB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5pbXBvcnQgeyBNaWdyYXRpb25Nb2RhbCwgTWlncmF0aW9uQ29uZmxpY3RSZXN1bHQgfSBmcm9tIFwiLi4vdWkvY29tcG9uZW50cy9NaWdyYXRpb25Nb2RhbFwiO1xyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyU2V0dGluZ1RhYiB9IGZyb20gXCIuLi91aS9zZXR0aW5ncy10YWJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBNaWdyYXRpb25TZXJ2aWNlIHtcclxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgYXBwOiBBcHAsIHByaXZhdGUgcGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlKSB7IH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIE1pZ3JhdGUgb2xkIHBvc3RzL3BhZ2VzIHNldHRpbmdzIHRvIHVuaWZpZWQgY29udGVudCB0eXBlc1xyXG4gICAgICovXHJcbiAgICBwdWJsaWMgYXN5bmMgbWlncmF0ZVNldHRpbmdzSWZOZWVkZWQoKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgbWlncmF0aW9uIGlzIGFscmVhZHkgY29tcGxldGVkXHJcbiAgICAgICAgaWYgKHNldHRpbmdzLm1pZ3JhdGlvbkNvbXBsZXRlZCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiB0aGVyZSBhcmUgb2xkIHNldHRpbmdzIHRvIG1pZ3JhdGVcclxuICAgICAgICBjb25zdCBoYXNQb3N0c1NldHRpbmdzID0gc2V0dGluZ3MuYXV0b21hdGVQb3N0Q3JlYXRpb24gIT09IHVuZGVmaW5lZCAmJiBzZXR0aW5ncy5hdXRvbWF0ZVBvc3RDcmVhdGlvbjtcclxuICAgICAgICBjb25zdCBoYXNQYWdlc1NldHRpbmdzID0gc2V0dGluZ3MuZW5hYmxlUGFnZXMgIT09IHVuZGVmaW5lZCAmJiBzZXR0aW5ncy5lbmFibGVQYWdlcztcclxuXHJcbiAgICAgICAgaWYgKCFoYXNQb3N0c1NldHRpbmdzICYmICFoYXNQYWdlc1NldHRpbmdzKSB7XHJcbiAgICAgICAgICAgIC8vIE5vIG9sZCBzZXR0aW5ncyB0byBtaWdyYXRlLCBtYXJrIGFzIGNvbXBsZXRlZFxyXG4gICAgICAgICAgICBzZXR0aW5ncy5taWdyYXRpb25Db21wbGV0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgZm9yIG5hbWluZyBjb25mbGljdHNcclxuICAgICAgICBjb25zdCBsZWdhY3lDb250ZW50VHlwZXMgPSAoc2V0dGluZ3MgYXMgdW5rbm93biBhcyB7IGN1c3RvbUNvbnRlbnRUeXBlcz86IENvbnRlbnRUeXBlW10gfSkuY3VzdG9tQ29udGVudFR5cGVzO1xyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQ29udGVudFR5cGVzID0gc2V0dGluZ3MuY29udGVudFR5cGVzIHx8IGxlZ2FjeUNvbnRlbnRUeXBlcyB8fCBbXTtcclxuICAgICAgICBjb25zdCBjb25mbGljdHM6IHN0cmluZ1tdID0gW107XHJcbiAgICAgICAgaWYgKGV4aXN0aW5nQ29udGVudFR5cGVzLnNvbWUoKGN0OiBDb250ZW50VHlwZSkgPT4gY3QubmFtZSA9PT0gXCJQb3N0c1wiKSkge1xyXG4gICAgICAgICAgICBjb25mbGljdHMucHVzaChcIlBvc3RzXCIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZXhpc3RpbmdDb250ZW50VHlwZXMuc29tZSgoY3Q6IENvbnRlbnRUeXBlKSA9PiBjdC5uYW1lID09PSBcIlBhZ2VzXCIpKSB7XHJcbiAgICAgICAgICAgIGNvbmZsaWN0cy5wdXNoKFwiUGFnZXNcIik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBsZXQgc2hvdWxkTWlncmF0ZSA9IHRydWU7XHJcblxyXG4gICAgICAgIC8vIElmIGNvbmZsaWN0cyBleGlzdCwgcHJvbXB0IHVzZXJcclxuICAgICAgICBpZiAoY29uZmxpY3RzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgYXdhaXQgbmV3IFByb21pc2U8dm9pZD4oKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHZvaWQgKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IE1pZ3JhdGlvbk1vZGFsKHRoaXMuYXBwLCBjb25mbGljdHMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGltZW91dFByb21pc2UgPSBuZXcgUHJvbWlzZTxNaWdyYXRpb25Db25mbGljdFJlc3VsdD4oKHRpbWVvdXRSZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXRSZXNvbHZlKHsgYWN0aW9uOiBcInNraXBcIiB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAzMDAwMCk7IC8vIDMwIHNlY29uZCB0aW1lb3V0XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBQcm9taXNlLnJhY2UoW1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGFsLndhaXRGb3JSZXN1bHQoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0UHJvbWlzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5hY3Rpb24gPT09IFwic2tpcFwiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvdWxkTWlncmF0ZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJNaWdyYXRpb24gc2tpcHBlZC4gT2xkIHBvc3RzL3BhZ2VzIHNldHRpbmdzIHdpbGwgYmUgaWdub3JlZC5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJNaWdyYXRpb24gbW9kYWwgZXJyb3I6XCIsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3VsZE1pZ3JhdGUgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJNaWdyYXRpb24gc2tpcHBlZCBkdWUgdG8gZXJyb3IuIFlvdSBjYW4gbWlncmF0ZSBtYW51YWxseSBpbiBzZXR0aW5ncy5cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pKCk7XHJcbiAgICAgICAgICAgICAgICB9LCA1MDApOyAvLyBTbWFsbCBkZWxheSB0byBlbnN1cmUgVUkgaXMgcmVhZHlcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIXNob3VsZE1pZ3JhdGUpIHtcclxuICAgICAgICAgICAgc2V0dGluZ3MubWlncmF0aW9uQ29tcGxldGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFBlcmZvcm0gbWlncmF0aW9uXHJcbiAgICAgICAgY29uc3QgbWlncmF0ZWRUeXBlczogQ29udGVudFR5cGVbXSA9IFtdO1xyXG5cclxuICAgICAgICAvLyBNaWdyYXRlIFBvc3RzXHJcbiAgICAgICAgaWYgKGhhc1Bvc3RzU2V0dGluZ3MgJiYgIWNvbmZsaWN0cy5pbmNsdWRlcyhcIlBvc3RzXCIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBvc3RzVHlwZTogQ29udGVudFR5cGUgPSB7XHJcbiAgICAgICAgICAgICAgICBpZDogYHBvc3RzLSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJQb3N0c1wiLFxyXG4gICAgICAgICAgICAgICAgZm9sZGVyOiBzZXR0aW5ncy5wb3N0c0ZvbGRlciB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgbGlua0Jhc2VQYXRoOiBzZXR0aW5ncy5wb3N0c0xpbmtCYXNlUGF0aCB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IHNldHRpbmdzLmRlZmF1bHRUZW1wbGF0ZSB8fCAnLS0tXFxudGl0bGU6IFwie3t0aXRsZX19XCJcXG5kYXRlOiB7e2RhdGV9fVxcbnRhZ3M6IFtdXFxuLS0tXFxuJyxcclxuICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGlvbk1vZGU6IHNldHRpbmdzLmNyZWF0aW9uTW9kZSB8fCBcImZpbGVcIixcclxuICAgICAgICAgICAgICAgIGluZGV4RmlsZU5hbWU6IHNldHRpbmdzLmluZGV4RmlsZU5hbWUgfHwgXCJcIixcclxuICAgICAgICAgICAgICAgIGlnbm9yZVN1YmZvbGRlcnM6IHNldHRpbmdzLm9ubHlBdXRvbWF0ZUluUG9zdHNGb2xkZXIgfHwgZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVVbmRlcnNjb3JlUHJlZml4OiBzZXR0aW5ncy5lbmFibGVVbmRlcnNjb3JlUHJlZml4IHx8IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgdXNlTWR4RXh0ZW5zaW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbWlncmF0ZWRUeXBlcy5wdXNoKHBvc3RzVHlwZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBNaWdyYXRlIFBhZ2VzXHJcbiAgICAgICAgaWYgKGhhc1BhZ2VzU2V0dGluZ3MgJiYgIWNvbmZsaWN0cy5pbmNsdWRlcyhcIlBhZ2VzXCIpKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHBhZ2VzVHlwZTogQ29udGVudFR5cGUgPSB7XHJcbiAgICAgICAgICAgICAgICBpZDogYHBhZ2VzLSR7RGF0ZS5ub3coKX1gLFxyXG4gICAgICAgICAgICAgICAgbmFtZTogXCJQYWdlc1wiLFxyXG4gICAgICAgICAgICAgICAgZm9sZGVyOiBzZXR0aW5ncy5wYWdlc0ZvbGRlciB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgbGlua0Jhc2VQYXRoOiBzZXR0aW5ncy5wYWdlc0xpbmtCYXNlUGF0aCB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6IHNldHRpbmdzLnBhZ2VUZW1wbGF0ZSB8fCAnLS0tXFxudGl0bGU6IFwie3t0aXRsZX19XCJcXG5kZXNjcmlwdGlvbjogXCJcIlxcbi0tLVxcbicsXHJcbiAgICAgICAgICAgICAgICBlbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgY3JlYXRpb25Nb2RlOiBzZXR0aW5ncy5wYWdlc0NyZWF0aW9uTW9kZSB8fCBcImZpbGVcIixcclxuICAgICAgICAgICAgICAgIGluZGV4RmlsZU5hbWU6IHNldHRpbmdzLnBhZ2VzSW5kZXhGaWxlTmFtZSB8fCBcIlwiLFxyXG4gICAgICAgICAgICAgICAgaWdub3JlU3ViZm9sZGVyczogc2V0dGluZ3Mub25seUF1dG9tYXRlSW5QYWdlc0ZvbGRlciB8fCBmYWxzZSxcclxuICAgICAgICAgICAgICAgIGVuYWJsZVVuZGVyc2NvcmVQcmVmaXg6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgdXNlTWR4RXh0ZW5zaW9uOiBmYWxzZSxcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgbWlncmF0ZWRUeXBlcy5wdXNoKHBhZ2VzVHlwZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBleGlzdGluZ0Zyb21OZXcgPSBzZXR0aW5ncy5jb250ZW50VHlwZXMgfHwgW107XHJcbiAgICAgICAgY29uc3QgZXhpc3RpbmdGcm9tTGVnYWN5ID0gbGVnYWN5Q29udGVudFR5cGVzIHx8IFtdO1xyXG5cclxuICAgICAgICBsZXQgZXhpc3RpbmdUeXBlczogQ29udGVudFR5cGVbXSA9IGV4aXN0aW5nRnJvbU5ldy5sZW5ndGggPiAwID8gZXhpc3RpbmdGcm9tTmV3IDogZXhpc3RpbmdGcm9tTGVnYWN5O1xyXG4gICAgICAgIGxldCBmaW5hbFR5cGVzOiBDb250ZW50VHlwZVtdID0gWy4uLmV4aXN0aW5nVHlwZXNdO1xyXG5cclxuICAgICAgICBpZiAobWlncmF0ZWRUeXBlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV4aXN0aW5nTmFtZXMgPSBuZXcgU2V0KGV4aXN0aW5nVHlwZXMubWFwKGN0ID0+IGN0Lm5hbWUpKTtcclxuICAgICAgICAgICAgY29uc3QgbmV3TWlncmF0ZWRUeXBlcyA9IG1pZ3JhdGVkVHlwZXMuZmlsdGVyKG10ID0+ICFleGlzdGluZ05hbWVzLmhhcyhtdC5uYW1lKSk7XHJcblxyXG4gICAgICAgICAgICBpZiAobmV3TWlncmF0ZWRUeXBlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmaW5hbFR5cGVzID0gWy4uLmV4aXN0aW5nVHlwZXMsIC4uLm5ld01pZ3JhdGVkVHlwZXNdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBzZXR0aW5ncy5jb250ZW50VHlwZXMgPSBmaW5hbFR5cGVzO1xyXG5cclxuICAgICAgICAvLyBDbGVhbiB1cCBsZWdhY3kgZmllbGRzXHJcbiAgICAgICAgY29uc3QgbGVnYWN5RmllbGRzID0gW1xyXG4gICAgICAgICAgICAnY3VzdG9tQ29udGVudFR5cGVzJywgJ2VuYWJsZVVuZGVyc2NvcmVQcmVmaXgnLCAncG9zdHNGb2xkZXInLCAncG9zdHNMaW5rQmFzZVBhdGgnLFxyXG4gICAgICAgICAgICAnYXV0b21hdGVQb3N0Q3JlYXRpb24nLCAnY3JlYXRpb25Nb2RlJywgJ2luZGV4RmlsZU5hbWUnLCAnZXhjbHVkZWREaXJlY3RvcmllcycsXHJcbiAgICAgICAgICAgICdvbmx5QXV0b21hdGVJblBvc3RzRm9sZGVyJywgJ2VuYWJsZVBhZ2VzJywgJ3BhZ2VzRm9sZGVyJywgJ3BhZ2VzTGlua0Jhc2VQYXRoJyxcclxuICAgICAgICAgICAgJ3BhZ2VzQ3JlYXRpb25Nb2RlJywgJ3BhZ2VzSW5kZXhGaWxlTmFtZScsICdwYWdlVGVtcGxhdGUnLCAnb25seUF1dG9tYXRlSW5QYWdlc0ZvbGRlcidcclxuICAgICAgICBdO1xyXG5cclxuICAgICAgICBjb25zdCBzZXR0aW5nc1JlY29yZCA9IHNldHRpbmdzIGFzIHVua25vd24gYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj47XHJcbiAgICAgICAgZm9yIChjb25zdCBmaWVsZCBvZiBsZWdhY3lGaWVsZHMpIHtcclxuICAgICAgICAgICAgZGVsZXRlIHNldHRpbmdzUmVjb3JkW2ZpZWxkXTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNldHRpbmdzLm1pZ3JhdGlvbkNvbXBsZXRlZCA9IHRydWU7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ubG9hZFNldHRpbmdzKCk7XHJcblxyXG4gICAgICAgIGlmIChtaWdyYXRlZFR5cGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbmV3IE5vdGljZShgTWlncmF0aW9uIGNvbXBsZXRlZDogJHttaWdyYXRlZFR5cGVzLmxlbmd0aH0gY29udGVudCB0eXBlKHMpIG1pZ3JhdGVkLmApO1xyXG5cclxuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3NUYWIgaW5zdGFuY2VvZiBBc3Ryb0NvbXBvc2VyU2V0dGluZ1RhYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNldHRpbmdzVGFiID0gdGhpcy5wbHVnaW4uc2V0dGluZ3NUYWI7XHJcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNldHRpbmdzVGFiLmN1c3RvbUNvbnRlbnRUeXBlc0NvbnRhaW5lciB8fCBzZXR0aW5nc1RhYi5jb250YWluZXJFbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NUYWIuZGlzcGxheSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgcmVmcmVzaCBzZXR0aW5ncyB0YWIgYWZ0ZXIgbWlncmF0aW9uOlwiLCBlKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0sIDMwMCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsICJpbXBvcnQgeyBBcHAsIE1vZGFsIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE1pZ3JhdGlvbkNvbmZsaWN0UmVzdWx0IHtcclxuXHRhY3Rpb246IFwic2tpcFwiIHwgXCJtaWdyYXRlXCI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBNaWdyYXRpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuXHRyZXN1bHQ6IE1pZ3JhdGlvbkNvbmZsaWN0UmVzdWx0IHwgbnVsbCA9IG51bGw7XHJcblx0cmVzb2x2ZVByb21pc2U6ICgocmVzdWx0OiBNaWdyYXRpb25Db25mbGljdFJlc3VsdCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcclxuXHJcblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGNvbmZsaWN0czogc3RyaW5nW10pIHtcclxuXHRcdHN1cGVyKGFwcCk7XHJcblx0fVxyXG5cclxuXHRvbk9wZW4oKSB7XHJcblx0XHRjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cdFx0Y29udGVudEVsLmFkZENsYXNzKFwiYXN0cm8tY29tcG9zZXItbWlncmF0aW9uLW1vZGFsXCIpO1xyXG5cclxuXHRcdGNvbnRlbnRFbC5jcmVhdGVFbChcImgyXCIsIHsgdGV4dDogXCJNaWdyYXRpb24gY29uZmxpY3QgZGV0ZWN0ZWRcIiB9KTtcclxuXHJcblx0XHRjb250ZW50RWwuY3JlYXRlRWwoXCJwXCIsIHtcclxuXHRcdFx0dGV4dDogXCJZb3UgaGF2ZSBleGlzdGluZyBjb250ZW50IHR5cGVzIHdpdGggbmFtZXMgdGhhdCBjb25mbGljdCB3aXRoIHBvc3RzIG9yIHBhZ2VzLiBIb3cgd291bGQgeW91IGxpa2UgdG8gcHJvY2VlZD9cIixcclxuXHRcdH0pO1xyXG5cclxuXHRcdGNvbnN0IGNvbmZsaWN0TGlzdCA9IGNvbnRlbnRFbC5jcmVhdGVFbChcInVsXCIpO1xyXG5cdFx0Y29uZmxpY3RMaXN0LmNyZWF0ZUVsKFwibGlcIiwgeyB0ZXh0OiBcIlNraXAgbWlncmF0aW9uOiBrZWVwIHlvdXIgZXhpc3RpbmcgcG9zdHMvcGFnZXMgc2V0dGluZ3MgKHRoZXkgd2lsbCBiZSBpZ25vcmVkKVwiIH0pO1xyXG5cdFx0Y29uZmxpY3RMaXN0LmNyZWF0ZUVsKFwibGlcIiwgeyB0ZXh0OiBcIk1pZ3JhdGUgd2l0aCByZW5hbWVkIHR5cGVzOiBjcmVhdGUgJ3Bvc3RzIChtaWdyYXRlZCknIGFuZCAncGFnZXMgKG1pZ3JhdGVkKScgY29udGVudCB0eXBlc1wiIH0pO1xyXG5cclxuXHRcdGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibW9kYWwtYnV0dG9uLWNvbnRhaW5lclwiIH0pO1xyXG5cclxuXHRcdGNvbnN0IHNraXBCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoXCJidXR0b25cIiwge1xyXG5cdFx0XHR0ZXh0OiBcIlNraXAgbWlncmF0aW9uXCIsXHJcblx0XHRcdGNsczogXCJtb2QtY3RhXCIsXHJcblx0XHR9KTtcclxuXHRcdHNraXBCdXR0b24ub25jbGljayA9ICgpID0+IHtcclxuXHRcdFx0dGhpcy5yZXN1bHQgPSB7IGFjdGlvbjogXCJza2lwXCIgfTtcclxuXHRcdFx0dGhpcy5jbG9zZSgpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRjb25zdCBtaWdyYXRlQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKFwiYnV0dG9uXCIsIHtcclxuXHRcdFx0dGV4dDogXCJNaWdyYXRlIHdpdGggcmVuYW1lZCB0eXBlc1wiLFxyXG5cdFx0XHRjbHM6IFwibW9kLWN0YVwiLFxyXG5cdFx0fSk7XHJcblx0XHRtaWdyYXRlQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XHJcblx0XHRcdHRoaXMucmVzdWx0ID0geyBhY3Rpb246IFwibWlncmF0ZVwiIH07XHJcblx0XHRcdHRoaXMuY2xvc2UoKTtcclxuXHRcdH07XHJcblx0fVxyXG5cclxuXHRvbkNsb3NlKCkge1xyXG5cdFx0Y29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcblx0XHRjb250ZW50RWwuZW1wdHkoKTtcclxuXHRcdGlmICh0aGlzLnJlc29sdmVQcm9taXNlICYmIHRoaXMucmVzdWx0KSB7XHJcblx0XHRcdHRoaXMucmVzb2x2ZVByb21pc2UodGhpcy5yZXN1bHQpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHJcblx0YXN5bmMgd2FpdEZvclJlc3VsdCgpOiBQcm9taXNlPE1pZ3JhdGlvbkNvbmZsaWN0UmVzdWx0PiB7XHJcblx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuXHRcdFx0dGhpcy5yZXNvbHZlUHJvbWlzZSA9IHJlc29sdmU7XHJcblx0XHRcdHRoaXMub3BlbigpO1xyXG5cdFx0fSk7XHJcblx0fVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcbmltcG9ydCB7IENvbnRlbnRUeXBlLCBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcbmltcG9ydCB7IENPTlNUQU5UUyB9IGZyb20gXCIuLi9zZXR0aW5nc1wiO1xyXG5pbXBvcnQgeyBtYXRjaGVzRm9sZGVyUGF0dGVybiwgc29ydEJ5UGF0dGVyblNwZWNpZmljaXR5IH0gZnJvbSBcIi4uL3V0aWxzL3BhdGgtbWF0Y2hpbmdcIjtcclxuaW1wb3J0IHsgVGl0bGVNb2RhbCB9IGZyb20gXCIuLi91aS90aXRsZS1tb2RhbFwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIENyZWF0ZUV2ZW50U2VydmljZSB7XHJcbiAgICBwcml2YXRlIGxhc3RQcm9jZXNzZWRGaWxlczogTWFwPHN0cmluZywgbnVtYmVyPiA9IG5ldyBNYXAoKTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxyXG4gICAgICAgIHByaXZhdGUgcGx1Z2luOiBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlXHJcbiAgICApIHsgfVxyXG5cclxuICAgIHB1YmxpYyBoYW5kbGVDcmVhdGUoZmlsZTogVEZpbGUpOiB2b2lkIHtcclxuICAgICAgICB2b2lkIChhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHx8IChmaWxlLmV4dGVuc2lvbiAhPT0gXCJtZFwiICYmIGZpbGUuZXh0ZW5zaW9uICE9PSBcIm1keFwiKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGZpbGUucGF0aDtcclxuXHJcbiAgICAgICAgICAgIC8vIFNraXAgaWYgdGhpcyBmaWxlIHdhcyBjcmVhdGVkIGJ5IHRoZSBwbHVnaW4gaXRzZWxmIChUVEwgY2hlY2spXHJcbiAgICAgICAgICAgIGNvbnN0IGNyZWF0ZWRUaW1lID0gdGhpcy5wbHVnaW4ucGx1Z2luQ3JlYXRlZEZpbGVzLmdldChmaWxlUGF0aCk7XHJcbiAgICAgICAgICAgIGlmIChjcmVhdGVkVGltZSAmJiBub3cgLSBjcmVhdGVkVGltZSA8IDUgKiA2MCAqIDEwMDApIHsgLy8gNSBtaW51dGVzIFRUTFxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBQZXItZmlsZSBkZWJvdW5jZSBjaGVja1xyXG4gICAgICAgICAgICBjb25zdCBsYXN0UHJvY2Vzc2VkID0gdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZXMuZ2V0KGZpbGVQYXRoKSB8fCAwO1xyXG4gICAgICAgICAgICBpZiAobGFzdFByb2Nlc3NlZCA+IDAgJiYgbm93IC0gbGFzdFByb2Nlc3NlZCA8IENPTlNUQU5UUy5ERUJPVU5DRV9NUykge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBDbGVhbiB1cCBvbGQgZW50cmllcyBpbiBsb2NhbCBkZWJvdW5jZSBtYXBcclxuICAgICAgICAgICAgaWYgKGxhc3RQcm9jZXNzZWQgPiAwICYmIG5vdyAtIGxhc3RQcm9jZXNzZWQgPiAyMDAwKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWRGaWxlcy5kZWxldGUoZmlsZVBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBQZXJpb2RpYyBjbGVhbnVwIG9mIGRlYm91bmNlIG1hcFxyXG4gICAgICAgICAgICBjb25zdCBwZXJpb2RpY0N1dG9mZiA9IG5vdyAtIENPTlNUQU5UUy5ERUJPVU5DRV9NUyAqIDI7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgW3BhdGgsIHRpbWVdIG9mIHRoaXMubGFzdFByb2Nlc3NlZEZpbGVzLmVudHJpZXMoKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRpbWUgPCBwZXJpb2RpY0N1dG9mZikge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEZpbGVzLmRlbGV0ZShwYXRoKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gUmVsb2FkIHNldHRpbmdzIHRvIGVuc3VyZSB3ZSBoYXZlIHRoZSBsYXRlc3RcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4ubG9hZFNldHRpbmdzKCk7XHJcblxyXG4gICAgICAgICAgICAvLyBDaGVjayBiYWNrZ3JvdW5kIHByb2Nlc3NpbmdcclxuICAgICAgICAgICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGlzQWN0aXZlRmlsZSA9IGFjdGl2ZUZpbGUgJiYgYWN0aXZlRmlsZS5wYXRoID09PSBmaWxlLnBhdGg7XHJcbiAgICAgICAgICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvY2Vzc0JhY2tncm91bmRGaWxlQ2hhbmdlcyAmJiAhaXNBY3RpdmVGaWxlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNvbnRlbnRUeXBlcyB8fCBbXTtcclxuICAgICAgICAgICAgY29uc3QgaGFzRW5hYmxlZENvbnRlbnRUeXBlcyA9IGNvbnRlbnRUeXBlcy5zb21lKGN0ID0+IGN0LmVuYWJsZWQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCFoYXNFbmFibGVkQ29udGVudFR5cGVzKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHNvcnRlZENvbnRlbnRUeXBlcyA9IHNvcnRCeVBhdHRlcm5TcGVjaWZpY2l0eShjb250ZW50VHlwZXMpO1xyXG4gICAgICAgICAgICBsZXQgbWF0Y2hlZENvbnRlbnRUeXBlSWQ6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gICAgICAgICAgICBjb25zdCBtYXRjaGluZ1R5cGVzOiBDb250ZW50VHlwZVtdID0gW107XHJcblxyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGNvbnRlbnRUeXBlIG9mIHNvcnRlZENvbnRlbnRUeXBlcykge1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50VHlwZS5lbmFibGVkKSBjb250aW51ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBsZXQgbWF0Y2hlcyA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmICghY29udGVudFR5cGUuZm9sZGVyIHx8IGNvbnRlbnRUeXBlLmZvbGRlci50cmltKCkgPT09IFwiXCIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWZpbGVQYXRoLmluY2x1ZGVzKFwiL1wiKSB8fCBmaWxlUGF0aC5zcGxpdChcIi9cIikubGVuZ3RoID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hlc0ZvbGRlclBhdHRlcm4oZmlsZVBhdGgsIGNvbnRlbnRUeXBlLmZvbGRlcikpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudFR5cGUuaWdub3JlU3ViZm9sZGVycykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXRoU2VnbWVudHMgPSBmaWxlUGF0aC5zcGxpdChcIi9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdGhEZXB0aCA9IHBhdGhTZWdtZW50cy5sZW5ndGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhdHRlcm5TZWdtZW50cyA9IGNvbnRlbnRUeXBlLmZvbGRlci5zcGxpdChcIi9cIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkRGVwdGggPSBwYXR0ZXJuU2VnbWVudHMubGVuZ3RoO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlLmNyZWF0aW9uTW9kZSA9PT0gXCJmb2xkZXJcIikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZm9sZGVyRGVwdGggPSBwYXRoRGVwdGggLSAxO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoIHx8IGZvbGRlckRlcHRoID09PSBleHBlY3RlZERlcHRoICsgMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhdGhEZXB0aCA9PT0gZXhwZWN0ZWREZXB0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0Y2hlcyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIGlmIChtYXRjaGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hpbmdUeXBlcy5wdXNoKGNvbnRlbnRUeXBlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIW1hdGNoZWRDb250ZW50VHlwZUlkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZWRDb250ZW50VHlwZUlkID0gY29udGVudFR5cGUuaWQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAobWF0Y2hpbmdUeXBlcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0eXBlTmFtZXMgPSBtYXRjaGluZ1R5cGVzLm1hcChjdCA9PiBjdC5uYW1lIHx8IFwiVW5uYW1lZFwiKS5qb2luKFwiLCBcIik7XHJcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBNdWx0aXBsZSBjb250ZW50IHR5cGVzICgke3R5cGVOYW1lc30pIG1hdGNoIHRoaXMgZmlsZS4gVXNpbmcgbW9zdCBzcGVjaWZpYzogJHttYXRjaGluZ1R5cGVzWzBdLm5hbWUgfHwgXCJVbm5hbWVkXCJ9YCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICghbWF0Y2hlZENvbnRlbnRUeXBlSWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3Qgc3RhdCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LmFkYXB0ZXIuc3RhdChmaWxlLnBhdGgpO1xyXG4gICAgICAgICAgICBjb25zdCBpc05ld05vdGUgPSBzdGF0Py5tdGltZSAmJiAobm93IC0gc3RhdC5tdGltZSA8IENPTlNUQU5UUy5TVEFUX01USU1FX1RIUkVTSE9MRCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoIWlzTmV3Tm90ZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgNTApKTtcclxuXHJcbiAgICAgICAgICAgIGxldCBjb250ZW50OiBzdHJpbmc7XHJcbiAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciByZWFkaW5nIGZpbGUgZm9yIGNyZWF0ZSBkZXRlY3Rpb246XCIsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKGNvbnRlbnQudHJpbSgpLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb250ZW50LnN0YXJ0c1dpdGgoJy0tLScpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXJFbmQgPSBjb250ZW50LmluZGV4T2YoJ1xcbi0tLScsIDMpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmcm9udG1hdHRlckVuZCAhPT0gLTEpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZnJvbnRtYXR0ZXJUZXh0ID0gY29udGVudC5zbGljZSg0LCBmcm9udG1hdHRlckVuZCkudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGZyb250bWF0dGVyVGV4dC5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLnByb2Nlc3NCYWNrZ3JvdW5kRmlsZUNoYW5nZXMgJiYgbGluZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluZXMubGVuZ3RoID4gMSB8fCAobGluZXMubGVuZ3RoID09PSAxICYmICFsaW5lc1swXS5zdGFydHNXaXRoKCd0aXRsZTonKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRXaXRob3V0RnJvbnRtYXR0ZXIgPSBjb250ZW50LnN0YXJ0c1dpdGgoJy0tLScpXHJcbiAgICAgICAgICAgICAgICAgICAgPyBjb250ZW50LnNsaWNlKGNvbnRlbnQuaW5kZXhPZignXFxuLS0tJywgMykgKyA0KS50cmltKClcclxuICAgICAgICAgICAgICAgICAgICA6IGNvbnRlbnQudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbnRlbnRXaXRob3V0RnJvbnRtYXR0ZXIubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZXMuc2V0KGZpbGUucGF0aCwgbm93KTtcclxuXHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZXMuZGVsZXRlKGZpbGUucGF0aCk7XHJcbiAgICAgICAgICAgIH0sIENPTlNUQU5UUy5ERUJPVU5DRV9NUyArIDEwMCk7XHJcblxyXG4gICAgICAgICAgICBuZXcgVGl0bGVNb2RhbCh0aGlzLmFwcCwgZmlsZSwgdGhpcy5wbHVnaW4sIG1hdGNoZWRDb250ZW50VHlwZUlkLCBmYWxzZSwgdHJ1ZSkub3BlbigpO1xyXG4gICAgICAgIH0pKCk7XHJcbiAgICB9XHJcbn1cclxuIiwgImltcG9ydCB7IEFwcCwgVEZpbGUsIG1vbWVudCwgVEFic3RyYWN0RmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBBc3Ryb0NvbXBvc2VyUGx1Z2luSW50ZXJmYWNlIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgRnJvbnRtYXR0ZXJTZXJ2aWNlIHtcclxuICAgIHByaXZhdGUgbGFzdFByb2Nlc3NlZEZpbGU6IHN0cmluZyA9IFwiXCI7XHJcbiAgICBwcml2YXRlIGxhc3RQcm9jZXNzZWRUaW1lOiBudW1iZXIgPSAwO1xyXG4gICAgcHJpdmF0ZSBkZWJvdW5jZVRpbWVvdXQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBkcmFmdFN0YXR1c01hcDogTWFwPHN0cmluZywgYm9vbGVhbj4gPSBuZXcgTWFwKCk7XHJcblxyXG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBhcHA6IEFwcCwgcHJpdmF0ZSBwbHVnaW46IEFzdHJvQ29tcG9zZXJQbHVnaW5JbnRlcmZhY2UpIHtcclxuICAgICAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XHJcblxyXG4gICAgICAgIC8vIEFsc28gcmUtaW5pdGlhbGl6ZSB3aGVuIGxheW91dCBpcyByZWFkeSBqdXN0IGluIGNhc2VcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZURyYWZ0U3RhdHVzTWFwKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGluaXRpYWxpemVEcmFmdFN0YXR1c01hcCgpIHtcclxuICAgICAgICB0aGlzLmRyYWZ0U3RhdHVzTWFwLmNsZWFyKCk7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuICAgICAgICBjb25zdCBkcmFmdFByb3AgPSBzZXR0aW5ncy5kcmFmdFByb3BlcnR5IHx8IFwiZHJhZnRcIjtcclxuICAgICAgICAvLyBJbmNsdWRlIGJvdGggLm1kIGFuZCAubWR4IGZpbGVzXHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRGaWxlcygpLmZpbHRlcihmID0+IGYgaW5zdGFuY2VvZiBURmlsZSAmJiAoZi5leHRlbnNpb24gPT09ICdtZCcgfHwgZi5leHRlbnNpb24gPT09ICdtZHgnKSkgYXMgVEZpbGVbXTtcclxuXHJcbiAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHJhd1ZhbHVlID0gY2FjaGU/LmZyb250bWF0dGVyPy5bZHJhZnRQcm9wXTtcclxuICAgICAgICAgICAgdGhpcy5kcmFmdFN0YXR1c01hcC5zZXQoZmlsZS5wYXRoLCB0aGlzLmNhbGN1bGF0ZUlzRHJhZnQocmF3VmFsdWUsIHNldHRpbmdzKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY2FsY3VsYXRlSXNEcmFmdChyYXdWYWx1ZTogYW55LCBzZXR0aW5nczogYW55KTogYm9vbGVhbiB7XHJcbiAgICAgICAgLy8gSWYgdW5kZWZpbmVkL251bGwsIGFzc3VtZSBpdCdzIE5PVCBhIGRyYWZ0IHVubGVzcyBsb2dpYyBzYXlzIG90aGVyd2lzZVxyXG4gICAgICAgIGlmIChyYXdWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHJhd1ZhbHVlID09PSBudWxsKSByZXR1cm4gZmFsc2U7XHJcblxyXG4gICAgICAgIC8vIENvbnZlcnQgdG8gc3RyaW5nIGZvciBlYXNpZXIgbWF0Y2hpbmcgaWYgaXQncyBub3QgYSBib29sZWFuXHJcbiAgICAgICAgY29uc3QgdmFsID0gU3RyaW5nKHJhd1ZhbHVlKS50b0xvd2VyQ2FzZSgpO1xyXG5cclxuICAgICAgICBpZiAoc2V0dGluZ3MuZHJhZnRMb2dpYyA9PT0gJ2ZhbHNlLWlzLWRyYWZ0Jykge1xyXG4gICAgICAgICAgICAvLyBcIkZhbHNlID0gUHVibGlzaGVkXCIsIHNvIGl0J3MgYSBkcmFmdCBpZiBpdCBpcyBmYWxzZSwgXCJmYWxzZVwiLCBcIjBcIiwgZXRjLlxyXG4gICAgICAgICAgICByZXR1cm4gdmFsID09PSAnZmFsc2UnIHx8IHZhbCA9PT0gJzAnIHx8IHJhd1ZhbHVlID09PSBmYWxzZTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBcIlRydWUgPSBEcmFmdFwiLCBzbyBpdCdzIGEgZHJhZnQgaWYgaXQgaXMgdHJ1ZSwgXCJ0cnVlXCIsIFwiMVwiLCBldGMuXHJcbiAgICAgICAgICAgIHJldHVybiB2YWwgPT09ICd0cnVlJyB8fCB2YWwgPT09ICcxJyB8fCByYXdWYWx1ZSA9PT0gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSByZWdpc3RlckV2ZW50cygpIHtcclxuICAgICAgICAvLyBXYXRjaCBmb3IgbWV0YWRhdGEgY2hhbmdlcyAocHJvcGVydHktYmFzZWQgZHJhZnQgc3luYylcclxuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICAgICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLm9uKFwiY2hhbmdlZFwiLCAoZmlsZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25NZXRhZGF0YUNoYW5nZShmaWxlKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBXYXRjaCBmb3IgcmVuYW1lcyAodW5kZXJzY29yZS1wcmVmaXggZHJhZnQgc3luYylcclxuICAgICAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5vbihcInJlbmFtZVwiLCAoZmlsZSwgb2xkUGF0aCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub25SZW5hbWUoZmlsZSwgb2xkUGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG9uUmVuYW1lKGZpbGU6IFRGaWxlLCBvbGRQYXRoOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG4gICAgICAgIGlmICghc2V0dGluZ3Muc3luY0RyYWZ0RGF0ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICBjb25zdCBvbGROYW1lID0gb2xkUGF0aC5zcGxpdChcIi9cIikucG9wKCkgfHwgXCJcIjtcclxuICAgICAgICBjb25zdCBuZXdOYW1lID0gZmlsZS5uYW1lO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBpZiBpdCB3YXMgYW4gdW5kZXJzY29yZSBkcmFmdCBhbmQgaXMgbm93IG5vdFxyXG4gICAgICAgIGlmIChvbGROYW1lLnN0YXJ0c1dpdGgoXCJfXCIpICYmICFuZXdOYW1lLnN0YXJ0c1dpdGgoXCJfXCIpKSB7XHJcbiAgICAgICAgICAgIC8vIE5lZWQgdG8gY2hlY2sgY29udGVudCB0eXBlIHRvIHNlZSBpZiB1bmRlcnNjb3JlIHByZWZpeCBpcyBlbmFibGVkXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gdGhpcy5wbHVnaW4uZmlsZU9wcz8uZ2V0Q29udGVudFR5cGVCeVBhdGgoZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgaWYgKGNvbnRlbnRUeXBlPy5lbmFibGVVbmRlcnNjb3JlUHJlZml4KSB7XHJcbiAgICAgICAgICAgICAgICB2b2lkIHRoaXMudXBkYXRlRGF0ZShmaWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIG9uTWV0YWRhdGFDaGFuZ2UoZmlsZTogVEZpbGUpIHtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHRoaXMucGx1Z2luLnNldHRpbmdzO1xyXG4gICAgICAgIGlmICghc2V0dGluZ3Muc3luY0RyYWZ0RGF0ZSAmJiAhc2V0dGluZ3MudXBkYXRlTW9kaWZpZWREYXRlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRyYWNrIGRyYWZ0IHN0YXR1cyBjaGFuZ2VzXHJcbiAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICBjb25zdCBkcmFmdFByb3AgPSBzZXR0aW5ncy5kcmFmdFByb3BlcnR5IHx8IFwiZHJhZnRcIjtcclxuICAgICAgICBjb25zdCByYXdWYWx1ZSA9IGNhY2hlPy5mcm9udG1hdHRlcj8uW2RyYWZ0UHJvcF07XHJcblxyXG4gICAgICAgIC8vIExvZ2ljOiB0cnVlLWlzLWRyYWZ0IHZzIGZhbHNlLWlzLWRyYWZ0XHJcbiAgICAgICAgY29uc3QgaXNDdXJyZW50bHlEcmFmdCA9IHRoaXMuY2FsY3VsYXRlSXNEcmFmdChyYXdWYWx1ZSwgc2V0dGluZ3MpO1xyXG5cclxuICAgICAgICAvLyBJZiBpdCdzIHRoZSBmaXJzdCB0aW1lIHdlIHNlZSB0aGlzIGZpbGUsIGp1c3QgcmVjb3JkIGl0IGFuZCBza2lwXHJcbiAgICAgICAgaWYgKCF0aGlzLmRyYWZ0U3RhdHVzTWFwLmhhcyhmaWxlLnBhdGgpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZHJhZnRTdGF0dXNNYXAuc2V0KGZpbGUucGF0aCwgaXNDdXJyZW50bHlEcmFmdCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IHByZXZpb3VzRHJhZnRTdGF0dXMgPSB0aGlzLmRyYWZ0U3RhdHVzTWFwLmdldChmaWxlLnBhdGgpO1xyXG5cclxuICAgICAgICBsZXQgZHJhZnRTdGF0dXNDaGFuZ2VkVG9QdWJsaXNoZWQgPSBmYWxzZTtcclxuICAgICAgICAvLyBUcmFuc2l0aW9uIGZyb20gZHJhZnQgdG8gbm9uLWRyYWZ0XHJcbiAgICAgICAgaWYgKHByZXZpb3VzRHJhZnRTdGF0dXMgPT09IHRydWUgJiYgaXNDdXJyZW50bHlEcmFmdCA9PT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgZHJhZnRTdGF0dXNDaGFuZ2VkVG9QdWJsaXNoZWQgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBtYXAgZm9yIG5leHQgdGltZVxyXG4gICAgICAgIHRoaXMuZHJhZnRTdGF0dXNNYXAuc2V0KGZpbGUucGF0aCwgaXNDdXJyZW50bHlEcmFmdCk7XHJcblxyXG4gICAgICAgIC8vIElmIG5vIHB1YmxpY2F0aW9uIGNoYW5nZSBhbmQgbm90IHVwZGF0aW5nIG1vZGlmaWVkIGRhdGUsIHNraXAgcHJvY2Vzc2luZ1xyXG4gICAgICAgIGlmICghZHJhZnRTdGF0dXNDaGFuZ2VkVG9QdWJsaXNoZWQgJiYgIXNldHRpbmdzLnVwZGF0ZU1vZGlmaWVkRGF0ZSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBQcmV2ZW50IGluZmluaXRlIGxvb3BzIGFuZCByZWR1bmRhbnQgcHJvY2Vzc2luZ1xyXG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XHJcbiAgICAgICAgaWYgKHRoaXMubGFzdFByb2Nlc3NlZEZpbGUgPT09IGZpbGUucGF0aCAmJiBub3cgLSB0aGlzLmxhc3RQcm9jZXNzZWRUaW1lIDwgMjAwMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBVc2UgYSBkZWJvdW5jZSB0byB3YWl0IGZvciB3cml0aW5nIHRvIGZpbmlzaFxyXG4gICAgICAgIGlmICh0aGlzLmRlYm91bmNlVGltZW91dCkge1xyXG4gICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuZGVib3VuY2VUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuZGVib3VuY2VUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgICB2b2lkIHRoaXMucHJvY2Vzc0ZpbGUoZmlsZSwgZHJhZnRTdGF0dXNDaGFuZ2VkVG9QdWJsaXNoZWQpO1xyXG4gICAgICAgIH0sIDUwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyB1cGRhdGVEYXRlKGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuICAgICAgICBjb25zdCBkYXRlRmllbGQgPSBzZXR0aW5ncy5wdWJsaXNoRGF0ZUZpZWxkIHx8IFwiZGF0ZVwiO1xyXG5cclxuICAgICAgICBhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5wcm9jZXNzRnJvbnRNYXR0ZXIoZmlsZSwgKGZyb250bWF0dGVyKSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvZGF5ID0gbW9tZW50KCkuZm9ybWF0KHNldHRpbmdzLmRhdGVGb3JtYXQpO1xyXG4gICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXJbZGF0ZUZpZWxkXSAhPT0gdG9kYXkpIHtcclxuICAgICAgICAgICAgICAgIGZyb250bWF0dGVyW2RhdGVGaWVsZF0gPSB0b2RheTtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZEZpbGUgPSBmaWxlLnBhdGg7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmxhc3RQcm9jZXNzZWRUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgcHJvY2Vzc0ZpbGUoZmlsZTogVEZpbGUsIGRyYWZ0U3RhdHVzQ2hhbmdlZFRvUHVibGlzaGVkOiBib29sZWFuKSB7XHJcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncztcclxuICAgICAgICBjb25zdCBwdWJsaXNoRGF0ZUZpZWxkID0gc2V0dGluZ3MucHVibGlzaERhdGVGaWVsZCB8fCBcImRhdGVcIjtcclxuXHJcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucHJvY2Vzc0Zyb250TWF0dGVyKGZpbGUsIChmcm9udG1hdHRlcikgPT4ge1xyXG4gICAgICAgICAgICBsZXQgY2hhbmdlZCA9IGZhbHNlO1xyXG5cclxuICAgICAgICAgICAgLy8gSGFuZGxlIERyYWZ0IFN5bmMgKHRyaWdnZXJlZCBvbmx5IG9uIHRoZSBzcGVjaWZpYyB0cmFuc2l0aW9uKVxyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3Muc3luY0RyYWZ0RGF0ZSAmJiBkcmFmdFN0YXR1c0NoYW5nZWRUb1B1Ymxpc2hlZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgdG9kYXkgPSBtb21lbnQoKS5mb3JtYXQoc2V0dGluZ3MuZGF0ZUZvcm1hdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXJbcHVibGlzaERhdGVGaWVsZF0gIT09IHRvZGF5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJbcHVibGlzaERhdGVGaWVsZF0gPSB0b2RheTtcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2VkID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gSGFuZGxlIE1vZGlmaWVkIERhdGUgU3luY1xyXG4gICAgICAgICAgICBjb25zdCBtb2RpZmllZEZpZWxkID0gc2V0dGluZ3MubW9kaWZpZWREYXRlRmllbGQgfHwgXCJtb2RpZmllZFwiO1xyXG4gICAgICAgICAgICBpZiAoc2V0dGluZ3MudXBkYXRlTW9kaWZpZWREYXRlKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBub3cgPSBtb21lbnQoKS5mb3JtYXQoc2V0dGluZ3MuZGF0ZUZvcm1hdCk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZnJvbnRtYXR0ZXJbbW9kaWZpZWRGaWVsZF0gIT09IG5vdykge1xyXG4gICAgICAgICAgICAgICAgICAgIGZyb250bWF0dGVyW21vZGlmaWVkRmllbGRdID0gbm93O1xyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoY2hhbmdlZCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5sYXN0UHJvY2Vzc2VkRmlsZSA9IGZpbGUucGF0aDtcclxuICAgICAgICAgICAgICAgIHRoaXMubGFzdFByb2Nlc3NlZFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsb0JBT087OztBQ3VGQSxJQUFNLG1CQUFtQixDQUFDLFFBQVEsV0FBVyxZQUFZO0FBRXpELElBQU0sWUFBWTtBQUFBLEVBQ3hCLGFBQWE7QUFBQSxFQUNiLHNCQUFzQjtBQUFBLEVBQ3RCLHdCQUF3QjtBQUFBLEVBQ3hCLDRCQUE0QjtBQUM3Qjs7O0FDaEdPLElBQU0sbUJBQTBDO0FBQUEsRUFDdEQsaUJBQ0M7QUFBQSxFQUNELHNCQUFzQjtBQUFBLEVBQ3RCLFlBQVk7QUFBQSxFQUNaLHVCQUF1QjtBQUFBLEVBQ3ZCLHVCQUF1QjtBQUFBLEVBQ3ZCLHlCQUF5QjtBQUFBLEVBQ3pCLDJCQUEyQjtBQUFBLEVB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QWEsWUFBWSxhQUFhLFdBQVc7QUFDN0UsZUFBSSxVQUFLLGdCQUFMLG1CQUFrQixjQUFjLFNBQVMsVUFBVyxNQUFLLE9BQU87QUFBQSxRQUNyRTtBQUFBLE1BQ0Q7QUFBQSxJQUNEO0FBQUEsRUFDRDtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIm5ld0ZpbGUiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiY29udGVudFR5cGUiLCAiX2EiLCAiaGFzTWF0Y2hpbmdDb250ZW50VHlwZSIsICJzZXR0aW5ncyIsICJwbHVnaW5JbnRlcmZhY2UiLCAiZmlsZSIsICJ0eXBlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAidG9nZ2xlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJfYSIsICJfYiJdCn0K
