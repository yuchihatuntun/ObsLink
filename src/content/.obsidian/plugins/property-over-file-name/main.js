/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/utils/search.ts
function buildFileCache(files, metadataCache, propertyKey) {
  const cache = /* @__PURE__ */ new Map();
  files.forEach((file) => {
    const fileCache = metadataCache.getFileCache(file);
    const frontmatter = fileCache == null ? void 0 : fileCache.frontmatter;
    let displayName = file.basename;
    let isCustomDisplay = false;
    let aliases = [];
    if (frontmatter && frontmatter[propertyKey] !== void 0 && frontmatter[propertyKey] !== null) {
      const propertyValue = String(frontmatter[propertyKey]).trim();
      if (propertyValue !== "") {
        displayName = propertyValue;
        isCustomDisplay = true;
      }
    }
    if (frontmatter == null ? void 0 : frontmatter.aliases) {
      const aliasesRaw = frontmatter.aliases;
      aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
      aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
    }
    cache.set(file.path, {
      file,
      displayName,
      aliases,
      lastModified: file.stat.mtime,
      isCustomDisplay
    });
  });
  return cache;
}
var init_search = __esm({
  "src/utils/search.ts"() {
    "use strict";
  }
});

// src/ui/QuickSwitchModal.ts
var QuickSwitchModal_exports = {};
__export(QuickSwitchModal_exports, {
  QuickSwitchModal: () => QuickSwitchModal
});
var import_obsidian4, QuickSwitchModal;
var init_QuickSwitchModal = __esm({
  "src/ui/QuickSwitchModal.ts"() {
    "use strict";
    import_obsidian4 = require("obsidian");
    init_search();
    QuickSwitchModal = class extends import_obsidian4.FuzzySuggestModal {
      constructor(app, plugin) {
        super(app);
        this.fileCache = /* @__PURE__ */ new Map();
        this.recentFiles = [];
        this.searchTimeout = null;
        this.matchReasons = /* @__PURE__ */ new Map();
        this.plugin = plugin;
        this.limit = 8;
        if (this.plugin.settings.enableForQuickSwitcher) {
          this.setPlaceholder("Type to search notes by title or file name...");
        } else {
          this.setPlaceholder("Type to search files...");
        }
        this.buildFileCache();
        this.updateRecentFiles();
        this.addKeyboardNavigation();
        this.addFooter();
        if (this.plugin.settings.enableForQuickSwitcher) {
          this.containerEl.addClass("property-over-filename-modal");
        }
      }
      addKeyboardNavigation() {
        this.inputEl.addEventListener("keydown", (e) => {
          if (e.key === "Escape") {
            this.close();
            e.preventDefault();
            e.stopPropagation();
          }
        });
      }
      addFooter() {
        const promptContainer = this.containerEl.querySelector(".prompt");
        if (promptContainer) {
          const footer = promptContainer.createDiv({ cls: "prompt-instructions" });
          const instructions = [
            { command: "\u2191\u2193", action: "to navigate" },
            { command: "\u21B5", action: "to open" },
            { command: "ctrl \u21B5", action: "to open in new tab" },
            { command: "ctrl alt \u21B5", action: "to open to the right" },
            { command: "shift \u21B5", action: "to create" },
            { command: "esc", action: "to dismiss" }
          ];
          instructions.forEach(({ command, action }) => {
            const instruction = footer.createDiv({ cls: "prompt-instruction" });
            instruction.createSpan({ cls: "prompt-instruction-command", text: command });
            instruction.createSpan({ text: action });
          });
        }
      }
      buildFileCache() {
        const files = this.getFilteredFiles();
        this.fileCache = buildFileCache(
          files,
          this.app.metadataCache,
          this.plugin.settings.propertyKey
        );
      }
      updateFileCache(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        let displayName = file.basename;
        let isCustomDisplay = false;
        let aliases = [];
        if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
          const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
          if (propertyValue !== "") {
            displayName = propertyValue;
            isCustomDisplay = true;
          }
        }
        if (frontmatter == null ? void 0 : frontmatter.aliases) {
          const aliasesRaw = frontmatter.aliases;
          aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
          aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
        }
        this.fileCache.set(file.path, {
          file,
          displayName,
          aliases,
          lastModified: file.stat.mtime,
          isCustomDisplay
        });
      }
      updateRecentFiles() {
        var _a, _b;
        let recentFiles = [];
        const workspace = this.app.workspace;
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        const showAttachments = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showAttachments) != null ? _a : true;
        if ((_b = workspace.recentFileTracker) == null ? void 0 : _b.getLastOpenFiles) {
          const lastOpenFiles = workspace.recentFileTracker.getLastOpenFiles();
          recentFiles = lastOpenFiles.map((filePath) => this.app.vault.getAbstractFileByPath(filePath)).filter((file) => file instanceof import_obsidian4.TFile);
        }
        if (recentFiles.length === 0) {
          const openFiles = this.app.workspace.getLeavesOfType("markdown").map((leaf) => leaf.view).filter((view) => view instanceof import_obsidian4.MarkdownView).map((view) => view.file).filter((file) => file !== null).filter((file, index, self) => self.indexOf(file) === index);
          recentFiles = [...openFiles];
        }
        if (!showAttachments) {
          recentFiles = recentFiles.filter((file) => file.extension === "md");
        }
        const targetCount = 8;
        const existingPaths = new Set(recentFiles.map((f) => f.path));
        if (recentFiles.length < targetCount) {
          if (showAttachments) {
            const allFiles = this.app.vault.getFiles().filter((file) => file instanceof import_obsidian4.TFile);
            const additionalFiles = allFiles.filter((file) => !existingPaths.has(file.path)).slice(0, targetCount - recentFiles.length);
            recentFiles.push(...additionalFiles);
          } else {
            const allMarkdownFiles = this.app.vault.getMarkdownFiles();
            const additionalFiles = allMarkdownFiles.filter((file) => !existingPaths.has(file.path)).slice(0, targetCount - recentFiles.length);
            recentFiles.push(...additionalFiles);
          }
        }
        this.recentFiles = recentFiles.slice(0, targetCount);
      }
      getItems() {
        return this.getFilteredFiles();
      }
      getFilteredFiles() {
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        let files = this.app.vault.getMarkdownFiles();
        if (quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showAttachments) {
          const allFiles = this.app.vault.getFiles().filter((file) => file instanceof import_obsidian4.TFile);
          files = allFiles.filter(
            (file) => file.extension === "md" || this.isAttachment(file)
          );
        }
        return files;
      }
      isAttachment(file) {
        const attachmentExtensions = ["png", "jpg", "jpeg", "gif", "svg", "webp", "pdf", "mp4", "mp3", "wav", "ogg", "webm"];
        return attachmentExtensions.includes(file.extension.toLowerCase());
      }
      getQuickSwitcherOptions() {
        var _a;
        try {
          const internalPlugins = this.app.internalPlugins;
          if (!internalPlugins)
            return null;
          const switcherPlugin = (_a = internalPlugins.getPluginById) == null ? void 0 : _a.call(internalPlugins, "switcher");
          if (!switcherPlugin || !switcherPlugin.instance) {
            return null;
          }
          return switcherPlugin.instance.options || null;
        } catch (error) {
          console.warn("Property Over Filename: Could not access Quick Switcher options:", error);
          return null;
        }
      }
      getItemText(item) {
        if ("isNewNote" in item) {
          return item.newName;
        }
        if ("isUnresolved" in item) {
          return item.unresolvedText;
        }
        if (!this.plugin.settings.enableForQuickSwitcher) {
          return item.basename;
        }
        const display = this.getDisplayName(item);
        return display;
      }
      getDisplayName(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
        if (propertyValue !== void 0 && propertyValue !== null) {
          const trimmed = typeof propertyValue === "string" ? propertyValue.trim() : (typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "").trim();
          if (trimmed !== "") {
            return trimmed;
          }
        }
        return file.basename;
      }
      getSuggestions(query) {
        var _a;
        if (!this.plugin.settings.enableForQuickSwitcher) {
          const searchQuery2 = query.trim();
          if (!searchQuery2) {
            return this.getRecentFilesResults();
          }
          const files = this.getFilteredFiles();
          const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian4.prepareSimpleSearch)(searchQuery2) : (0, import_obsidian4.prepareFuzzySearch)(searchQuery2);
          const results = [];
          for (const file of files) {
            const match = (_a = search(file.basename)) != null ? _a : { score: 0, matches: [] };
            if (match.matches.length > 0) {
              results.push({ item: file, match });
            }
          }
          (0, import_obsidian4.sortSearchResults)(results);
          if (results.length === 0) {
            const newItem = { isNewNote: true, newName: searchQuery2 };
            results.push({
              item: newItem,
              match: { score: 1e3, matches: [[0, searchQuery2.length]] }
            });
          }
          return results.slice(0, this.limit);
        }
        const searchQuery = query.trim();
        if (this.searchTimeout) {
          clearTimeout(this.searchTimeout);
        }
        if (!searchQuery) {
          return this.getRecentFilesResults();
        }
        return this.performSearch(searchQuery);
      }
      getRecentFilesResults() {
        this.updateRecentFiles();
        this.matchReasons.clear();
        return this.recentFiles.map((file) => ({
          item: file,
          match: { score: 1e3, matches: [] }
        }));
      }
      performSearch(searchQuery) {
        var _a;
        const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian4.prepareSimpleSearch)(searchQuery) : (0, import_obsidian4.prepareFuzzySearch)(searchQuery);
        const results = [];
        this.matchReasons.clear();
        for (const cachedData of this.fileCache.values()) {
          const { file, displayName, aliases, isCustomDisplay } = cachedData;
          const matchReason = {
            matchedInTitle: false,
            matchedInFilename: false,
            matchedInAlias: false
          };
          let primaryMatch = null;
          let bestMatch = null;
          let matchType = null;
          if (isCustomDisplay) {
            primaryMatch = search(displayName);
            if (primaryMatch && primaryMatch.matches.length > 0) {
              matchReason.matchedInTitle = true;
              bestMatch = primaryMatch;
              matchType = "title";
            }
          }
          if (!matchType) {
            if (this.plugin.settings.includeFilenameInSearch && file.basename !== displayName) {
              const filenameMatch = search(file.basename);
              if (filenameMatch && filenameMatch.matches.length > 0) {
                matchReason.matchedInFilename = true;
                bestMatch = { ...filenameMatch, score: filenameMatch.score - 1 };
                matchType = "filename";
              }
            } else if (!isCustomDisplay) {
              const filenameMatch = search(file.basename);
              if (filenameMatch && filenameMatch.matches.length > 0) {
                matchReason.matchedInFilename = true;
                bestMatch = filenameMatch;
                matchType = "filename";
              }
            }
          }
          if (!matchType && this.plugin.settings.includeAliasesInSearch && aliases.length > 0) {
            for (const alias of aliases) {
              const aliasMatch = search(alias);
              if (aliasMatch && aliasMatch.matches.length > 0) {
                matchReason.matchedInAlias = true;
                matchReason.matchedAliasText = alias;
                bestMatch = { ...aliasMatch, score: aliasMatch.score - 1 };
                matchType = "alias";
                break;
              }
            }
          }
          if (bestMatch && bestMatch.matches.length > 0) {
            results.push({ item: file, match: bestMatch });
            this.matchReasons.set(file.path, matchReason);
          }
        }
        const quickSwitcherOptions = this.getQuickSwitcherOptions();
        const showExistingOnly = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showExistingOnly) != null ? _a : false;
        if (!showExistingOnly) {
          const { unresolvedLinks } = this.app.metadataCache;
          const unresolvedSet = /* @__PURE__ */ new Set();
          for (const sourcePath in unresolvedLinks) {
            const links = Object.keys(unresolvedLinks[sourcePath]);
            links.forEach((link) => unresolvedSet.add(link));
          }
          for (const unresolved of unresolvedSet) {
            const unresolvedMatch = search(unresolved);
            if (unresolvedMatch && unresolvedMatch.matches.length > 0) {
              const unresolvedItem = { isUnresolved: true, unresolvedText: unresolved };
              results.push({
                item: unresolvedItem,
                match: unresolvedMatch
              });
            }
          }
        }
        try {
          (0, import_obsidian4.sortSearchResults)(results);
          let filteredResults = results;
          if (showExistingOnly) {
            filteredResults = results.filter((r) => {
              return r.item instanceof import_obsidian4.TFile || "isNewNote" in r.item && r.item.isNewNote === true;
            });
          }
          const lowerQuery = searchQuery.toLowerCase();
          let exactMatch = filteredResults.some(
            (r) => {
              var _a2;
              return r.item instanceof import_obsidian4.TFile && (this.getDisplayName(r.item).toLowerCase() === lowerQuery || this.plugin.settings.includeFilenameInSearch && r.item.basename.toLowerCase() === lowerQuery || this.plugin.settings.includeAliasesInSearch && ((_a2 = this.fileCache.get(r.item.path)) == null ? void 0 : _a2.aliases.some((alias) => alias.toLowerCase() === lowerQuery)));
            }
          );
          if (!showExistingOnly && !exactMatch) {
            const { unresolvedLinks } = this.app.metadataCache;
            const unresolvedSet = /* @__PURE__ */ new Set();
            for (const sourcePath in unresolvedLinks) {
              const links = Object.keys(unresolvedLinks[sourcePath]);
              links.forEach((link) => unresolvedSet.add(link));
            }
            exactMatch = Array.from(unresolvedSet).some((link) => link.toLowerCase() === lowerQuery);
          }
          if (!exactMatch && searchQuery) {
            const newItem = { isNewNote: true, newName: searchQuery };
            filteredResults.unshift({
              item: newItem,
              match: { score: 1e3, matches: [[0, searchQuery.length]] }
            });
          }
          return filteredResults.slice(0, this.limit);
        } catch (error) {
          console.error("Error generating suggestions:", error);
          new import_obsidian4.Notice("Error updating quick switcher suggestions. Please check console for details.");
          return [];
        }
      }
      renderSuggestion(suggestion, el) {
        var _a;
        const { item } = suggestion;
        if ("isUnresolved" in item && item.isUnresolved) {
          const unresolvedText = item.unresolvedText;
          el.empty();
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const suggestionTitle = suggestionContent.createDiv({ cls: "suggestion-title" });
          suggestionTitle.setText(unresolvedText);
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionFlair = suggestionAux.createSpan({
            cls: "suggestion-flair",
            attr: { "aria-label": "Unresolved link - Enter to create" }
          });
          this.createFilePlusIcon(suggestionFlair);
          return;
        }
        const text = this.getItemText(item);
        if ("isNewNote" in item) {
          el.empty();
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const suggestionTitle = suggestionContent.createDiv({ cls: "suggestion-title" });
          suggestionTitle.setText(text);
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionAction = suggestionAux.createSpan({ cls: "suggestion-action" });
          suggestionAction.setText("Enter to create");
          return;
        }
        if (!this.plugin.settings.enableForQuickSwitcher) {
          if (item instanceof import_obsidian4.TFile) {
            el.setText(item.path.replace(".md", ""));
          } else {
            el.setText(text);
          }
        } else {
          if (!(item instanceof import_obsidian4.TFile)) {
            el.setText(text);
            return;
          }
          const cachedData = this.fileCache.get(item.path);
          const isCustomDisplay = (_a = cachedData == null ? void 0 : cachedData.isCustomDisplay) != null ? _a : false;
          const matchReason = this.matchReasons.get(item.path);
          if (!isCustomDisplay && (matchReason == null ? void 0 : matchReason.matchedInAlias) && matchReason.matchedAliasText) {
            el.addClass("mod-complex");
            const suggestionContent = el.createDiv({ cls: "suggestion-content" });
            const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
            titleEl.setText(matchReason.matchedAliasText);
            const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
            pathEl.setText(item.path.replace(".md", ""));
            const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
            const suggestionFlair = suggestionAux.createSpan({
              cls: "suggestion-flair",
              attr: { "aria-label": "Alias Match" }
            });
            this.createForwardIcon(suggestionFlair);
          } else if (isCustomDisplay) {
            const shouldShowIcon = matchReason && (matchReason.matchedInTitle || matchReason.matchedInFilename || matchReason.matchedInAlias);
            if (shouldShowIcon) {
              el.addClass("mod-complex");
              const suggestionContent = el.createDiv({ cls: "suggestion-content" });
              const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
              titleEl.setText(text);
              const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
              pathEl.setText(item.path.replace(".md", ""));
              const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
              const suggestionFlair = suggestionAux.createSpan({
                cls: "suggestion-flair",
                attr: { "aria-label": this.getIconLabel(matchReason) }
              });
              if (matchReason.matchedInTitle) {
                this.createTypeIcon(suggestionFlair);
              } else if (matchReason.matchedInFilename) {
                this.createFileIcon(suggestionFlair);
              } else if (matchReason.matchedInAlias) {
                this.createForwardIcon(suggestionFlair);
              }
            } else {
              el.addClass("mod-complex");
              const suggestionContent = el.createDiv({ cls: "suggestion-content" });
              const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
              titleEl.setText(text);
              const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
              pathEl.setText(item.path.replace(".md", ""));
              const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
              const suggestionFlair = suggestionAux.createSpan({
                cls: "suggestion-flair",
                attr: { "aria-label": "Property-based title" }
              });
              this.createTypeIcon(suggestionFlair);
            }
          } else {
            el.setText(text);
          }
        }
      }
      getIconLabel(matchReason) {
        if (matchReason.matchedInTitle) {
          return "Title/Property Match";
        } else if (matchReason.matchedInFilename) {
          return "File Name Match";
        } else if (matchReason.matchedInAlias) {
          return "Alias Match";
        }
        return "Match";
      }
      createTypeIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-type");
        const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline1.setAttribute("points", "4 7 4 4 20 4 20 7");
        svg.appendChild(polyline1);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "9");
        line1.setAttribute("y1", "20");
        line1.setAttribute("x2", "15");
        line1.setAttribute("y2", "20");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "12");
        line2.setAttribute("y1", "4");
        line2.setAttribute("x2", "12");
        line2.setAttribute("y2", "20");
        svg.appendChild(line2);
        container.appendChild(svg);
      }
      createFileIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-file-text");
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
        svg.appendChild(path);
        const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline1.setAttribute("points", "14,2 14,8 20,8");
        svg.appendChild(polyline1);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "16");
        line1.setAttribute("y1", "13");
        line1.setAttribute("x2", "8");
        line1.setAttribute("y2", "13");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "16");
        line2.setAttribute("y1", "17");
        line2.setAttribute("x2", "8");
        line2.setAttribute("y2", "17");
        svg.appendChild(line2);
        const polyline2 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline2.setAttribute("points", "10,9 9,9 8,9");
        svg.appendChild(polyline2);
        container.appendChild(svg);
      }
      createForwardIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-forward");
        const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline.setAttribute("points", "15 17 20 12 15 7");
        svg.appendChild(polyline);
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M4 18v-2a4 4 0 0 1 4-4h12");
        svg.appendChild(path);
        container.appendChild(svg);
      }
      createFilePlusIcon(container) {
        const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
        svg.setAttribute("width", "24");
        svg.setAttribute("height", "24");
        svg.setAttribute("viewBox", "0 0 24 24");
        svg.setAttribute("fill", "none");
        svg.setAttribute("stroke", "currentColor");
        svg.setAttribute("stroke-width", "2");
        svg.setAttribute("stroke-linecap", "round");
        svg.setAttribute("stroke-linejoin", "round");
        svg.classList.add("svg-icon", "lucide-file-plus");
        const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
        path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
        svg.appendChild(path);
        const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
        polyline.setAttribute("points", "14,2 14,8 20,8");
        svg.appendChild(polyline);
        const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line1.setAttribute("x1", "12");
        line1.setAttribute("y1", "18");
        line1.setAttribute("x2", "12");
        line1.setAttribute("y2", "12");
        svg.appendChild(line1);
        const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
        line2.setAttribute("x1", "9");
        line2.setAttribute("y1", "15");
        line2.setAttribute("x2", "15");
        line2.setAttribute("y2", "15");
        svg.appendChild(line2);
        container.appendChild(svg);
      }
      isUsingCustomProperty(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
        if (propertyValue === void 0 || propertyValue === null) {
          return false;
        }
        const strValue = typeof propertyValue === "string" ? propertyValue : typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "";
        return strValue.trim() !== "";
      }
      isUsingAlias(file) {
        const cache = this.app.metadataCache.getFileCache(file);
        const frontmatter = cache == null ? void 0 : cache.frontmatter;
        const aliases = frontmatter == null ? void 0 : frontmatter.aliases;
        if (!aliases)
          return false;
        const isUsingCustomProperty = this.isUsingCustomProperty(file);
        return !isUsingCustomProperty && Boolean(aliases);
      }
      onChooseItem(item, evt) {
        var _a, _b;
        if ("isUnresolved" in item && item.isUnresolved) {
          const unresolvedText = item.unresolvedText;
          const activeView = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
          const sourcePath = ((_a = activeView == null ? void 0 : activeView.file) == null ? void 0 : _a.path) || "";
          void this.app.workspace.openLinkText(unresolvedText, sourcePath).catch((err) => {
            const message = err instanceof Error ? err.message : String(err);
            new import_obsidian4.Notice(`Error creating note: ${message}`);
          });
          return;
        }
        if ("isNewNote" in item) {
          const activeView = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
          const sourcePath = ((_b = activeView == null ? void 0 : activeView.file) == null ? void 0 : _b.path) || "";
          void this.app.workspace.openLinkText(item.newName, sourcePath).catch((err) => {
            const message = err instanceof Error ? err.message : String(err);
            new import_obsidian4.Notice(`Error creating note: ${message}`);
          });
        } else if (item instanceof import_obsidian4.TFile) {
          if (evt instanceof KeyboardEvent) {
            if (evt.ctrlKey && evt.altKey) {
              const leaf = this.app.workspace.getLeaf(true);
              void leaf.openFile(item);
            } else if (evt.ctrlKey) {
              void this.app.workspace.getLeaf().openFile(item);
            } else if (evt.shiftKey) {
              void this.app.workspace.getLeaf().openFile(item);
            } else {
              void this.app.workspace.getLeaf().openFile(item);
            }
          } else {
            void this.app.workspace.getLeaf().openFile(item);
          }
        }
      }
    };
  }
});

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => PropertyOverFileNamePlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian11 = require("obsidian");

// src/settings.ts
var DEFAULT_SETTINGS = {
  propertyKey: "title",
  enableForLinking: true,
  enableForQuickSwitcher: true,
  includeFilenameInSearch: true,
  includeAliasesInSearch: true,
  enableForDragDrop: true,
  useSimpleSearch: false,
  enableForGraphView: true,
  enableForBacklinks: true,
  enableForTabs: true,
  enableForExplorer: false,
  folderNoteFilename: "",
  enableForWindowFrame: true
};

// src/ui/LinkTitleSuggest.ts
var import_obsidian = require("obsidian");
init_search();
var LinkTitleSuggest = class extends import_obsidian.EditorSuggest {
  constructor(plugin) {
    super(plugin.app);
    this.fileCache = /* @__PURE__ */ new Map();
    this.searchTimeout = null;
    this.matchReasons = /* @__PURE__ */ new Map();
    this.plugin = plugin;
    this.buildFileCache();
  }
  open() {
    super.open();
    const el = this.suggestEl;
    if (el) {
      el.addClass("property-over-filename-suggestion");
      if (!el.querySelector(".prompt-instructions")) {
        const instructions = el.createDiv({ cls: "prompt-instructions" });
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type # to link heading");
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type ^ to link blocks");
        instructions.createDiv({ cls: "prompt-instruction" }).setText("Type | to change display text");
      }
    }
    this.addKeyboardNavigation();
  }
  addKeyboardNavigation() {
    const el = this.suggestEl;
    if (!el)
      return;
    el.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        this.close();
        e.preventDefault();
        e.stopPropagation();
      }
    });
  }
  onTrigger(cursor, editor, file) {
    if (!this.plugin.settings.enableForLinking)
      return null;
    const line = editor.getLine(cursor.line).substring(0, cursor.ch);
    const match = /\[\[([^#^|\]]*)$/.exec(line);
    if (match) {
      return {
        start: { line: cursor.line, ch: line.lastIndexOf("[[") },
        end: cursor,
        query: match[1]
      };
    }
    return null;
  }
  buildFileCache() {
    this.fileCache = buildFileCache(
      this.app.vault.getMarkdownFiles(),
      this.app.metadataCache,
      this.plugin.settings.propertyKey
    );
  }
  updateFileCache(file) {
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    let displayName = file.basename;
    let isCustomDisplay = false;
    let aliases = [];
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        displayName = propertyValue;
        isCustomDisplay = true;
      }
    }
    if (frontmatter == null ? void 0 : frontmatter.aliases) {
      const aliasesRaw = frontmatter.aliases;
      aliases = Array.isArray(aliasesRaw) ? aliasesRaw.map((a) => String(a)) : [String(aliasesRaw)];
      aliases = aliases.map((alias) => alias.trim()).filter((alias) => alias !== "");
    }
    this.fileCache.set(file.path, {
      file,
      displayName,
      aliases,
      lastModified: file.stat.mtime,
      isCustomDisplay
    });
  }
  getSuggestions(context) {
    const query = context.query.trim();
    return this.performSearch(query);
  }
  performSearch(query) {
    var _a;
    if (!query || query.trim() === "") {
      const suggestions2 = [];
      for (const cachedData of this.fileCache.values()) {
        suggestions2.push({
          file: cachedData.file,
          display: cachedData.displayName,
          isCustomDisplay: cachedData.isCustomDisplay
        });
      }
      return suggestions2;
    }
    const search = this.plugin.settings.useSimpleSearch ? (0, import_obsidian.prepareSimpleSearch)(query) : (0, import_obsidian.prepareFuzzySearch)(query);
    const searchableSuggestions = [];
    this.matchReasons.clear();
    for (const cachedData of this.fileCache.values()) {
      const { file, displayName, aliases, isCustomDisplay } = cachedData;
      const matchReason = {
        matchedInTitle: false,
        matchedInFilename: false,
        matchedInAlias: false
      };
      let primaryMatch = null;
      let bestMatch = null;
      let matchType = null;
      if (isCustomDisplay) {
        primaryMatch = search(displayName);
        if (primaryMatch && primaryMatch.matches.length > 0) {
          matchReason.matchedInTitle = true;
          bestMatch = primaryMatch;
          matchType = "title";
        }
      }
      if (!matchType) {
        if (this.plugin.settings.includeFilenameInSearch && file.basename !== displayName) {
          const filenameMatch = search(file.basename);
          if (filenameMatch && filenameMatch.matches.length > 0) {
            matchReason.matchedInFilename = true;
            bestMatch = { ...filenameMatch, score: filenameMatch.score - 1 };
            matchType = "filename";
          }
        } else if (!isCustomDisplay) {
          const filenameMatch = search(file.basename);
          if (filenameMatch && filenameMatch.matches.length > 0) {
            matchReason.matchedInFilename = true;
            bestMatch = filenameMatch;
            matchType = "filename";
          }
        }
      }
      if (!matchType && this.plugin.settings.includeAliasesInSearch && aliases.length > 0) {
        for (const alias of aliases) {
          const aliasMatch = search(alias);
          if (aliasMatch && aliasMatch.matches.length > 0) {
            matchReason.matchedInAlias = true;
            matchReason.matchedAliasText = alias;
            bestMatch = { ...aliasMatch, score: aliasMatch.score - 1 };
            matchType = "alias";
            break;
          }
        }
      }
      if (bestMatch && bestMatch.matches.length > 0) {
        const suggestion = {
          file,
          display: displayName,
          isCustomDisplay
        };
        searchableSuggestions.push({ item: suggestion, match: bestMatch });
        this.matchReasons.set(file.path, matchReason);
      }
    }
    const quickSwitcherOptions = this.getQuickSwitcherOptions();
    const showExistingOnly = (_a = quickSwitcherOptions == null ? void 0 : quickSwitcherOptions.showExistingOnly) != null ? _a : false;
    if (!showExistingOnly) {
      const { unresolvedLinks } = this.app.metadataCache;
      const unresolvedSet = /* @__PURE__ */ new Set();
      for (const sourcePath in unresolvedLinks) {
        const links = Object.keys(unresolvedLinks[sourcePath]);
        links.forEach((link) => unresolvedSet.add(link));
      }
      for (const unresolved of unresolvedSet) {
        const unresolvedMatch = search(unresolved);
        if (unresolvedMatch && unresolvedMatch.matches.length > 0) {
          searchableSuggestions.push({
            item: {
              display: unresolved,
              isCustomDisplay: false
              // No file property means it's unresolved
            },
            match: unresolvedMatch
          });
        }
      }
    }
    (0, import_obsidian.sortSearchResults)(searchableSuggestions);
    let suggestions = searchableSuggestions.map((s) => s.item);
    if (showExistingOnly) {
      suggestions = suggestions.filter((s) => s.file !== void 0);
    }
    if (suggestions.length === 0 && query) {
      suggestions.push({
        display: "No match found",
        isCustomDisplay: false,
        isNoMatch: true
      });
    }
    return suggestions;
  }
  renderSuggestion(suggestion, el) {
    el.empty();
    if (suggestion.isNoMatch) {
      el.setText(suggestion.display);
      return;
    }
    if (suggestion.file) {
      const matchReason = this.matchReasons.get(suggestion.file.path);
      if (!suggestion.isCustomDisplay && (matchReason == null ? void 0 : matchReason.matchedInAlias) && matchReason.matchedAliasText) {
        el.addClass("mod-complex");
        const suggestionContent = el.createDiv({ cls: "suggestion-content" });
        const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
        titleEl.setText(matchReason.matchedAliasText);
        const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
        pathEl.setText(suggestion.file.path.replace(".md", ""));
        const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
        const suggestionFlair = suggestionAux.createSpan({
          cls: "suggestion-flair",
          attr: { "aria-label": "Alias Match" }
        });
        this.createForwardIcon(suggestionFlair);
      } else if (suggestion.isCustomDisplay) {
        const shouldShowIcon = matchReason && (matchReason.matchedInTitle || matchReason.matchedInFilename || matchReason.matchedInAlias);
        if (shouldShowIcon) {
          el.addClass("mod-complex");
          const suggestionContent = el.createDiv({ cls: "suggestion-content" });
          const titleEl = suggestionContent.createDiv({ cls: "suggestion-title" });
          titleEl.setText(suggestion.display);
          const pathEl = suggestionContent.createDiv({ cls: "suggestion-note" });
          pathEl.setText(suggestion.file.path.replace(".md", ""));
          const suggestionAux = el.createDiv({ cls: "suggestion-aux" });
          const suggestionFlair = suggestionAux.createSpan({
            cls: "suggestion-flair",
            attr: { "aria-label": this.getIconLabel(matchReason) }
          });
          if (matchReason.matchedInTitle) {
            this.createTypeIcon(suggestionFlair);
          } else if (matchReason.matchedInFilename) {
            this.createFileIcon(suggestionFlair);
          } else if (matchReason.matchedInAlias) {
            this.createForwardIcon(suggestionFlair);
          }
        } else {
          el.setText(suggestion.display);
        }
      } else {
        el.setText(suggestion.display);
      }
    }
  }
  getIconLabel(matchReason) {
    if (matchReason.matchedInTitle) {
      return "Title/Property Match";
    } else if (matchReason.matchedInFilename) {
      return "File Name Match";
    } else if (matchReason.matchedInAlias) {
      return "Alias Match";
    }
    return "Match";
  }
  createTypeIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-type");
    const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline1.setAttribute("points", "4 7 4 4 20 4 20 7");
    svg.appendChild(polyline1);
    const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line1.setAttribute("x1", "9");
    line1.setAttribute("y1", "20");
    line1.setAttribute("x2", "15");
    line1.setAttribute("y2", "20");
    svg.appendChild(line1);
    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", "12");
    line2.setAttribute("y1", "4");
    line2.setAttribute("x2", "12");
    line2.setAttribute("y2", "20");
    svg.appendChild(line2);
    container.appendChild(svg);
  }
  createFileIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-file-text");
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", "M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z");
    svg.appendChild(path);
    const polyline1 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline1.setAttribute("points", "14,2 14,8 20,8");
    svg.appendChild(polyline1);
    const line1 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line1.setAttribute("x1", "16");
    line1.setAttribute("y1", "13");
    line1.setAttribute("x2", "8");
    line1.setAttribute("y2", "13");
    svg.appendChild(line1);
    const line2 = document.createElementNS("http://www.w3.org/2000/svg", "line");
    line2.setAttribute("x1", "16");
    line2.setAttribute("y1", "17");
    line2.setAttribute("x2", "8");
    line2.setAttribute("y2", "17");
    svg.appendChild(line2);
    const polyline2 = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline2.setAttribute("points", "10,9 9,9 8,9");
    svg.appendChild(polyline2);
    container.appendChild(svg);
  }
  createForwardIcon(container) {
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "24");
    svg.setAttribute("height", "24");
    svg.setAttribute("viewBox", "0 0 24 24");
    svg.setAttribute("fill", "none");
    svg.setAttribute("stroke", "currentColor");
    svg.setAttribute("stroke-width", "2");
    svg.setAttribute("stroke-linecap", "round");
    svg.setAttribute("stroke-linejoin", "round");
    svg.classList.add("svg-icon", "lucide-forward");
    const polyline = document.createElementNS("http://www.w3.org/2000/svg", "polyline");
    polyline.setAttribute("points", "15 17 20 12 15 7");
    svg.appendChild(polyline);
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", "M4 18v-2a4 4 0 0 1 4-4h12");
    svg.appendChild(path);
    container.appendChild(svg);
  }
  isUsingCustomProperty(file) {
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    const propertyValue = frontmatter == null ? void 0 : frontmatter[this.plugin.settings.propertyKey];
    if (propertyValue === void 0 || propertyValue === null) {
      return false;
    }
    const strValue = typeof propertyValue === "string" ? propertyValue : typeof propertyValue === "number" || typeof propertyValue === "boolean" ? String(propertyValue) : "";
    return strValue.trim() !== "";
  }
  isUsingAlias(file) {
    const cache = this.app.metadataCache.getFileCache(file);
    const frontmatter = cache == null ? void 0 : cache.frontmatter;
    const aliases = frontmatter == null ? void 0 : frontmatter.aliases;
    if (!aliases)
      return false;
    const isUsingCustomProperty = this.isUsingCustomProperty(file);
    return !isUsingCustomProperty && Boolean(aliases);
  }
  selectSuggestion(suggestion, evt) {
    var _a, _b;
    if (suggestion.isNoMatch) {
      return;
    }
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (!activeView || !this.context)
      return;
    const editor = activeView.editor;
    const { start, end } = this.context;
    const line = editor.getLine(start.line);
    let endPos = end;
    if (line.slice(end.ch, end.ch + 2) === "]]") {
      endPos = { line: end.line, ch: end.ch + 2 };
    }
    if (!suggestion.file) {
      return;
    }
    const vault = this.app.vault;
    const useMarkdownLinks = (_b = (_a = vault.getConfig) == null ? void 0 : _a.call(vault, "useMarkdownLinks")) != null ? _b : false;
    let linkText;
    if (suggestion.isCustomDisplay) {
      if (useMarkdownLinks) {
        linkText = `[${suggestion.display}](${encodeURI(suggestion.file.path)})`;
      } else {
        const linkPath = suggestion.file.path.replace(".md", "");
        linkText = `[[${linkPath}|${suggestion.display}]]`;
      }
    } else {
      if (useMarkdownLinks) {
        linkText = `[${suggestion.file.path.replace(".md", "")}](${encodeURI(suggestion.file.path)})`;
      } else {
        const linkPath = suggestion.file.path.replace(".md", "");
        linkText = `[[${linkPath}]]`;
      }
    }
    editor.replaceRange(linkText, { line: start.line, ch: start.ch }, endPos);
    const newCursorPos = start.ch + linkText.length;
    try {
      editor.setCursor({ line: start.line, ch: newCursorPos });
    } catch (error) {
      console.error("Error setting cursor:", error);
      new import_obsidian.Notice("Error setting cursor position. Please check console for details.");
    }
  }
  getQuickSwitcherOptions() {
    var _a;
    try {
      const internalPlugins = this.app.internalPlugins;
      if (!internalPlugins)
        return null;
      const switcherPlugin = (_a = internalPlugins.getPluginById) == null ? void 0 : _a.call(internalPlugins, "switcher");
      if (!switcherPlugin || !switcherPlugin.instance) {
        return null;
      }
      return switcherPlugin.instance.options || null;
    } catch (error) {
      console.warn("Property Over Filename: Could not access Quick Switcher options:", error);
      return null;
    }
  }
};

// src/ui/SettingTab.ts
var import_obsidian3 = require("obsidian");

// src/utils/settings-compat.ts
var import_obsidian2 = require("obsidian");
var ObsidianModule = __toESM(require("obsidian"));
function createSettingsGroup(containerEl, heading) {
  if ((0, import_obsidian2.requireApiVersion)("1.11.0")) {
    const SettingGroupClass = ObsidianModule.SettingGroup;
    if (SettingGroupClass) {
      const group = heading ? new SettingGroupClass(containerEl).setHeading(heading) : new SettingGroupClass(containerEl);
      return {
        addSetting(cb) {
          group.addSetting(cb);
        }
      };
    }
  }
  {
    if (heading) {
      const headingEl = containerEl.createDiv("setting-group-heading");
      headingEl.createEl("h3", { text: heading });
    }
    return {
      addSetting(cb) {
        const setting = new import_obsidian2.Setting(containerEl);
        cb(setting);
      }
    };
  }
}

// src/ui/SettingTab.ts
var SettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass("property-over-filename-settings");
    const generalGroup = createSettingsGroup(containerEl);
    generalGroup.addSetting((setting) => {
      setting.setName("Property key").setDesc("The property to use as the display title. Falls back to the file name when no property is set for that item.").addText(
        (text) => text.setPlaceholder("Title").setValue(this.plugin.settings.propertyKey).onChange(async (value) => {
          this.plugin.settings.propertyKey = value.trim() || "title";
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateLinkSuggester();
          this.plugin.updateGraphView();
          this.plugin.updateBacklinks();
          this.plugin.updateTabs();
          this.plugin.updateExplorer();
          this.plugin.updateWindowFrame();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("When linking notes").setDesc("Enable property-based titles in the link suggester.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForLinking).onChange(async (value) => {
          this.plugin.settings.enableForLinking = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateLinkSuggester();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In quick switcher").setDesc("Enable property-based titles in the quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForQuickSwitcher).onChange(async (value) => {
          const prevQuickSwitcherState = this.plugin.settings.enableForQuickSwitcher;
          this.plugin.settings.enableForQuickSwitcher = value;
          await this.plugin.saveSettings(prevQuickSwitcherState);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Include file name in fuzzy searches").setDesc("Include note file names in fuzzy search results for link suggester and quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.includeFilenameInSearch).onChange(async (value) => {
          this.plugin.settings.includeFilenameInSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("Include aliases in fuzzy searches").setDesc("Include property aliases in fuzzy search results for link suggester and quick switcher.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.includeAliasesInSearch).onChange(async (value) => {
          this.plugin.settings.includeAliasesInSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("When dragging notes").setDesc("Use property-based titles when dragging notes from the file explorer.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForDragDrop).onChange(async (value) => {
          this.plugin.settings.enableForDragDrop = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In graph view").setDesc("Use the property instead of the file name as the note's title in graph view.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForGraphView).onChange(async (value) => {
          this.plugin.settings.enableForGraphView = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateGraphView();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In backlinks and outgoing links").setDesc("Use the property instead of the file name in the linked mentions footer, dedicated backlinks panel, and outgoing links.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForBacklinks).onChange(async (value) => {
          this.plugin.settings.enableForBacklinks = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateBacklinks();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In tab titles").setDesc("Use the property instead of the file name in tab titles.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForTabs).onChange(async (value) => {
          const prevTabState = this.plugin.settings.enableForTabs;
          this.plugin.settings.enableForTabs = value;
          await this.plugin.saveSettings(void 0, prevTabState);
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In window frame title").setDesc("Use the property instead of the file name in the browser window title bar.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForWindowFrame).onChange(async (value) => {
          this.plugin.settings.enableForWindowFrame = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateWindowFrame();
        })
      );
    });
    generalGroup.addSetting((setting) => {
      setting.setName("In file explorer").setDesc("Use the property instead of the file name in the file explorer.").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.enableForExplorer).onChange(async (value) => {
          this.plugin.settings.enableForExplorer = value;
          await this.plugin.saveData(this.plugin.settings);
          this.plugin.updateExplorer();
          this.display();
        })
      );
    });
    if (this.plugin.settings.enableForExplorer) {
      generalGroup.addSetting((setting) => {
        setting.setName("Folder note file name").setDesc("If a folder contains a file with this name that has the configured property, the folder will display that property value instead. This ensures compatibility with folder notes plugins. Leave blank to disable.").addText(
          (text) => text.setPlaceholder("Index").setValue(this.plugin.settings.folderNoteFilename).onChange(async (value) => {
            this.plugin.settings.folderNoteFilename = value.trim();
            await this.plugin.saveData(this.plugin.settings);
            this.plugin.updateExplorer();
          })
        );
      });
    }
    generalGroup.addSetting((setting) => {
      setting.setName("Use simple search").setDesc("Instead of using fuzzy search, simple search provides better performance with very large vaults (thousands of files).").addToggle(
        (toggle) => toggle.setValue(this.plugin.settings.useSimpleSearch).onChange(async (value) => {
          this.plugin.settings.useSimpleSearch = value;
          await this.plugin.saveData(this.plugin.settings);
        })
      );
    });
  }
};

// src/commands/index.ts
var import_obsidian5 = require("obsidian");
function registerCommands(plugin) {
  plugin.addCommand({
    id: "open-quick-switcher",
    name: "Open quick switcher (property-based)",
    callback: async () => {
      const { QuickSwitchModal: QuickSwitchModal2 } = await Promise.resolve().then(() => (init_QuickSwitchModal(), QuickSwitchModal_exports));
      new QuickSwitchModal2(plugin.app, plugin).open();
    }
  });
  plugin.addCommand({
    id: "toggle-linking",
    name: "Toggle property-based linking",
    callback: async () => {
      plugin.settings.enableForLinking = !plugin.settings.enableForLinking;
      await plugin.saveData(plugin.settings);
      plugin.updateLinkSuggester();
      new import_obsidian5.Notice(`Property-based linking ${plugin.settings.enableForLinking ? "enabled" : "disabled"}`);
    }
  });
  plugin.addCommand({
    id: "toggle-quick-switcher",
    name: "Toggle property-based quick switcher",
    callback: async () => {
      const prevState = plugin.settings.enableForQuickSwitcher;
      plugin.settings.enableForQuickSwitcher = !plugin.settings.enableForQuickSwitcher;
      await plugin.saveSettings(prevState);
      new import_obsidian5.Notice(`Property-based Quick Switcher ${plugin.settings.enableForQuickSwitcher ? "enabled" : "disabled"}`);
    }
  });
  plugin.addCommand({
    id: "rebuild-cache",
    name: "Rebuild file cache",
    callback: () => {
      plugin.rebuildCache();
      new import_obsidian5.Notice("File cache rebuilt");
    }
  });
  plugin.addCommand({
    id: "toggle-drag-drop",
    name: "Toggle property-based drag and drop",
    callback: async () => {
      plugin.settings.enableForDragDrop = !plugin.settings.enableForDragDrop;
      await plugin.saveData(plugin.settings);
      new import_obsidian5.Notice(`Property-based drag and drop ${plugin.settings.enableForDragDrop ? "enabled" : "disabled"}`);
    }
  });
}

// src/services/QuickSwitcherService.ts
var QuickSwitcherService = class {
  constructor(plugin) {
    this.isCommandOverridden = false;
    this.plugin = plugin;
  }
  updateQuickSwitcher() {
    if (this.plugin.settings.enableForQuickSwitcher && !this.isCommandOverridden) {
      this.overrideQuickSwitcherCommand();
    } else if (!this.plugin.settings.enableForQuickSwitcher && this.isCommandOverridden) {
      this.restoreOriginalCommand();
    }
  }
  overrideQuickSwitcherCommand() {
    var _a;
    const commands = this.plugin.app.commands.commands;
    if (commands["switcher:open"] && !this.originalSwitcherCommand) {
      const originalCmd = commands["switcher:open"];
      this.originalSwitcherCommand = {
        id: originalCmd.id || "switcher:open",
        name: originalCmd.name || "Quick Switcher",
        icon: originalCmd.icon,
        hotkeys: originalCmd.hotkeys ? [...originalCmd.hotkeys] : [],
        callback: originalCmd.callback
      };
    }
    if (commands["switcher:open"]) {
      delete commands["switcher:open"];
    }
    const customCommand = {
      id: "switcher:open",
      name: "Quick Switcher",
      icon: (_a = this.originalSwitcherCommand) == null ? void 0 : _a.icon,
      hotkeys: [{ modifiers: ["Mod"], key: "o" }],
      callback: () => {
        const workspace = this.plugin.app.workspace;
        if (workspace.switcher && typeof workspace.switcher.close === "function") {
          workspace.switcher.close();
        }
        const existingModals = document.querySelectorAll(".modal");
        existingModals.forEach((modal) => {
          if (modal instanceof HTMLElement && !modal.classList.contains("hidden")) {
            modal.addClass("hidden");
          }
        });
        try {
          Promise.resolve().then(() => (init_QuickSwitchModal(), QuickSwitchModal_exports)).then(({ QuickSwitchModal: QuickSwitchModal2 }) => {
            const modal = new QuickSwitchModal2(this.plugin.app, this.plugin);
            modal.open();
          }).catch((error) => {
            console.error("Error loading QuickSwitchModal:", error);
            if (this.originalSwitcherCommand && this.originalSwitcherCommand.callback) {
              this.originalSwitcherCommand.callback();
            }
          });
        } catch (error) {
          console.error("Error creating QuickSwitchModal:", error);
          if (this.originalSwitcherCommand && this.originalSwitcherCommand.callback) {
            this.originalSwitcherCommand.callback();
          }
        }
      }
    };
    commands["switcher:open"] = customCommand;
    this.isCommandOverridden = true;
  }
  restoreOriginalCommand() {
    if (!this.originalSwitcherCommand) {
      return;
    }
    const commands = this.plugin.app.commands.commands;
    if (commands["switcher:open"]) {
      delete commands["switcher:open"];
    }
    commands["switcher:open"] = {
      id: this.originalSwitcherCommand.id,
      name: this.originalSwitcherCommand.name,
      icon: this.originalSwitcherCommand.icon,
      hotkeys: this.originalSwitcherCommand.hotkeys,
      callback: this.originalSwitcherCommand.callback
    };
    this.isCommandOverridden = false;
  }
};

// src/services/DragDropService.ts
var import_obsidian6 = require("obsidian");
var DragDropService = class {
  // Prevent duplicate processing within 100ms
  constructor(plugin) {
    this.lastDropTime = 0;
    this.lastDropData = null;
    this.DROP_DEBOUNCE_MS = 100;
    this.plugin = plugin;
  }
  handleDragDrop(event, editor) {
    const dataTransfer = event.dataTransfer;
    if (!dataTransfer) {
      console.warn("[PropertyOverFileName] handleDragDrop: dataTransfer is undefined");
      return;
    }
    const filePath = dataTransfer.getData("text/plain");
    if (!filePath || !filePath.endsWith(".md")) {
      return;
    }
    const now = Date.now();
    if (now - this.lastDropTime < this.DROP_DEBOUNCE_MS && this.lastDropData === filePath) {
      console.debug("[PropertyOverFileName] handleDragDrop: Ignoring duplicate drop event");
      return;
    }
    this.lastDropTime = now;
    this.lastDropData = filePath;
    const file = this.plugin.app.vault.getAbstractFileByPath(filePath);
    if (!file || !(file instanceof import_obsidian6.TFile)) {
      console.warn("[PropertyOverFileName] handleDragDrop: File not found:", filePath);
      return;
    }
    const displayName = this.getDisplayName(file);
    if (displayName !== null) {
      setTimeout(() => {
        this.replaceLastInsertedLink(file, displayName, editor);
      }, 50);
    }
  }
  handleDOMDrop(event) {
    const target = event.target;
    const editorElement = target == null ? void 0 : target.closest(".cm-editor");
    const activeView = this.plugin.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
    const hasActiveEditor = activeView && activeView.editor;
    if (!editorElement && !hasActiveEditor) {
      return;
    }
    const dataTransfer = event.dataTransfer;
    if (!dataTransfer) {
      console.warn("[PropertyOverFileName] handleDOMDrop: dataTransfer is undefined");
      return;
    }
    const filePath = dataTransfer.getData("text/plain");
    if (!filePath) {
      return;
    }
    let actualFilePath = filePath;
    if (filePath.startsWith("obsidian://open?")) {
      try {
        const url = new URL(filePath);
        const fileParam = url.searchParams.get("file");
        if (fileParam) {
          actualFilePath = decodeURIComponent(fileParam) + ".md";
        } else {
          return;
        }
      } catch (e) {
        console.warn("[PropertyOverFileName] handleDOMDrop: Failed to parse obsidian:// URL:", e);
        return;
      }
    } else if (!filePath.endsWith(".md")) {
      return;
    }
    const now = Date.now();
    if (now - this.lastDropTime < this.DROP_DEBOUNCE_MS && this.lastDropData === actualFilePath) {
      console.debug("[PropertyOverFileName] handleDOMDrop: Ignoring duplicate drop event");
      return;
    }
    this.lastDropTime = now;
    this.lastDropData = actualFilePath;
    const file = this.plugin.app.vault.getAbstractFileByPath(actualFilePath);
    if (!file || !(file instanceof import_obsidian6.TFile)) {
      console.warn("[PropertyOverFileName] handleDOMDrop: File not found:", actualFilePath);
      return;
    }
    const displayName = this.getDisplayName(file);
    if (displayName !== null) {
      setTimeout(() => {
        const activeView2 = this.plugin.app.workspace.getActiveViewOfType(import_obsidian6.MarkdownView);
        if (activeView2 && activeView2.editor) {
          this.replaceLastInsertedLink(file, displayName, activeView2.editor);
        }
      }, 50);
    }
  }
  getDisplayName(file) {
    const fileCache = this.plugin.app.metadataCache.getFileCache(file);
    const frontmatter = fileCache == null ? void 0 : fileCache.frontmatter;
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  replaceLastInsertedLink(file, displayName, editor) {
    const content = editor.getValue();
    const cursor = editor.getCursor();
    const lines = content.split("\n");
    const currentLine = lines[cursor.line];
    const wikiLinkRegex = /\[\[([^\]]+)\]\]/g;
    const markdownLinkRegex = /\[([^\]]+)\]\(([^)]+)\)/g;
    let match;
    let lastMatch = null;
    while ((match = wikiLinkRegex.exec(currentLine)) !== null) {
      lastMatch = match;
    }
    if (lastMatch) {
      const linkPath = lastMatch[1];
      const newLinkText = `[[${linkPath}|${displayName}]]`;
      const startPos = { line: cursor.line, ch: lastMatch.index };
      const endPos = { line: cursor.line, ch: lastMatch.index + lastMatch[0].length };
      editor.replaceRange(newLinkText, startPos, endPos);
      return;
    }
    markdownLinkRegex.lastIndex = 0;
    while ((match = markdownLinkRegex.exec(currentLine)) !== null) {
      lastMatch = match;
    }
    if (lastMatch) {
      const linkUrl = lastMatch[2];
      const newLinkText = `[${displayName}](${linkUrl})`;
      const startPos = { line: cursor.line, ch: lastMatch.index };
      const endPos = { line: cursor.line, ch: lastMatch.index + lastMatch[0].length };
      editor.replaceRange(newLinkText, startPos, endPos);
    }
  }
};

// src/services/CacheService.ts
var CacheService = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  setSuggest(suggest) {
    this.suggest = suggest;
  }
  invalidateCache(file) {
    if (this.suggest) {
      this.suggest.updateFileCache(file);
    }
  }
  rebuildCache() {
    if (this.suggest) {
      this.suggest.buildFileCache();
    }
  }
};

// src/services/GraphViewService.ts
var import_obsidian7 = require("obsidian");
var GraphViewService = class {
  constructor(plugin) {
    this.modifiedPrototypes = [];
    this.plugin = plugin;
  }
  createGetDisplayText(app) {
    return function getDisplayText() {
      const plugin = this.pov_plugin;
      if (!plugin || !plugin.settings.enableForGraphView) {
        if (this.pov_originalGetDisplayText) {
          return this.pov_originalGetDisplayText();
        }
        throw new Error("pov_originalGetDisplayText does not exist on node");
      }
      const file = app.vault.getFileByPath(this.id);
      if (file) {
        const fileCache = app.metadataCache.getFileCache(file);
        const frontmatter = fileCache == null ? void 0 : fileCache.frontmatter;
        if (frontmatter && frontmatter[plugin.settings.propertyKey] !== void 0 && frontmatter[plugin.settings.propertyKey] !== null) {
          const propertyValue = String(frontmatter[plugin.settings.propertyKey]).trim();
          if (propertyValue !== "") {
            return propertyValue;
          }
        }
      }
      if (this.pov_originalGetDisplayText) {
        return this.pov_originalGetDisplayText();
      }
      throw new Error("pov_originalGetDisplayText does not exist on node");
    };
  }
  getGraphLeaves() {
    const leaves = [];
    leaves.push(...this.plugin.app.workspace.getLeavesOfType("graph"));
    leaves.push(...this.plugin.app.workspace.getLeavesOfType("localgraph"));
    return [...new Set(leaves)];
  }
  overridePrototypes() {
    if (!this.plugin.settings.enableForGraphView) {
      return;
    }
    const leaves = this.getGraphLeaves();
    for (const leaf of leaves) {
      if (!(leaf.view instanceof import_obsidian7.View) || leaf.isDeferred)
        continue;
      const view = leaf.view;
      this.overridePrototype(view);
    }
  }
  overridePrototype(view) {
    let firstNode;
    const nodesWithFirst = view.renderer.nodes;
    if (typeof nodesWithFirst.first === "function") {
      firstNode = nodesWithFirst.first();
    } else if (view.renderer.nodes instanceof Set) {
      firstNode = view.renderer.nodes.values().next().value;
    } else {
      for (const node of view.renderer.nodes) {
        firstNode = node;
        break;
      }
    }
    if (firstNode) {
      const proto = firstNode.constructor.prototype;
      if (!proto.hasOwnProperty("pov_originalGetDisplayText") && !this.modifiedPrototypes.includes(proto)) {
        proto.pov_originalGetDisplayText = proto.getDisplayText;
        const getDisplayTextFn = this.createGetDisplayText(this.plugin.app);
        proto.getDisplayText = getDisplayTextFn;
        proto.pov_plugin = this.plugin;
        for (const node of view.renderer.nodes) {
          if (node.text) {
            node.text.text = node.getDisplayText();
          }
        }
        view.renderer.changed();
        this.modifiedPrototypes.push(proto);
      }
    }
  }
  restorePrototypes() {
    for (const proto of this.modifiedPrototypes) {
      if (typeof proto.pov_originalGetDisplayText === "function") {
        proto.getDisplayText = proto.pov_originalGetDisplayText;
        delete proto.pov_originalGetDisplayText;
      }
      delete proto.pov_plugin;
    }
    this.modifiedPrototypes = [];
    this.rewriteNames();
  }
  rewriteNames() {
    const leaves = this.getGraphLeaves();
    for (const leaf of leaves) {
      if (!(leaf.view instanceof import_obsidian7.View) || leaf.isDeferred)
        continue;
      const view = leaf.view;
      for (const node of view.renderer.nodes) {
        if (node.text) {
          node.text.text = node.getDisplayText();
        }
      }
      view.renderer.changed();
    }
  }
  onLayoutChange() {
    var _a, _b;
    if (!this.plugin.settings.enableForGraphView) {
      this.restorePrototypes();
      return;
    }
    const appInternal = this.plugin.app;
    const graphPlugin = (_b = (_a = appInternal.internalPlugins) == null ? void 0 : _a.getPluginById) == null ? void 0 : _b.call(_a, "graph");
    if (!(graphPlugin == null ? void 0 : graphPlugin._loaded))
      return;
    this.overridePrototypes();
  }
  updateGraphView() {
    if (this.plugin.settings.enableForGraphView) {
      this.overridePrototypes();
    } else {
      this.restorePrototypes();
    }
  }
  refreshGraphView() {
    if (this.plugin.settings.enableForGraphView) {
      this.rewriteNames();
    }
  }
  onunload() {
    this.restorePrototypes();
  }
};

// src/services/BacklinkService.ts
var import_obsidian8 = require("obsidian");
var BacklinkService = class {
  constructor(plugin) {
    this.processedElements = /* @__PURE__ */ new WeakSet();
    this.modifiedElements = /* @__PURE__ */ new WeakSet();
    this.originalTextContentDescriptors = /* @__PURE__ */ new Map();
    this.plugin = plugin;
  }
  /**
   * Get display name from file's frontmatter property
   */
  getDisplayName(file) {
    if (!this.plugin.settings.enableForBacklinks) {
      return null;
    }
    const fileCache = this.plugin.app.metadataCache.getFileCache(file);
    const frontmatter = fileCache == null ? void 0 : fileCache.frontmatter;
    if (frontmatter && frontmatter[this.plugin.settings.propertyKey] !== void 0 && frontmatter[this.plugin.settings.propertyKey] !== null) {
      const propertyValue = String(frontmatter[this.plugin.settings.propertyKey]).trim();
      if (propertyValue !== "") {
        return propertyValue;
      }
    }
    return null;
  }
  /**
   * Update all backlink displays
   */
  updateBacklinks() {
    if (!this.plugin.settings.enableForBacklinks) {
      this.stopObserving();
      return;
    }
    this.updateEmbeddedBacklinks();
    void this.updateDedicatedBacklinksPanel();
    this.startObserving();
  }
  /**
   * Update embedded backlinks in markdown views
   */
  updateEmbeddedBacklinks() {
    for (const leaf of this.plugin.app.workspace.getLeavesOfType("markdown")) {
      if (!(leaf.view instanceof import_obsidian8.MarkdownView)) {
        continue;
      }
      const embeddedBacklinks = leaf.view.containerEl.querySelector(".embedded-backlinks");
      if (embeddedBacklinks) {
        this.updateBacklinkContainer(embeddedBacklinks);
      }
    }
  }
  /**
   * Update dedicated backlinks panel
   */
  async updateDedicatedBacklinksPanel() {
    const backlinksLeaves = this.plugin.app.workspace.getLeavesOfType("backlink");
    for (const leaf of backlinksLeaves) {
      await leaf.loadIfDeferred();
      if (leaf.view) {
        const container = leaf.view.containerEl;
        if (container) {
          const backlinksContainer = container.querySelector(".backlinks-pane") || container.querySelector(".backlink-pane");
          if (backlinksContainer) {
            this.updateBacklinkContainer(backlinksContainer);
          }
          const outgoingLinksContainer = container.querySelector(".outgoing-link-pane") || container.querySelector(".outgoing-links");
          if (outgoingLinksContainer) {
            this.updateBacklinkContainer(outgoingLinksContainer);
          }
        }
      }
    }
  }
  /**
   * Extract file path from an element or its parent link
   */
  extractFilePathFromElement(element) {
    var _a;
    const dataPath = element.getAttribute("data-path");
    if (dataPath) {
      const file = this.plugin.app.vault.getAbstractFileByPath(dataPath);
      if (file instanceof import_obsidian8.TFile) {
        return file;
      }
    }
    const link = element.closest("a") || element.querySelector("a");
    if (link) {
      const href = link instanceof HTMLAnchorElement ? link.href : link.getAttribute("href");
      if (href) {
        if (href.startsWith("obsidian://")) {
          try {
            const url = new URL(href);
            const fileParam = url.searchParams.get("file");
            if (fileParam) {
              const decodedPath = decodeURIComponent(fileParam);
              const file = this.plugin.app.vault.getAbstractFileByPath(decodedPath + ".md");
              if (file instanceof import_obsidian8.TFile) {
                return file;
              }
            }
          } catch (e) {
          }
        }
        const internalLinkMatch = href.match(/#file\/(.+)/);
        if (internalLinkMatch) {
          const filePath = decodeURIComponent(internalLinkMatch[1]);
          const file = this.plugin.app.vault.getAbstractFileByPath(filePath);
          if (file instanceof import_obsidian8.TFile) {
            return file;
          }
        }
        const dataHref = link.getAttribute("data-href");
        if (dataHref) {
          const file = this.plugin.app.vault.getAbstractFileByPath(dataHref);
          if (file instanceof import_obsidian8.TFile) {
            return file;
          }
        }
      }
    }
    const textContent = (_a = element.textContent) == null ? void 0 : _a.trim();
    if (textContent) {
      const allFiles = this.plugin.app.vault.getMarkdownFiles();
      const matchingFile = allFiles.find((f) => f.basename === textContent);
      if (matchingFile) {
        return matchingFile;
      }
    }
    return null;
  }
  /**
   * Update a backlink container by replacing file names with property titles
   */
  updateBacklinkContainer(container) {
    const selectors = [
      ".tree-item-inner",
      ".backlink-title",
      ".backlink-file-link",
      ".outgoing-link-file-link",
      ".tree-item-self",
      ".nav-file-title",
      "[data-path]",
      "a.internal-link"
    ];
    const fileElements = /* @__PURE__ */ new Set();
    selectors.forEach((selector) => {
      try {
        container.querySelectorAll(selector).forEach((el) => {
          fileElements.add(el);
        });
      } catch (e) {
      }
    });
    fileElements.forEach((element) => {
      if (this.processedElements.has(element)) {
        return;
      }
      const file = this.extractFilePathFromElement(element);
      if (file && file instanceof import_obsidian8.TFile) {
        this.updateElementWithFile(element, file);
      }
    });
  }
  /**
   * Update an element with file's display name
   */
  updateElementWithFile(element, file) {
    var _a;
    const displayName = this.getDisplayName(file);
    if (displayName === null) {
      return;
    }
    this.processedElements.add(element);
    element.setAttribute("data-pov-processed", "true");
    const currentText = ((_a = element.textContent) == null ? void 0 : _a.trim()) || "";
    const basename = file.basename;
    if (currentText === basename || currentText === file.name || currentText.endsWith(basename)) {
      const link = element.closest("a") || element.querySelector("a");
      const targetElement = link || element;
      const updateTextInElement = (el) => {
        var _a2, _b;
        if (el.childNodes.length === 1 && el.childNodes[0].nodeType === Node.TEXT_NODE) {
          el.textContent = displayName;
          return true;
        }
        const textNodes = Array.from(el.childNodes).filter((node) => node.nodeType === Node.TEXT_NODE);
        if (textNodes.length > 0) {
          textNodes[0].textContent = displayName;
          for (let i = 1; i < textNodes.length; i++) {
            textNodes[i].remove();
          }
          return true;
        }
        if (((_a2 = el.textContent) == null ? void 0 : _a2.trim()) === basename || ((_b = el.textContent) == null ? void 0 : _b.trim()) === file.name) {
          el.textContent = displayName;
          return true;
        }
        return false;
      };
      if (!updateTextInElement(targetElement)) {
        updateTextInElement(element);
      }
    }
  }
  /**
   * Start observing DOM changes for backlinks
   */
  startObserving() {
    if (this.observer) {
      return;
    }
    this.overrideBacklinkElements();
    let updateTimeout = null;
    this.observer = new MutationObserver((mutations) => {
      let shouldUpdate = false;
      const newElements = [];
      for (const mutation of mutations) {
        if (mutation.type === "childList") {
          for (const node of Array.from(mutation.addedNodes)) {
            if (node instanceof HTMLElement) {
              const embeddedBacklinks = node.closest(".embedded-backlinks");
              const backlinksPanel = node.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
              if (embeddedBacklinks || backlinksPanel) {
                shouldUpdate = true;
                const selectors = [".tree-item-inner", ".backlink-title", ".backlink-file-link", ".outgoing-link-file-link", ".tree-item-self", ".nav-file-title", "[data-path]", "a.internal-link"];
                selectors.forEach((selector) => {
                  var _a;
                  try {
                    const elements = (_a = node.querySelectorAll) == null ? void 0 : _a.call(node, selector);
                    elements == null ? void 0 : elements.forEach((el) => {
                      if (el instanceof HTMLElement) {
                        newElements.push(el);
                      }
                    });
                  } catch (e) {
                  }
                });
              }
            }
          }
        } else if (mutation.type === "characterData") {
          const target = mutation.target;
          if (target instanceof HTMLElement) {
            const embeddedBacklinks = target.closest(".embedded-backlinks");
            const backlinksPanel = target.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
            if (embeddedBacklinks || backlinksPanel) {
              shouldUpdate = true;
            }
          } else if (target.parentElement) {
            const embeddedBacklinks = target.parentElement.closest(".embedded-backlinks");
            const backlinksPanel = target.parentElement.closest(".backlinks-pane, .backlink-pane, .outgoing-link-pane, .outgoing-links, .backlink-container");
            if (embeddedBacklinks || backlinksPanel) {
              shouldUpdate = true;
            }
          }
        }
      }
      newElements.forEach((el) => {
        var _a;
        this.overrideElementTextContent(el);
        const file = this.extractFilePathFromElement(el);
        if (file && file instanceof import_obsidian8.TFile) {
          const displayName = this.getDisplayName(file);
          if (displayName) {
            const currentText = ((_a = el.textContent) == null ? void 0 : _a.trim()) || "";
            if (currentText === file.basename || currentText === file.name) {
              el.textContent = displayName;
              el.setAttribute("data-pov-processed", "true");
              this.processedElements.add(el);
            }
          }
        }
      });
      if (shouldUpdate) {
        this.processedElements = /* @__PURE__ */ new WeakSet();
        if (updateTimeout) {
          clearTimeout(updateTimeout);
        }
        updateTimeout = setTimeout(() => {
          this.updateBacklinks();
          this.overrideBacklinkElements();
          updateTimeout = null;
        }, 10);
      }
    });
    this.observer.observe(document.body, {
      childList: true,
      subtree: true,
      characterData: true
    });
  }
  /**
   * Override textContent on all backlink elements
   */
  overrideBacklinkElements() {
    const selectors = [
      ".tree-item-inner",
      ".backlink-title",
      ".backlink-file-link",
      ".outgoing-link-file-link",
      ".tree-item-self",
      ".nav-file-title",
      "[data-path]",
      "a.internal-link"
    ];
    const containers = [
      ...Array.from(document.querySelectorAll(".embedded-backlinks")),
      ...Array.from(document.querySelectorAll(".backlinks-pane")),
      ...Array.from(document.querySelectorAll(".backlink-pane")),
      ...Array.from(document.querySelectorAll(".outgoing-link-pane")),
      ...Array.from(document.querySelectorAll(".outgoing-links")),
      ...Array.from(document.querySelectorAll(".backlink-container"))
    ];
    containers.forEach((container) => {
      selectors.forEach((selector) => {
        try {
          container.querySelectorAll(selector).forEach((el) => {
            if (el instanceof HTMLElement) {
              this.overrideElementTextContent(el);
            }
          });
        } catch (e) {
        }
      });
    });
  }
  /**
   * Override textContent setter on an element to intercept Obsidian's updates
   */
  overrideElementTextContent(element) {
    if (this.modifiedElements.has(element)) {
      return;
    }
    const proto = Object.getPrototypeOf(element);
    const originalDescriptor = Object.getOwnPropertyDescriptor(proto, "textContent");
    if (originalDescriptor && originalDescriptor.set) {
      this.originalTextContentDescriptors.set(element, originalDescriptor);
      try {
        Object.defineProperty(element, "textContent", {
          set: (value) => {
            const file = this.extractFilePathFromElement(element);
            if (file && file instanceof import_obsidian8.TFile) {
              const displayName = this.getDisplayName(file);
              if (displayName && (value === file.basename || value === file.name || value.endsWith(file.basename))) {
                originalDescriptor.set.call(element, displayName);
                element.setAttribute("data-pov-processed", "true");
                this.processedElements.add(element);
                return;
              }
            }
            originalDescriptor.set.call(element, value);
            element.setAttribute("data-pov-processed", "true");
          },
          // eslint-disable-next-line @typescript-eslint/unbound-method
          get: originalDescriptor.get || (() => {
            var _a, _b;
            return ((_b = (_a = Object.getOwnPropertyDescriptor(HTMLElement.prototype, "textContent")) == null ? void 0 : _a.get) == null ? void 0 : _b.call(element)) || "";
          }),
          configurable: true,
          enumerable: true
        });
      } catch (e) {
        element.setAttribute("data-pov-processed", "true");
      }
    } else {
      element.setAttribute("data-pov-processed", "true");
    }
    this.modifiedElements.add(element);
  }
  /**
   * Stop observing DOM changes
   */
  stopObserving() {
    if (this.observer) {
      this.observer.disconnect();
      this.observer = void 0;
    }
  }
  /**
   * Handle layout changes
   */
  onLayoutChange() {
    if (this.plugin.settings.enableForBacklinks) {
      setTimeout(() => {
        this.updateBacklinks();
      }, 100);
    } else {
      this.stopObserving();
    }
  }
  /**
   * Handle file open events
   */
  onFileOpen() {
    if (this.plugin.settings.enableForBacklinks) {
      setTimeout(() => {
        this.updateEmbeddedBacklinks();
      }, 200);
    }
  }
  /**
   * Clean up on unload
   */
  onunload() {
    this.stopObserving();
    this.originalTextContentDescriptors.forEach((descriptor, element) => {
      try {
        Object.defineProperty(element, "textContent", descriptor);
      } catch (e) {
      }
    });
    this.originalTextContentDescriptors.clear();
    this.modifiedElements = /* @__PURE__ */ new WeakSet();
  }
};

// src/services/TabService.ts
var TabService = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  /**
   * Renames all markdown tabs to use the configured property value
   * Falls back to file basename if property is not found
   * EXACT copy of the working implementation from obsidian-title-only-tab
   */
  async renameTabs() {
    const leaves = this.plugin.app.workspace.getLeavesOfType("markdown");
    leaves.forEach((leaf) => {
      var _a, _b;
      const view = leaf.view;
      const state = leaf.getViewState();
      if (((_a = state.state) == null ? void 0 : _a.file) && !(view == null ? void 0 : view.file)) {
        void leaf.setViewState({ type: state.type, state: state.state });
      }
      if (view == null ? void 0 : view.file) {
        const file = view.file;
        const cache = this.plugin.app.metadataCache.getFileCache(file);
        const propertyValue = (_b = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _b[this.plugin.settings.propertyKey];
        const tabHeaderEl = leaf.tabHeaderEl;
        if (tabHeaderEl) {
          tabHeaderEl.setAttribute("data-pov-title-set", "true");
          if (this.plugin.settings.enableForTabs) {
            const titleEl = tabHeaderEl.querySelector(".workspace-tab-header-inner-title");
            const displayText = propertyValue ? String(propertyValue) : file.basename;
            if (titleEl) {
              titleEl.setText(displayText);
            }
            tabHeaderEl.setAttribute("aria-label", displayText);
            tabHeaderEl.setAttribute("title", displayText);
          }
        }
      }
    });
  }
  /**
   * Register event listeners for tab renaming
   * EXACT copy of the working implementation from obsidian-title-only-tab
   */
  async registerEvents() {
    await this.renameTabs();
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("active-leaf-change", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("file-open", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("rename", () => this.renameTabs())
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => this.renameTabs())
    );
  }
  /**
   * Update tabs (public method for manual updates)
   */
  updateTabs() {
    void this.renameTabs();
  }
  /**
   * Cleanup on unload
   */
  onunload() {
  }
};

// src/services/ExplorerService.ts
var import_obsidian9 = require("obsidian");
var ExplorerService = class {
  constructor(plugin) {
    // Public so ExplorerFileItemMutator can access it
    this.explorerView = null;
    this.modified = /* @__PURE__ */ new WeakMap();
    this.plugin = plugin;
  }
  /**
   * Get the file explorer view
   */
  getExplorerView() {
    if (this.explorerView === null) {
      const leaves = this.plugin.app.workspace.getLeavesOfType("file-explorer");
      if (leaves.length === 0) {
        return null;
      }
      const leaf = leaves[0];
      if (leaf && leaf.view) {
        this.explorerView = leaf.view;
      }
    }
    return this.explorerView;
  }
  /**
   * Get folder note title for a folder
   * Returns the frontmatter title property from the folder note file if it exists
   */
  getFolderNoteTitle(folder) {
    var _a;
    if (!this.plugin.settings.folderNoteFilename || this.plugin.settings.folderNoteFilename.trim() === "") {
      return null;
    }
    const folderNoteFilename = this.plugin.settings.folderNoteFilename.trim();
    const folderNotePath = `${folder.path}/${folderNoteFilename}.md`;
    const folderNoteFile = this.plugin.app.vault.getAbstractFileByPath(folderNotePath);
    if (folderNoteFile instanceof import_obsidian9.TFile) {
      const cache = this.plugin.app.metadataCache.getFileCache(folderNoteFile);
      const propertyValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[this.plugin.settings.propertyKey];
      if (propertyValue) {
        return String(propertyValue);
      }
    }
    return null;
  }
  /**
   * Resolve title for a file or folder
   * Public so ExplorerFileItemMutator can access it
   */
  resolveTitle(item) {
    var _a;
    if (item.file instanceof import_obsidian9.TFile) {
      const cache = this.plugin.app.metadataCache.getFileCache(item.file);
      const propertyValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[this.plugin.settings.propertyKey];
      return propertyValue ? String(propertyValue) : null;
    } else if (item.file instanceof import_obsidian9.TFolder) {
      return this.getFolderNoteTitle(item.file);
    }
    return null;
  }
  /**
   * Update all file explorer items
   */
  updateAllItems() {
    const view = this.getExplorerView();
    if (!view || !view.fileItems) {
      return;
    }
    const items = Object.values(view.fileItems);
    for (const item of items) {
      if (!this.modified.has(item)) {
        this.modified.set(item, new ExplorerFileItemMutator(item, this));
      }
      item.updateTitle();
    }
  }
  /**
   * Restore all original titles
   */
  restoreAllItems() {
    const view = this.getExplorerView();
    if (!view || !view.fileItems) {
      return;
    }
    const items = Object.values(view.fileItems);
    for (const item of items) {
      if (this.modified.has(item)) {
        const mutator = this.modified.get(item);
        mutator == null ? void 0 : mutator.destroy();
        this.modified.delete(item);
        item.updateTitle();
      }
    }
  }
  /**
   * Register events and initialize
   */
  registerEvents() {
    if (!this.plugin.settings.enableForExplorer) {
      return;
    }
    this.plugin.app.workspace.onLayoutReady(() => {
      this.explorerView = null;
      this.updateAllItems();
    });
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("layout-change", () => {
        this.explorerView = null;
        if (this.plugin.settings.enableForExplorer) {
          this.updateAllItems();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => {
        if (this.plugin.settings.enableForExplorer) {
          this.updateAllItems();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.vault.on("rename", () => {
        if (this.plugin.settings.enableForExplorer) {
          this.explorerView = null;
          setTimeout(() => this.updateAllItems(), 100);
        }
      })
    );
  }
  /**
   * Update explorer when settings change
   */
  updateExplorer() {
    if (this.plugin.settings.enableForExplorer) {
      this.explorerView = null;
      this.registerEvents();
      setTimeout(() => this.updateAllItems(), 100);
    } else {
      this.restoreAllItems();
    }
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    this.restoreAllItems();
    this.explorerView = null;
  }
};
var ExplorerFileItemMutator = class {
  constructor(item, service) {
    this.item = item;
    this.service = service;
    const proto = Object.getPrototypeOf(item);
    this.originalUpdateTitle = proto.updateTitle.bind(item);
    this.originalStartRename = proto.startRename ? proto.startRename.bind(item) : void 0;
    item.updateTitle = this.updateTitle.bind(this);
    if (proto.startRename) {
      item.startRename = this.startRename.bind(this);
    }
  }
  updateTitle() {
    this.originalUpdateTitle();
    if (this.service.plugin.settings.enableForExplorer) {
      const title = this.service.resolveTitle(this.item);
      if (title && title.length > 0) {
        this.item.innerEl.setText(title);
      }
    }
  }
  startRename() {
    var _a;
    this.item.innerEl.setText(this.item.getTitle());
    return (_a = this.originalStartRename) == null ? void 0 : _a.call(this);
  }
  destroy() {
    const proto = Object.getPrototypeOf(this.item);
    this.item.updateTitle = this.originalUpdateTitle;
    if (proto.startRename && this.originalStartRename) {
      this.item.startRename = this.originalStartRename;
    }
  }
};

// src/services/WindowFrameService.ts
var import_obsidian10 = require("obsidian");
var WindowFrameService = class {
  constructor(plugin) {
    this.originalUpdateTitle = null;
    this.enabled = false;
    this.plugin = plugin;
  }
  /**
   * Get the title for the active file
   */
  getActiveFileTitle() {
    var _a;
    const activeFile = this.plugin.app.workspace.getActiveFile();
    if (activeFile instanceof import_obsidian10.TFile) {
      const cache = this.plugin.app.metadataCache.getFileCache(activeFile);
      const propertyValue = (_a = cache == null ? void 0 : cache.frontmatter) == null ? void 0 : _a[this.plugin.settings.propertyKey];
      if (propertyValue) {
        return String(propertyValue);
      }
      return activeFile.basename;
    }
    return "";
  }
  /**
   * Override updateTitle to use property-based title
   */
  updateTitle() {
    if (!this.enabled) {
      if (this.originalUpdateTitle) {
        this.originalUpdateTitle();
      }
      return;
    }
    const title = this.getActiveFileTitle();
    if (title) {
      const app = this.plugin.app;
      if (typeof app.getAppTitle === "function") {
        document.title = app.getAppTitle(title);
      } else {
        const vaultName = this.plugin.app.vault.getName();
        document.title = `${title} - ${vaultName}`;
      }
    } else {
      if (this.originalUpdateTitle) {
        this.originalUpdateTitle();
      }
    }
  }
  /**
   * Enable the window frame feature
   */
  enable() {
    if (this.enabled) {
      return;
    }
    const workspace = this.plugin.app.workspace;
    if (workspace.updateTitle) {
      this.originalUpdateTitle = workspace.updateTitle.bind(workspace);
      workspace.updateTitle = this.updateTitle.bind(this);
      this.updateTitle();
      this.enabled = true;
    }
  }
  /**
   * Disable the window frame feature
   */
  disable() {
    if (!this.enabled) {
      return;
    }
    const workspace = this.plugin.app.workspace;
    if (workspace.updateTitle && this.originalUpdateTitle) {
      workspace.updateTitle = this.originalUpdateTitle;
      workspace.updateTitle();
      this.originalUpdateTitle = null;
      this.enabled = false;
    }
  }
  /**
   * Register events for window frame updates
   */
  registerEvents() {
    if (!this.plugin.settings.enableForWindowFrame) {
      return;
    }
    this.plugin.registerEvent(
      this.plugin.app.workspace.on("file-open", () => {
        if (this.enabled) {
          this.updateTitle();
        }
      })
    );
    this.plugin.registerEvent(
      this.plugin.app.metadataCache.on("changed", () => {
        if (this.enabled) {
          this.updateTitle();
        }
      })
    );
  }
  /**
   * Update window frame when settings change
   */
  updateWindowFrame() {
    if (this.plugin.settings.enableForWindowFrame) {
      this.enable();
      this.registerEvents();
    } else {
      this.disable();
    }
  }
  /**
   * Cleanup on unload
   */
  onunload() {
    this.disable();
  }
};

// src/main.ts
var PropertyOverFileNamePlugin = class extends import_obsidian11.Plugin {
  async onload() {
    await this.loadSettings();
    this.quickSwitcherService = new QuickSwitcherService(this);
    this.dragDropService = new DragDropService(this);
    this.cacheService = new CacheService(this);
    this.graphViewService = new GraphViewService(this);
    this.backlinkService = new BacklinkService(this);
    this.tabService = new TabService(this);
    this.explorerService = new ExplorerService(this);
    this.windowFrameService = new WindowFrameService(this);
    await this.tabService.registerEvents();
    this.explorerService.registerEvents();
    this.windowFrameService.registerEvents();
    setTimeout(() => {
      this.updateLinkSuggester();
      this.updateQuickSwitcher();
      this.updateBacklinks();
      this.updateTabs();
      this.updateExplorer();
      this.updateWindowFrame();
    }, 1e3);
    this.app.workspace.onLayoutReady(() => {
      this.graphViewService.onLayoutChange();
      this.backlinkService.onLayoutChange();
      void this.tabService.renameTabs();
      this.updateExplorer();
      this.updateWindowFrame();
    });
    this.registerEvent(
      this.app.workspace.on("layout-change", () => {
        this.graphViewService.onLayoutChange();
        this.backlinkService.onLayoutChange();
      })
    );
    this.registerEvent(
      this.app.workspace.on("file-open", () => {
        this.backlinkService.onFileOpen();
      })
    );
    this.registerEvent(
      this.app.vault.on("modify", (file) => {
        if (file instanceof import_obsidian11.TFile && file.extension === "md") {
          this.cacheService.invalidateCache(file);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("rename", (file, oldPath) => {
        if (file instanceof import_obsidian11.TFile && file.extension === "md") {
          this.cacheService.invalidateCache(file);
        }
      })
    );
    this.registerEvent(
      this.app.vault.on("delete", (file) => {
        if (file instanceof import_obsidian11.TFile && file.extension === "md") {
          this.cacheService.invalidateCache(file);
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("changed", (file) => {
        if (file instanceof import_obsidian11.TFile && file.extension === "md") {
          this.cacheService.rebuildCache();
          if (this.settings.enableForGraphView) {
            this.graphViewService.refreshGraphView();
          }
          if (this.settings.enableForBacklinks) {
            this.backlinkService.updateBacklinks();
          }
          if (this.settings.enableForExplorer) {
            this.explorerService.updateExplorer();
          }
          if (this.settings.enableForWindowFrame) {
            this.windowFrameService.updateWindowFrame();
          }
        }
      })
    );
    this.registerEvent(
      this.app.metadataCache.on("resolved", () => {
        this.cacheService.rebuildCache();
      })
    );
    this.registerEvent(
      this.app.workspace.on("editor-drop", (event, editor) => {
        if (this.settings.enableForDragDrop) {
          this.dragDropService.handleDragDrop(event, editor);
        }
      })
    );
    this.registerDomEvent(document, "drop", (event) => {
      if (this.settings.enableForDragDrop) {
        this.dragDropService.handleDOMDrop(event);
      }
    });
    registerCommands(this);
    this.addSettingTab(new SettingTab(this.app, this));
  }
  updateLinkSuggester() {
    const editorSuggest = this.app.workspace.editorSuggest;
    if (!editorSuggest)
      return;
    if (this.suggest) {
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => s !== this.suggest);
      this.suggest = void 0;
    }
    if (this.settings.enableForLinking) {
      this.suggest = new LinkTitleSuggest(this);
      this.registerEditorSuggest(this.suggest);
      this.cacheService.setSuggest(this.suggest);
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => !s.constructor.name.includes("LinkSuggest"));
      editorSuggest.suggests.unshift(this.suggest);
    }
  }
  updateQuickSwitcher() {
    this.quickSwitcherService.updateQuickSwitcher();
  }
  updateGraphView() {
    this.graphViewService.updateGraphView();
  }
  updateBacklinks() {
    this.backlinkService.updateBacklinks();
  }
  updateTabs() {
    this.tabService.updateTabs();
  }
  updateExplorer() {
    this.explorerService.updateExplorer();
  }
  updateWindowFrame() {
    this.windowFrameService.updateWindowFrame();
  }
  rebuildCache() {
    this.cacheService.rebuildCache();
  }
  onunload() {
    const editorSuggest = this.app.workspace.editorSuggest;
    if (editorSuggest && this.suggest) {
      editorSuggest.suggests = editorSuggest.suggests.filter((s) => s !== this.suggest);
    }
    this.quickSwitcherService.restoreOriginalCommand();
    this.graphViewService.onunload();
    this.backlinkService.onunload();
    this.tabService.onunload();
    this.explorerService.onunload();
    this.windowFrameService.onunload();
  }
  async loadSettings() {
    const loadedData = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, loadedData != null ? loadedData : {});
  }
  async saveSettings(prevQuickSwitcherState, prevTabState) {
    await this.saveData(this.settings);
    if (prevQuickSwitcherState !== void 0 && prevQuickSwitcherState !== this.settings.enableForQuickSwitcher) {
      this.updateQuickSwitcher();
    }
    if (prevTabState !== void 0 && prevTabState !== this.settings.enableForTabs) {
      void this.tabService.registerEvents();
      this.updateTabs();
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL3V0aWxzL3NlYXJjaC50cyIsICJzcmMvdWkvUXVpY2tTd2l0Y2hNb2RhbC50cyIsICJzcmMvbWFpbi50cyIsICJzcmMvc2V0dGluZ3MudHMiLCAic3JjL3VpL0xpbmtUaXRsZVN1Z2dlc3QudHMiLCAic3JjL3VpL1NldHRpbmdUYWIudHMiLCAic3JjL3V0aWxzL3NldHRpbmdzLWNvbXBhdC50cyIsICJzcmMvY29tbWFuZHMvaW5kZXgudHMiLCAic3JjL3NlcnZpY2VzL1F1aWNrU3dpdGNoZXJTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9EcmFnRHJvcFNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL0NhY2hlU2VydmljZS50cyIsICJzcmMvc2VydmljZXMvR3JhcGhWaWV3U2VydmljZS50cyIsICJzcmMvc2VydmljZXMvQmFja2xpbmtTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9UYWJTZXJ2aWNlLnRzIiwgInNyYy9zZXJ2aWNlcy9FeHBsb3JlclNlcnZpY2UudHMiLCAic3JjL3NlcnZpY2VzL1dpbmRvd0ZyYW1lU2VydmljZS50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgVEZpbGUsIE1ldGFkYXRhQ2FjaGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBDYWNoZWRGaWxlRGF0YSB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGZ1enp5TWF0Y2goc3RyOiBzdHJpbmcsIHF1ZXJ5OiBzdHJpbmcpOiBib29sZWFuIHtcbiAgbGV0IGkgPSAwO1xuICBjb25zdCBsb3dlclN0ciA9IHN0ci50b0xvd2VyQ2FzZSgpO1xuICBjb25zdCBsb3dlclF1ZXJ5ID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcbiAgZm9yIChjb25zdCBjaGFyIG9mIGxvd2VyUXVlcnkpIHtcbiAgICBpID0gbG93ZXJTdHIuaW5kZXhPZihjaGFyLCBpKSArIDE7XG4gICAgaWYgKGkgPT09IDApIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldE1hdGNoU2NvcmUoZGlzcGxheTogc3RyaW5nLCBxdWVyeTogc3RyaW5nLCBiYXNlbmFtZTogc3RyaW5nLCBpbmNsdWRlRmlsZW5hbWVJblNlYXJjaDogYm9vbGVhbik6IG51bWJlciB7XG4gIGxldCBzY29yZSA9IDA7XG4gIGNvbnN0IGxvd2VyRGlzcGxheSA9IGRpc3BsYXkudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgbG93ZXJCYXNlbmFtZSA9IGJhc2VuYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGxvd2VyUXVlcnkgPSBxdWVyeS50b0xvd2VyQ2FzZSgpO1xuICBcbiAgLy8gRXhhY3QgbWF0Y2hlcyBnZXQgaGlnaGVzdCBzY29yZVxuICBpZiAobG93ZXJEaXNwbGF5ID09PSBsb3dlclF1ZXJ5KSBzY29yZSArPSAxMDAwO1xuICBlbHNlIGlmIChsb3dlckJhc2VuYW1lID09PSBsb3dlclF1ZXJ5KSBzY29yZSArPSA5MDA7XG4gIFxuICAvLyBTdGFydHMgd2l0aCBxdWVyeSBnZXRzIGhpZ2ggc2NvcmVcbiAgZWxzZSBpZiAobG93ZXJEaXNwbGF5LnN0YXJ0c1dpdGgobG93ZXJRdWVyeSkpIHNjb3JlICs9IDEwMDtcbiAgZWxzZSBpZiAoaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2ggJiYgbG93ZXJCYXNlbmFtZS5zdGFydHNXaXRoKGxvd2VyUXVlcnkpKSBzY29yZSArPSA4MDtcbiAgXG4gIC8vIENvbnRhaW5zIHF1ZXJ5IGdldHMgbWVkaXVtIHNjb3JlXG4gIGVsc2UgaWYgKGxvd2VyRGlzcGxheS5pbmNsdWRlcyhsb3dlclF1ZXJ5KSkgc2NvcmUgKz0gNTA7XG4gIGVsc2UgaWYgKGluY2x1ZGVGaWxlbmFtZUluU2VhcmNoICYmIGxvd2VyQmFzZW5hbWUuaW5jbHVkZXMobG93ZXJRdWVyeSkpIHNjb3JlICs9IDMwO1xuICBcbiAgLy8gV29yZCBib3VuZGFyeSBtYXRjaGVzIGdldCBib251c1xuICBjb25zdCB3b3JkQm91bmRhcnlSZWdleCA9IG5ldyBSZWdFeHAoYFxcXFxiJHtsb3dlclF1ZXJ5fWAsICdpJyk7XG4gIGlmICh3b3JkQm91bmRhcnlSZWdleC50ZXN0KGxvd2VyRGlzcGxheSkpIHNjb3JlICs9IDIwO1xuICBpZiAoaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2ggJiYgd29yZEJvdW5kYXJ5UmVnZXgudGVzdChsb3dlckJhc2VuYW1lKSkgc2NvcmUgKz0gMTU7XG4gIFxuICAvLyBQZW5hbHR5IGZvciB2ZXJ5IGxvbmcgbmFtZXNcbiAgY29uc3QgbGVuZ3RoUGVuYWx0eSA9IE1hdGgubWF4KDAsIChkaXNwbGF5Lmxlbmd0aCAtIHF1ZXJ5Lmxlbmd0aCkgKiAwLjEpO1xuICBzY29yZSAtPSBsZW5ndGhQZW5hbHR5O1xuICBcbiAgcmV0dXJuIE1hdGgubWF4KDAsIHNjb3JlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkRmlsZUNhY2hlKFxuICBmaWxlczogVEZpbGVbXSwgXG4gIG1ldGFkYXRhQ2FjaGU6IE1ldGFkYXRhQ2FjaGUsIFxuICBwcm9wZXJ0eUtleTogc3RyaW5nXG4pOiBNYXA8c3RyaW5nLCBDYWNoZWRGaWxlRGF0YT4ge1xuICBjb25zdCBjYWNoZSA9IG5ldyBNYXA8c3RyaW5nLCBDYWNoZWRGaWxlRGF0YT4oKTtcbiAgXG4gIGZpbGVzLmZvckVhY2goKGZpbGUpID0+IHtcbiAgICBjb25zdCBmaWxlQ2FjaGUgPSBtZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGZpbGVDYWNoZT8uZnJvbnRtYXR0ZXI7XG4gICAgbGV0IGRpc3BsYXlOYW1lID0gZmlsZS5iYXNlbmFtZTtcbiAgICBsZXQgaXNDdXN0b21EaXNwbGF5ID0gZmFsc2U7XG4gICAgbGV0IGFsaWFzZXM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbcHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgZnJvbnRtYXR0ZXJbcHJvcGVydHlLZXldICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gU3RyaW5nKGZyb250bWF0dGVyW3Byb3BlcnR5S2V5XSkudHJpbSgpO1xuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XG4gICAgICAgIGRpc3BsYXlOYW1lID0gcHJvcGVydHlWYWx1ZTtcbiAgICAgICAgaXNDdXN0b21EaXNwbGF5ID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoZnJvbnRtYXR0ZXI/LmFsaWFzZXMpIHtcbiAgICAgIGNvbnN0IGFsaWFzZXNSYXcgPSBmcm9udG1hdHRlci5hbGlhc2VzIGFzIHVua25vd247XG4gICAgICBhbGlhc2VzID0gQXJyYXkuaXNBcnJheShhbGlhc2VzUmF3KSA/IGFsaWFzZXNSYXcubWFwKGEgPT4gU3RyaW5nKGEpKSA6IFtTdHJpbmcoYWxpYXNlc1JhdyldO1xuICAgICAgYWxpYXNlcyA9IGFsaWFzZXMubWFwKGFsaWFzID0+IGFsaWFzLnRyaW0oKSkuZmlsdGVyKGFsaWFzID0+IGFsaWFzICE9PSAnJyk7XG4gICAgfVxuXG4gICAgY2FjaGUuc2V0KGZpbGUucGF0aCwge1xuICAgICAgZmlsZSxcbiAgICAgIGRpc3BsYXlOYW1lLFxuICAgICAgYWxpYXNlcyxcbiAgICAgIGxhc3RNb2RpZmllZDogZmlsZS5zdGF0Lm10aW1lLFxuICAgICAgaXNDdXN0b21EaXNwbGF5XG4gICAgfSk7XG4gIH0pO1xuICBcbiAgcmV0dXJuIGNhY2hlO1xufVxuIiwgImltcG9ydCB7IEFwcCwgRnV6enlTdWdnZXN0TW9kYWwsIE1hcmtkb3duVmlldywgTm90aWNlLCBURmlsZSwgcHJlcGFyZUZ1enp5U2VhcmNoLCBwcmVwYXJlU2ltcGxlU2VhcmNoLCBGdXp6eU1hdGNoLCBzb3J0U2VhcmNoUmVzdWx0cywgU2VhcmNoUmVzdWx0IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgUXVpY2tTd2l0Y2hJdGVtLCBDYWNoZWRGaWxlRGF0YSwgU2VhcmNoTWF0Y2hSZWFzb24sIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBXb3Jrc3BhY2VJbnRlcm5hbCwgUXVpY2tTd2l0Y2hlclBsdWdpbkluc3RhbmNlLCBVbnJlc29sdmVkTGlua0l0ZW0sIE5ld05vdGVJdGVtLCBBcHBJbnRlcm5hbCB9IGZyb20gJy4uL3R5cGVzJztcbmltcG9ydCB7IGJ1aWxkRmlsZUNhY2hlIH0gZnJvbSAnLi4vdXRpbHMvc2VhcmNoJztcblxuZXhwb3J0IGNsYXNzIFF1aWNrU3dpdGNoTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXT4ge1xuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XG4gIHByaXZhdGUgZmlsZUNhY2hlOiBNYXA8c3RyaW5nLCBDYWNoZWRGaWxlRGF0YT4gPSBuZXcgTWFwKCk7XG4gIHByaXZhdGUgcmVjZW50RmlsZXM6IFRGaWxlW10gPSBbXTtcbiAgcHJpdmF0ZSBzZWFyY2hUaW1lb3V0OiBudW1iZXIgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSBtYXRjaFJlYXNvbnM6IE1hcDxzdHJpbmcsIFNlYXJjaE1hdGNoUmVhc29uPiA9IG5ldyBNYXAoKTtcblxuICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xuICAgIHN1cGVyKGFwcCk7XG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgdGhpcy5saW1pdCA9IDg7IC8vIExpbWl0IHRvIDggaXRlbXMgZm9yIGNvbWZvcnRhYmxlIGRpc3BsYXlcbiAgICBcbiAgICAvLyBTZXQgcGxhY2Vob2xkZXIgYmFzZWQgb24gc2V0dGluZ1xuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyKSB7XG4gICAgICB0aGlzLnNldFBsYWNlaG9sZGVyKCdUeXBlIHRvIHNlYXJjaCBub3RlcyBieSB0aXRsZSBvciBmaWxlIG5hbWUuLi4nKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXRQbGFjZWhvbGRlcignVHlwZSB0byBzZWFyY2ggZmlsZXMuLi4nKTtcbiAgICB9XG4gICAgXG4gICAgdGhpcy5idWlsZEZpbGVDYWNoZSgpO1xuICAgIHRoaXMudXBkYXRlUmVjZW50RmlsZXMoKTtcbiAgICB0aGlzLmFkZEtleWJvYXJkTmF2aWdhdGlvbigpO1xuICAgIHRoaXMuYWRkRm9vdGVyKCk7XG4gICAgXG4gICAgLy8gT25seSBhZGQgc2NvcGluZyBjbGFzcyB3aGVuIGVuYWJsZWRcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcikge1xuICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcygncHJvcGVydHktb3Zlci1maWxlbmFtZS1tb2RhbCcpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgYWRkS2V5Ym9hcmROYXZpZ2F0aW9uKCk6IHZvaWQge1xuICAgIC8vIEFkZCBlc2NhcGUga2V5IGhhbmRsaW5nXG4gICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZSkgPT4ge1xuICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkRm9vdGVyKCk6IHZvaWQge1xuICAgIC8vIEZpbmQgdGhlIC5wcm9tcHQgY29udGFpbmVyIGFuZCBhZGQgZm9vdGVyIGluc2lkZSBpdFxuICAgIGNvbnN0IHByb21wdENvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLnByb21wdCcpO1xuICAgIGlmIChwcm9tcHRDb250YWluZXIpIHtcbiAgICAgIGNvbnN0IGZvb3RlciA9IHByb21wdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb25zJyB9KTtcbiAgICAgIC8vIENyZWF0ZSBuYXZpZ2F0aW9uIGluc3RydWN0aW9ucyB1c2luZyBET00gQVBJXG4gICAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSBbXG4gICAgICAgIHsgY29tbWFuZDogJ1x1MjE5MVx1MjE5MycsIGFjdGlvbjogJ3RvIG5hdmlnYXRlJyB9LFxuICAgICAgICB7IGNvbW1hbmQ6ICdcdTIxQjUnLCBhY3Rpb246ICd0byBvcGVuJyB9LFxuICAgICAgICB7IGNvbW1hbmQ6ICdjdHJsIFx1MjFCNScsIGFjdGlvbjogJ3RvIG9wZW4gaW4gbmV3IHRhYicgfSxcbiAgICAgICAgeyBjb21tYW5kOiAnY3RybCBhbHQgXHUyMUI1JywgYWN0aW9uOiAndG8gb3BlbiB0byB0aGUgcmlnaHQnIH0sXG4gICAgICAgIHsgY29tbWFuZDogJ3NoaWZ0IFx1MjFCNScsIGFjdGlvbjogJ3RvIGNyZWF0ZScgfSxcbiAgICAgICAgeyBjb21tYW5kOiAnZXNjJywgYWN0aW9uOiAndG8gZGlzbWlzcycgfVxuICAgICAgXTtcbiAgICAgIFxuICAgICAgaW5zdHJ1Y3Rpb25zLmZvckVhY2goKHsgY29tbWFuZCwgYWN0aW9uIH0pID0+IHtcbiAgICAgICAgY29uc3QgaW5zdHJ1Y3Rpb24gPSBmb290ZXIuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KTtcbiAgICAgICAgaW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbi1jb21tYW5kJywgdGV4dDogY29tbWFuZCB9KTtcbiAgICAgICAgaW5zdHJ1Y3Rpb24uY3JlYXRlU3Bhbih7IHRleHQ6IGFjdGlvbiB9KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGJ1aWxkRmlsZUNhY2hlKCk6IHZvaWQge1xuICAgIGNvbnN0IGZpbGVzID0gdGhpcy5nZXRGaWx0ZXJlZEZpbGVzKCk7XG4gICAgdGhpcy5maWxlQ2FjaGUgPSBidWlsZEZpbGVDYWNoZShcbiAgICAgIGZpbGVzLFxuICAgICAgdGhpcy5hcHAubWV0YWRhdGFDYWNoZSxcbiAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XG4gICAgKTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlRmlsZUNhY2hlKGZpbGU6IFRGaWxlKTogdm9pZCB7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlcjtcbiAgICBsZXQgZGlzcGxheU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuICAgIGxldCBpc0N1c3RvbURpc3BsYXkgPSBmYWxzZTtcbiAgICBsZXQgYWxpYXNlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XG4gICAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgZGlzcGxheU5hbWUgPSBwcm9wZXJ0eVZhbHVlO1xuICAgICAgICBpc0N1c3RvbURpc3BsYXkgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmcm9udG1hdHRlcj8uYWxpYXNlcykge1xuICAgICAgY29uc3QgYWxpYXNlc1JhdyA9IGZyb250bWF0dGVyLmFsaWFzZXMgYXMgdW5rbm93bjtcbiAgICAgIGFsaWFzZXMgPSBBcnJheS5pc0FycmF5KGFsaWFzZXNSYXcpID8gYWxpYXNlc1Jhdy5tYXAoYSA9PiBTdHJpbmcoYSkpIDogW1N0cmluZyhhbGlhc2VzUmF3KV07XG4gICAgICBhbGlhc2VzID0gYWxpYXNlcy5tYXAoYWxpYXMgPT4gYWxpYXMudHJpbSgpKS5maWx0ZXIoYWxpYXMgPT4gYWxpYXMgIT09ICcnKTtcbiAgICB9XG5cbiAgICB0aGlzLmZpbGVDYWNoZS5zZXQoZmlsZS5wYXRoLCB7XG4gICAgICBmaWxlLFxuICAgICAgZGlzcGxheU5hbWUsXG4gICAgICBhbGlhc2VzLFxuICAgICAgbGFzdE1vZGlmaWVkOiBmaWxlLnN0YXQubXRpbWUsXG4gICAgICBpc0N1c3RvbURpc3BsYXlcbiAgICB9KTtcbiAgfVxuXG4gIHByaXZhdGUgdXBkYXRlUmVjZW50RmlsZXMoKTogdm9pZCB7XG4gICAgLy8gVXNlIE9ic2lkaWFuJ3MgaW50ZXJuYWwgcmVjZW50IGZpbGVzIG1lY2hhbmlzbSBmb3IgcGVyZmVjdCBjb21wYXRpYmlsaXR5XG4gICAgbGV0IHJlY2VudEZpbGVzOiBURmlsZVtdID0gW107XG4gICAgXG4gICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5hcHAud29ya3NwYWNlIGFzIHVua25vd24gYXMgV29ya3NwYWNlSW50ZXJuYWwgJiB7IHJlY2VudEZpbGVUcmFja2VyPzogeyBnZXRMYXN0T3BlbkZpbGVzKCk6IHN0cmluZ1tdIH0gfTtcbiAgICBcbiAgICAvLyBDaGVjayBRdWljayBTd2l0Y2hlciBzZXR0aW5ncyB0byBkZXRlcm1pbmUgd2hhdCBmaWxlIHR5cGVzIHRvIGluY2x1ZGVcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcbiAgICBjb25zdCBzaG93QXR0YWNobWVudHMgPSBxdWlja1N3aXRjaGVyT3B0aW9ucz8uc2hvd0F0dGFjaG1lbnRzID8/IHRydWU7XG4gICAgXG4gICAgLy8gQWNjZXNzIE9ic2lkaWFuJ3MgcmVjZW50RmlsZVRyYWNrZXIgdG8gZ2V0IHRoZSBzYW1lIGZpbGVzIGFzIGRlZmF1bHQgcXVpY2sgc3dpdGNoZXJcbiAgICBpZiAod29ya3NwYWNlLnJlY2VudEZpbGVUcmFja2VyPy5nZXRMYXN0T3BlbkZpbGVzKSB7XG4gICAgICBjb25zdCBsYXN0T3BlbkZpbGVzID0gd29ya3NwYWNlLnJlY2VudEZpbGVUcmFja2VyLmdldExhc3RPcGVuRmlsZXMoKTtcbiAgICAgIFxuICAgICAgLy8gQ29udmVydCBmaWxlIHBhdGhzIHRvIFRGaWxlIG9iamVjdHNcbiAgICAgIHJlY2VudEZpbGVzID0gbGFzdE9wZW5GaWxlc1xuICAgICAgICAubWFwKChmaWxlUGF0aDogc3RyaW5nKSA9PiB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpKVxuICAgICAgICAuZmlsdGVyKChmaWxlOiB1bmtub3duKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xuICAgIH1cbiAgICBcbiAgICAvLyBGYWxsYmFjayBpZiByZWNlbnRGaWxlVHJhY2tlciBpcyBub3QgYXZhaWxhYmxlXG4gICAgaWYgKHJlY2VudEZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgY29uc3Qgb3BlbkZpbGVzID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnbWFya2Rvd24nKVxuICAgICAgICAubWFwKGxlYWYgPT4gbGVhZi52aWV3KVxuICAgICAgICAuZmlsdGVyKCh2aWV3KTogdmlldyBpcyBNYXJrZG93blZpZXcgPT4gdmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldylcbiAgICAgICAgLm1hcCh2aWV3ID0+IHZpZXcuZmlsZSlcbiAgICAgICAgLmZpbHRlcigoZmlsZSk6IGZpbGUgaXMgVEZpbGUgPT4gZmlsZSAhPT0gbnVsbClcbiAgICAgICAgLmZpbHRlcigoZmlsZSwgaW5kZXgsIHNlbGYpID0+IHNlbGYuaW5kZXhPZihmaWxlKSA9PT0gaW5kZXgpO1xuICAgICAgXG4gICAgICByZWNlbnRGaWxlcyA9IFsuLi5vcGVuRmlsZXNdO1xuICAgIH1cbiAgICBcbiAgICAvLyBGaWx0ZXIgYmFzZWQgb24gUXVpY2sgU3dpdGNoZXIgc2V0dGluZ3MgQkVGT1JFIGJhY2tmaWxsaW5nXG4gICAgaWYgKCFzaG93QXR0YWNobWVudHMpIHtcbiAgICAgIC8vIEZpbHRlciBvdXQgYXR0YWNobWVudHMgLSBvbmx5IHNob3cgbWFya2Rvd24gZmlsZXNcbiAgICAgIHJlY2VudEZpbGVzID0gcmVjZW50RmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS5leHRlbnNpb24gPT09ICdtZCcpO1xuICAgIH1cbiAgICBcbiAgICAvLyBBbHdheXMgYmFja2ZpbGwgdG8gOCBpdGVtcyAob3IgYXMgbWFueSBhcyBhdmFpbGFibGUpXG4gICAgY29uc3QgdGFyZ2V0Q291bnQgPSA4O1xuICAgIGNvbnN0IGV4aXN0aW5nUGF0aHMgPSBuZXcgU2V0KHJlY2VudEZpbGVzLm1hcChmID0+IGYucGF0aCkpO1xuICAgIFxuICAgIGlmIChyZWNlbnRGaWxlcy5sZW5ndGggPCB0YXJnZXRDb3VudCkge1xuICAgICAgaWYgKHNob3dBdHRhY2htZW50cykge1xuICAgICAgICAvLyBJbmNsdWRlIGFsbCBmaWxlIHR5cGVzIChtYXJrZG93biArIGF0dGFjaG1lbnRzKVxuICAgICAgICBjb25zdCBhbGxGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xuICAgICAgICBjb25zdCBhZGRpdGlvbmFsRmlsZXMgPSBhbGxGaWxlc1xuICAgICAgICAgIC5maWx0ZXIoZmlsZSA9PiAhZXhpc3RpbmdQYXRocy5oYXMoZmlsZS5wYXRoKSlcbiAgICAgICAgICAuc2xpY2UoMCwgdGFyZ2V0Q291bnQgLSByZWNlbnRGaWxlcy5sZW5ndGgpO1xuICAgICAgICByZWNlbnRGaWxlcy5wdXNoKC4uLmFkZGl0aW9uYWxGaWxlcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBPbmx5IG1hcmtkb3duIGZpbGVzXG4gICAgICAgIGNvbnN0IGFsbE1hcmtkb3duRmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIGNvbnN0IGFkZGl0aW9uYWxGaWxlcyA9IGFsbE1hcmtkb3duRmlsZXNcbiAgICAgICAgICAuZmlsdGVyKGZpbGUgPT4gIWV4aXN0aW5nUGF0aHMuaGFzKGZpbGUucGF0aCkpXG4gICAgICAgICAgLnNsaWNlKDAsIHRhcmdldENvdW50IC0gcmVjZW50RmlsZXMubGVuZ3RoKTtcbiAgICAgICAgcmVjZW50RmlsZXMucHVzaCguLi5hZGRpdGlvbmFsRmlsZXMpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBMaW1pdCB0byA4IGZpbGVzXG4gICAgdGhpcy5yZWNlbnRGaWxlcyA9IHJlY2VudEZpbGVzLnNsaWNlKDAsIHRhcmdldENvdW50KTtcbiAgfVxuXG4gIGdldEl0ZW1zKCk6IFF1aWNrU3dpdGNoSXRlbVsnaXRlbSddW10ge1xuICAgIHJldHVybiB0aGlzLmdldEZpbHRlcmVkRmlsZXMoKTtcbiAgfVxuXG4gIHByaXZhdGUgZ2V0RmlsdGVyZWRGaWxlcygpOiBURmlsZVtdIHtcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcbiAgICBcbiAgICAvLyBTdGFydCB3aXRoIG1hcmtkb3duIGZpbGVzXG4gICAgbGV0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xuICAgIFxuICAgIC8vIElmIHdlIGNhbiBhY2Nlc3MgUXVpY2sgU3dpdGNoZXIgb3B0aW9ucyBhbmQgYXR0YWNobWVudHMgYXJlIGVuYWJsZWQsIGluY2x1ZGUgdGhlbVxuICAgIGlmIChxdWlja1N3aXRjaGVyT3B0aW9ucz8uc2hvd0F0dGFjaG1lbnRzKSB7XG4gICAgICBjb25zdCBhbGxGaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldEZpbGVzKCkuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xuICAgICAgLy8gSW5jbHVkZSBtYXJrZG93biBmaWxlcyBhbmQgYXR0YWNobWVudHNcbiAgICAgIGZpbGVzID0gYWxsRmlsZXMuZmlsdGVyKGZpbGUgPT4gXG4gICAgICAgIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnIHx8IHRoaXMuaXNBdHRhY2htZW50KGZpbGUpXG4gICAgICApO1xuICAgIH1cbiAgICAvLyBJZiBzaG93QXR0YWNobWVudHMgaXMgZmFsc2Ugb3Igd2UgY2FuJ3QgYWNjZXNzIG9wdGlvbnMsIG9ubHkgc2hvdyBtYXJrZG93biBmaWxlcyAoZGVmYXVsdCBiZWhhdmlvcilcblxuICAgIHJldHVybiBmaWxlcztcbiAgfVxuXG4gIHByaXZhdGUgaXNBdHRhY2htZW50KGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgYXR0YWNobWVudEV4dGVuc2lvbnMgPSBbJ3BuZycsICdqcGcnLCAnanBlZycsICdnaWYnLCAnc3ZnJywgJ3dlYnAnLCAncGRmJywgJ21wNCcsICdtcDMnLCAnd2F2JywgJ29nZycsICd3ZWJtJ107XG4gICAgcmV0dXJuIGF0dGFjaG1lbnRFeHRlbnNpb25zLmluY2x1ZGVzKGZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRRdWlja1N3aXRjaGVyT3B0aW9ucygpOiBRdWlja1N3aXRjaGVyUGx1Z2luSW5zdGFuY2VbJ29wdGlvbnMnXSB8IG51bGwge1xuICAgIHRyeSB7XG4gICAgICAvLyBBY2Nlc3MgdGhlIGludGVybmFsIFF1aWNrIFN3aXRjaGVyIHBsdWdpbiB0aGUgc2FtZSB3YXkgUXVpY2sgU3dpdGNoICsrIGRvZXNcbiAgICAgIGNvbnN0IGludGVybmFsUGx1Z2lucyA9ICh0aGlzLmFwcCBhcyB1bmtub3duIGFzIEFwcEludGVybmFsKS5pbnRlcm5hbFBsdWdpbnM7XG4gICAgICBpZiAoIWludGVybmFsUGx1Z2lucykgcmV0dXJuIG51bGw7XG4gICAgICBcbiAgICAgIGNvbnN0IHN3aXRjaGVyUGx1Z2luID0gaW50ZXJuYWxQbHVnaW5zLmdldFBsdWdpbkJ5SWQ/Lignc3dpdGNoZXInKTtcbiAgICAgIGlmICghc3dpdGNoZXJQbHVnaW4gfHwgIXN3aXRjaGVyUGx1Z2luLmluc3RhbmNlKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gc3dpdGNoZXJQbHVnaW4uaW5zdGFuY2Uub3B0aW9ucyB8fCBudWxsO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1Byb3BlcnR5IE92ZXIgRmlsZW5hbWU6IENvdWxkIG5vdCBhY2Nlc3MgUXVpY2sgU3dpdGNoZXIgb3B0aW9uczonLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBnZXRJdGVtVGV4dChpdGVtOiBRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXSk6IHN0cmluZyB7XG4gICAgaWYgKCdpc05ld05vdGUnIGluIGl0ZW0pIHtcbiAgICAgIHJldHVybiBpdGVtLm5ld05hbWU7IC8vIEp1c3QgcmV0dXJuIHRoZSBuYW1lLCBPYnNpZGlhbiB3aWxsIGhhbmRsZSB0aGUgXCJFbnRlciB0byBjcmVhdGVcIiB0ZXh0XG4gICAgfVxuICAgIFxuICAgIGlmICgnaXNVbnJlc29sdmVkJyBpbiBpdGVtKSB7XG4gICAgICByZXR1cm4gaXRlbS51bnJlc29sdmVkVGV4dDtcbiAgICB9XG4gICAgXG4gICAgLy8gV2hlbiBkaXNhYmxlZCwgc2hvdyBqdXN0IHRoZSBmaWxlIG5hbWUgbGlrZSBkZWZhdWx0IE9ic2lkaWFuXG4gICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyKSB7XG4gICAgICByZXR1cm4gaXRlbS5iYXNlbmFtZTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgZGlzcGxheSA9IHRoaXMuZ2V0RGlzcGxheU5hbWUoaXRlbSk7XG4gICAgcmV0dXJuIGRpc3BsYXk7XG4gIH1cblxuICBnZXREaXNwbGF5TmFtZShmaWxlOiBURmlsZSk6IHN0cmluZyB7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gYXMgdW5rbm93bjtcbiAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gdW5kZWZpbmVkICYmIHByb3BlcnR5VmFsdWUgIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHRyaW1tZWQgPSB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ3N0cmluZycgPyBwcm9wZXJ0eVZhbHVlLnRyaW0oKSA6ICh0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdib29sZWFuJyA/IFN0cmluZyhwcm9wZXJ0eVZhbHVlKSA6ICcnKS50cmltKCk7XG4gICAgICBpZiAodHJpbW1lZCAhPT0gJycpIHtcbiAgICAgICAgcmV0dXJuIHRyaW1tZWQ7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaWxlLmJhc2VuYW1lO1xuICB9XG5cbiAgZ2V0U3VnZ2VzdGlvbnMocXVlcnk6IHN0cmluZyk6IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+W10ge1xuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcikge1xuICAgICAgLy8gV2hlbiBkaXNhYmxlZCwgdXNlIGRlZmF1bHQgT2JzaWRpYW4gYmVoYXZpb3IgLSBzaG93IGFsbCBmaWxlcyB3aXRoIGRlZmF1bHQgc2VhcmNoXG4gICAgICBjb25zdCBzZWFyY2hRdWVyeSA9IHF1ZXJ5LnRyaW0oKTtcbiAgICAgIFxuICAgICAgaWYgKCFzZWFyY2hRdWVyeSkge1xuICAgICAgICAvLyBTaG93IHJlY2VudCBmaWxlcyBsaWtlIGRlZmF1bHQgT2JzaWRpYW5cbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVjZW50RmlsZXNSZXN1bHRzKCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFVzZSBkZWZhdWx0IE9ic2lkaWFuIHNlYXJjaCAtIGp1c3Qgc2hvdyBmaWxlcyB3aXRoIGZpbGUgbmFtZSBtYXRjaGluZ1xuICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmdldEZpbHRlcmVkRmlsZXMoKTtcbiAgICAgIGNvbnN0IHNlYXJjaCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVNpbXBsZVNlYXJjaCBcbiAgICAgICAgPyBwcmVwYXJlU2ltcGxlU2VhcmNoKHNlYXJjaFF1ZXJ5KVxuICAgICAgICA6IHByZXBhcmVGdXp6eVNlYXJjaChzZWFyY2hRdWVyeSk7XG4gICAgICBjb25zdCByZXN1bHRzOiBGdXp6eU1hdGNoPFF1aWNrU3dpdGNoSXRlbVsnaXRlbSddPltdID0gW107XG4gICAgICBcbiAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xuICAgICAgICBjb25zdCBtYXRjaCA9IHNlYXJjaChmaWxlLmJhc2VuYW1lKSA/PyB7IHNjb3JlOiAwLCBtYXRjaGVzOiBbXSB9O1xuICAgICAgICBpZiAobWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmVzdWx0cy5wdXNoKHsgaXRlbTogZmlsZSwgbWF0Y2ggfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVXNlIE9ic2lkaWFuJ3MgbmF0aXZlIHNvcnRpbmcgZm9yIGV4YWN0IHZhbmlsbGEgY29tcGF0aWJpbGl0eVxuICAgICAgc29ydFNlYXJjaFJlc3VsdHMocmVzdWx0cyk7XG4gICAgICBcbiAgICAgIC8vIEFsd2F5cyBhZGQgbmV3IG5vdGUgb3B0aW9uIGlmIG5vIHJlc3VsdHNcbiAgICAgIC8vIFwiU2hvdyBleGlzdGluZyBvbmx5XCIgb25seSBhZmZlY3RzIHNob3dpbmcgdW5yZXNvbHZlZCBsaW5rcywgbm90IGNyZWF0aW5nIG5ldyBub3Rlc1xuICAgICAgaWYgKHJlc3VsdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGNvbnN0IG5ld0l0ZW06IE5ld05vdGVJdGVtID0geyBpc05ld05vdGU6IHRydWUsIG5ld05hbWU6IHNlYXJjaFF1ZXJ5IH07XG4gICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgaXRlbTogbmV3SXRlbSxcbiAgICAgICAgICBtYXRjaDogeyBzY29yZTogMTAwMCwgbWF0Y2hlczogW1swLCBzZWFyY2hRdWVyeS5sZW5ndGhdXSB9LFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIHJlc3VsdHMuc2xpY2UoMCwgdGhpcy5saW1pdCk7XG4gICAgfVxuXG4gICAgY29uc3Qgc2VhcmNoUXVlcnkgPSBxdWVyeS50cmltKCk7XG4gICAgXG4gICAgLy8gQ2xlYXIgcHJldmlvdXMgdGltZW91dFxuICAgIGlmICh0aGlzLnNlYXJjaFRpbWVvdXQpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLnNlYXJjaFRpbWVvdXQpO1xuICAgIH1cblxuICAgIC8vIElmIG5vIHF1ZXJ5LCBzaG93IHJlY2VudCBmaWxlc1xuICAgIGlmICghc2VhcmNoUXVlcnkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFJlY2VudEZpbGVzUmVzdWx0cygpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLnBlcmZvcm1TZWFyY2goc2VhcmNoUXVlcnkpO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRSZWNlbnRGaWxlc1Jlc3VsdHMoKTogRnV6enlNYXRjaDxRdWlja1N3aXRjaEl0ZW1bJ2l0ZW0nXT5bXSB7XG4gICAgLy8gVXBkYXRlIHJlY2VudCBmaWxlcyAodGhpcyBhbHJlYWR5IGhhbmRsZXMgZmlsdGVyaW5nIGFuZCBiYWNrZmlsbGluZylcbiAgICB0aGlzLnVwZGF0ZVJlY2VudEZpbGVzKCk7XG4gICAgXG4gICAgLy8gQ2xlYXIgbWF0Y2ggcmVhc29ucyBmb3IgcmVjZW50IGZpbGVzIHNpbmNlIHRoZXkncmUgbm90IHNlYXJjaCByZXN1bHRzXG4gICAgdGhpcy5tYXRjaFJlYXNvbnMuY2xlYXIoKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gdGhlIHJlY2VudCBmaWxlcyAoYWxyZWFkeSBmaWx0ZXJlZCBhbmQgYmFja2ZpbGxlZCBpbiB1cGRhdGVSZWNlbnRGaWxlcylcbiAgICByZXR1cm4gdGhpcy5yZWNlbnRGaWxlcy5tYXAoZmlsZSA9PiAoe1xuICAgICAgaXRlbTogZmlsZSxcbiAgICAgIG1hdGNoOiB7IHNjb3JlOiAxMDAwLCBtYXRjaGVzOiBbXSB9XG4gICAgfSkpO1xuICB9XG5cbiAgcHJpdmF0ZSBwZXJmb3JtU2VhcmNoKHNlYXJjaFF1ZXJ5OiBzdHJpbmcpOiBGdXp6eU1hdGNoPFF1aWNrU3dpdGNoSXRlbVsnaXRlbSddPltdIHtcbiAgICAvLyBVc2Ugc2ltcGxlIHNlYXJjaCBmb3IgbGFyZ2UgdmF1bHRzIGlmIGVuYWJsZWQsIG90aGVyd2lzZSB1c2UgZnV6enkgc2VhcmNoXG4gICAgY29uc3Qgc2VhcmNoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlU2ltcGxlU2VhcmNoIFxuICAgICAgPyBwcmVwYXJlU2ltcGxlU2VhcmNoKHNlYXJjaFF1ZXJ5KVxuICAgICAgOiBwcmVwYXJlRnV6enlTZWFyY2goc2VhcmNoUXVlcnkpO1xuICAgIGNvbnN0IHJlc3VsdHM6IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+W10gPSBbXTtcbiAgICB0aGlzLm1hdGNoUmVhc29ucy5jbGVhcigpOyAvLyBDbGVhciBwcmV2aW91cyBtYXRjaCByZWFzb25zXG5cbiAgICAvLyBVc2UgY2FjaGVkIGRhdGEgZm9yIG11Y2ggZmFzdGVyIHNlYXJjaFxuICAgIGZvciAoY29uc3QgY2FjaGVkRGF0YSBvZiB0aGlzLmZpbGVDYWNoZS52YWx1ZXMoKSkge1xuICAgICAgY29uc3QgeyBmaWxlLCBkaXNwbGF5TmFtZSwgYWxpYXNlcywgaXNDdXN0b21EaXNwbGF5IH0gPSBjYWNoZWREYXRhO1xuICAgICAgXG4gICAgICAvLyBUcmFjayB3aGljaCBmaWVsZHMgY2F1c2VkIHRoZSBtYXRjaFxuICAgICAgY29uc3QgbWF0Y2hSZWFzb246IFNlYXJjaE1hdGNoUmVhc29uID0ge1xuICAgICAgICBtYXRjaGVkSW5UaXRsZTogZmFsc2UsXG4gICAgICAgIG1hdGNoZWRJbkZpbGVuYW1lOiBmYWxzZSxcbiAgICAgICAgbWF0Y2hlZEluQWxpYXM6IGZhbHNlXG4gICAgICB9O1xuICAgICAgXG4gICAgICAvLyBQcmltYXJ5IG1hdGNoOiBzZWFyY2ggdGl0bGUvcHJvcGVydHkgZmlyc3QgKG9ubHkgaWYgbm90ZSBoYXMgY3VzdG9tIGRpc3BsYXkpXG4gICAgICBsZXQgcHJpbWFyeU1hdGNoOiBTZWFyY2hSZXN1bHQgfCBudWxsID0gbnVsbDtcbiAgICAgIGxldCBiZXN0TWF0Y2g6IFNlYXJjaFJlc3VsdCB8IG51bGwgPSBudWxsO1xuICAgICAgbGV0IG1hdGNoVHlwZTogJ3RpdGxlJyB8ICdmaWxlbmFtZScgfCAnYWxpYXMnIHwgbnVsbCA9IG51bGw7XG4gICAgICBcbiAgICAgIGlmIChpc0N1c3RvbURpc3BsYXkpIHtcbiAgICAgICAgLy8gT25seSBzZWFyY2ggdGl0bGUvcHJvcGVydHkgaWYgbm90ZSBhY3R1YWxseSBoYXMgYSBjdXN0b20gcHJvcGVydHlcbiAgICAgICAgcHJpbWFyeU1hdGNoID0gc2VhcmNoKGRpc3BsYXlOYW1lKTtcbiAgICAgICAgaWYgKHByaW1hcnlNYXRjaCAmJiBwcmltYXJ5TWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluVGl0bGUgPSB0cnVlO1xuICAgICAgICAgIGJlc3RNYXRjaCA9IHByaW1hcnlNYXRjaDtcbiAgICAgICAgICBtYXRjaFR5cGUgPSAndGl0bGUnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIElmIG5vIHRpdGxlIG1hdGNoIChvciBub3RlIGRvZXNuJ3QgaGF2ZSBwcm9wZXJ0eSksIHNlYXJjaCBmaWxlbmFtZVxuICAgICAgaWYgKCFtYXRjaFR5cGUpIHtcbiAgICAgICAgLy8gU2VhcmNoIGZpbGVuYW1lIGlmIGl0J3MgZGlmZmVyZW50IGZyb20gZGlzcGxheU5hbWUsIG9yIGlmIG5vdGUgZG9lc24ndCBoYXZlIHByb3BlcnR5XG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlRmlsZW5hbWVJblNlYXJjaCAmJiBmaWxlLmJhc2VuYW1lICE9PSBkaXNwbGF5TmFtZSkge1xuICAgICAgICAgIGNvbnN0IGZpbGVuYW1lTWF0Y2ggPSBzZWFyY2goZmlsZS5iYXNlbmFtZSk7XG4gICAgICAgICAgaWYgKGZpbGVuYW1lTWF0Y2ggJiYgZmlsZW5hbWVNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lID0gdHJ1ZTtcbiAgICAgICAgICAgIC8vIERvd25yYW5rIGZpbGVuYW1lIG1hdGNoZXMgYnkgLTFcbiAgICAgICAgICAgIGJlc3RNYXRjaCA9IHsgLi4uZmlsZW5hbWVNYXRjaCwgc2NvcmU6IGZpbGVuYW1lTWF0Y2guc2NvcmUgLSAxIH07XG4gICAgICAgICAgICBtYXRjaFR5cGUgPSAnZmlsZW5hbWUnO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmICghaXNDdXN0b21EaXNwbGF5KSB7XG4gICAgICAgICAgLy8gSWYgbm90ZSBkb2Vzbid0IGhhdmUgcHJvcGVydHksIGRpc3BsYXlOYW1lIGVxdWFscyBmaWxlbmFtZSwgc28gc2VhcmNoIGZpbGVuYW1lXG4gICAgICAgICAgY29uc3QgZmlsZW5hbWVNYXRjaCA9IHNlYXJjaChmaWxlLmJhc2VuYW1lKTtcbiAgICAgICAgICBpZiAoZmlsZW5hbWVNYXRjaCAmJiBmaWxlbmFtZU1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluRmlsZW5hbWUgPSB0cnVlO1xuICAgICAgICAgICAgYmVzdE1hdGNoID0gZmlsZW5hbWVNYXRjaDtcbiAgICAgICAgICAgIG1hdGNoVHlwZSA9ICdmaWxlbmFtZSc7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFRlcnRpYXJ5IG1hdGNoOiBzZWFyY2ggYWxpYXNlcyAod2l0aCBkb3ducmFua2luZylcbiAgICAgIGlmICghbWF0Y2hUeXBlICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVBbGlhc2VzSW5TZWFyY2ggJiYgYWxpYXNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvciAoY29uc3QgYWxpYXMgb2YgYWxpYXNlcykge1xuICAgICAgICAgIGNvbnN0IGFsaWFzTWF0Y2ggPSBzZWFyY2goYWxpYXMpO1xuICAgICAgICAgIGlmIChhbGlhc01hdGNoICYmIGFsaWFzTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcyA9IHRydWU7XG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0ID0gYWxpYXM7IC8vIFN0b3JlIHdoaWNoIGFsaWFzIG1hdGNoZWRcbiAgICAgICAgICAgIC8vIERvd25yYW5rIGFsaWFzIG1hdGNoZXMgYnkgLTFcbiAgICAgICAgICAgIGJlc3RNYXRjaCA9IHsgLi4uYWxpYXNNYXRjaCwgc2NvcmU6IGFsaWFzTWF0Y2guc2NvcmUgLSAxIH07XG4gICAgICAgICAgICBtYXRjaFR5cGUgPSAnYWxpYXMnO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIElmIHdlIGhhdmUgYW55IG1hdGNoLCBhZGQgdG8gcmVzdWx0c1xuICAgICAgaWYgKGJlc3RNYXRjaCAmJiBiZXN0TWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHJlc3VsdHMucHVzaCh7IGl0ZW06IGZpbGUsIG1hdGNoOiBiZXN0TWF0Y2ggfSk7XG4gICAgICAgIHRoaXMubWF0Y2hSZWFzb25zLnNldChmaWxlLnBhdGgsIG1hdGNoUmVhc29uKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGQgdW5yZXNvbHZlZCBsaW5rcyBpZiBcIlNob3cgZXhpc3Rpbmcgb25seVwiIGlzIGRpc2FibGVkXG4gICAgLy8gVGhpcyBtYXRjaGVzIFF1aWNrIFN3aXRjaCArKyBiZWhhdmlvcjogdW5yZXNvbHZlZDogIXNldHRpbmdzLnNob3dFeGlzdGluZ09ubHlcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcbiAgICBjb25zdCBzaG93RXhpc3RpbmdPbmx5ID0gcXVpY2tTd2l0Y2hlck9wdGlvbnM/LnNob3dFeGlzdGluZ09ubHkgPz8gZmFsc2U7XG4gICAgXG4gICAgaWYgKCFzaG93RXhpc3RpbmdPbmx5KSB7XG4gICAgICAvLyBHZXQgdW5yZXNvbHZlZCBsaW5rcyBmcm9tIG1ldGFkYXRhIGNhY2hlIChsaWtlIFF1aWNrIFN3aXRjaCArKyBkb2VzKVxuICAgICAgY29uc3QgeyB1bnJlc29sdmVkTGlua3MgfSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGU7XG4gICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICBcbiAgICAgIC8vIENvbGxlY3QgYWxsIHVucmVzb2x2ZWQgbGlua3MgZnJvbSBhbGwgZmlsZXNcbiAgICAgIGZvciAoY29uc3Qgc291cmNlUGF0aCBpbiB1bnJlc29sdmVkTGlua3MpIHtcbiAgICAgICAgY29uc3QgbGlua3MgPSBPYmplY3Qua2V5cyh1bnJlc29sdmVkTGlua3Nbc291cmNlUGF0aF0pO1xuICAgICAgICBsaW5rcy5mb3JFYWNoKGxpbmsgPT4gdW5yZXNvbHZlZFNldC5hZGQobGluaykpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTZWFyY2ggdW5yZXNvbHZlZCBsaW5rcyBhbmQgYWRkIG1hdGNoZXNcbiAgICAgIGZvciAoY29uc3QgdW5yZXNvbHZlZCBvZiB1bnJlc29sdmVkU2V0KSB7XG4gICAgICAgIGNvbnN0IHVucmVzb2x2ZWRNYXRjaCA9IHNlYXJjaCh1bnJlc29sdmVkKTtcbiAgICAgICAgaWYgKHVucmVzb2x2ZWRNYXRjaCAmJiB1bnJlc29sdmVkTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gQWRkIGFzIGEgc3VnZ2VzdGlvbiB3aXRob3V0IGEgZmlsZSAodW5yZXNvbHZlZCBsaW5rKVxuICAgICAgICAgIC8vIFVzZSBhIHNwZWNpYWwgb2JqZWN0IHRvIHJlcHJlc2VudCB1bnJlc29sdmVkIGxpbmtzXG4gICAgICAgICAgY29uc3QgdW5yZXNvbHZlZEl0ZW06IFVucmVzb2x2ZWRMaW5rSXRlbSA9IHsgaXNVbnJlc29sdmVkOiB0cnVlLCB1bnJlc29sdmVkVGV4dDogdW5yZXNvbHZlZCB9O1xuICAgICAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgICAgICBpdGVtOiB1bnJlc29sdmVkSXRlbSxcbiAgICAgICAgICAgIG1hdGNoOiB1bnJlc29sdmVkTWF0Y2hcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICAvLyBVc2UgT2JzaWRpYW4ncyBuYXRpdmUgc29ydGluZyBmb3IgZXhhY3QgdmFuaWxsYSBjb21wYXRpYmlsaXR5XG4gICAgICBzb3J0U2VhcmNoUmVzdWx0cyhyZXN1bHRzKTtcbiAgICAgIFxuICAgICAgLy8gRmlsdGVyIG91dCB1bnJlc29sdmVkIGxpbmtzIGlmIFwiU2hvdyBleGlzdGluZyBvbmx5XCIgaXMgZW5hYmxlZFxuICAgICAgLy8gVW5yZXNvbHZlZCBsaW5rcyBhcmUgaXRlbXMgd2l0aCBpc1VucmVzb2x2ZWQgcHJvcGVydHksIGJ1dCBrZWVwIFwiY3JlYXRlIG5ldyBub3RlXCIgb3B0aW9uc1xuICAgICAgbGV0IGZpbHRlcmVkUmVzdWx0cyA9IHJlc3VsdHM7XG4gICAgICBpZiAoc2hvd0V4aXN0aW5nT25seSkge1xuICAgICAgICBmaWx0ZXJlZFJlc3VsdHMgPSByZXN1bHRzLmZpbHRlcihyID0+IHtcbiAgICAgICAgICAvLyBLZWVwIGZpbGVzIGFuZCBuZXcgbm90ZSBpdGVtcywgZmlsdGVyIG91dCB1bnJlc29sdmVkIGxpbmtzXG4gICAgICAgICAgcmV0dXJuIHIuaXRlbSBpbnN0YW5jZW9mIFRGaWxlIHx8ICgnaXNOZXdOb3RlJyBpbiByLml0ZW0gJiYgci5pdGVtLmlzTmV3Tm90ZSA9PT0gdHJ1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBDaGVjayBmb3IgZXhhY3QgbWF0Y2hlcyBpbiBleGlzdGluZyBmaWxlc1xuICAgICAgY29uc3QgbG93ZXJRdWVyeSA9IHNlYXJjaFF1ZXJ5LnRvTG93ZXJDYXNlKCk7XG4gICAgICBsZXQgZXhhY3RNYXRjaCA9IGZpbHRlcmVkUmVzdWx0cy5zb21lKHIgPT4gXG4gICAgICAgIHIuaXRlbSBpbnN0YW5jZW9mIFRGaWxlICYmIChcbiAgICAgICAgICB0aGlzLmdldERpc3BsYXlOYW1lKHIuaXRlbSkudG9Mb3dlckNhc2UoKSA9PT0gbG93ZXJRdWVyeSB8fFxuICAgICAgICAgICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlRmlsZW5hbWVJblNlYXJjaCAmJiByLml0ZW0uYmFzZW5hbWUudG9Mb3dlckNhc2UoKSA9PT0gbG93ZXJRdWVyeSkgfHxcbiAgICAgICAgICAodGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUFsaWFzZXNJblNlYXJjaCAmJiB0aGlzLmZpbGVDYWNoZS5nZXQoci5pdGVtLnBhdGgpPy5hbGlhc2VzLnNvbWUoYWxpYXMgPT4gYWxpYXMudG9Mb3dlckNhc2UoKSA9PT0gbG93ZXJRdWVyeSkpXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgICBcbiAgICAgIC8vIEFsc28gY2hlY2sgdW5yZXNvbHZlZCBsaW5rcyBpZiB0aGV5J3JlIGJlaW5nIHNob3duXG4gICAgICBpZiAoIXNob3dFeGlzdGluZ09ubHkgJiYgIWV4YWN0TWF0Y2gpIHtcbiAgICAgICAgY29uc3QgeyB1bnJlc29sdmVkTGlua3MgfSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGU7XG4gICAgICAgIGNvbnN0IHVucmVzb2x2ZWRTZXQgPSBuZXcgU2V0PHN0cmluZz4oKTtcbiAgICAgICAgZm9yIChjb25zdCBzb3VyY2VQYXRoIGluIHVucmVzb2x2ZWRMaW5rcykge1xuICAgICAgICAgIGNvbnN0IGxpbmtzID0gT2JqZWN0LmtleXModW5yZXNvbHZlZExpbmtzW3NvdXJjZVBhdGhdKTtcbiAgICAgICAgICBsaW5rcy5mb3JFYWNoKGxpbmsgPT4gdW5yZXNvbHZlZFNldC5hZGQobGluaykpO1xuICAgICAgICB9XG4gICAgICAgIC8vIENoZWNrIGlmIHF1ZXJ5IGV4YWN0bHkgbWF0Y2hlcyBhbnkgdW5yZXNvbHZlZCBsaW5rXG4gICAgICAgIGV4YWN0TWF0Y2ggPSBBcnJheS5mcm9tKHVucmVzb2x2ZWRTZXQpLnNvbWUobGluayA9PiBsaW5rLnRvTG93ZXJDYXNlKCkgPT09IGxvd2VyUXVlcnkpO1xuICAgICAgfVxuXG4gICAgICAvLyBBbHdheXMgYWRkIG5ldyBub3RlIG9wdGlvbiBpZiBubyBleGFjdCBtYXRjaCBleGlzdHNcbiAgICAgIC8vIFwiU2hvdyBleGlzdGluZyBvbmx5XCIgb25seSBhZmZlY3RzIHNob3dpbmcgdW5yZXNvbHZlZCBsaW5rcywgbm90IGNyZWF0aW5nIG5ldyBub3Rlc1xuICAgICAgaWYgKCFleGFjdE1hdGNoICYmIHNlYXJjaFF1ZXJ5KSB7XG4gICAgICAgIGNvbnN0IG5ld0l0ZW06IE5ld05vdGVJdGVtID0geyBpc05ld05vdGU6IHRydWUsIG5ld05hbWU6IHNlYXJjaFF1ZXJ5IH07XG4gICAgICAgIGZpbHRlcmVkUmVzdWx0cy51bnNoaWZ0KHtcbiAgICAgICAgICBpdGVtOiBuZXdJdGVtLFxuICAgICAgICAgIG1hdGNoOiB7IHNjb3JlOiAxMDAwLCBtYXRjaGVzOiBbWzAsIHNlYXJjaFF1ZXJ5Lmxlbmd0aF1dIH0sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gZmlsdGVyZWRSZXN1bHRzLnNsaWNlKDAsIHRoaXMubGltaXQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIHN1Z2dlc3Rpb25zOicsIGVycm9yKTtcbiAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIHVwZGF0aW5nIHF1aWNrIHN3aXRjaGVyIHN1Z2dlc3Rpb25zLiBQbGVhc2UgY2hlY2sgY29uc29sZSBmb3IgZGV0YWlscy4nKTtcbiAgICAgIHJldHVybiBbXTtcbiAgICB9XG4gIH1cblxuICByZW5kZXJTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IEZ1enp5TWF0Y2g8UXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10+LCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCB7IGl0ZW0gfSA9IHN1Z2dlc3Rpb247XG4gICAgXG4gICAgLy8gSGFuZGxlIHVucmVzb2x2ZWQgbGlua3MgLSBzaG93IGZpbGUtcGx1cyBpY29uIGluc3RlYWQgb2YgXCJFbnRlciB0byBjcmVhdGVcIiB0ZXh0XG4gICAgaWYgKCdpc1VucmVzb2x2ZWQnIGluIGl0ZW0gJiYgaXRlbS5pc1VucmVzb2x2ZWQpIHtcbiAgICAgIGNvbnN0IHVucmVzb2x2ZWRUZXh0ID0gaXRlbS51bnJlc29sdmVkVGV4dDtcbiAgICAgIGVsLmVtcHR5KCk7XG4gICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25UaXRsZSA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xuICAgICAgc3VnZ2VzdGlvblRpdGxlLnNldFRleHQodW5yZXNvbHZlZFRleHQpO1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxuICAgICAgICBjbHM6ICdzdWdnZXN0aW9uLWZsYWlyJywgXG4gICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiAnVW5yZXNvbHZlZCBsaW5rIC0gRW50ZXIgdG8gY3JlYXRlJyB9IFxuICAgICAgfSk7XG4gICAgICB0aGlzLmNyZWF0ZUZpbGVQbHVzSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB0ZXh0ID0gdGhpcy5nZXRJdGVtVGV4dChpdGVtKTtcbiAgICBcbiAgICBpZiAoJ2lzTmV3Tm90ZScgaW4gaXRlbSkge1xuICAgICAgLy8gRm9yIG5ldyBub3RlcywgdXNlIHRoZSBleGFjdCBIVE1MIHN0cnVjdHVyZSBmcm9tIGRlZmF1bHQgT2JzaWRpYW5cbiAgICAgIGVsLmVtcHR5KCk7XG4gICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcbiAgICAgIFxuICAgICAgLy8gTWFpbiBzdWdnZXN0aW9uIGNvbnRlbnRcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcbiAgICAgIGNvbnN0IHN1Z2dlc3Rpb25UaXRsZSA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xuICAgICAgc3VnZ2VzdGlvblRpdGxlLnNldFRleHQodGV4dCk7XG4gICAgICBcbiAgICAgIC8vIEFkZCBcIkVudGVyIHRvIGNyZWF0ZVwiIHRleHQgb24gdGhlIHJpZ2h0IHVzaW5nIHRoZSBjb3JyZWN0IGNsYXNzXG4gICAgICBjb25zdCBzdWdnZXN0aW9uQXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xuICAgICAgY29uc3Qgc3VnZ2VzdGlvbkFjdGlvbiA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IGNsczogJ3N1Z2dlc3Rpb24tYWN0aW9uJyB9KTtcbiAgICAgIHN1Z2dlc3Rpb25BY3Rpb24uc2V0VGV4dCgnRW50ZXIgdG8gY3JlYXRlJyk7XG4gICAgICBcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBXaGVuIGRpc2FibGVkLCB1c2UgZGVmYXVsdCBPYnNpZGlhbiBzdHlsaW5nIChubyBjdXN0b20gY2xhc3NlcyBvciBpY29ucylcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpIHtcbiAgICAgIC8vIFVzZSBkZWZhdWx0IE9ic2lkaWFuIHNpbmdsZS1saW5lIGRpc3BsYXlcbiAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZWwuc2V0VGV4dChpdGVtLnBhdGgucmVwbGFjZSgnLm1kJywgJycpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsLnNldFRleHQodGV4dCk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFdoZW4gZW5hYmxlZCwgdXNlIG91ciBjdXN0b20gc3R5bGluZyB3aXRoIGljb25zXG4gICAgICAvLyBPbmx5IHNob3cgaWNvbnMgZm9yIFRGaWxlIGl0ZW1zLCBub3QgdW5yZXNvbHZlZCBsaW5rc1xuICAgICAgaWYgKCEoaXRlbSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICBlbC5zZXRUZXh0KHRleHQpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENoZWNrIGlmIHRoaXMgZmlsZSBoYXMgYSBjdXN0b20gcHJvcGVydHlcbiAgICAgIGNvbnN0IGNhY2hlZERhdGEgPSB0aGlzLmZpbGVDYWNoZS5nZXQoaXRlbS5wYXRoKTtcbiAgICAgIGNvbnN0IGlzQ3VzdG9tRGlzcGxheSA9IGNhY2hlZERhdGE/LmlzQ3VzdG9tRGlzcGxheSA/PyBmYWxzZTtcbiAgICAgIGNvbnN0IG1hdGNoUmVhc29uID0gdGhpcy5tYXRjaFJlYXNvbnMuZ2V0KGl0ZW0ucGF0aCk7XG4gICAgICBcbiAgICAgIC8vIFNwZWNpYWwgY2FzZTogbm90ZXMgd2l0aG91dCBwcm9wZXJ0eSB0aGF0IG1hdGNoZWQgdmlhIGFsaWFzIHNob3VsZCBzaG93IGFsaWFzIHdpdGggaWNvblxuICAgICAgaWYgKCFpc0N1c3RvbURpc3BsYXkgJiYgbWF0Y2hSZWFzb24/Lm1hdGNoZWRJbkFsaWFzICYmIG1hdGNoUmVhc29uLm1hdGNoZWRBbGlhc1RleHQpIHtcbiAgICAgICAgLy8gU2hvdyBhbGlhcyBhcyBtYWluIHRleHQsIGZpbGVuYW1lIGJlbG93LCB3aXRoIGFsaWFzIGljb24gKGxpa2UgZGVmYXVsdCBPYnNpZGlhbilcbiAgICAgICAgZWwuYWRkQ2xhc3MoJ21vZC1jb21wbGV4Jyk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25Db250ZW50ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1jb250ZW50JyB9KTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1haW4gdGl0bGUgLSBzaG93IHRoZSBhbGlhcyB0aGF0IG1hdGNoZWRcbiAgICAgICAgY29uc3QgdGl0bGVFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xuICAgICAgICB0aXRsZUVsLnNldFRleHQobWF0Y2hSZWFzb24ubWF0Y2hlZEFsaWFzVGV4dCk7XG4gICAgICAgIFxuICAgICAgICAvLyBGaWxlIHBhdGggYmVsb3dcbiAgICAgICAgY29uc3QgcGF0aEVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1ub3RlJyB9KTtcbiAgICAgICAgcGF0aEVsLnNldFRleHQoaXRlbS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgc3VnZ2VzdGlvbi1hdXggd2l0aCBhbGlhcyBpY29uXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25BdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxuICAgICAgICAgIGNsczogJ3N1Z2dlc3Rpb24tZmxhaXInLCBcbiAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogJ0FsaWFzIE1hdGNoJyB9IFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgfSBlbHNlIGlmIChpc0N1c3RvbURpc3BsYXkpIHtcbiAgICAgICAgLy8gTm90ZXMgd2l0aCB0aGUgcHJvcGVydHkgLSBrZWVwIGV4aXN0aW5nIGJlaGF2aW9yXG4gICAgICAgIGNvbnN0IHNob3VsZFNob3dJY29uID0gbWF0Y2hSZWFzb24gJiYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlIHx8IG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lIHx8IG1hdGNoUmVhc29uLm1hdGNoZWRJbkFsaWFzKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChzaG91bGRTaG93SWNvbikge1xuICAgICAgICAgIC8vIEFkZCBtb2QtY29tcGxleCBjbGFzcyB0byBtYXRjaCBPYnNpZGlhbidzIHN0cnVjdHVyZVxuICAgICAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xuXG4gICAgICAgICAgLy8gQ3JlYXRlIHRoZSBtYWluIHN1Z2dlc3Rpb24gY29udGFpbmVyXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkNvbnRlbnQgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWNvbnRlbnQnIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIE1haW4gdGl0bGVcbiAgICAgICAgICBjb25zdCB0aXRsZUVsID0gc3VnZ2VzdGlvbkNvbnRlbnQuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi10aXRsZScgfSk7XG4gICAgICAgICAgdGl0bGVFbC5zZXRUZXh0KHRleHQpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIEZpbGUgcGF0aCBiZWxvd1xuICAgICAgICAgIGNvbnN0IHBhdGhFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tbm90ZScgfSk7XG4gICAgICAgICAgcGF0aEVsLnNldFRleHQoaXRlbS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQWRkIHN1Z2dlc3Rpb24tYXV4IHdpdGggYXBwcm9wcmlhdGUgaWNvbiBiYXNlZCBvbiBtYXRjaCByZWFzb25cbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xuICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxuICAgICAgICAgICAgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicsIFxuICAgICAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6IHRoaXMuZ2V0SWNvbkxhYmVsKG1hdGNoUmVhc29uKSB9IFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIERldGVybWluZSBpY29uIGJhc2VkIG9uIHByaW9yaXR5OiB0aXRsZSA+IGZpbGUgbmFtZSA+IGFsaWFzXG4gICAgICAgICAgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlKSB7XG4gICAgICAgICAgICAvLyBUeXBlIGljb24gZm9yIHRpdGxlL3Byb3BlcnR5IG1hdGNoZXNcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVHlwZUljb24oc3VnZ2VzdGlvbkZsYWlyKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XG4gICAgICAgICAgICAvLyBGaWxlIGljb24gZm9yIGZpbGUgbmFtZSBtYXRjaGVzXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUZpbGVJY29uKHN1Z2dlc3Rpb25GbGFpcik7XG4gICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xuICAgICAgICAgICAgLy8gQXJyb3cgaWNvbiBmb3IgYWxpYXMgbWF0Y2hlc1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBOb3RlIGhhcyBwcm9wZXJ0eSBidXQgbm8gbWF0Y2ggcmVhc29uIChlLmcuLCByZWNlbnQgZmlsZXMpXG4gICAgICAgICAgLy8gU2hvdyBjb21wbGV4IGxheW91dCB3aXRoIGljb24gaWYgdXNpbmcgcHJvcGVydHktYmFzZWQgdGl0bGVcbiAgICAgICAgICBlbC5hZGRDbGFzcygnbW9kLWNvbXBsZXgnKTtcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XG4gICAgICAgICAgY29uc3QgdGl0bGVFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tdGl0bGUnIH0pO1xuICAgICAgICAgIHRpdGxlRWwuc2V0VGV4dCh0ZXh0KTtcbiAgICAgICAgICBjb25zdCBwYXRoRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLW5vdGUnIH0pO1xuICAgICAgICAgIHBhdGhFbC5zZXRUZXh0KGl0ZW0ucGF0aC5yZXBsYWNlKCcubWQnLCAnJykpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFNob3cgXCJUXCIgaWNvbiBmb3IgcHJvcGVydHktYmFzZWQgdGl0bGVzXG4gICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkF1eCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tYXV4JyB9KTtcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uRmxhaXIgPSBzdWdnZXN0aW9uQXV4LmNyZWF0ZVNwYW4oeyBcbiAgICAgICAgICAgIGNsczogJ3N1Z2dlc3Rpb24tZmxhaXInLCBcbiAgICAgICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiAnUHJvcGVydHktYmFzZWQgdGl0bGUnIH0gXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5jcmVhdGVUeXBlSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBGb3Igbm90ZXMgd2l0aG91dCB0aGUgcHJvcGVydHkgKGFuZCBub3QgbWF0Y2hlZCB2aWEgYWxpYXMpLCBzaG93IHNpbXBsZSBkaXNwbGF5IChubyBpY29uLCBubyBkdXBsaWNhdGUgbmFtZSlcbiAgICAgICAgZWwuc2V0VGV4dCh0ZXh0KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEljb25MYWJlbChtYXRjaFJlYXNvbjogU2VhcmNoTWF0Y2hSZWFzb24pOiBzdHJpbmcge1xuICAgIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5UaXRsZSkge1xuICAgICAgcmV0dXJuICdUaXRsZS9Qcm9wZXJ0eSBNYXRjaCc7XG4gICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSkge1xuICAgICAgcmV0dXJuICdGaWxlIE5hbWUgTWF0Y2gnO1xuICAgIH0gZWxzZSBpZiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMpIHtcbiAgICAgIHJldHVybiAnQWxpYXMgTWF0Y2gnO1xuICAgIH1cbiAgICByZXR1cm4gJ01hdGNoJztcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVHlwZUljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgc3ZnLmNsYXNzTGlzdC5hZGQoJ3N2Zy1pY29uJywgJ2x1Y2lkZS10eXBlJyk7XG4gICAgXG4gICAgY29uc3QgcG9seWxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5bGluZScpO1xuICAgIHBvbHlsaW5lMS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICc0IDcgNCA0IDIwIDQgMjAgNycpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZTEpO1xuICAgIFxuICAgIGNvbnN0IGxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MScsICc5Jyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcyMCcpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDInLCAnMTUnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kyJywgJzIwJyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcbiAgICBcbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnMTInKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kxJywgJzQnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzEyJyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcyMCcpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG4gICAgXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUZpbGVJY29uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnY3VycmVudENvbG9yJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpO1xuICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdzdmctaWNvbicsICdsdWNpZGUtZmlsZS10ZXh0Jyk7XG4gICAgXG4gICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ00xNC41IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY3LjVMMTQuNSAyeicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcbiAgICBcbiAgICBjb25zdCBwb2x5bGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUxLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE0LDIgMTQsOCAyMCw4Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMSk7XG4gICAgXG4gICAgY29uc3QgbGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gxJywgJzE2Jyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcxMycpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDInLCAnOCcpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneTInLCAnMTMnKTtcbiAgICBzdmcuYXBwZW5kQ2hpbGQobGluZTEpO1xuICAgIFxuICAgIGNvbnN0IGxpbmUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MScsICcxNicpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnMTcnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzgnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kyJywgJzE3Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcbiAgICBcbiAgICBjb25zdCBwb2x5bGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUyLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzEwLDkgOSw5IDgsOScpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZTIpO1xuICAgIFxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzdmcpO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVGb3J3YXJkSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCAncm91bmQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLWZvcndhcmQnKTtcbiAgICBcbiAgICBjb25zdCBwb2x5bGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcxNSAxNyAyMCAxMiAxNSA3Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lKTtcbiAgICBcbiAgICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XG4gICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2QnLCAnTTQgMTh2LTJhNCA0IDAgMCAxIDQtNGgxMicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcbiAgICBcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3ZnKTtcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlRmlsZVBsdXNJY29uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnY3VycmVudENvbG9yJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpO1xuICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdzdmctaWNvbicsICdsdWNpZGUtZmlsZS1wbHVzJyk7XG4gICAgXG4gICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ00xNC41IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY3LjVMMTQuNSAyeicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcbiAgICBcbiAgICBjb25zdCBwb2x5bGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcxNCwyIDE0LDggMjAsOCcpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZSk7XG4gICAgXG4gICAgY29uc3QgbGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gxJywgJzEyJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcxOCcpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDInLCAnMTInKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kyJywgJzEyJyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcbiAgICBcbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnOScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnMTUnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzE1Jyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcxNScpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG4gICAgXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XG4gIH1cblxuICBwcml2YXRlIGlzVXNpbmdDdXN0b21Qcm9wZXJ0eShmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBjYWNoZT8uZnJvbnRtYXR0ZXI7XG4gICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IGZyb250bWF0dGVyPy5bdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldIGFzIHVua25vd247XG4gICAgaWYgKHByb3BlcnR5VmFsdWUgPT09IHVuZGVmaW5lZCB8fCBwcm9wZXJ0eVZhbHVlID09PSBudWxsKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IHN0clZhbHVlID0gdHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdzdHJpbmcnID8gcHJvcGVydHlWYWx1ZSA6ICh0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHByb3BlcnR5VmFsdWUgPT09ICdib29sZWFuJyA/IFN0cmluZyhwcm9wZXJ0eVZhbHVlKSA6ICcnKTtcbiAgICByZXR1cm4gc3RyVmFsdWUudHJpbSgpICE9PSAnJztcbiAgfVxuXG4gIHByaXZhdGUgaXNVc2luZ0FsaWFzKGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG4gICAgLy8gQ2hlY2sgaWYgdGhpcyBmaWxlIGhhcyBhbGlhc2VzIGFuZCBpZiB3ZSdyZSBjdXJyZW50bHkgc2VhcmNoaW5nXG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCBhbGlhc2VzID0gZnJvbnRtYXR0ZXI/LmFsaWFzZXMgYXMgdW5rbm93bjtcbiAgICBcbiAgICBpZiAoIWFsaWFzZXMpIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICAvLyBGb3Igbm93LCBzaG93IGFsaWFzIGljb24gaWYgdGhlIGZpbGUgaGFzIGFsaWFzZXMgYW5kIHdlJ3JlIG5vdCB1c2luZyBhIGN1c3RvbSBwcm9wZXJ0eVxuICAgIGNvbnN0IGlzVXNpbmdDdXN0b21Qcm9wZXJ0eSA9IHRoaXMuaXNVc2luZ0N1c3RvbVByb3BlcnR5KGZpbGUpO1xuICAgIHJldHVybiAhaXNVc2luZ0N1c3RvbVByb3BlcnR5ICYmIEJvb2xlYW4oYWxpYXNlcyk7XG4gIH1cblxuICBvbkNob29zZUl0ZW0oaXRlbTogUXVpY2tTd2l0Y2hJdGVtWydpdGVtJ10sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAvLyBIYW5kbGUgdW5yZXNvbHZlZCBsaW5rcyAtIGNyZWF0ZSB0aGUgZmlsZSB1c2luZyBvcGVuTGlua1RleHQgdG8gcmVzcGVjdCBuZXcgbm90ZSBsb2NhdGlvbiBzZXR0aW5nc1xuICAgIGlmICgnaXNVbnJlc29sdmVkJyBpbiBpdGVtICYmIGl0ZW0uaXNVbnJlc29sdmVkKSB7XG4gICAgICBjb25zdCB1bnJlc29sdmVkVGV4dCA9IGl0ZW0udW5yZXNvbHZlZFRleHQ7XG4gICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgIGNvbnN0IHNvdXJjZVBhdGggPSBhY3RpdmVWaWV3Py5maWxlPy5wYXRoIHx8ICcnO1xuICAgICAgXG4gICAgICAvLyBVc2Ugb3BlbkxpbmtUZXh0IHdoaWNoIHJlc3BlY3RzIE9ic2lkaWFuJ3MgZGVmYXVsdCBuZXcgbm90ZSBsb2NhdGlvbiBzZXR0aW5nc1xuICAgICAgdm9pZCB0aGlzLmFwcC53b3Jrc3BhY2Uub3BlbkxpbmtUZXh0KHVucmVzb2x2ZWRUZXh0LCBzb3VyY2VQYXRoKS5jYXRjaCgoZXJyOiB1bmtub3duKSA9PiB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogU3RyaW5nKGVycik7XG4gICAgICAgIG5ldyBOb3RpY2UoYEVycm9yIGNyZWF0aW5nIG5vdGU6ICR7bWVzc2FnZX1gKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICBpZiAoJ2lzTmV3Tm90ZScgaW4gaXRlbSkge1xuICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICBjb25zdCBzb3VyY2VQYXRoID0gYWN0aXZlVmlldz8uZmlsZT8ucGF0aCB8fCAnJztcbiAgICAgIFxuICAgICAgLy8gVXNlIG9wZW5MaW5rVGV4dCB3aGljaCByZXNwZWN0cyBPYnNpZGlhbidzIGRlZmF1bHQgbmV3IG5vdGUgbG9jYXRpb24gc2V0dGluZ3NcbiAgICAgIHZvaWQgdGhpcy5hcHAud29ya3NwYWNlLm9wZW5MaW5rVGV4dChpdGVtLm5ld05hbWUsIHNvdXJjZVBhdGgpLmNhdGNoKChlcnI6IHVua25vd24pID0+IHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiBTdHJpbmcoZXJyKTtcbiAgICAgICAgbmV3IE5vdGljZShgRXJyb3IgY3JlYXRpbmcgbm90ZTogJHttZXNzYWdlfWApO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChpdGVtIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgIC8vIEhhbmRsZSBkaWZmZXJlbnQgbW9kaWZpZXIga2V5cyBsaWtlIGRlZmF1bHQgT2JzaWRpYW5cbiAgICAgIGlmIChldnQgaW5zdGFuY2VvZiBLZXlib2FyZEV2ZW50KSB7XG4gICAgICAgIGlmIChldnQuY3RybEtleSAmJiBldnQuYWx0S2V5KSB7XG4gICAgICAgICAgLy8gT3BlbiB0byB0aGUgcmlnaHRcbiAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYodHJ1ZSk7XG4gICAgICAgICAgdm9pZCBsZWFmLm9wZW5GaWxlKGl0ZW0pO1xuICAgICAgICB9IGVsc2UgaWYgKGV2dC5jdHJsS2V5KSB7XG4gICAgICAgICAgLy8gT3BlbiBpbiBuZXcgdGFiXG4gICAgICAgICAgdm9pZCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKGl0ZW0pO1xuICAgICAgICB9IGVsc2UgaWYgKGV2dC5zaGlmdEtleSkge1xuICAgICAgICAgIC8vIENyZWF0ZSBuZXcgbm90ZSAodGhpcyBzaG91bGRuJ3QgaGFwcGVuIGZvciBleGlzdGluZyBmaWxlcywgYnV0IGtlZXBpbmcgZm9yIGNvbnNpc3RlbmN5KVxuICAgICAgICAgIHZvaWQgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoKS5vcGVuRmlsZShpdGVtKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBEZWZhdWx0OiBvcGVuIGluIGN1cnJlbnQgdGFiXG4gICAgICAgICAgdm9pZCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigpLm9wZW5GaWxlKGl0ZW0pO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBNb3VzZSBjbGljazogZGVmYXVsdCBiZWhhdmlvclxuICAgICAgICB2b2lkIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCkub3BlbkZpbGUoaXRlbSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbiIsICJpbXBvcnQgeyBQbHVnaW4sIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgUGx1Z2luU2V0dGluZ3MsIFdvcmtzcGFjZUludGVybmFsLCBFZGl0b3JTdWdnZXN0IH0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgeyBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zZXR0aW5ncyc7XG5pbXBvcnQgeyBMaW5rVGl0bGVTdWdnZXN0IH0gZnJvbSAnLi91aS9MaW5rVGl0bGVTdWdnZXN0JztcbmltcG9ydCB7IFNldHRpbmdUYWIgfSBmcm9tICcuL3VpL1NldHRpbmdUYWInO1xuaW1wb3J0IHsgcmVnaXN0ZXJDb21tYW5kcyB9IGZyb20gJy4vY29tbWFuZHMnO1xuaW1wb3J0IHsgUXVpY2tTd2l0Y2hlclNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL1F1aWNrU3dpdGNoZXJTZXJ2aWNlJztcbmltcG9ydCB7IERyYWdEcm9wU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvRHJhZ0Ryb3BTZXJ2aWNlJztcbmltcG9ydCB7IENhY2hlU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvQ2FjaGVTZXJ2aWNlJztcbmltcG9ydCB7IEdyYXBoVmlld1NlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL0dyYXBoVmlld1NlcnZpY2UnO1xuaW1wb3J0IHsgQmFja2xpbmtTZXJ2aWNlIH0gZnJvbSAnLi9zZXJ2aWNlcy9CYWNrbGlua1NlcnZpY2UnO1xuaW1wb3J0IHsgVGFiU2VydmljZSB9IGZyb20gJy4vc2VydmljZXMvVGFiU2VydmljZSc7XG5pbXBvcnQgeyBFeHBsb3JlclNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL0V4cGxvcmVyU2VydmljZSc7XG5pbXBvcnQgeyBXaW5kb3dGcmFtZVNlcnZpY2UgfSBmcm9tICcuL3NlcnZpY2VzL1dpbmRvd0ZyYW1lU2VydmljZSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgc2V0dGluZ3MhOiBQbHVnaW5TZXR0aW5ncztcbiAgc3VnZ2VzdD86IExpbmtUaXRsZVN1Z2dlc3Q7XG4gIHByaXZhdGUgcXVpY2tTd2l0Y2hlclNlcnZpY2UhOiBRdWlja1N3aXRjaGVyU2VydmljZTtcbiAgcHJpdmF0ZSBkcmFnRHJvcFNlcnZpY2UhOiBEcmFnRHJvcFNlcnZpY2U7XG4gIHByaXZhdGUgY2FjaGVTZXJ2aWNlITogQ2FjaGVTZXJ2aWNlO1xuICBwcml2YXRlIGdyYXBoVmlld1NlcnZpY2UhOiBHcmFwaFZpZXdTZXJ2aWNlO1xuICBwcml2YXRlIGJhY2tsaW5rU2VydmljZSE6IEJhY2tsaW5rU2VydmljZTtcbiAgcHJpdmF0ZSB0YWJTZXJ2aWNlITogVGFiU2VydmljZTtcbiAgcHJpdmF0ZSBleHBsb3JlclNlcnZpY2UhOiBFeHBsb3JlclNlcnZpY2U7XG4gIHByaXZhdGUgd2luZG93RnJhbWVTZXJ2aWNlITogV2luZG93RnJhbWVTZXJ2aWNlO1xuXG4gIGFzeW5jIG9ubG9hZCgpIHtcbiAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgIFxuICAgIC8vIEluaXRpYWxpemUgc2VydmljZXNcbiAgICB0aGlzLnF1aWNrU3dpdGNoZXJTZXJ2aWNlID0gbmV3IFF1aWNrU3dpdGNoZXJTZXJ2aWNlKHRoaXMpO1xuICAgIHRoaXMuZHJhZ0Ryb3BTZXJ2aWNlID0gbmV3IERyYWdEcm9wU2VydmljZSh0aGlzKTtcbiAgICB0aGlzLmNhY2hlU2VydmljZSA9IG5ldyBDYWNoZVNlcnZpY2UodGhpcyk7XG4gICAgdGhpcy5ncmFwaFZpZXdTZXJ2aWNlID0gbmV3IEdyYXBoVmlld1NlcnZpY2UodGhpcyk7XG4gICAgdGhpcy5iYWNrbGlua1NlcnZpY2UgPSBuZXcgQmFja2xpbmtTZXJ2aWNlKHRoaXMpO1xuICAgIHRoaXMudGFiU2VydmljZSA9IG5ldyBUYWJTZXJ2aWNlKHRoaXMpO1xuICAgIHRoaXMuZXhwbG9yZXJTZXJ2aWNlID0gbmV3IEV4cGxvcmVyU2VydmljZSh0aGlzKTtcbiAgICB0aGlzLndpbmRvd0ZyYW1lU2VydmljZSA9IG5ldyBXaW5kb3dGcmFtZVNlcnZpY2UodGhpcyk7XG4gICAgXG4gICAgLy8gUmVnaXN0ZXIgdGFiIHNlcnZpY2UgZXZlbnRzIGFuZCByZW5hbWUgdGFicyBpbW1lZGlhdGVseVxuICAgIGF3YWl0IHRoaXMudGFiU2VydmljZS5yZWdpc3RlckV2ZW50cygpO1xuICAgIFxuICAgIC8vIFJlZ2lzdGVyIGV4cGxvcmVyIGFuZCB3aW5kb3cgZnJhbWUgc2VydmljZXNcbiAgICB0aGlzLmV4cGxvcmVyU2VydmljZS5yZWdpc3RlckV2ZW50cygpO1xuICAgIHRoaXMud2luZG93RnJhbWVTZXJ2aWNlLnJlZ2lzdGVyRXZlbnRzKCk7XG4gICAgXG4gICAgLy8gV2FpdCBhIGJpdCBmb3IgbWV0YWRhdGEgY2FjaGUgdG8gYmUgZnVsbHkgcG9wdWxhdGVkXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICB0aGlzLnVwZGF0ZUxpbmtTdWdnZXN0ZXIoKTtcbiAgICAgIHRoaXMudXBkYXRlUXVpY2tTd2l0Y2hlcigpO1xuICAgICAgdGhpcy51cGRhdGVCYWNrbGlua3MoKTtcbiAgICAgIHRoaXMudXBkYXRlVGFicygpO1xuICAgICAgdGhpcy51cGRhdGVFeHBsb3JlcigpO1xuICAgICAgdGhpcy51cGRhdGVXaW5kb3dGcmFtZSgpO1xuICAgIH0sIDEwMDApO1xuXG4gICAgLy8gU2V0IHVwIGdyYXBoIHZpZXcgaGFuZGxpbmdcbiAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XG4gICAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcbiAgICAgIHRoaXMuYmFja2xpbmtTZXJ2aWNlLm9uTGF5b3V0Q2hhbmdlKCk7XG4gICAgICB2b2lkIHRoaXMudGFiU2VydmljZS5yZW5hbWVUYWJzKCk7XG4gICAgICB0aGlzLnVwZGF0ZUV4cGxvcmVyKCk7XG4gICAgICB0aGlzLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XG4gICAgfSk7XG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgdGhpcy5hcHAud29ya3NwYWNlLm9uKCdsYXlvdXQtY2hhbmdlJywgKCkgPT4ge1xuICAgICAgICB0aGlzLmdyYXBoVmlld1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcbiAgICAgICAgdGhpcy5iYWNrbGlua1NlcnZpY2Uub25MYXlvdXRDaGFuZ2UoKTtcbiAgICAgIH0pXG4gICAgKTtcblxuICAgIC8vIFNldCB1cCBiYWNrbGlua3MgaGFuZGxpbmdcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtb3BlbicsICgpID0+IHtcbiAgICAgICAgdGhpcy5iYWNrbGlua1NlcnZpY2Uub25GaWxlT3BlbigpO1xuICAgICAgfSlcbiAgICApO1xuXG4gICAgLy8gUmVnaXN0ZXIgZmlsZSBjaGFuZ2UgZXZlbnRzIHRvIGludmFsaWRhdGUgY2FjaGVcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICB0aGlzLmFwcC52YXVsdC5vbignbW9kaWZ5JywgKGZpbGUpID0+IHtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLmludmFsaWRhdGVDYWNoZShmaWxlKTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICApO1xuXG4gICAgdGhpcy5yZWdpc3RlckV2ZW50KFxuICAgICAgdGhpcy5hcHAudmF1bHQub24oJ3JlbmFtZScsIChmaWxlLCBvbGRQYXRoKSA9PiB7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcbiAgICAgICAgICB0aGlzLmNhY2hlU2VydmljZS5pbnZhbGlkYXRlQ2FjaGUoZmlsZSk7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgKTtcblxuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgIHRoaXMuYXBwLnZhdWx0Lm9uKCdkZWxldGUnLCAoZmlsZSkgPT4ge1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09PSAnbWQnKSB7XG4gICAgICAgICAgdGhpcy5jYWNoZVNlcnZpY2UuaW52YWxpZGF0ZUNhY2hlKGZpbGUpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG5cbiAgICAvLyBSZWdpc3RlciBtZXRhZGF0YSBjYWNoZSBjaGFuZ2UgZXZlbnRzIHRvIHJlYnVpbGQgY2FjaGVcbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdjaGFuZ2VkJywgKGZpbGUpID0+IHtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PT0gJ21kJykge1xuICAgICAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLnJlYnVpbGRDYWNoZSgpO1xuICAgICAgICAgIC8vIFJlZnJlc2ggZ3JhcGggdmlldyB3aGVuIG1ldGFkYXRhIGNoYW5nZXMgKHRvIHVwZGF0ZSB2aXNpYmxlIG5vZGVzKVxuICAgICAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xuICAgICAgICAgICAgdGhpcy5ncmFwaFZpZXdTZXJ2aWNlLnJlZnJlc2hHcmFwaFZpZXcoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gUmVmcmVzaCBiYWNrbGlua3Mgd2hlbiBtZXRhZGF0YSBjaGFuZ2VzXG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XG4gICAgICAgICAgICB0aGlzLmJhY2tsaW5rU2VydmljZS51cGRhdGVCYWNrbGlua3MoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gUmVmcmVzaCBleHBsb3JlciB3aGVuIG1ldGFkYXRhIGNoYW5nZXNcbiAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3Jlcikge1xuICAgICAgICAgICAgdGhpcy5leHBsb3JlclNlcnZpY2UudXBkYXRlRXhwbG9yZXIoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gUmVmcmVzaCB3aW5kb3cgZnJhbWUgd2hlbiBtZXRhZGF0YSBjaGFuZ2VzXG4gICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yV2luZG93RnJhbWUpIHtcbiAgICAgICAgICAgIHRoaXMud2luZG93RnJhbWVTZXJ2aWNlLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG5cbiAgICB0aGlzLnJlZ2lzdGVyRXZlbnQoXG4gICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLm9uKCdyZXNvbHZlZCcsICgpID0+IHtcbiAgICAgICAgLy8gUmVidWlsZCBjYWNoZSB3aGVuIG1ldGFkYXRhIGNhY2hlIGlzIGZ1bGx5IHJlc29sdmVkXG4gICAgICAgIHRoaXMuY2FjaGVTZXJ2aWNlLnJlYnVpbGRDYWNoZSgpO1xuICAgICAgfSlcbiAgICApO1xuXG4gICAgLy8gUmVnaXN0ZXIgZHJhZyBhbmQgZHJvcCBldmVudCBoYW5kbGluZ1xuICAgIHRoaXMucmVnaXN0ZXJFdmVudChcbiAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5vbignZWRpdG9yLWRyb3AnLCAoZXZlbnQsIGVkaXRvcikgPT4ge1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcCkge1xuICAgICAgICAgIHRoaXMuZHJhZ0Ryb3BTZXJ2aWNlLmhhbmRsZURyYWdEcm9wKGV2ZW50LCBlZGl0b3IpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICk7XG5cbiAgICAvLyBBbHNvIHRyeSBET00gZXZlbnRzIGFzIGJhY2t1cFxuICAgIHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgJ2Ryb3AnLCAoZXZlbnQpID0+IHtcbiAgICAgIGlmICh0aGlzLnNldHRpbmdzLmVuYWJsZUZvckRyYWdEcm9wKSB7XG4gICAgICAgIHRoaXMuZHJhZ0Ryb3BTZXJ2aWNlLmhhbmRsZURPTURyb3AoZXZlbnQpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gTm90ZTogTW9iaWxlIHF1aWNrIHN3aXRjaGVyIGlzIGhhbmRsZWQgYnkgdGhlIFF1aWNrU3dpdGNoZXJTZXJ2aWNlXG4gICAgLy8gd2hpY2ggb3ZlcnJpZGVzIHRoZSAnc3dpdGNoZXI6b3BlbicgY29tbWFuZC4gVGhlIHF1aWNrLXByZXZpZXcgZXZlbnRcbiAgICAvLyB3YXMgY2F1c2luZyBjb25mbGljdHMgd2l0aCBub3JtYWwgdHlwaW5nLCBzbyB3ZSByZW1vdmVkIHRoYXQgYXBwcm9hY2guXG5cbiAgICAvLyBSZWdpc3RlciBjb21tYW5kc1xuICAgIHJlZ2lzdGVyQ29tbWFuZHModGhpcyk7XG5cbiAgICAvLyBBZGQgc2V0dGluZyB0YWJcbiAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcbiAgfVxuXG4gIHVwZGF0ZUxpbmtTdWdnZXN0ZXIoKSB7XG4gICAgY29uc3QgZWRpdG9yU3VnZ2VzdCA9ICh0aGlzLmFwcC53b3Jrc3BhY2UgYXMgV29ya3NwYWNlSW50ZXJuYWwpLmVkaXRvclN1Z2dlc3Q7XG4gICAgaWYgKCFlZGl0b3JTdWdnZXN0KSByZXR1cm47XG5cbiAgICBpZiAodGhpcy5zdWdnZXN0KSB7XG4gICAgICBlZGl0b3JTdWdnZXN0LnN1Z2dlc3RzID0gZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cy5maWx0ZXIoKHM6IEVkaXRvclN1Z2dlc3QpID0+IHMgIT09IHRoaXMuc3VnZ2VzdCk7XG4gICAgICB0aGlzLnN1Z2dlc3QgPSB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZykge1xuICAgICAgdGhpcy5zdWdnZXN0ID0gbmV3IExpbmtUaXRsZVN1Z2dlc3QodGhpcyk7XG4gICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yU3VnZ2VzdCh0aGlzLnN1Z2dlc3QpO1xuICAgICAgdGhpcy5jYWNoZVNlcnZpY2Uuc2V0U3VnZ2VzdCh0aGlzLnN1Z2dlc3QpO1xuICAgICAgZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cyA9IGVkaXRvclN1Z2dlc3Quc3VnZ2VzdHMuZmlsdGVyKChzOiBFZGl0b3JTdWdnZXN0KSA9PiAhcy5jb25zdHJ1Y3Rvci5uYW1lLmluY2x1ZGVzKCdMaW5rU3VnZ2VzdCcpKTtcbiAgICAgIGVkaXRvclN1Z2dlc3Quc3VnZ2VzdHMudW5zaGlmdCh0aGlzLnN1Z2dlc3QpO1xuICAgIH1cbiAgfVxuXG4gIHVwZGF0ZVF1aWNrU3dpdGNoZXIoKSB7XG4gICAgdGhpcy5xdWlja1N3aXRjaGVyU2VydmljZS51cGRhdGVRdWlja1N3aXRjaGVyKCk7XG4gIH1cblxuICB1cGRhdGVHcmFwaFZpZXcoKSB7XG4gICAgdGhpcy5ncmFwaFZpZXdTZXJ2aWNlLnVwZGF0ZUdyYXBoVmlldygpO1xuICB9XG5cbiAgdXBkYXRlQmFja2xpbmtzKCkge1xuICAgIHRoaXMuYmFja2xpbmtTZXJ2aWNlLnVwZGF0ZUJhY2tsaW5rcygpO1xuICB9XG5cbiAgdXBkYXRlVGFicygpIHtcbiAgICB0aGlzLnRhYlNlcnZpY2UudXBkYXRlVGFicygpO1xuICB9XG5cbiAgdXBkYXRlRXhwbG9yZXIoKSB7XG4gICAgdGhpcy5leHBsb3JlclNlcnZpY2UudXBkYXRlRXhwbG9yZXIoKTtcbiAgfVxuXG4gIHVwZGF0ZVdpbmRvd0ZyYW1lKCkge1xuICAgIHRoaXMud2luZG93RnJhbWVTZXJ2aWNlLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XG4gIH1cblxuICByZWJ1aWxkQ2FjaGUoKSB7XG4gICAgdGhpcy5jYWNoZVNlcnZpY2UucmVidWlsZENhY2hlKCk7XG4gIH1cblxuICBvbnVubG9hZCgpIHtcbiAgICAvLyBDbGVhbiB1cCBlZGl0b3Igc3VnZ2VzdGVyXG4gICAgY29uc3QgZWRpdG9yU3VnZ2VzdCA9ICh0aGlzLmFwcC53b3Jrc3BhY2UgYXMgV29ya3NwYWNlSW50ZXJuYWwpLmVkaXRvclN1Z2dlc3Q7XG4gICAgaWYgKGVkaXRvclN1Z2dlc3QgJiYgdGhpcy5zdWdnZXN0KSB7XG4gICAgICBlZGl0b3JTdWdnZXN0LnN1Z2dlc3RzID0gZWRpdG9yU3VnZ2VzdC5zdWdnZXN0cy5maWx0ZXIoKHM6IEVkaXRvclN1Z2dlc3QpID0+IHMgIT09IHRoaXMuc3VnZ2VzdCk7XG4gICAgfVxuXG4gICAgLy8gUmVzdG9yZSB0aGUgb3JpZ2luYWwgUXVpY2sgU3dpdGNoZXIgY29tbWFuZFxuICAgIHRoaXMucXVpY2tTd2l0Y2hlclNlcnZpY2UucmVzdG9yZU9yaWdpbmFsQ29tbWFuZCgpO1xuXG4gICAgLy8gQ2xlYW4gdXAgZ3JhcGggdmlld1xuICAgIHRoaXMuZ3JhcGhWaWV3U2VydmljZS5vbnVubG9hZCgpO1xuXG4gICAgLy8gQ2xlYW4gdXAgYmFja2xpbmtzIHNlcnZpY2VcbiAgICB0aGlzLmJhY2tsaW5rU2VydmljZS5vbnVubG9hZCgpO1xuXG4gICAgLy8gQ2xlYW4gdXAgdGFiIHNlcnZpY2VcbiAgICB0aGlzLnRhYlNlcnZpY2Uub251bmxvYWQoKTtcblxuICAgIC8vIENsZWFuIHVwIGV4cGxvcmVyIHNlcnZpY2VcbiAgICB0aGlzLmV4cGxvcmVyU2VydmljZS5vbnVubG9hZCgpO1xuXG4gICAgLy8gQ2xlYW4gdXAgd2luZG93IGZyYW1lIHNlcnZpY2VcbiAgICB0aGlzLndpbmRvd0ZyYW1lU2VydmljZS5vbnVubG9hZCgpO1xuICB9XG5cbiAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgIGNvbnN0IGxvYWRlZERhdGEgPSAoYXdhaXQgdGhpcy5sb2FkRGF0YSgpKSBhcyBQbHVnaW5TZXR0aW5ncyB8IG51bGw7XG4gICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGxvYWRlZERhdGEgPz8ge30pO1xuICB9XG5cbiAgYXN5bmMgc2F2ZVNldHRpbmdzKHByZXZRdWlja1N3aXRjaGVyU3RhdGU/OiBib29sZWFuLCBwcmV2VGFiU3RhdGU/OiBib29sZWFuKSB7XG4gICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICAvLyBPbmx5IHVwZGF0ZSBjb21wb25lbnRzIHdoZW4gcmVsZXZhbnQgc2V0dGluZ3MgY2hhbmdlXG4gICAgaWYgKHByZXZRdWlja1N3aXRjaGVyU3RhdGUgIT09IHVuZGVmaW5lZCAmJiBwcmV2UXVpY2tTd2l0Y2hlclN0YXRlICE9PSB0aGlzLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIpIHtcbiAgICAgIHRoaXMudXBkYXRlUXVpY2tTd2l0Y2hlcigpO1xuICAgIH1cbiAgICBpZiAocHJldlRhYlN0YXRlICE9PSB1bmRlZmluZWQgJiYgcHJldlRhYlN0YXRlICE9PSB0aGlzLnNldHRpbmdzLmVuYWJsZUZvclRhYnMpIHtcbiAgICAgIC8vIEFsd2F5cyByZS1yZWdpc3RlciBldmVudHMgdG8gZW5zdXJlIHRhYnMgYXJlIG1hcmtlZCBhcyBwcm9jZXNzZWRcbiAgICAgIC8vIChldmVuIHdoZW4gZGlzYWJsZWQsIHdlIG5lZWQgdG8gbWFyayB0YWJzIHNvIHRoZXkncmUgdmlzaWJsZSlcbiAgICAgIHZvaWQgdGhpcy50YWJTZXJ2aWNlLnJlZ2lzdGVyRXZlbnRzKCk7XG4gICAgICB0aGlzLnVwZGF0ZVRhYnMoKTtcbiAgICB9XG4gIH1cbn1cbiIsICJpbXBvcnQgeyBQbHVnaW5TZXR0aW5ncyB9IGZyb20gJy4vdHlwZXMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IFBsdWdpblNldHRpbmdzID0ge1xyXG4gIHByb3BlcnR5S2V5OiAndGl0bGUnLFxyXG4gIGVuYWJsZUZvckxpbmtpbmc6IHRydWUsXHJcbiAgZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcjogdHJ1ZSxcclxuICBpbmNsdWRlRmlsZW5hbWVJblNlYXJjaDogdHJ1ZSxcclxuICBpbmNsdWRlQWxpYXNlc0luU2VhcmNoOiB0cnVlLFxyXG4gIGVuYWJsZUZvckRyYWdEcm9wOiB0cnVlLFxyXG4gIHVzZVNpbXBsZVNlYXJjaDogZmFsc2UsXHJcbiAgZW5hYmxlRm9yR3JhcGhWaWV3OiB0cnVlLFxyXG4gIGVuYWJsZUZvckJhY2tsaW5rczogdHJ1ZSxcclxuICBlbmFibGVGb3JUYWJzOiB0cnVlLFxyXG4gIGVuYWJsZUZvckV4cGxvcmVyOiBmYWxzZSxcclxuICBmb2xkZXJOb3RlRmlsZW5hbWU6ICcnLFxyXG4gIGVuYWJsZUZvcldpbmRvd0ZyYW1lOiB0cnVlLFxyXG59O1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IFBsdWdpblNldHRpbmdzKTogeyBpc1ZhbGlkOiBib29sZWFuOyBlcnJvcnM6IHN0cmluZ1tdIH0ge1xyXG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXTtcclxuICBcclxuICBpZiAoIXNldHRpbmdzLnByb3BlcnR5S2V5IHx8IHNldHRpbmdzLnByb3BlcnR5S2V5LnRyaW0oKSA9PT0gJycpIHtcclxuICAgIGVycm9ycy5wdXNoKCdQcm9wZXJ0eSBrZXkgY2Fubm90IGJlIGVtcHR5Jyk7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiB7XHJcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxyXG4gICAgZXJyb3JzXHJcbiAgfTtcclxufVxyXG4iLCAiaW1wb3J0IHsgRWRpdG9yLCBFZGl0b3JQb3NpdGlvbiwgRWRpdG9yU3VnZ2VzdCwgRWRpdG9yU3VnZ2VzdENvbnRleHQsIEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbywgTWFya2Rvd25WaWV3LCBOb3RpY2UsIFRGaWxlLCBwcmVwYXJlRnV6enlTZWFyY2gsIHByZXBhcmVTaW1wbGVTZWFyY2gsIFNlYXJjaFJlc3VsdCwgc29ydFNlYXJjaFJlc3VsdHMgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBTdWdnZXN0aW9uSXRlbSwgQ2FjaGVkRmlsZURhdGEsIEVkaXRvclN1Z2dlc3RJbnRlcm5hbCwgU2VhcmNoTWF0Y2hSZWFzb24sIFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBWYXVsdEludGVybmFsLCBRdWlja1N3aXRjaGVyUGx1Z2luSW5zdGFuY2UsIEFwcEludGVybmFsIH0gZnJvbSAnLi4vdHlwZXMnO1xuaW1wb3J0IHsgYnVpbGRGaWxlQ2FjaGUgfSBmcm9tICcuLi91dGlscy9zZWFyY2gnO1xuXG5leHBvcnQgY2xhc3MgTGlua1RpdGxlU3VnZ2VzdCBleHRlbmRzIEVkaXRvclN1Z2dlc3Q8U3VnZ2VzdGlvbkl0ZW0+IHtcbiAgcHJpdmF0ZSBwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xuICBwcml2YXRlIGZpbGVDYWNoZTogTWFwPHN0cmluZywgQ2FjaGVkRmlsZURhdGE+ID0gbmV3IE1hcCgpO1xuICBwcml2YXRlIHNlYXJjaFRpbWVvdXQ6IG51bWJlciB8IG51bGwgPSBudWxsO1xuICBwcml2YXRlIG1hdGNoUmVhc29uczogTWFwPHN0cmluZywgU2VhcmNoTWF0Y2hSZWFzb24+ID0gbmV3IE1hcCgpO1xuXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcbiAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB0aGlzLmJ1aWxkRmlsZUNhY2hlKCk7XG4gIH1cblxuICBvcGVuKCk6IHZvaWQge1xuICAgIHN1cGVyLm9wZW4oKTtcbiAgICBjb25zdCBlbCA9ICh0aGlzIGFzIEVkaXRvclN1Z2dlc3RJbnRlcm5hbCkuc3VnZ2VzdEVsO1xuICAgIGlmIChlbCkge1xuICAgICAgLy8gQWRkIHNjb3BpbmcgY2xhc3MgdG8gcHJldmVudCBDU1MgZnJvbSBhZmZlY3Rpbmcgb3RoZXIgc3VnZ2VzdGlvbiBzeXN0ZW1zXG4gICAgICBlbC5hZGRDbGFzcygncHJvcGVydHktb3Zlci1maWxlbmFtZS1zdWdnZXN0aW9uJyk7XG4gICAgICBcbiAgICAgIGlmICghZWwucXVlcnlTZWxlY3RvcignLnByb21wdC1pbnN0cnVjdGlvbnMnKSkge1xuICAgICAgICBjb25zdCBpbnN0cnVjdGlvbnMgPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdwcm9tcHQtaW5zdHJ1Y3Rpb25zJyB9KTtcbiAgICAgICAgaW5zdHJ1Y3Rpb25zLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbicgfSkuc2V0VGV4dCgnVHlwZSAjIHRvIGxpbmsgaGVhZGluZycpO1xuICAgICAgICBpbnN0cnVjdGlvbnMuY3JlYXRlRGl2KHsgY2xzOiAncHJvbXB0LWluc3RydWN0aW9uJyB9KS5zZXRUZXh0KCdUeXBlIF4gdG8gbGluayBibG9ja3MnKTtcbiAgICAgICAgaW5zdHJ1Y3Rpb25zLmNyZWF0ZURpdih7IGNsczogJ3Byb21wdC1pbnN0cnVjdGlvbicgfSkuc2V0VGV4dCgnVHlwZSB8IHRvIGNoYW5nZSBkaXNwbGF5IHRleHQnKTtcbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIGtleWJvYXJkIG5hdmlnYXRpb24gaW1wcm92ZW1lbnRzXG4gICAgdGhpcy5hZGRLZXlib2FyZE5hdmlnYXRpb24oKTtcbiAgfVxuXG4gIHByaXZhdGUgYWRkS2V5Ym9hcmROYXZpZ2F0aW9uKCk6IHZvaWQge1xuICAgIGNvbnN0IGVsID0gKHRoaXMgYXMgRWRpdG9yU3VnZ2VzdEludGVybmFsKS5zdWdnZXN0RWw7XG4gICAgaWYgKCFlbCkgcmV0dXJuO1xuXG4gICAgLy8gQWRkIGVzY2FwZSBrZXkgaGFuZGxpbmdcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGUpID0+IHtcbiAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBvblRyaWdnZXIoY3Vyc29yOiBFZGl0b3JQb3NpdGlvbiwgZWRpdG9yOiBFZGl0b3IsIGZpbGU6IFRGaWxlIHwgbnVsbCk6IEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyB8IG51bGwge1xuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yTGlua2luZykgcmV0dXJuIG51bGw7XG4gICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKS5zdWJzdHJpbmcoMCwgY3Vyc29yLmNoKTtcbiAgICBjb25zdCBtYXRjaCA9IC9cXFtcXFsoW14jXnxcXF1dKikkLy5leGVjKGxpbmUpO1xuICAgIGlmIChtYXRjaCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3RhcnQ6IHsgbGluZTogY3Vyc29yLmxpbmUsIGNoOiBsaW5lLmxhc3RJbmRleE9mKCdbWycpIH0sXG4gICAgICAgIGVuZDogY3Vyc29yLFxuICAgICAgICBxdWVyeTogbWF0Y2hbMV0sXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGJ1aWxkRmlsZUNhY2hlKCk6IHZvaWQge1xuICAgIHRoaXMuZmlsZUNhY2hlID0gYnVpbGRGaWxlQ2FjaGUoXG4gICAgICB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCksXG4gICAgICB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLFxuICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXlcbiAgICApO1xuICB9XG5cbiAgdXBkYXRlRmlsZUNhY2hlKGZpbGU6IFRGaWxlKTogdm9pZCB7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlcjtcbiAgICBsZXQgZGlzcGxheU5hbWUgPSBmaWxlLmJhc2VuYW1lO1xuICAgIGxldCBpc0N1c3RvbURpc3BsYXkgPSBmYWxzZTtcbiAgICBsZXQgYWxpYXNlczogc3RyaW5nW10gPSBbXTtcblxuICAgIGlmIChmcm9udG1hdHRlciAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlclt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldKS50cmltKCk7XG4gICAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcbiAgICAgICAgZGlzcGxheU5hbWUgPSBwcm9wZXJ0eVZhbHVlO1xuICAgICAgICBpc0N1c3RvbURpc3BsYXkgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmcm9udG1hdHRlcj8uYWxpYXNlcykge1xuICAgICAgY29uc3QgYWxpYXNlc1JhdyA9IGZyb250bWF0dGVyLmFsaWFzZXMgYXMgdW5rbm93bjtcbiAgICAgIGFsaWFzZXMgPSBBcnJheS5pc0FycmF5KGFsaWFzZXNSYXcpID8gYWxpYXNlc1Jhdy5tYXAoYSA9PiBTdHJpbmcoYSkpIDogW1N0cmluZyhhbGlhc2VzUmF3KV07XG4gICAgICBhbGlhc2VzID0gYWxpYXNlcy5tYXAoYWxpYXMgPT4gYWxpYXMudHJpbSgpKS5maWx0ZXIoYWxpYXMgPT4gYWxpYXMgIT09ICcnKTtcbiAgICB9XG5cbiAgICB0aGlzLmZpbGVDYWNoZS5zZXQoZmlsZS5wYXRoLCB7XG4gICAgICBmaWxlLFxuICAgICAgZGlzcGxheU5hbWUsXG4gICAgICBhbGlhc2VzLFxuICAgICAgbGFzdE1vZGlmaWVkOiBmaWxlLnN0YXQubXRpbWUsXG4gICAgICBpc0N1c3RvbURpc3BsYXlcbiAgICB9KTtcbiAgfVxuXG4gIGdldFN1Z2dlc3Rpb25zKGNvbnRleHQ6IEVkaXRvclN1Z2dlc3RDb250ZXh0KTogU3VnZ2VzdGlvbkl0ZW1bXSB7XG4gICAgY29uc3QgcXVlcnkgPSBjb250ZXh0LnF1ZXJ5LnRyaW0oKTtcbiAgICByZXR1cm4gdGhpcy5wZXJmb3JtU2VhcmNoKHF1ZXJ5KTtcbiAgfVxuXG4gIHByaXZhdGUgcGVyZm9ybVNlYXJjaChxdWVyeTogc3RyaW5nKTogU3VnZ2VzdGlvbkl0ZW1bXSB7XG4gICAgLy8gSWYgbm8gcXVlcnksIHNob3cgYWxsIGZpbGVzXG4gICAgaWYgKCFxdWVyeSB8fCBxdWVyeS50cmltKCkgPT09ICcnKSB7XG4gICAgICBjb25zdCBzdWdnZXN0aW9uczogU3VnZ2VzdGlvbkl0ZW1bXSA9IFtdO1xuICAgICAgZm9yIChjb25zdCBjYWNoZWREYXRhIG9mIHRoaXMuZmlsZUNhY2hlLnZhbHVlcygpKSB7XG4gICAgICAgIHN1Z2dlc3Rpb25zLnB1c2goeyBcbiAgICAgICAgICBmaWxlOiBjYWNoZWREYXRhLmZpbGUsIFxuICAgICAgICAgIGRpc3BsYXk6IGNhY2hlZERhdGEuZGlzcGxheU5hbWUsIFxuICAgICAgICAgIGlzQ3VzdG9tRGlzcGxheTogY2FjaGVkRGF0YS5pc0N1c3RvbURpc3BsYXkgXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgIH1cblxuICAgIC8vIFVzZSBzaW1wbGUgc2VhcmNoIGZvciBsYXJnZSB2YXVsdHMgaWYgZW5hYmxlZCwgb3RoZXJ3aXNlIHVzZSBmdXp6eSBzZWFyY2hcbiAgICBjb25zdCBzZWFyY2ggPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTaW1wbGVTZWFyY2ggXG4gICAgICA/IHByZXBhcmVTaW1wbGVTZWFyY2gocXVlcnkpXG4gICAgICA6IHByZXBhcmVGdXp6eVNlYXJjaChxdWVyeSk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGEgc3RydWN0dXJlIGNvbXBhdGlibGUgd2l0aCBzb3J0U2VhcmNoUmVzdWx0c1xuICAgIGludGVyZmFjZSBTZWFyY2hhYmxlU3VnZ2VzdGlvbiB7XG4gICAgICBpdGVtOiBTdWdnZXN0aW9uSXRlbTtcbiAgICAgIG1hdGNoOiBTZWFyY2hSZXN1bHQ7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHNlYXJjaGFibGVTdWdnZXN0aW9uczogU2VhcmNoYWJsZVN1Z2dlc3Rpb25bXSA9IFtdO1xuICAgIHRoaXMubWF0Y2hSZWFzb25zLmNsZWFyKCk7IC8vIENsZWFyIHByZXZpb3VzIG1hdGNoIHJlYXNvbnNcblxuICAgIC8vIFVzZSBjYWNoZWQgZGF0YSBmb3IgbXVjaCBmYXN0ZXIgc2VhcmNoXG4gICAgZm9yIChjb25zdCBjYWNoZWREYXRhIG9mIHRoaXMuZmlsZUNhY2hlLnZhbHVlcygpKSB7XG4gICAgICBjb25zdCB7IGZpbGUsIGRpc3BsYXlOYW1lLCBhbGlhc2VzLCBpc0N1c3RvbURpc3BsYXkgfSA9IGNhY2hlZERhdGE7XG4gICAgICBcbiAgICAgIC8vIFRyYWNrIHdoaWNoIGZpZWxkcyBjYXVzZWQgdGhlIG1hdGNoXG4gICAgICBjb25zdCBtYXRjaFJlYXNvbjogU2VhcmNoTWF0Y2hSZWFzb24gPSB7XG4gICAgICAgIG1hdGNoZWRJblRpdGxlOiBmYWxzZSxcbiAgICAgICAgbWF0Y2hlZEluRmlsZW5hbWU6IGZhbHNlLFxuICAgICAgICBtYXRjaGVkSW5BbGlhczogZmFsc2VcbiAgICAgIH07XG4gICAgICBcbiAgICAgIC8vIFByaW1hcnkgbWF0Y2g6IHNlYXJjaCB0aXRsZS9wcm9wZXJ0eSBmaXJzdCAob25seSBpZiBub3RlIGhhcyBjdXN0b20gZGlzcGxheSlcbiAgICAgIGxldCBwcmltYXJ5TWF0Y2g6IFNlYXJjaFJlc3VsdCB8IG51bGwgPSBudWxsO1xuICAgICAgbGV0IGJlc3RNYXRjaDogU2VhcmNoUmVzdWx0IHwgbnVsbCA9IG51bGw7XG4gICAgICBsZXQgbWF0Y2hUeXBlOiAndGl0bGUnIHwgJ2ZpbGVuYW1lJyB8ICdhbGlhcycgfCBudWxsID0gbnVsbDtcbiAgICAgIFxuICAgICAgaWYgKGlzQ3VzdG9tRGlzcGxheSkge1xuICAgICAgICAvLyBPbmx5IHNlYXJjaCB0aXRsZS9wcm9wZXJ0eSBpZiBub3RlIGFjdHVhbGx5IGhhcyBhIGN1c3RvbSBwcm9wZXJ0eVxuICAgICAgICBwcmltYXJ5TWF0Y2ggPSBzZWFyY2goZGlzcGxheU5hbWUpO1xuICAgICAgICBpZiAocHJpbWFyeU1hdGNoICYmIHByaW1hcnlNYXRjaC5tYXRjaGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5UaXRsZSA9IHRydWU7XG4gICAgICAgICAgYmVzdE1hdGNoID0gcHJpbWFyeU1hdGNoO1xuICAgICAgICAgIG1hdGNoVHlwZSA9ICd0aXRsZSc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSWYgbm8gdGl0bGUgbWF0Y2ggKG9yIG5vdGUgZG9lc24ndCBoYXZlIHByb3BlcnR5KSwgc2VhcmNoIGZpbGVuYW1lXG4gICAgICBpZiAoIW1hdGNoVHlwZSkge1xuICAgICAgICAvLyBTZWFyY2ggZmlsZW5hbWUgaWYgaXQncyBkaWZmZXJlbnQgZnJvbSBkaXNwbGF5TmFtZSwgb3IgaWYgbm90ZSBkb2Vzbid0IGhhdmUgcHJvcGVydHlcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVGaWxlbmFtZUluU2VhcmNoICYmIGZpbGUuYmFzZW5hbWUgIT09IGRpc3BsYXlOYW1lKSB7XG4gICAgICAgICAgY29uc3QgZmlsZW5hbWVNYXRjaCA9IHNlYXJjaChmaWxlLmJhc2VuYW1lKTtcbiAgICAgICAgICBpZiAoZmlsZW5hbWVNYXRjaCAmJiBmaWxlbmFtZU1hdGNoLm1hdGNoZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEluRmlsZW5hbWUgPSB0cnVlO1xuICAgICAgICAgICAgLy8gRG93bnJhbmsgZmlsZW5hbWUgbWF0Y2hlcyBieSAtMVxuICAgICAgICAgICAgYmVzdE1hdGNoID0geyAuLi5maWxlbmFtZU1hdGNoLCBzY29yZTogZmlsZW5hbWVNYXRjaC5zY29yZSAtIDEgfTtcbiAgICAgICAgICAgIG1hdGNoVHlwZSA9ICdmaWxlbmFtZSc7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKCFpc0N1c3RvbURpc3BsYXkpIHtcbiAgICAgICAgICAvLyBJZiBub3RlIGRvZXNuJ3QgaGF2ZSBwcm9wZXJ0eSwgZGlzcGxheU5hbWUgZXF1YWxzIGZpbGVuYW1lLCBzbyBzZWFyY2ggZmlsZW5hbWVcbiAgICAgICAgICBjb25zdCBmaWxlbmFtZU1hdGNoID0gc2VhcmNoKGZpbGUuYmFzZW5hbWUpO1xuICAgICAgICAgIGlmIChmaWxlbmFtZU1hdGNoICYmIGZpbGVuYW1lTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSA9IHRydWU7XG4gICAgICAgICAgICBiZXN0TWF0Y2ggPSBmaWxlbmFtZU1hdGNoO1xuICAgICAgICAgICAgbWF0Y2hUeXBlID0gJ2ZpbGVuYW1lJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgICAvLyBUZXJ0aWFyeSBtYXRjaDogc2VhcmNoIGFsaWFzZXMgKHdpdGggZG93bnJhbmtpbmcpXG4gICAgICAgIGlmICghbWF0Y2hUeXBlICYmIHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVBbGlhc2VzSW5TZWFyY2ggJiYgYWxpYXNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgZm9yIChjb25zdCBhbGlhcyBvZiBhbGlhc2VzKSB7XG4gICAgICAgICAgICBjb25zdCBhbGlhc01hdGNoID0gc2VhcmNoKGFsaWFzKTtcbiAgICAgICAgICAgIGlmIChhbGlhc01hdGNoICYmIGFsaWFzTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgIG1hdGNoUmVhc29uLm1hdGNoZWRJbkFsaWFzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgbWF0Y2hSZWFzb24ubWF0Y2hlZEFsaWFzVGV4dCA9IGFsaWFzOyAvLyBTdG9yZSB3aGljaCBhbGlhcyBtYXRjaGVkXG4gICAgICAgICAgICAgIC8vIERvd25yYW5rIGFsaWFzIG1hdGNoZXMgYnkgLTFcbiAgICAgICAgICAgICAgYmVzdE1hdGNoID0geyAuLi5hbGlhc01hdGNoLCBzY29yZTogYWxpYXNNYXRjaC5zY29yZSAtIDEgfTtcbiAgICAgICAgICAgICAgbWF0Y2hUeXBlID0gJ2FsaWFzJztcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICBcbiAgICAgIC8vIElmIHdlIGhhdmUgYW55IG1hdGNoLCBhZGQgdG8gcmVzdWx0c1xuICAgICAgaWYgKGJlc3RNYXRjaCAmJiBiZXN0TWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb246IFN1Z2dlc3Rpb25JdGVtID0geyBcbiAgICAgICAgICBmaWxlLCBcbiAgICAgICAgICBkaXNwbGF5OiBkaXNwbGF5TmFtZSwgXG4gICAgICAgICAgaXNDdXN0b21EaXNwbGF5IFxuICAgICAgICB9O1xuICAgICAgICBzZWFyY2hhYmxlU3VnZ2VzdGlvbnMucHVzaCh7IGl0ZW06IHN1Z2dlc3Rpb24sIG1hdGNoOiBiZXN0TWF0Y2ggfSk7XG4gICAgICAgIHRoaXMubWF0Y2hSZWFzb25zLnNldChmaWxlLnBhdGgsIG1hdGNoUmVhc29uKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGQgdW5yZXNvbHZlZCBsaW5rcyBpZiBcIlNob3cgZXhpc3Rpbmcgb25seVwiIGlzIGRpc2FibGVkXG4gICAgLy8gVGhpcyBtYXRjaGVzIFF1aWNrIFN3aXRjaCArKyBiZWhhdmlvcjogdW5yZXNvbHZlZDogIXNldHRpbmdzLnNob3dFeGlzdGluZ09ubHlcbiAgICBjb25zdCBxdWlja1N3aXRjaGVyT3B0aW9ucyA9IHRoaXMuZ2V0UXVpY2tTd2l0Y2hlck9wdGlvbnMoKTtcbiAgICBjb25zdCBzaG93RXhpc3RpbmdPbmx5ID0gcXVpY2tTd2l0Y2hlck9wdGlvbnM/LnNob3dFeGlzdGluZ09ubHkgPz8gZmFsc2U7XG4gICAgXG4gICAgaWYgKCFzaG93RXhpc3RpbmdPbmx5KSB7XG4gICAgICAvLyBHZXQgdW5yZXNvbHZlZCBsaW5rcyBmcm9tIG1ldGFkYXRhIGNhY2hlIChsaWtlIFF1aWNrIFN3aXRjaCArKyBkb2VzKVxuICAgICAgY29uc3QgeyB1bnJlc29sdmVkTGlua3MgfSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGU7XG4gICAgICBjb25zdCB1bnJlc29sdmVkU2V0ID0gbmV3IFNldDxzdHJpbmc+KCk7XG4gICAgICBcbiAgICAgIC8vIENvbGxlY3QgYWxsIHVucmVzb2x2ZWQgbGlua3MgZnJvbSBhbGwgZmlsZXNcbiAgICAgIGZvciAoY29uc3Qgc291cmNlUGF0aCBpbiB1bnJlc29sdmVkTGlua3MpIHtcbiAgICAgICAgY29uc3QgbGlua3MgPSBPYmplY3Qua2V5cyh1bnJlc29sdmVkTGlua3Nbc291cmNlUGF0aF0pO1xuICAgICAgICBsaW5rcy5mb3JFYWNoKGxpbmsgPT4gdW5yZXNvbHZlZFNldC5hZGQobGluaykpO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBTZWFyY2ggdW5yZXNvbHZlZCBsaW5rcyBhbmQgYWRkIG1hdGNoZXNcbiAgICAgIGZvciAoY29uc3QgdW5yZXNvbHZlZCBvZiB1bnJlc29sdmVkU2V0KSB7XG4gICAgICAgIGNvbnN0IHVucmVzb2x2ZWRNYXRjaCA9IHNlYXJjaCh1bnJlc29sdmVkKTtcbiAgICAgICAgaWYgKHVucmVzb2x2ZWRNYXRjaCAmJiB1bnJlc29sdmVkTWF0Y2gubWF0Y2hlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgLy8gQWRkIGFzIGEgc3VnZ2VzdGlvbiB3aXRob3V0IGEgZmlsZSAodW5yZXNvbHZlZCBsaW5rKVxuICAgICAgICAgIHNlYXJjaGFibGVTdWdnZXN0aW9ucy5wdXNoKHtcbiAgICAgICAgICAgIGl0ZW06IHtcbiAgICAgICAgICAgICAgZGlzcGxheTogdW5yZXNvbHZlZCxcbiAgICAgICAgICAgICAgaXNDdXN0b21EaXNwbGF5OiBmYWxzZSxcbiAgICAgICAgICAgICAgLy8gTm8gZmlsZSBwcm9wZXJ0eSBtZWFucyBpdCdzIHVucmVzb2x2ZWRcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtYXRjaDogdW5yZXNvbHZlZE1hdGNoXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBVc2UgT2JzaWRpYW4ncyBuYXRpdmUgc29ydGluZyBmb3IgZXhhY3QgdmFuaWxsYSBjb21wYXRpYmlsaXR5XG4gICAgc29ydFNlYXJjaFJlc3VsdHMoc2VhcmNoYWJsZVN1Z2dlc3Rpb25zKTtcbiAgICBcbiAgICAvLyBFeHRyYWN0IHN1Z2dlc3Rpb25zIGZyb20gc29ydGVkIHJlc3VsdHNcbiAgICBsZXQgc3VnZ2VzdGlvbnMgPSBzZWFyY2hhYmxlU3VnZ2VzdGlvbnMubWFwKHMgPT4gcy5pdGVtKTtcbiAgICBcbiAgICAvLyBGaWx0ZXIgb3V0IHVucmVzb2x2ZWQgbGlua3MgaWYgXCJTaG93IGV4aXN0aW5nIG9ubHlcIiBpcyBlbmFibGVkXG4gICAgLy8gVW5yZXNvbHZlZCBsaW5rcyBhcmUgaXRlbXMgd2l0aG91dCBhIGZpbGUgcHJvcGVydHlcbiAgICBpZiAoc2hvd0V4aXN0aW5nT25seSkge1xuICAgICAgc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9ucy5maWx0ZXIocyA9PiBzLmZpbGUgIT09IHVuZGVmaW5lZCk7XG4gICAgfVxuXG4gICAgLy8gTGluayBzdWdnZXN0ZXIgc2hvdWxkIE5PVCBzaG93IFwiY3JlYXRlIG5ldyBub3RlXCIgb3B0aW9uIC0gdGhhdCdzIFF1aWNrIFN3aXRjaGVyIGJlaGF2aW9yXG4gICAgLy8gQnV0IGlmIHRoZXJlIGFyZSBubyBtYXRjaGVzIGFuZCB0aGVyZSdzIGEgcXVlcnksIHNob3cgXCJObyBtYXRjaCBmb3VuZFwiIGxpa2UgdmFuaWxsYSBPYnNpZGlhblxuICAgIGlmIChzdWdnZXN0aW9ucy5sZW5ndGggPT09IDAgJiYgcXVlcnkpIHtcbiAgICAgIHN1Z2dlc3Rpb25zLnB1c2goe1xuICAgICAgICBkaXNwbGF5OiAnTm8gbWF0Y2ggZm91bmQnLFxuICAgICAgICBpc0N1c3RvbURpc3BsYXk6IGZhbHNlLFxuICAgICAgICBpc05vTWF0Y2g6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gIH1cblxuICByZW5kZXJTdWdnZXN0aW9uKHN1Z2dlc3Rpb246IFN1Z2dlc3Rpb25JdGVtLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBlbC5lbXB0eSgpO1xuICAgIFxuICAgIGlmIChzdWdnZXN0aW9uLmlzTm9NYXRjaCkge1xuICAgICAgLy8gRm9yIFwiTm8gbWF0Y2ggZm91bmRcIiwgc2hvdyBqdXN0IHRoZSB0ZXh0XG4gICAgICBlbC5zZXRUZXh0KHN1Z2dlc3Rpb24uZGlzcGxheSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIGlmIChzdWdnZXN0aW9uLmZpbGUpIHtcbiAgICAgIC8vIEdldCB0aGUgbWF0Y2ggcmVhc29uIGZvciB0aGlzIGZpbGVcbiAgICAgIGNvbnN0IG1hdGNoUmVhc29uID0gdGhpcy5tYXRjaFJlYXNvbnMuZ2V0KHN1Z2dlc3Rpb24uZmlsZS5wYXRoKTtcbiAgICAgIFxuICAgICAgLy8gU3BlY2lhbCBjYXNlOiBub3RlcyB3aXRob3V0IHByb3BlcnR5IHRoYXQgbWF0Y2hlZCB2aWEgYWxpYXMgc2hvdWxkIHNob3cgYWxpYXMgd2l0aCBpY29uXG4gICAgICBpZiAoIXN1Z2dlc3Rpb24uaXNDdXN0b21EaXNwbGF5ICYmIG1hdGNoUmVhc29uPy5tYXRjaGVkSW5BbGlhcyAmJiBtYXRjaFJlYXNvbi5tYXRjaGVkQWxpYXNUZXh0KSB7XG4gICAgICAgIC8vIFNob3cgYWxpYXMgYXMgbWFpbiB0ZXh0LCBmaWxlbmFtZSBiZWxvdywgd2l0aCBhbGlhcyBpY29uIChsaWtlIGRlZmF1bHQgT2JzaWRpYW4pXG4gICAgICAgIGVsLmFkZENsYXNzKCdtb2QtY29tcGxleCcpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBNYWluIHRpdGxlIC0gc2hvdyB0aGUgYWxpYXMgdGhhdCBtYXRjaGVkXG4gICAgICAgIGNvbnN0IHRpdGxlRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcbiAgICAgICAgdGl0bGVFbC5zZXRUZXh0KG1hdGNoUmVhc29uLm1hdGNoZWRBbGlhc1RleHQpO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsZSBwYXRoIGJlbG93XG4gICAgICAgIGNvbnN0IHBhdGhFbCA9IHN1Z2dlc3Rpb25Db250ZW50LmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tbm90ZScgfSk7XG4gICAgICAgIHBhdGhFbC5zZXRUZXh0KHN1Z2dlc3Rpb24uZmlsZS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKSk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgc3VnZ2VzdGlvbi1hdXggd2l0aCBhbGlhcyBpY29uXG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25BdXggPSBlbC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLWF1eCcgfSk7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxuICAgICAgICAgIGNsczogJ3N1Z2dlc3Rpb24tZmxhaXInLCBcbiAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogJ0FsaWFzIE1hdGNoJyB9IFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgfSBlbHNlIGlmIChzdWdnZXN0aW9uLmlzQ3VzdG9tRGlzcGxheSkge1xuICAgICAgICAvLyBOb3RlcyB3aXRoIHRoZSBwcm9wZXJ0eSAtIGtlZXAgZXhpc3RpbmcgYmVoYXZpb3JcbiAgICAgICAgY29uc3Qgc2hvdWxkU2hvd0ljb24gPSBtYXRjaFJlYXNvbiAmJiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluVGl0bGUgfHwgbWF0Y2hSZWFzb24ubWF0Y2hlZEluRmlsZW5hbWUgfHwgbWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMpO1xuICAgICAgICBcbiAgICAgICAgaWYgKHNob3VsZFNob3dJY29uKSB7XG4gICAgICAgICAgLy8gQWRkIG1vZC1jb21wbGV4IGNsYXNzIHRvIG1hdGNoIE9ic2lkaWFuJ3Mgc3RydWN0dXJlXG4gICAgICAgICAgZWwuYWRkQ2xhc3MoJ21vZC1jb21wbGV4Jyk7XG5cbiAgICAgICAgICAvLyBDcmVhdGUgdGhlIG1haW4gc3VnZ2VzdGlvbiBjb250YWluZXJcbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQ29udGVudCA9IGVsLmNyZWF0ZURpdih7IGNsczogJ3N1Z2dlc3Rpb24tY29udGVudCcgfSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gTWFpbiB0aXRsZVxuICAgICAgICAgIGNvbnN0IHRpdGxlRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLXRpdGxlJyB9KTtcbiAgICAgICAgICB0aXRsZUVsLnNldFRleHQoc3VnZ2VzdGlvbi5kaXNwbGF5KTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBGaWxlIHBhdGggYmVsb3dcbiAgICAgICAgICBjb25zdCBwYXRoRWwgPSBzdWdnZXN0aW9uQ29udGVudC5jcmVhdGVEaXYoeyBjbHM6ICdzdWdnZXN0aW9uLW5vdGUnIH0pO1xuICAgICAgICAgIHBhdGhFbC5zZXRUZXh0KHN1Z2dlc3Rpb24uZmlsZS5wYXRoLnJlcGxhY2UoJy5tZCcsICcnKSk7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gQWRkIHN1Z2dlc3Rpb24tYXV4IHdpdGggYXBwcm9wcmlhdGUgaWNvbiBiYXNlZCBvbiBtYXRjaCByZWFzb25cbiAgICAgICAgICBjb25zdCBzdWdnZXN0aW9uQXV4ID0gZWwuY3JlYXRlRGl2KHsgY2xzOiAnc3VnZ2VzdGlvbi1hdXgnIH0pO1xuICAgICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25GbGFpciA9IHN1Z2dlc3Rpb25BdXguY3JlYXRlU3Bhbih7IFxuICAgICAgICAgICAgY2xzOiAnc3VnZ2VzdGlvbi1mbGFpcicsIFxuICAgICAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6IHRoaXMuZ2V0SWNvbkxhYmVsKG1hdGNoUmVhc29uKSB9IFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIERldGVybWluZSBpY29uIGJhc2VkIG9uIHByaW9yaXR5OiB0aXRsZSA+IGZpbGUgbmFtZSA+IGFsaWFzXG4gICAgICAgICAgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJblRpdGxlKSB7XG4gICAgICAgICAgICAvLyBUeXBlIGljb24gZm9yIHRpdGxlL3Byb3BlcnR5IG1hdGNoZXNcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVHlwZUljb24oc3VnZ2VzdGlvbkZsYWlyKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1hdGNoUmVhc29uLm1hdGNoZWRJbkZpbGVuYW1lKSB7XG4gICAgICAgICAgICAvLyBGaWxlIGljb24gZm9yIGZpbGUgbmFtZSBtYXRjaGVzXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUZpbGVJY29uKHN1Z2dlc3Rpb25GbGFpcik7XG4gICAgICAgICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5BbGlhcykge1xuICAgICAgICAgICAgLy8gQXJyb3cgaWNvbiBmb3IgYWxpYXMgbWF0Y2hlc1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVGb3J3YXJkSWNvbihzdWdnZXN0aW9uRmxhaXIpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBOb3RlIGhhcyBwcm9wZXJ0eSBidXQgbm8gbWF0Y2ggcmVhc29uIChzaG91bGRuJ3QgaGFwcGVuLCBidXQgaGFuZGxlIGdyYWNlZnVsbHkpXG4gICAgICAgICAgLy8gU2hvdyBzaW1wbGUgZGlzcGxheSB3aXRoIGp1c3QgdGhlIGRpc3BsYXkgbmFtZVxuICAgICAgICAgIGVsLnNldFRleHQoc3VnZ2VzdGlvbi5kaXNwbGF5KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRm9yIG5vdGVzIHdpdGhvdXQgdGhlIHByb3BlcnR5IChhbmQgbm90IG1hdGNoZWQgdmlhIGFsaWFzKSwgc2hvdyBzaW1wbGUgZGlzcGxheSAobm8gaWNvbiwgbm8gZHVwbGljYXRlIG5hbWUpXG4gICAgICAgIGVsLnNldFRleHQoc3VnZ2VzdGlvbi5kaXNwbGF5KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldEljb25MYWJlbChtYXRjaFJlYXNvbjogU2VhcmNoTWF0Y2hSZWFzb24pOiBzdHJpbmcge1xuICAgIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5UaXRsZSkge1xuICAgICAgcmV0dXJuICdUaXRsZS9Qcm9wZXJ0eSBNYXRjaCc7XG4gICAgfSBlbHNlIGlmIChtYXRjaFJlYXNvbi5tYXRjaGVkSW5GaWxlbmFtZSkge1xuICAgICAgcmV0dXJuICdGaWxlIE5hbWUgTWF0Y2gnO1xuICAgIH0gZWxzZSBpZiAobWF0Y2hSZWFzb24ubWF0Y2hlZEluQWxpYXMpIHtcbiAgICAgIHJldHVybiAnQWxpYXMgTWF0Y2gnO1xuICAgIH1cbiAgICByZXR1cm4gJ01hdGNoJztcbiAgfVxuXG4gIHByaXZhdGUgY3JlYXRlVHlwZUljb24oY29udGFpbmVyOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgIGNvbnN0IHN2ZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnc3ZnJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCAnMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd2aWV3Qm94JywgJzAgMCAyNCAyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2ZpbGwnLCAnbm9uZScpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZScsICdjdXJyZW50Q29sb3InKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2Utd2lkdGgnLCAnMicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lY2FwJywgJ3JvdW5kJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVqb2luJywgJ3JvdW5kJyk7XG4gICAgc3ZnLmNsYXNzTGlzdC5hZGQoJ3N2Zy1pY29uJywgJ2x1Y2lkZS10eXBlJyk7XG4gICAgXG4gICAgY29uc3QgcG9seWxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwb2x5bGluZScpO1xuICAgIHBvbHlsaW5lMS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICc0IDcgNCA0IDIwIDQgMjAgNycpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZTEpO1xuICAgIFxuICAgIGNvbnN0IGxpbmUxID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd4MScsICc5Jyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcyMCcpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDInLCAnMTUnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3kyJywgJzIwJyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUxKTtcbiAgICBcbiAgICBjb25zdCBsaW5lMiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAnbGluZScpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneDEnLCAnMTInKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kxJywgJzQnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzEyJyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd5MicsICcyMCcpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChsaW5lMik7XG4gICAgXG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHN2Zyk7XG4gIH1cblxuICBwcml2YXRlIGNyZWF0ZUZpbGVJY29uKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3N2ZycpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3dpZHRoJywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnaGVpZ2h0JywgJzI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgndmlld0JveCcsICcwIDAgMjQgMjQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdmaWxsJywgJ25vbmUnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UnLCAnY3VycmVudENvbG9yJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLXdpZHRoJywgJzInKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWNhcCcsICdyb3VuZCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS1saW5lam9pbicsICdyb3VuZCcpO1xuICAgIHN2Zy5jbGFzc0xpc3QuYWRkKCdzdmctaWNvbicsICdsdWNpZGUtZmlsZS10ZXh0Jyk7XG4gICAgXG4gICAgY29uc3QgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpO1xuICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgJ00xNC41IDJINmEyIDIgMCAwIDAtMiAydjE2YTIgMiAwIDAgMCAyIDJoMTJhMiAyIDAgMCAwIDItMlY3LjVMMTQuNSAyeicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcbiAgICBcbiAgICBjb25zdCBwb2x5bGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUxLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzE0LDIgMTQsOCAyMCw4Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lMSk7XG4gICAgXG4gICAgY29uc3QgbGluZTEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ2xpbmUnKTtcbiAgICBsaW5lMS5zZXRBdHRyaWJ1dGUoJ3gxJywgJzE2Jyk7XG4gICAgbGluZTEuc2V0QXR0cmlidXRlKCd5MScsICcxMycpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneDInLCAnOCcpO1xuICAgIGxpbmUxLnNldEF0dHJpYnV0ZSgneTInLCAnMTMnKTtcbiAgICBzdmcuYXBwZW5kQ2hpbGQobGluZTEpO1xuICAgIFxuICAgIGNvbnN0IGxpbmUyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdsaW5lJyk7XG4gICAgbGluZTIuc2V0QXR0cmlidXRlKCd4MScsICcxNicpO1xuICAgIGxpbmUyLnNldEF0dHJpYnV0ZSgneTEnLCAnMTcnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3gyJywgJzgnKTtcbiAgICBsaW5lMi5zZXRBdHRyaWJ1dGUoJ3kyJywgJzE3Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKGxpbmUyKTtcbiAgICBcbiAgICBjb25zdCBwb2x5bGluZTIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BvbHlsaW5lJyk7XG4gICAgcG9seWxpbmUyLnNldEF0dHJpYnV0ZSgncG9pbnRzJywgJzEwLDkgOSw5IDgsOScpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwb2x5bGluZTIpO1xuICAgIFxuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZChzdmcpO1xuICB9XG5cbiAgcHJpdmF0ZSBjcmVhdGVGb3J3YXJkSWNvbihjb250YWluZXI6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgY29uc3Qgc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdzdmcnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCd3aWR0aCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ2hlaWdodCcsICcyNCcpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3ZpZXdCb3gnLCAnMCAwIDI0IDI0Jyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnZmlsbCcsICdub25lJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlJywgJ2N1cnJlbnRDb2xvcicpO1xuICAgIHN2Zy5zZXRBdHRyaWJ1dGUoJ3N0cm9rZS13aWR0aCcsICcyJyk7XG4gICAgc3ZnLnNldEF0dHJpYnV0ZSgnc3Ryb2tlLWxpbmVjYXAnLCAncm91bmQnKTtcbiAgICBzdmcuc2V0QXR0cmlidXRlKCdzdHJva2UtbGluZWpvaW4nLCAncm91bmQnKTtcbiAgICBzdmcuY2xhc3NMaXN0LmFkZCgnc3ZnLWljb24nLCAnbHVjaWRlLWZvcndhcmQnKTtcbiAgICBcbiAgICBjb25zdCBwb2x5bGluZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncG9seWxpbmUnKTtcbiAgICBwb2x5bGluZS5zZXRBdHRyaWJ1dGUoJ3BvaW50cycsICcxNSAxNyAyMCAxMiAxNSA3Jyk7XG4gICAgc3ZnLmFwcGVuZENoaWxkKHBvbHlsaW5lKTtcbiAgICBcbiAgICBjb25zdCBwYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICdwYXRoJyk7XG4gICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ2QnLCAnTTQgMTh2LTJhNCA0IDAgMCAxIDQtNGgxMicpO1xuICAgIHN2Zy5hcHBlbmRDaGlsZChwYXRoKTtcbiAgICBcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQoc3ZnKTtcbiAgfVxuXG4gIHByaXZhdGUgaXNVc2luZ0N1c3RvbVByb3BlcnR5KGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG4gICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IGNhY2hlPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gYXMgdW5rbm93bjtcbiAgICBpZiAocHJvcGVydHlWYWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHByb3BlcnR5VmFsdWUgPT09IG51bGwpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgY29uc3Qgc3RyVmFsdWUgPSB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ3N0cmluZycgPyBwcm9wZXJ0eVZhbHVlIDogKHR5cGVvZiBwcm9wZXJ0eVZhbHVlID09PSAnbnVtYmVyJyB8fCB0eXBlb2YgcHJvcGVydHlWYWx1ZSA9PT0gJ2Jvb2xlYW4nID8gU3RyaW5nKHByb3BlcnR5VmFsdWUpIDogJycpO1xuICAgIHJldHVybiBzdHJWYWx1ZS50cmltKCkgIT09ICcnO1xuICB9XG5cbiAgcHJpdmF0ZSBpc1VzaW5nQWxpYXMoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcbiAgICAvLyBDaGVjayBpZiB0aGlzIGZpbGUgaGFzIGFsaWFzZXMgYW5kIGlmIHdlJ3JlIGN1cnJlbnRseSBzZWFyY2hpbmdcbiAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gY2FjaGU/LmZyb250bWF0dGVyO1xuICAgIGNvbnN0IGFsaWFzZXMgPSBmcm9udG1hdHRlcj8uYWxpYXNlcyBhcyB1bmtub3duO1xuICAgIFxuICAgIGlmICghYWxpYXNlcykgcmV0dXJuIGZhbHNlO1xuICAgIFxuICAgIC8vIEZvciBub3csIHNob3cgYWxpYXMgaWNvbiBpZiB0aGUgZmlsZSBoYXMgYWxpYXNlcyBhbmQgd2UncmUgbm90IHVzaW5nIGEgY3VzdG9tIHByb3BlcnR5XG4gICAgY29uc3QgaXNVc2luZ0N1c3RvbVByb3BlcnR5ID0gdGhpcy5pc1VzaW5nQ3VzdG9tUHJvcGVydHkoZmlsZSk7XG4gICAgcmV0dXJuICFpc1VzaW5nQ3VzdG9tUHJvcGVydHkgJiYgQm9vbGVhbihhbGlhc2VzKTtcbiAgfVxuXG4gIHNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogU3VnZ2VzdGlvbkl0ZW0sIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpOiB2b2lkIHtcbiAgICAvLyBEb24ndCBkbyBhbnl0aGluZyBmb3IgXCJObyBtYXRjaCBmb3VuZFwiXG4gICAgaWYgKHN1Z2dlc3Rpb24uaXNOb01hdGNoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgIGlmICghYWN0aXZlVmlldyB8fCAhdGhpcy5jb250ZXh0KSByZXR1cm47XG4gICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgY29uc3QgeyBzdGFydCwgZW5kIH0gPSB0aGlzLmNvbnRleHQ7XG4gICAgY29uc3QgbGluZSA9IGVkaXRvci5nZXRMaW5lKHN0YXJ0LmxpbmUpO1xuICAgIGxldCBlbmRQb3MgPSBlbmQ7XG4gICAgaWYgKGxpbmUuc2xpY2UoZW5kLmNoLCBlbmQuY2ggKyAyKSA9PT0gJ11dJykge1xuICAgICAgZW5kUG9zID0geyBsaW5lOiBlbmQubGluZSwgY2g6IGVuZC5jaCArIDIgfTtcbiAgICB9XG4gICAgXG4gICAgLy8gSGFuZGxlIGV4aXN0aW5nIGZpbGVcbiAgICBpZiAoIXN1Z2dlc3Rpb24uZmlsZSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICBjb25zdCB2YXVsdCA9IHRoaXMuYXBwLnZhdWx0IGFzIHVua25vd24gYXMgVmF1bHRJbnRlcm5hbDtcbiAgICBjb25zdCB1c2VNYXJrZG93bkxpbmtzID0gdmF1bHQuZ2V0Q29uZmlnPy4oJ3VzZU1hcmtkb3duTGlua3MnKSA/PyBmYWxzZTtcbiAgICBsZXQgbGlua1RleHQ6IHN0cmluZztcblxuICAgIC8vIE9ubHkgYWRkIGRpc3BsYXkgdGV4dCBpZiB0aGUgbm90ZSBoYXMgdGhlIGN1c3RvbSBwcm9wZXJ0eVxuICAgIC8vIE90aGVyd2lzZSwgdXNlIGRlZmF1bHQgT2JzaWRpYW4gYmVoYXZpb3IgKG5vIGRpc3BsYXkgdGV4dClcbiAgICBpZiAoc3VnZ2VzdGlvbi5pc0N1c3RvbURpc3BsYXkpIHtcbiAgICAgIGlmICh1c2VNYXJrZG93bkxpbmtzKSB7XG4gICAgICAgIGxpbmtUZXh0ID0gYFske3N1Z2dlc3Rpb24uZGlzcGxheX1dKCR7ZW5jb2RlVVJJKHN1Z2dlc3Rpb24uZmlsZS5wYXRoKX0pYDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IGxpbmtQYXRoID0gc3VnZ2VzdGlvbi5maWxlLnBhdGgucmVwbGFjZSgnLm1kJywgJycpO1xuICAgICAgICBsaW5rVGV4dCA9IGBbWyR7bGlua1BhdGh9fCR7c3VnZ2VzdGlvbi5kaXNwbGF5fV1dYDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgLy8gRGVmYXVsdCBPYnNpZGlhbiBiZWhhdmlvciAtIG5vIGRpc3BsYXkgdGV4dFxuICAgICAgaWYgKHVzZU1hcmtkb3duTGlua3MpIHtcbiAgICAgICAgbGlua1RleHQgPSBgWyR7c3VnZ2VzdGlvbi5maWxlLnBhdGgucmVwbGFjZSgnLm1kJywgJycpfV0oJHtlbmNvZGVVUkkoc3VnZ2VzdGlvbi5maWxlLnBhdGgpfSlgO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbGlua1BhdGggPSBzdWdnZXN0aW9uLmZpbGUucGF0aC5yZXBsYWNlKCcubWQnLCAnJyk7XG4gICAgICAgIGxpbmtUZXh0ID0gYFtbJHtsaW5rUGF0aH1dXWA7XG4gICAgICB9XG4gICAgfVxuICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobGlua1RleHQsIHsgbGluZTogc3RhcnQubGluZSwgY2g6IHN0YXJ0LmNoIH0sIGVuZFBvcyk7XG4gICAgY29uc3QgbmV3Q3Vyc29yUG9zID0gc3RhcnQuY2ggKyBsaW5rVGV4dC5sZW5ndGg7XG4gICAgdHJ5IHtcbiAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiBzdGFydC5saW5lLCBjaDogbmV3Q3Vyc29yUG9zIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIGN1cnNvcjonLCBlcnJvcik7XG4gICAgICBuZXcgTm90aWNlKCdFcnJvciBzZXR0aW5nIGN1cnNvciBwb3NpdGlvbi4gUGxlYXNlIGNoZWNrIGNvbnNvbGUgZm9yIGRldGFpbHMuJyk7XG4gICAgfVxuICB9XG4gIFxuICBwcml2YXRlIGdldFF1aWNrU3dpdGNoZXJPcHRpb25zKCk6IFF1aWNrU3dpdGNoZXJQbHVnaW5JbnN0YW5jZVsnb3B0aW9ucyddIHwgbnVsbCB7XG4gICAgdHJ5IHtcbiAgICAgIC8vIEFjY2VzcyB0aGUgaW50ZXJuYWwgUXVpY2sgU3dpdGNoZXIgcGx1Z2luIHRoZSBzYW1lIHdheSBRdWljayBTd2l0Y2ggKysgZG9lc1xuICAgICAgY29uc3QgaW50ZXJuYWxQbHVnaW5zID0gKHRoaXMuYXBwIGFzIHVua25vd24gYXMgQXBwSW50ZXJuYWwpLmludGVybmFsUGx1Z2lucztcbiAgICAgIGlmICghaW50ZXJuYWxQbHVnaW5zKSByZXR1cm4gbnVsbDtcbiAgICAgIFxuICAgICAgY29uc3Qgc3dpdGNoZXJQbHVnaW4gPSBpbnRlcm5hbFBsdWdpbnMuZ2V0UGx1Z2luQnlJZD8uKCdzd2l0Y2hlcicpO1xuICAgICAgaWYgKCFzd2l0Y2hlclBsdWdpbiB8fCAhc3dpdGNoZXJQbHVnaW4uaW5zdGFuY2UpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBzd2l0Y2hlclBsdWdpbi5pbnN0YW5jZS5vcHRpb25zIHx8IG51bGw7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUud2FybignUHJvcGVydHkgT3ZlciBGaWxlbmFtZTogQ291bGQgbm90IGFjY2VzcyBRdWljayBTd2l0Y2hlciBvcHRpb25zOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxufSIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5pbXBvcnQgeyBjcmVhdGVTZXR0aW5nc0dyb3VwIH0gZnJvbSAnLi4vdXRpbHMvc2V0dGluZ3MtY29tcGF0JztcclxuXHJcbmV4cG9ydCBjbGFzcyBTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XHJcbiAgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuXHJcbiAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG4gICAgXHJcbiAgICAvLyBBZGQgc2NvcGluZyBjbGFzcyB0byBwcmV2ZW50IENTUyBmcm9tIGFmZmVjdGluZyBvdGhlciBzZXR0aW5nc1xyXG4gICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ3Byb3BlcnR5LW92ZXItZmlsZW5hbWUtc2V0dGluZ3MnKTtcclxuXHJcbiAgICAvLyBDcmVhdGUgYSBzaW5nbGUgc2V0dGluZ3MgZ3JvdXAgd2l0aCBubyBoZWFkaW5nIChmb2xsb3dpbmcgVUkgVHdlYWtlciBwYXR0ZXJuKVxyXG4gICAgY29uc3QgZ2VuZXJhbEdyb3VwID0gY3JlYXRlU2V0dGluZ3NHcm91cChjb250YWluZXJFbCk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdQcm9wZXJ0eSBrZXknKVxyXG4gICAgICAgIC5zZXREZXNjKCdUaGUgcHJvcGVydHkgdG8gdXNlIGFzIHRoZSBkaXNwbGF5IHRpdGxlLiBGYWxscyBiYWNrIHRvIHRoZSBmaWxlIG5hbWUgd2hlbiBubyBwcm9wZXJ0eSBpcyBzZXQgZm9yIHRoYXQgaXRlbS4nKVxyXG4gICAgICAgIC5hZGRUZXh0KCh0ZXh0KSA9PlxyXG4gICAgICAgICAgdGV4dFxyXG4gICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ1RpdGxlJylcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5KVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXkgPSB2YWx1ZS50cmltKCkgfHwgJ3RpdGxlJztcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlTGlua1N1Z2dlc3RlcigpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUdyYXBoVmlldygpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVRhYnMoKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVFeHBsb3JlcigpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnV2hlbiBsaW5raW5nIG5vdGVzJylcclxuICAgICAgICAuc2V0RGVzYygnRW5hYmxlIHByb3BlcnR5LWJhc2VkIHRpdGxlcyBpbiB0aGUgbGluayBzdWdnZXN0ZXIuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckxpbmtpbmcpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JMaW5raW5nID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUxpbmtTdWdnZXN0ZXIoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbiBxdWljayBzd2l0Y2hlcicpXHJcbiAgICAgICAgLnNldERlc2MoJ0VuYWJsZSBwcm9wZXJ0eS1iYXNlZCB0aXRsZXMgaW4gdGhlIHF1aWNrIHN3aXRjaGVyLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcHJldlF1aWNrU3dpdGNoZXJTdGF0ZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXI7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlciA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncyhwcmV2UXVpY2tTd2l0Y2hlclN0YXRlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbmNsdWRlIGZpbGUgbmFtZSBpbiBmdXp6eSBzZWFyY2hlcycpXHJcbiAgICAgICAgLnNldERlc2MoJ0luY2x1ZGUgbm90ZSBmaWxlIG5hbWVzIGluIGZ1enp5IHNlYXJjaCByZXN1bHRzIGZvciBsaW5rIHN1Z2dlc3RlciBhbmQgcXVpY2sgc3dpdGNoZXIuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVGaWxlbmFtZUluU2VhcmNoKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuaW5jbHVkZUZpbGVuYW1lSW5TZWFyY2ggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnSW5jbHVkZSBhbGlhc2VzIGluIGZ1enp5IHNlYXJjaGVzJylcclxuICAgICAgICAuc2V0RGVzYygnSW5jbHVkZSBwcm9wZXJ0eSBhbGlhc2VzIGluIGZ1enp5IHNlYXJjaCByZXN1bHRzIGZvciBsaW5rIHN1Z2dlc3RlciBhbmQgcXVpY2sgc3dpdGNoZXIuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmluY2x1ZGVBbGlhc2VzSW5TZWFyY2gpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbmNsdWRlQWxpYXNlc0luU2VhcmNoID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ1doZW4gZHJhZ2dpbmcgbm90ZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVc2UgcHJvcGVydHktYmFzZWQgdGl0bGVzIHdoZW4gZHJhZ2dpbmcgbm90ZXMgZnJvbSB0aGUgZmlsZSBleHBsb3Jlci4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRHJhZ0Ryb3ApXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcCA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbiBncmFwaCB2aWV3JylcclxuICAgICAgICAuc2V0RGVzYygnVXNlIHRoZSBwcm9wZXJ0eSBpbnN0ZWFkIG9mIHRoZSBmaWxlIG5hbWUgYXMgdGhlIG5vdGVcXCdzIHRpdGxlIGluIGdyYXBoIHZpZXcuJylcclxuICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+XHJcbiAgICAgICAgICB0b2dnbGVcclxuICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldylcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVEYXRhKHRoaXMucGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi51cGRhdGVHcmFwaFZpZXcoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbiBiYWNrbGlua3MgYW5kIG91dGdvaW5nIGxpbmtzJylcclxuICAgICAgICAuc2V0RGVzYygnVXNlIHRoZSBwcm9wZXJ0eSBpbnN0ZWFkIG9mIHRoZSBmaWxlIG5hbWUgaW4gdGhlIGxpbmtlZCBtZW50aW9ucyBmb290ZXIsIGRlZGljYXRlZCBiYWNrbGlua3MgcGFuZWwsIGFuZCBvdXRnb2luZyBsaW5rcy4nKVxyXG4gICAgICAgIC5hZGRUb2dnbGUoKHRvZ2dsZSkgPT5cclxuICAgICAgICAgIHRvZ2dsZVxyXG4gICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICBzZXR0aW5nXHJcbiAgICAgICAgLnNldE5hbWUoJ0luIHRhYiB0aXRsZXMnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVc2UgdGhlIHByb3BlcnR5IGluc3RlYWQgb2YgdGhlIGZpbGUgbmFtZSBpbiB0YWIgdGl0bGVzLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JUYWJzKVxyXG4gICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgcHJldlRhYlN0YXRlID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yVGFicztcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JUYWJzID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKHVuZGVmaW5lZCwgcHJldlRhYlN0YXRlKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdJbiB3aW5kb3cgZnJhbWUgdGl0bGUnKVxyXG4gICAgICAgIC5zZXREZXNjKCdVc2UgdGhlIHByb3BlcnR5IGluc3RlYWQgb2YgdGhlIGZpbGUgbmFtZSBpbiB0aGUgYnJvd3NlciB3aW5kb3cgdGl0bGUgYmFyLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JXaW5kb3dGcmFtZSlcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvcldpbmRvd0ZyYW1lID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZVdpbmRvd0ZyYW1lKCk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGdlbmVyYWxHcm91cC5hZGRTZXR0aW5nKChzZXR0aW5nKSA9PiB7XHJcbiAgICAgIHNldHRpbmdcclxuICAgICAgICAuc2V0TmFtZSgnSW4gZmlsZSBleHBsb3JlcicpXHJcbiAgICAgICAgLnNldERlc2MoJ1VzZSB0aGUgcHJvcGVydHkgaW5zdGVhZCBvZiB0aGUgZmlsZSBuYW1lIGluIHRoZSBmaWxlIGV4cGxvcmVyLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3JlcilcclxuICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUV4cGxvcmVyKCk7XHJcbiAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdG8gc2hvdy9oaWRlIGZvbGRlciBub3RlIHNldHRpbmdcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gU2hvdyBmb2xkZXIgbm90ZSBmaWxlIG5hbWUgc2V0dGluZyBvbmx5IGlmIGV4cGxvcmVyIGlzIGVuYWJsZWRcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3Jlcikge1xyXG4gICAgICBnZW5lcmFsR3JvdXAuYWRkU2V0dGluZygoc2V0dGluZykgPT4ge1xyXG4gICAgICAgIHNldHRpbmdcclxuICAgICAgICAgIC5zZXROYW1lKCdGb2xkZXIgbm90ZSBmaWxlIG5hbWUnKVxyXG4gICAgICAgICAgLnNldERlc2MoJ0lmIGEgZm9sZGVyIGNvbnRhaW5zIGEgZmlsZSB3aXRoIHRoaXMgbmFtZSB0aGF0IGhhcyB0aGUgY29uZmlndXJlZCBwcm9wZXJ0eSwgdGhlIGZvbGRlciB3aWxsIGRpc3BsYXkgdGhhdCBwcm9wZXJ0eSB2YWx1ZSBpbnN0ZWFkLiBUaGlzIGVuc3VyZXMgY29tcGF0aWJpbGl0eSB3aXRoIGZvbGRlciBub3RlcyBwbHVnaW5zLiBMZWF2ZSBibGFuayB0byBkaXNhYmxlLicpXHJcbiAgICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT5cclxuICAgICAgICAgICAgdGV4dFxyXG4gICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignSW5kZXgnKVxyXG4gICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5mb2xkZXJOb3RlRmlsZW5hbWUpXHJcbiAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZm9sZGVyTm90ZUZpbGVuYW1lID0gdmFsdWUudHJpbSgpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZURhdGEodGhpcy5wbHVnaW4uc2V0dGluZ3MpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlRXhwbG9yZXIoKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2VuZXJhbEdyb3VwLmFkZFNldHRpbmcoKHNldHRpbmcpID0+IHtcclxuICAgICAgc2V0dGluZ1xyXG4gICAgICAgIC5zZXROYW1lKCdVc2Ugc2ltcGxlIHNlYXJjaCcpXHJcbiAgICAgICAgLnNldERlc2MoJ0luc3RlYWQgb2YgdXNpbmcgZnV6enkgc2VhcmNoLCBzaW1wbGUgc2VhcmNoIHByb3ZpZGVzIGJldHRlciBwZXJmb3JtYW5jZSB3aXRoIHZlcnkgbGFyZ2UgdmF1bHRzICh0aG91c2FuZHMgb2YgZmlsZXMpLicpXHJcbiAgICAgICAgLmFkZFRvZ2dsZSgodG9nZ2xlKSA9PlxyXG4gICAgICAgICAgdG9nZ2xlXHJcbiAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTaW1wbGVTZWFyY2gpXHJcbiAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTaW1wbGVTZWFyY2ggPSB2YWx1ZTtcclxuICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlRGF0YSh0aGlzLnBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCAiLyoqXHJcbiAqIENvbXBhdGliaWxpdHkgdXRpbGl0aWVzIGZvciBzZXR0aW5nc1xyXG4gKiBQcm92aWRlcyBiYWNrd2FyZCBjb21wYXRpYmlsaXR5IGZvciBTZXR0aW5nR3JvdXAgKHJlcXVpcmVzIEFQSSAxLjExLjArKVxyXG4gKi9cclxuXHJcbmltcG9ydCB7IFNldHRpbmcsIHJlcXVpcmVBcGlWZXJzaW9uIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgKiBhcyBPYnNpZGlhbk1vZHVsZSBmcm9tICdvYnNpZGlhbic7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIHRoYXQgd29ya3Mgd2l0aCBib3RoIFNldHRpbmdHcm91cCBhbmQgZmFsbGJhY2sgY29udGFpbmVyXHJcbiAqL1xyXG5leHBvcnQgaW50ZXJmYWNlIFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHRhZGRTZXR0aW5nKGNiOiAoc2V0dGluZzogU2V0dGluZykgPT4gdm9pZCk6IHZvaWQ7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBDcmVhdGVzIGEgc2V0dGluZ3MgY29udGFpbmVyIHRoYXQgdXNlcyBTZXR0aW5nR3JvdXAgaWYgYXZhaWxhYmxlIChBUEkgMS4xMS4wKyksXHJcbiAqIG90aGVyd2lzZSBmYWxscyBiYWNrIHRvIGNyZWF0aW5nIGEgaGVhZGluZyBhbmQgdXNpbmcgdGhlIGNvbnRhaW5lciBkaXJlY3RseS5cclxuICogXHJcbiAqIFVzZXMgcmVxdWlyZUFwaVZlcnNpb24oJzEuMTEuMCcpIHRvIGNoZWNrIGlmIFNldHRpbmdHcm91cCBpcyBhdmFpbGFibGUuXHJcbiAqIFRoaXMgaXMgdGhlIG9mZmljaWFsIE9ic2lkaWFuIEFQSSBtZXRob2QgZm9yIHZlcnNpb24gY2hlY2tpbmcuXHJcbiAqIFxyXG4gKiBAcGFyYW0gY29udGFpbmVyRWwgLSBUaGUgY29udGFpbmVyIGVsZW1lbnQgZm9yIHNldHRpbmdzXHJcbiAqIEBwYXJhbSBoZWFkaW5nIC0gVGhlIGhlYWRpbmcgdGV4dCBmb3IgdGhlIHNldHRpbmdzIGdyb3VwIChvcHRpb25hbClcclxuICogQHJldHVybnMgQSBjb250YWluZXIgdGhhdCBjYW4gYmUgdXNlZCB0byBhZGQgc2V0dGluZ3NcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVTZXR0aW5nc0dyb3VwKFxyXG5cdGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcclxuXHRoZWFkaW5nPzogc3RyaW5nXHJcbik6IFNldHRpbmdzQ29udGFpbmVyIHtcclxuXHQvLyBDaGVjayBpZiBTZXR0aW5nR3JvdXAgaXMgYXZhaWxhYmxlIChBUEkgMS4xMS4wKylcclxuXHQvLyByZXF1aXJlQXBpVmVyc2lvbiBpcyB0aGUgb2ZmaWNpYWwgT2JzaWRpYW4gQVBJIG1ldGhvZCBmb3IgdmVyc2lvbiBjaGVja2luZ1xyXG5cdGlmIChyZXF1aXJlQXBpVmVyc2lvbignMS4xMS4wJykpIHtcclxuXHRcdC8vIFVzZSBTZXR0aW5nR3JvdXAgLSBpdCdzIGd1YXJhbnRlZWQgdG8gZXhpc3QgaWYgcmVxdWlyZUFwaVZlcnNpb24gcmV0dXJucyB0cnVlXHJcblx0XHQvLyBBY2Nlc3MgU2V0dGluZ0dyb3VwIHZpYSB0eXBlIGFzc2VydGlvbiBzaW5jZSBpdCBtYXkgbm90IGJlIGluIHR5cGUgZGVmaW5pdGlvbnNcclxuXHRcdC8vIGZvciBvbGRlciBUeXBlU2NyaXB0IHZlcnNpb25zLCBidXQgZXhpc3RzIGF0IHJ1bnRpbWUgaW4gT2JzaWRpYW4gMS4xMS4wK1xyXG5cdFx0Ly8gVXNpbmcgdW5rbm93biBpbnN0ZWFkIG9mIGFueSB0byBzYXRpc2Z5IGVzbGludCB3aGlsZSBtYWludGFpbmluZyB0eXBlIHNhZmV0eVxyXG5cdFx0Y29uc3QgU2V0dGluZ0dyb3VwQ2xhc3MgPSAoT2JzaWRpYW5Nb2R1bGUgYXMgdW5rbm93biBhcyB7IFNldHRpbmdHcm91cD86IG5ldyAoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50KSA9PiB7XHJcblx0XHRcdHNldEhlYWRpbmcoaGVhZGluZzogc3RyaW5nKToge1xyXG5cdFx0XHRcdGFkZFNldHRpbmcoY2I6IChzZXR0aW5nOiBTZXR0aW5nKSA9PiB2b2lkKTogdm9pZDtcclxuXHRcdFx0fTtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpOiB2b2lkO1xyXG5cdFx0fSB9KS5TZXR0aW5nR3JvdXA7XHJcblx0XHRcclxuXHRcdGlmIChTZXR0aW5nR3JvdXBDbGFzcykge1xyXG5cdFx0XHRjb25zdCBncm91cCA9IGhlYWRpbmcgXHJcblx0XHRcdFx0PyBuZXcgU2V0dGluZ0dyb3VwQ2xhc3MoY29udGFpbmVyRWwpLnNldEhlYWRpbmcoaGVhZGluZylcclxuXHRcdFx0XHQ6IG5ldyBTZXR0aW5nR3JvdXBDbGFzcyhjb250YWluZXJFbCk7XHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRcdGdyb3VwLmFkZFNldHRpbmcoY2IpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fTtcclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0Ly8gRmFsbGJhY2sgcGF0aCAoZWl0aGVyIEFQSSA8IDEuMTEuMCBvciBTZXR0aW5nR3JvdXAgbm90IGZvdW5kKVxyXG5cdHtcclxuXHRcdC8vIEZhbGxiYWNrOiBDcmVhdGUgYSBoZWFkaW5nIG1hbnVhbGx5IGZvciBvbGRlciBBUEkgdmVyc2lvbnNcclxuXHRcdC8vIE5vdGU6IFdoaWxlIGJlc3QgcHJhY3RpY2UgcHJlZmVycyBTZXR0aW5nLnNldEhlYWRpbmcoKSwgdGhlIGZhbGxiYWNrIHBhdGhcclxuXHRcdC8vIGlzIGZvciB2ZXJzaW9ucyB0aGF0IG1heSBub3Qgc3VwcG9ydCBpdCwgc28gbWFudWFsIGhlYWRpbmcgaXMgYXBwcm9wcmlhdGUgaGVyZVxyXG5cdFx0aWYgKGhlYWRpbmcpIHtcclxuXHRcdFx0Y29uc3QgaGVhZGluZ0VsID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdzZXR0aW5nLWdyb3VwLWhlYWRpbmcnKTtcclxuXHRcdFx0aGVhZGluZ0VsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogaGVhZGluZyB9KTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0YWRkU2V0dGluZyhjYjogKHNldHRpbmc6IFNldHRpbmcpID0+IHZvaWQpIHtcclxuXHRcdFx0XHRjb25zdCBzZXR0aW5nID0gbmV3IFNldHRpbmcoY29udGFpbmVyRWwpO1xyXG5cdFx0XHRcdGNiKHNldHRpbmcpO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IE5vdGljZSB9IGZyb20gXCJvYnNpZGlhblwiO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gXCIuLi90eXBlc1wiO1xyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHJlZ2lzdGVyQ29tbWFuZHMocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gIC8vIFF1aWNrIFN3aXRjaGVyIGNvbW1hbmRcclxuICBwbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICBpZDogJ29wZW4tcXVpY2stc3dpdGNoZXInLFxyXG4gICAgbmFtZTogJ09wZW4gcXVpY2sgc3dpdGNoZXIgKHByb3BlcnR5LWJhc2VkKScsXHJcbiAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IFF1aWNrU3dpdGNoTW9kYWwgfSA9IGF3YWl0IGltcG9ydCgnLi4vdWkvUXVpY2tTd2l0Y2hNb2RhbCcpO1xyXG4gICAgICBuZXcgUXVpY2tTd2l0Y2hNb2RhbChwbHVnaW4uYXBwLCBwbHVnaW4pLm9wZW4oKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gVG9nZ2xlIGxpbmtpbmcgY29tbWFuZFxyXG4gIHBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgIGlkOiAndG9nZ2xlLWxpbmtpbmcnLFxyXG4gICAgbmFtZTogJ1RvZ2dsZSBwcm9wZXJ0eS1iYXNlZCBsaW5raW5nJyxcclxuICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JMaW5raW5nID0gIXBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JMaW5raW5nO1xyXG4gICAgICBhd2FpdCBwbHVnaW4uc2F2ZURhdGEocGx1Z2luLnNldHRpbmdzKTtcclxuICAgICAgcGx1Z2luLnVwZGF0ZUxpbmtTdWdnZXN0ZXIoKTtcclxuICAgICAgbmV3IE5vdGljZShgUHJvcGVydHktYmFzZWQgbGlua2luZyAke3BsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JMaW5raW5nID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gVG9nZ2xlIFF1aWNrIFN3aXRjaGVyIGNvbW1hbmRcclxuICBwbHVnaW4uYWRkQ29tbWFuZCh7XHJcbiAgICBpZDogJ3RvZ2dsZS1xdWljay1zd2l0Y2hlcicsXHJcbiAgICBuYW1lOiAnVG9nZ2xlIHByb3BlcnR5LWJhc2VkIHF1aWNrIHN3aXRjaGVyJyxcclxuICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHByZXZTdGF0ZSA9IHBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyO1xyXG4gICAgICBwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlciA9ICFwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yUXVpY2tTd2l0Y2hlcjtcclxuICAgICAgYXdhaXQgcGx1Z2luLnNhdmVTZXR0aW5ncyhwcmV2U3RhdGUpO1xyXG4gICAgICBuZXcgTm90aWNlKGBQcm9wZXJ0eS1iYXNlZCBRdWljayBTd2l0Y2hlciAke3BsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JRdWlja1N3aXRjaGVyID8gJ2VuYWJsZWQnIDogJ2Rpc2FibGVkJ31gKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gUmVidWlsZCBjYWNoZSBjb21tYW5kXHJcbiAgcGx1Z2luLmFkZENvbW1hbmQoe1xyXG4gICAgaWQ6ICdyZWJ1aWxkLWNhY2hlJyxcclxuICAgIG5hbWU6ICdSZWJ1aWxkIGZpbGUgY2FjaGUnLFxyXG4gICAgY2FsbGJhY2s6ICgpID0+IHtcclxuICAgICAgcGx1Z2luLnJlYnVpbGRDYWNoZSgpO1xyXG4gICAgICBuZXcgTm90aWNlKCdGaWxlIGNhY2hlIHJlYnVpbHQnKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgLy8gVG9nZ2xlIGRyYWcgYW5kIGRyb3AgY29tbWFuZFxyXG4gIHBsdWdpbi5hZGRDb21tYW5kKHtcclxuICAgIGlkOiAndG9nZ2xlLWRyYWctZHJvcCcsXHJcbiAgICBuYW1lOiAnVG9nZ2xlIHByb3BlcnR5LWJhc2VkIGRyYWcgYW5kIGRyb3AnLFxyXG4gICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcclxuICAgICAgcGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckRyYWdEcm9wID0gIXBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JEcmFnRHJvcDtcclxuICAgICAgYXdhaXQgcGx1Z2luLnNhdmVEYXRhKHBsdWdpbi5zZXR0aW5ncyk7XHJcbiAgICAgIG5ldyBOb3RpY2UoYFByb3BlcnR5LWJhc2VkIGRyYWcgYW5kIGRyb3AgJHtwbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRHJhZ0Ryb3AgPyAnZW5hYmxlZCcgOiAnZGlzYWJsZWQnfWApO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcbiIsICJpbXBvcnQgeyBBcHBJbnRlcm5hbCwgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4sIFdvcmtzcGFjZUludGVybmFsIH0gZnJvbSBcIi4uL3R5cGVzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUXVpY2tTd2l0Y2hlclNlcnZpY2Uge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwcml2YXRlIG9yaWdpbmFsU3dpdGNoZXJDb21tYW5kPzoge1xyXG4gICAgaWQ6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIGljb24/OiBzdHJpbmc7XHJcbiAgICBob3RrZXlzOiBBcnJheTx7IG1vZGlmaWVyczogc3RyaW5nW107IGtleTogc3RyaW5nIH0+O1xyXG4gICAgY2FsbGJhY2s6ICgpID0+IHZvaWQ7XHJcbiAgfTtcclxuICBwcml2YXRlIGlzQ29tbWFuZE92ZXJyaWRkZW4gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICB1cGRhdGVRdWlja1N3aXRjaGVyKCkge1xyXG4gICAgLy8gT25seSBvdmVycmlkZSB0aGUgY29tbWFuZCBpZiBvdXIgUXVpY2sgU3dpdGNoZXIgaXMgZW5hYmxlZFxyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIgJiYgIXRoaXMuaXNDb21tYW5kT3ZlcnJpZGRlbikge1xyXG4gICAgICB0aGlzLm92ZXJyaWRlUXVpY2tTd2l0Y2hlckNvbW1hbmQoKTtcclxuICAgIH0gZWxzZSBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclF1aWNrU3dpdGNoZXIgJiYgdGhpcy5pc0NvbW1hbmRPdmVycmlkZGVuKSB7XHJcbiAgICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgY29tbWFuZCB3aGVuIGRpc2FibGVkXHJcbiAgICAgIHRoaXMucmVzdG9yZU9yaWdpbmFsQ29tbWFuZCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvdmVycmlkZVF1aWNrU3dpdGNoZXJDb21tYW5kKCkge1xyXG4gICAgLy8gR2V0IHRoZSBjb21tYW5kIHJlZ2lzdHJ5XHJcbiAgICBjb25zdCBjb21tYW5kcyA9ICh0aGlzLnBsdWdpbi5hcHAgYXMgdW5rbm93biBhcyBBcHBJbnRlcm5hbCkuY29tbWFuZHMuY29tbWFuZHM7XHJcblxyXG4gICAgLy8gU3RvcmUgdGhlIG9yaWdpbmFsIGNvbW1hbmQgQkVGT1JFIHdlIGRlbGV0ZSBpdFxyXG4gICAgaWYgKGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10gJiYgIXRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQpIHtcclxuICAgICAgY29uc3Qgb3JpZ2luYWxDbWQgPSBjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddO1xyXG4gICAgICB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kID0ge1xyXG4gICAgICAgIGlkOiBvcmlnaW5hbENtZC5pZCB8fCAnc3dpdGNoZXI6b3BlbicsXHJcbiAgICAgICAgbmFtZTogb3JpZ2luYWxDbWQubmFtZSB8fCAnUXVpY2sgU3dpdGNoZXInLFxyXG4gICAgICAgIGljb246IG9yaWdpbmFsQ21kLmljb24sXHJcbiAgICAgICAgaG90a2V5czogb3JpZ2luYWxDbWQuaG90a2V5cyA/IFsuLi5vcmlnaW5hbENtZC5ob3RrZXlzXSA6IFtdLFxyXG4gICAgICAgIGNhbGxiYWNrOiBvcmlnaW5hbENtZC5jYWxsYmFja1xyXG4gICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlbW92ZSB0aGUgb3JpZ2luYWwgY29tbWFuZCBjb21wbGV0ZWx5IHRvIGF2b2lkIGNvbmZsaWN0c1xyXG4gICAgaWYgKGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10pIHtcclxuICAgICAgZGVsZXRlIGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ107XHJcbiAgICB9XHJcblxyXG4gICAgLy8gQ3JlYXRlIG91ciBjdXN0b20gY29tbWFuZCBvYmplY3RcclxuICAgIGNvbnN0IGN1c3RvbUNvbW1hbmQgPSB7XHJcbiAgICAgIGlkOiAnc3dpdGNoZXI6b3BlbicsXHJcbiAgICAgIG5hbWU6ICdRdWljayBTd2l0Y2hlcicsXHJcbiAgICAgIGljb246IHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQ/Lmljb24sXHJcbiAgICAgIGhvdGtleXM6IFt7IG1vZGlmaWVyczogW1wiTW9kXCJdLCBrZXk6IFwib1wiIH1dLFxyXG4gICAgICBjYWxsYmFjazogKCkgPT4ge1xyXG4gICAgICAgIC8vIFByZXZlbnQgYW55IGRlZmF1bHQgUXVpY2sgU3dpdGNoZXIgZnJvbSBvcGVuaW5nXHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZSBhcyB1bmtub3duIGFzIFdvcmtzcGFjZUludGVybmFsICYgeyBzd2l0Y2hlcj86IHsgY2xvc2UoKTogdm9pZCB9IH07XHJcbiAgICAgICAgaWYgKHdvcmtzcGFjZS5zd2l0Y2hlciAmJiB0eXBlb2Ygd29ya3NwYWNlLnN3aXRjaGVyLmNsb3NlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICB3b3Jrc3BhY2Uuc3dpdGNoZXIuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXNlIG91ciBjdXN0b20gbW9kYWwgd2hlbiB0aGlzIGNvbW1hbmQgaXMgYWN0aXZlXHJcbiAgICAgICAgLy8gQ2xvc2UgYW55IGV4aXN0aW5nIG1vZGFscyBmaXJzdFxyXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nTW9kYWxzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1vZGFsJyk7XHJcbiAgICAgICAgZXhpc3RpbmdNb2RhbHMuZm9yRWFjaChtb2RhbCA9PiB7XHJcbiAgICAgICAgICBpZiAobW9kYWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiAhbW9kYWwuY2xhc3NMaXN0LmNvbnRhaW5zKCdoaWRkZW4nKSkge1xyXG4gICAgICAgICAgICBtb2RhbC5hZGRDbGFzcygnaGlkZGVuJyk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGltcG9ydCgnLi4vdWkvUXVpY2tTd2l0Y2hNb2RhbCcpLnRoZW4oKHsgUXVpY2tTd2l0Y2hNb2RhbCB9KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IFF1aWNrU3dpdGNoTW9kYWwodGhpcy5wbHVnaW4uYXBwLCB0aGlzLnBsdWdpbik7XHJcbiAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcclxuICAgICAgICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBsb2FkaW5nIFF1aWNrU3dpdGNoTW9kYWw6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBjb21tYW5kIGlmIG91ciBtb2RhbCBmYWlsc1xyXG4gICAgICAgICAgICBpZiAodGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZCAmJiB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLmNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5jYWxsYmFjaygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY3JlYXRpbmcgUXVpY2tTd2l0Y2hNb2RhbDonLCBlcnJvcik7XHJcbiAgICAgICAgICAvLyBGYWxsYmFjayB0byBvcmlnaW5hbCBjb21tYW5kIGlmIG91ciBtb2RhbCBmYWlsc1xyXG4gICAgICAgICAgaWYgKHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQgJiYgdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5jYWxsYmFjaykge1xyXG4gICAgICAgICAgICB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLmNhbGxiYWNrKCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIC8vIERpcmVjdGx5IGFzc2lnbiB0byB0aGUgY29tbWFuZCByZWdpc3RyeSBpbnN0ZWFkIG9mIHVzaW5nIGFkZENvbW1hbmRcclxuICAgIGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10gPSBjdXN0b21Db21tYW5kO1xyXG5cclxuICAgIHRoaXMuaXNDb21tYW5kT3ZlcnJpZGRlbiA9IHRydWU7XHJcbiAgfVxyXG5cclxuICByZXN0b3JlT3JpZ2luYWxDb21tYW5kKCkge1xyXG4gICAgaWYgKCF0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZW1vdmUgb3VyIGNvbW1hbmRcclxuICAgIGNvbnN0IGNvbW1hbmRzID0gKHRoaXMucGx1Z2luLmFwcCBhcyB1bmtub3duIGFzIEFwcEludGVybmFsKS5jb21tYW5kcy5jb21tYW5kcztcclxuICAgIGlmIChjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddKSB7XHJcbiAgICAgIGRlbGV0ZSBjb21tYW5kc1snc3dpdGNoZXI6b3BlbiddO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFJlc3RvcmUgdGhlIG9yaWdpbmFsIGNvbW1hbmRcclxuICAgIGNvbW1hbmRzWydzd2l0Y2hlcjpvcGVuJ10gPSB7XHJcbiAgICAgIGlkOiB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLmlkLFxyXG4gICAgICBuYW1lOiB0aGlzLm9yaWdpbmFsU3dpdGNoZXJDb21tYW5kLm5hbWUsXHJcbiAgICAgIGljb246IHRoaXMub3JpZ2luYWxTd2l0Y2hlckNvbW1hbmQuaWNvbixcclxuICAgICAgaG90a2V5czogdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5ob3RrZXlzLFxyXG4gICAgICBjYWxsYmFjazogdGhpcy5vcmlnaW5hbFN3aXRjaGVyQ29tbWFuZC5jYWxsYmFja1xyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLmlzQ29tbWFuZE92ZXJyaWRkZW4gPSBmYWxzZTtcclxuICB9XHJcbn1cclxuIiwgImltcG9ydCB7IFRGaWxlLCBNYXJrZG93blZpZXcsIEVkaXRvciB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4gfSBmcm9tIFwiLi4vdHlwZXNcIjtcblxuZXhwb3J0IGNsYXNzIERyYWdEcm9wU2VydmljZSB7XG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcbiAgcHJpdmF0ZSBsYXN0RHJvcFRpbWU6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgbGFzdERyb3BEYXRhOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcHJpdmF0ZSByZWFkb25seSBEUk9QX0RFQk9VTkNFX01TID0gMTAwOyAvLyBQcmV2ZW50IGR1cGxpY2F0ZSBwcm9jZXNzaW5nIHdpdGhpbiAxMDBtc1xuXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgfVxuXG4gIGhhbmRsZURyYWdEcm9wKGV2ZW50OiBEcmFnRXZlbnQsIGVkaXRvcjogRWRpdG9yKTogdm9pZCB7XG4gICAgLy8gQ1JJVElDQUw6IENhcHR1cmUgZGF0YVRyYW5zZmVyIHN5bmNocm9ub3VzbHkgaW4gYSBsb2NhbCB2YXJpYWJsZVxuICAgIC8vIFRoZSBldmVudC5kYXRhVHJhbnNmZXIgY2FuIGJlY29tZSBudWxsL3VuZGVmaW5lZCBhZnRlciB0aGUgZXZlbnQgaGFuZGxlciBjb21wbGV0ZXMsXG4gICAgLy8gc28gd2UgbXVzdCBjYXB0dXJlIGl0IGltbWVkaWF0ZWx5IGFuZCB1c2UgdGhlIGxvY2FsIHJlZmVyZW5jZVxuICAgIGNvbnN0IGRhdGFUcmFuc2ZlciA9IGV2ZW50LmRhdGFUcmFuc2ZlcjtcbiAgICBpZiAoIWRhdGFUcmFuc2Zlcikge1xuICAgICAgY29uc29sZS53YXJuKCdbUHJvcGVydHlPdmVyRmlsZU5hbWVdIGhhbmRsZURyYWdEcm9wOiBkYXRhVHJhbnNmZXIgaXMgdW5kZWZpbmVkJyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gR2V0IHRoZSBmaWxlIHBhdGggZnJvbSB0aGUgZHJhZyBldmVudCBzeW5jaHJvbm91c2x5XG4gICAgLy8gVGhpcyBtdXN0IGJlIGRvbmUgZHVyaW5nIHRoZSBldmVudCwgbm90IGluIHNldFRpbWVvdXRcbiAgICAvLyBVc2UgdGhlIGNhcHR1cmVkIGRhdGFUcmFuc2ZlciByZWZlcmVuY2UsIG5vdCBldmVudC5kYXRhVHJhbnNmZXJcbiAgICBjb25zdCBmaWxlUGF0aCA9IGRhdGFUcmFuc2Zlci5nZXREYXRhKCd0ZXh0L3BsYWluJyk7XG4gICAgXG4gICAgaWYgKCFmaWxlUGF0aCB8fCAhZmlsZVBhdGguZW5kc1dpdGgoJy5tZCcpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUHJldmVudCBkdXBsaWNhdGUgcHJvY2Vzc2luZyBpZiBib3RoIGhhbmRsZXJzIGZpcmUgZm9yIHRoZSBzYW1lIGRyb3BcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLmxhc3REcm9wVGltZSA8IHRoaXMuRFJPUF9ERUJPVU5DRV9NUyAmJiB0aGlzLmxhc3REcm9wRGF0YSA9PT0gZmlsZVBhdGgpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ1tQcm9wZXJ0eU92ZXJGaWxlTmFtZV0gaGFuZGxlRHJhZ0Ryb3A6IElnbm9yaW5nIGR1cGxpY2F0ZSBkcm9wIGV2ZW50Jyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMubGFzdERyb3BUaW1lID0gbm93O1xuICAgIHRoaXMubGFzdERyb3BEYXRhID0gZmlsZVBhdGg7XG5cbiAgICAvLyBGaW5kIHRoZSBmaWxlIGluIHRoZSB2YXVsdFxuICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcbiAgICBpZiAoIWZpbGUgfHwgIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tQcm9wZXJ0eU92ZXJGaWxlTmFtZV0gaGFuZGxlRHJhZ0Ryb3A6IEZpbGUgbm90IGZvdW5kOicsIGZpbGVQYXRoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIGRpc3BsYXkgbmFtZSBmcm9tIGZyb250bWF0dGVyIChvbmx5IGlmIHByb3BlcnR5IGV4aXN0cylcbiAgICBjb25zdCBkaXNwbGF5TmFtZSA9IHRoaXMuZ2V0RGlzcGxheU5hbWUoZmlsZSk7XG5cbiAgICAvLyBPbmx5IHJlcGxhY2UgbGluayBpZiB0aGUgZmlsZSBoYXMgdGhlIHByb3BlcnR5XG4gICAgLy8gT3RoZXJ3aXNlLCBsZXQgT2JzaWRpYW4gdXNlIGRlZmF1bHQgYmVoYXZpb3IgKG5vIGRpc3BsYXkgdGV4dClcbiAgICBpZiAoZGlzcGxheU5hbWUgIT09IG51bGwpIHtcbiAgICAgIC8vIERvbid0IHByZXZlbnQgZGVmYXVsdCAtIGxldCBPYnNpZGlhbiBpbnNlcnQgdGhlIGRlZmF1bHQgbGluayBmaXJzdFxuICAgICAgLy8gVGhlbiB3ZSdsbCByZXBsYWNlIGl0IHdpdGggb3VyIGN1c3RvbSBkaXNwbGF5IHRleHRcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLnJlcGxhY2VMYXN0SW5zZXJ0ZWRMaW5rKGZpbGUsIGRpc3BsYXlOYW1lLCBlZGl0b3IpO1xuICAgICAgfSwgNTApO1xuICAgIH1cbiAgfVxuXG4gIGhhbmRsZURPTURyb3AoZXZlbnQ6IERyYWdFdmVudCk6IHZvaWQge1xuICAgIC8vIENoZWNrIGlmIHdlJ3JlIGRyb3BwaW5nIG9uIGFuIGVkaXRvclxuICAgIC8vIFVzZSBtdWx0aXBsZSBtZXRob2RzIHRvIGRldGVjdCBlZGl0b3IgY29udGV4dCwgYXMgY2xvc2VzdCgpIGNhbiBmYWlsXG4gICAgLy8gd2hlbiBkcm9wcGluZyBvbiBjbS1saW5lIGVsZW1lbnRzIHRoYXQgYXJlbid0IGZ1bGx5IGF0dGFjaGVkIHRvIERPTSAobGFyZ2UgdmF1bHQgbGFnKVxuICAgIGNvbnN0IHRhcmdldCA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICBcbiAgICAvLyBNZXRob2QgMTogVHJ5IERPTSB0cmF2ZXJzYWwgKHdvcmtzIHdoZW4gZWxlbWVudCBpcyBmdWxseSBhdHRhY2hlZClcbiAgICBjb25zdCBlZGl0b3JFbGVtZW50ID0gdGFyZ2V0Py5jbG9zZXN0KCcuY20tZWRpdG9yJyk7XG4gICAgXG4gICAgLy8gTWV0aG9kIDI6IEZhbGxiYWNrIC0gY2hlY2sgaWYgdGhlcmUncyBhbiBhY3RpdmUgbWFya2Rvd24gdmlldyB3aXRoIGFuIGVkaXRvclxuICAgIC8vIFRoaXMgd29ya3MgZXZlbiB3aGVuIERPTSB0cmF2ZXJzYWwgZmFpbHMgZHVlIHRvIHRpbWluZy9sYWcgaXNzdWVzIGluIGxhcmdlIHZhdWx0c1xuICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICBjb25zdCBoYXNBY3RpdmVFZGl0b3IgPSBhY3RpdmVWaWV3ICYmIGFjdGl2ZVZpZXcuZWRpdG9yO1xuICAgIFxuICAgIC8vIFdlIG5lZWQgYXQgbGVhc3Qgb25lIG9mIHRoZXNlIHRvIGJlIHRydWUgdG8gcHJvY2VlZFxuICAgIGlmICghZWRpdG9yRWxlbWVudCAmJiAhaGFzQWN0aXZlRWRpdG9yKSB7XG4gICAgICAvLyBOb3QgZHJvcHBpbmcgb24gYW4gZWRpdG9yIG9yIG5vIGFjdGl2ZSBlZGl0b3IgYXZhaWxhYmxlXG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIElmIGNsb3Nlc3QoKSBmYWlsZWQgYnV0IHdlIGhhdmUgYW4gYWN0aXZlIGVkaXRvciwgd2UgY2FuIHN0aWxsIHByb2NlZWRcbiAgICAvLyBUaGUgYWN0aXZlVmlldy5lZGl0b3Igd2lsbCBiZSB1c2VkIGxhdGVyIGluIHRoZSBzZXRUaW1lb3V0XG5cbiAgICAvLyBDUklUSUNBTDogQ2FwdHVyZSBkYXRhVHJhbnNmZXIgc3luY2hyb25vdXNseSBpbiBhIGxvY2FsIHZhcmlhYmxlXG4gICAgLy8gVGhlIGV2ZW50LmRhdGFUcmFuc2ZlciBjYW4gYmVjb21lIG51bGwvdW5kZWZpbmVkIGFmdGVyIHRoZSBldmVudCBoYW5kbGVyIGNvbXBsZXRlcyxcbiAgICAvLyBzbyB3ZSBtdXN0IGNhcHR1cmUgaXQgaW1tZWRpYXRlbHkgYW5kIHVzZSB0aGUgbG9jYWwgcmVmZXJlbmNlXG4gICAgY29uc3QgZGF0YVRyYW5zZmVyID0gZXZlbnQuZGF0YVRyYW5zZmVyO1xuICAgIGlmICghZGF0YVRyYW5zZmVyKSB7XG4gICAgICBjb25zb2xlLndhcm4oJ1tQcm9wZXJ0eU92ZXJGaWxlTmFtZV0gaGFuZGxlRE9NRHJvcDogZGF0YVRyYW5zZmVyIGlzIHVuZGVmaW5lZCcpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgZmlsZSBwYXRoIGZyb20gdGhlIGRyYWcgZXZlbnQgc3luY2hyb25vdXNseVxuICAgIC8vIFRoaXMgbXVzdCBiZSBkb25lIGR1cmluZyB0aGUgZXZlbnQsIG5vdCBpbiBzZXRUaW1lb3V0XG4gICAgLy8gVXNlIHRoZSBjYXB0dXJlZCBkYXRhVHJhbnNmZXIgcmVmZXJlbmNlLCBub3QgZXZlbnQuZGF0YVRyYW5zZmVyXG4gICAgY29uc3QgZmlsZVBhdGggPSBkYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpO1xuICAgIFxuICAgIGlmICghZmlsZVBhdGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBQYXJzZSBPYnNpZGlhbiBVUkwgZm9ybWF0OiBvYnNpZGlhbjovL29wZW4/dmF1bHQ9Li4uJmZpbGU9Li4uXG4gICAgbGV0IGFjdHVhbEZpbGVQYXRoID0gZmlsZVBhdGg7XG4gICAgaWYgKGZpbGVQYXRoLnN0YXJ0c1dpdGgoJ29ic2lkaWFuOi8vb3Blbj8nKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChmaWxlUGF0aCk7XG4gICAgICAgIGNvbnN0IGZpbGVQYXJhbSA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdmaWxlJyk7XG4gICAgICAgIGlmIChmaWxlUGFyYW0pIHtcbiAgICAgICAgICBhY3R1YWxGaWxlUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChmaWxlUGFyYW0pICsgJy5tZCc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNvbnNvbGUud2FybignW1Byb3BlcnR5T3ZlckZpbGVOYW1lXSBoYW5kbGVET01Ecm9wOiBGYWlsZWQgdG8gcGFyc2Ugb2JzaWRpYW46Ly8gVVJMOicsIGUpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSBlbHNlIGlmICghZmlsZVBhdGguZW5kc1dpdGgoJy5tZCcpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gUHJldmVudCBkdXBsaWNhdGUgcHJvY2Vzc2luZyBpZiBib3RoIGhhbmRsZXJzIGZpcmUgZm9yIHRoZSBzYW1lIGRyb3BcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGlmIChub3cgLSB0aGlzLmxhc3REcm9wVGltZSA8IHRoaXMuRFJPUF9ERUJPVU5DRV9NUyAmJiB0aGlzLmxhc3REcm9wRGF0YSA9PT0gYWN0dWFsRmlsZVBhdGgpIHtcbiAgICAgIGNvbnNvbGUuZGVidWcoJ1tQcm9wZXJ0eU92ZXJGaWxlTmFtZV0gaGFuZGxlRE9NRHJvcDogSWdub3JpbmcgZHVwbGljYXRlIGRyb3AgZXZlbnQnKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5sYXN0RHJvcFRpbWUgPSBub3c7XG4gICAgdGhpcy5sYXN0RHJvcERhdGEgPSBhY3R1YWxGaWxlUGF0aDtcblxuICAgIC8vIEZpbmQgdGhlIGZpbGUgaW4gdGhlIHZhdWx0XG4gICAgY29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYWN0dWFsRmlsZVBhdGgpO1xuICAgIFxuICAgIGlmICghZmlsZSB8fCAhKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkpIHtcbiAgICAgIGNvbnNvbGUud2FybignW1Byb3BlcnR5T3ZlckZpbGVOYW1lXSBoYW5kbGVET01Ecm9wOiBGaWxlIG5vdCBmb3VuZDonLCBhY3R1YWxGaWxlUGF0aCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gR2V0IHRoZSBkaXNwbGF5IG5hbWUgZnJvbSBmcm9udG1hdHRlciAob25seSBpZiBwcm9wZXJ0eSBleGlzdHMpXG4gICAgY29uc3QgZGlzcGxheU5hbWUgPSB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xuXG4gICAgLy8gT25seSByZXBsYWNlIGxpbmsgaWYgdGhlIGZpbGUgaGFzIHRoZSBwcm9wZXJ0eVxuICAgIC8vIE90aGVyd2lzZSwgbGV0IE9ic2lkaWFuIHVzZSBkZWZhdWx0IGJlaGF2aW9yIChubyBkaXNwbGF5IHRleHQpXG4gICAgaWYgKGRpc3BsYXlOYW1lICE9PSBudWxsKSB7XG4gICAgICAvLyBEb24ndCBwcmV2ZW50IGRlZmF1bHQgLSBsZXQgT2JzaWRpYW4gaW5zZXJ0IHRoZSBkZWZhdWx0IGxpbmsgZmlyc3RcbiAgICAgIC8vIFRoZW4gd2UnbGwgcmVwbGFjZSBpdCB3aXRoIG91ciBjdXN0b20gZGlzcGxheSB0ZXh0XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoYWN0aXZlVmlldyAmJiBhY3RpdmVWaWV3LmVkaXRvcikge1xuICAgICAgICAgIHRoaXMucmVwbGFjZUxhc3RJbnNlcnRlZExpbmsoZmlsZSwgZGlzcGxheU5hbWUsIGFjdGl2ZVZpZXcuZWRpdG9yKTtcbiAgICAgICAgfVxuICAgICAgfSwgNTApO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0RGlzcGxheU5hbWUoZmlsZTogVEZpbGUpOiBzdHJpbmcgfCBudWxsIHtcbiAgICBjb25zdCBmaWxlQ2FjaGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgY29uc3QgZnJvbnRtYXR0ZXIgPSBmaWxlQ2FjaGU/LmZyb250bWF0dGVyO1xuICAgIFxuICAgIC8vIE9ubHkgcmV0dXJuIGRpc3BsYXkgbmFtZSBpZiB0aGUgcHJvcGVydHkgZXhpc3RzIGFuZCBoYXMgYSB2YWx1ZVxuICAgIC8vIFJldHVybiBudWxsIGlmIHByb3BlcnR5IGRvZXNuJ3QgZXhpc3QgKHRvIGluZGljYXRlIHdlIHNob3VsZCB1c2UgZGVmYXVsdCBiZWhhdmlvcilcbiAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSB1bmRlZmluZWQgJiYgZnJvbnRtYXR0ZXJbdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJvcGVydHlLZXldICE9PSBudWxsKSB7XG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gU3RyaW5nKGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSkudHJpbSgpO1xuICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XG4gICAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlOyAvLyBVc2UgZnJvbnRtYXR0ZXIgdGl0bGVcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDsgLy8gTm8gcHJvcGVydHkgLSB1c2UgZGVmYXVsdCBPYnNpZGlhbiBiZWhhdmlvclxuICB9XG5cbiAgcHJpdmF0ZSByZXBsYWNlTGFzdEluc2VydGVkTGluayhmaWxlOiBURmlsZSwgZGlzcGxheU5hbWU6IHN0cmluZywgZWRpdG9yOiBFZGl0b3IpOiB2b2lkIHtcbiAgICBjb25zdCBjb250ZW50ID0gZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuICAgIFxuICAgIC8vIExvb2sgZm9yIHRoZSBtb3N0IHJlY2VudGx5IGluc2VydGVkIGxpbmsgbmVhciB0aGUgY3Vyc29yXG4gICAgY29uc3QgbGluZXMgPSBjb250ZW50LnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBjdXJyZW50TGluZSA9IGxpbmVzW2N1cnNvci5saW5lXTtcbiAgICBcbiAgICAvLyBGaW5kIHdpa2kgbGlua3Mgb3IgbWFya2Rvd24gbGlua3Mgb24gdGhlIGN1cnJlbnQgbGluZVxuICAgIGNvbnN0IHdpa2lMaW5rUmVnZXggPSAvXFxbXFxbKFteXFxdXSspXFxdXFxdL2c7XG4gICAgY29uc3QgbWFya2Rvd25MaW5rUmVnZXggPSAvXFxbKFteXFxdXSspXFxdXFwoKFteKV0rKVxcKS9nO1xuICAgIFxuICAgIGxldCBtYXRjaDtcbiAgICBsZXQgbGFzdE1hdGNoID0gbnVsbDtcbiAgICBcbiAgICAvLyBGaW5kIHRoZSBsYXN0IHdpa2kgbGluayBvbiB0aGUgY3VycmVudCBsaW5lXG4gICAgd2hpbGUgKChtYXRjaCA9IHdpa2lMaW5rUmVnZXguZXhlYyhjdXJyZW50TGluZSkpICE9PSBudWxsKSB7XG4gICAgICBsYXN0TWF0Y2ggPSBtYXRjaDtcbiAgICB9XG4gICAgXG4gICAgaWYgKGxhc3RNYXRjaCkge1xuICAgICAgY29uc3QgbGlua1BhdGggPSBsYXN0TWF0Y2hbMV07XG4gICAgICBjb25zdCBuZXdMaW5rVGV4dCA9IGBbWyR7bGlua1BhdGh9fCR7ZGlzcGxheU5hbWV9XV1gO1xuICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGFzdE1hdGNoLmluZGV4IH07XG4gICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGFzdE1hdGNoLmluZGV4ICsgbGFzdE1hdGNoWzBdLmxlbmd0aCB9O1xuICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdMaW5rVGV4dCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIFJlc2V0IHJlZ2V4IGZvciBtYXJrZG93biBsaW5rc1xuICAgIG1hcmtkb3duTGlua1JlZ2V4Lmxhc3RJbmRleCA9IDA7XG4gICAgXG4gICAgLy8gRmluZCB0aGUgbGFzdCBtYXJrZG93biBsaW5rIG9uIHRoZSBjdXJyZW50IGxpbmVcbiAgICB3aGlsZSAoKG1hdGNoID0gbWFya2Rvd25MaW5rUmVnZXguZXhlYyhjdXJyZW50TGluZSkpICE9PSBudWxsKSB7XG4gICAgICBsYXN0TWF0Y2ggPSBtYXRjaDtcbiAgICB9XG4gICAgXG4gICAgaWYgKGxhc3RNYXRjaCkge1xuICAgICAgY29uc3QgbGlua1VybCA9IGxhc3RNYXRjaFsyXTtcbiAgICAgIGNvbnN0IG5ld0xpbmtUZXh0ID0gYFske2Rpc3BsYXlOYW1lfV0oJHtsaW5rVXJsfSlgO1xuICAgICAgY29uc3Qgc3RhcnRQb3MgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGFzdE1hdGNoLmluZGV4IH07XG4gICAgICBjb25zdCBlbmRQb3MgPSB7IGxpbmU6IGN1cnNvci5saW5lLCBjaDogbGFzdE1hdGNoLmluZGV4ICsgbGFzdE1hdGNoWzBdLmxlbmd0aCB9O1xuICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShuZXdMaW5rVGV4dCwgc3RhcnRQb3MsIGVuZFBvcyk7XG4gICAgfVxuICB9XG59XG4iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcclxuaW1wb3J0IHsgRWRpdG9yU3VnZ2VzdCwgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4gfSBmcm9tIFwiLi4vdHlwZXNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDYWNoZVNlcnZpY2Uge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwcml2YXRlIHN1Z2dlc3Q/OiBFZGl0b3JTdWdnZXN0O1xyXG5cclxuICBjb25zdHJ1Y3RvcihwbHVnaW46IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luKSB7XHJcbiAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICB9XHJcblxyXG4gIHNldFN1Z2dlc3Qoc3VnZ2VzdDogRWRpdG9yU3VnZ2VzdCkge1xyXG4gICAgdGhpcy5zdWdnZXN0ID0gc3VnZ2VzdDtcclxuICB9XHJcblxyXG4gIGludmFsaWRhdGVDYWNoZShmaWxlOiBURmlsZSk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuc3VnZ2VzdCkge1xyXG4gICAgICB0aGlzLnN1Z2dlc3QudXBkYXRlRmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVidWlsZENhY2hlKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuc3VnZ2VzdCkge1xyXG4gICAgICB0aGlzLnN1Z2dlc3QuYnVpbGRGaWxlQ2FjaGUoKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwgIi8qKlxyXG4gKiBHcmFwaCBWaWV3IFNlcnZpY2VcclxuICogXHJcbiAqIFRoaXMgZmlsZSBjb250YWlucyBjb2RlIGFkYXB0ZWQgZnJvbSB0aGUgTm9kZSBNYXNxdWVyYWRlIHBsdWdpbiBieSBFbHNhVGFtLlxyXG4gKiBPcmlnaW5hbCBzb3VyY2U6IGh0dHBzOi8vZ2l0aHViLmNvbS9LYXBpcmtsYWEvb2JzaWRpYW4tbm9kZS1tYXNxdWVyYWRlXHJcbiAqIFxyXG4gKiBUaGUgY29kZSBoYXMgYmVlbiBtb2RpZmllZCB0byBpbnRlZ3JhdGUgd2l0aCB0aGUgUHJvcGVydHkgT3ZlciBGaWxlIE5hbWUgcGx1Z2luXHJcbiAqIGFuZCB1c2UgdGhlIHBsdWdpbidzIHByb3BlcnR5IGtleSBzZXR0aW5nIGluc3RlYWQgb2YgTm9kZSBNYXNxdWVyYWRlJ3MgY29uZmlndXJhdGlvbi5cclxuICogXHJcbiAqIE9yaWdpbmFsIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgR1BMdjMuIFRoaXMgZmlsZSBpcyBhbHNvIGxpY2Vuc2VkIHVuZGVyIEdQTHYzLlxyXG4gKi9cclxuXHJcbmltcG9ydCB7IEFwcCwgVmlldywgV29ya3NwYWNlTGVhZiB9IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IHsgUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4gfSBmcm9tICcuLi90eXBlcyc7XHJcblxyXG4vLyBUeXBlIGRlZmluaXRpb25zIGZvciBncmFwaCB2aWV3IGludGVybmFsc1xyXG5pbnRlcmZhY2UgR3JhcGhOb2RlQ29sbGVjdGlvbiB7XHJcbiAgZmlyc3QoKTogR3JhcGhOb2RlIHwgdW5kZWZpbmVkO1xyXG4gIFtTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhdG9yPEdyYXBoTm9kZT47XHJcbn1cclxuXHJcbmludGVyZmFjZSBHcmFwaFZpZXcge1xyXG4gIHJlbmRlcmVyOiB7XHJcbiAgICBub2RlczogR3JhcGhOb2RlQ29sbGVjdGlvbjtcclxuICAgIGNoYW5nZWQoKTogdm9pZDtcclxuICB9O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgTG9jYWxHcmFwaFZpZXcge1xyXG4gIHJlbmRlcmVyOiB7XHJcbiAgICBub2RlczogR3JhcGhOb2RlQ29sbGVjdGlvbjtcclxuICAgIGNoYW5nZWQoKTogdm9pZDtcclxuICB9O1xyXG59XHJcblxyXG5pbnRlcmZhY2UgR3JhcGhOb2RlIHtcclxuICBpZDogc3RyaW5nO1xyXG4gIHRleHQ/OiB7XHJcbiAgICB0ZXh0OiBzdHJpbmc7XHJcbiAgfTtcclxuICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmc7XHJcbiAgcG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQ/OiAoKSA9PiBzdHJpbmc7XHJcbiAgcG92X3BsdWdpbj86IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgR3JhcGhOb2RlUHJvdG90eXBlIHtcclxuICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmc7XHJcbiAgcG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQ/OiAoKSA9PiBzdHJpbmc7XHJcbiAgcG92X3BsdWdpbj86IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luO1xyXG59XHJcblxyXG5pbnRlcmZhY2UgR3JhcGhOb2RlQ29sbGVjdGlvbldpdGhGaXJzdCBleHRlbmRzIEdyYXBoTm9kZUNvbGxlY3Rpb24ge1xyXG4gIGZpcnN0KCk6IEdyYXBoTm9kZSB8IHVuZGVmaW5lZDtcclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEdyYXBoVmlld1NlcnZpY2Uge1xyXG4gIHByaXZhdGUgcGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbjtcclxuICBwcml2YXRlIG1vZGlmaWVkUHJvdG90eXBlczogR3JhcGhOb2RlUHJvdG90eXBlW10gPSBbXTtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGNyZWF0ZUdldERpc3BsYXlUZXh0KGFwcDogQXBwKSB7XHJcbiAgICByZXR1cm4gZnVuY3Rpb24gZ2V0RGlzcGxheVRleHQodGhpczogR3JhcGhOb2RlKTogc3RyaW5nIHtcclxuICAgICAgY29uc3QgcGx1Z2luID0gdGhpcy5wb3ZfcGx1Z2luO1xyXG4gICAgICBpZiAoIXBsdWdpbiB8fCAhcGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xyXG4gICAgICAgIC8vIElmIGRpc2FibGVkIG9yIHBsdWdpbiBub3QgZm91bmQsIHVzZSBvcmlnaW5hbFxyXG4gICAgICAgIGlmICh0aGlzLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0KSB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5wb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3Bvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0IGRvZXMgbm90IGV4aXN0IG9uIG5vZGUnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gVHJ5IHRvIGdldCBwcm9wZXJ0eSB2YWx1ZVxyXG4gICAgICBjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEZpbGVCeVBhdGgodGhpcy5pZCk7XHJcbiAgICAgIGlmIChmaWxlKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZUNhY2hlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gZmlsZUNhY2hlPy5mcm9udG1hdHRlcjtcclxuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgZnJvbnRtYXR0ZXJbcGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gdW5kZWZpbmVkICYmIGZyb250bWF0dGVyW3BsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gIT09IG51bGwpIHtcclxuICAgICAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBTdHJpbmcoZnJvbnRtYXR0ZXJbcGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSkudHJpbSgpO1xyXG4gICAgICAgICAgaWYgKHByb3BlcnR5VmFsdWUgIT09ICcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm9wZXJ0eVZhbHVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gRmFsbCBiYWNrIHRvIG9yaWdpbmFsIGRpc3BsYXkgdGV4dCAoZmlsZSBuYW1lKVxyXG4gICAgICBpZiAodGhpcy5wb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0KCk7XHJcbiAgICAgIH1cclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dCBkb2VzIG5vdCBleGlzdCBvbiBub2RlJyk7XHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnZXRHcmFwaExlYXZlcygpOiBXb3Jrc3BhY2VMZWFmW10ge1xyXG4gICAgY29uc3QgbGVhdmVzOiBXb3Jrc3BhY2VMZWFmW10gPSBbXTtcclxuICAgIGxlYXZlcy5wdXNoKC4uLnRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdncmFwaCcpKTtcclxuICAgIGxlYXZlcy5wdXNoKC4uLnRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdsb2NhbGdyYXBoJykpO1xyXG4gICAgcmV0dXJuIFsuLi5uZXcgU2V0KGxlYXZlcyldO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBvdmVycmlkZVByb3RvdHlwZXMoKSB7XHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgbGVhdmVzID0gdGhpcy5nZXRHcmFwaExlYXZlcygpO1xyXG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xyXG4gICAgICBpZiAoIShsZWFmLnZpZXcgaW5zdGFuY2VvZiBWaWV3KSB8fCBsZWFmLmlzRGVmZXJyZWQpIGNvbnRpbnVlO1xyXG4gICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIHVua25vd24gYXMgR3JhcGhWaWV3IHwgTG9jYWxHcmFwaFZpZXc7XHJcbiAgICAgIHRoaXMub3ZlcnJpZGVQcm90b3R5cGUodmlldyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIG92ZXJyaWRlUHJvdG90eXBlKHZpZXc6IEdyYXBoVmlldyB8IExvY2FsR3JhcGhWaWV3KSB7XHJcbiAgICAvLyBUcnkgdG8gZ2V0IGZpcnN0IG5vZGUgLSBoYW5kbGUgYm90aCBTZXQgYW5kIGN1c3RvbSBjb2xsZWN0aW9uIHR5cGVzXHJcbiAgICBsZXQgZmlyc3ROb2RlOiBHcmFwaE5vZGUgfCB1bmRlZmluZWQ7XHJcbiAgICBjb25zdCBub2Rlc1dpdGhGaXJzdCA9IHZpZXcucmVuZGVyZXIubm9kZXMgYXMgR3JhcGhOb2RlQ29sbGVjdGlvbldpdGhGaXJzdDtcclxuICAgIGlmICh0eXBlb2Ygbm9kZXNXaXRoRmlyc3QuZmlyc3QgPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgZmlyc3ROb2RlID0gbm9kZXNXaXRoRmlyc3QuZmlyc3QoKTtcclxuICAgIH0gZWxzZSBpZiAodmlldy5yZW5kZXJlci5ub2RlcyBpbnN0YW5jZW9mIFNldCkge1xyXG4gICAgICBmaXJzdE5vZGUgPSAodmlldy5yZW5kZXJlci5ub2Rlcy52YWx1ZXMoKS5uZXh0KCkudmFsdWUgYXMgR3JhcGhOb2RlIHwgdW5kZWZpbmVkKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIC8vIEZhbGxiYWNrOiBpdGVyYXRlIHRvIGdldCBmaXJzdFxyXG4gICAgICBmb3IgKGNvbnN0IG5vZGUgb2Ygdmlldy5yZW5kZXJlci5ub2Rlcykge1xyXG4gICAgICAgIGZpcnN0Tm9kZSA9IG5vZGU7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZiAoZmlyc3ROb2RlKSB7XHJcbiAgICAgIGNvbnN0IHByb3RvID0gZmlyc3ROb2RlLmNvbnN0cnVjdG9yLnByb3RvdHlwZSBhcyBHcmFwaE5vZGVQcm90b3R5cGU7XHJcbiAgICAgIGlmICghcHJvdG8uaGFzT3duUHJvcGVydHkoJ3Bvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0JykgJiYgIXRoaXMubW9kaWZpZWRQcm90b3R5cGVzLmluY2x1ZGVzKHByb3RvKSkge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvdW5ib3VuZC1tZXRob2QgLS0gRnVuY3Rpb24gaXMgZGVzaWduZWQgdG8gYmUgY2FsbGVkIHdpdGggYHRoaXNgIGFzIEdyYXBoTm9kZVxyXG4gICAgICAgIHByb3RvLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0ID0gcHJvdG8uZ2V0RGlzcGxheVRleHQ7XHJcbiAgICAgICAgY29uc3QgZ2V0RGlzcGxheVRleHRGbiA9IHRoaXMuY3JlYXRlR2V0RGlzcGxheVRleHQodGhpcy5wbHVnaW4uYXBwKTtcclxuICAgICAgICBwcm90by5nZXREaXNwbGF5VGV4dCA9IGdldERpc3BsYXlUZXh0Rm47XHJcbiAgICAgICAgLy8gU3RvcmUgcGx1Z2luIHJlZmVyZW5jZSBvbiBwcm90b3R5cGUgZm9yIGFjY2VzcyBpbiBnZXREaXNwbGF5VGV4dFxyXG4gICAgICAgIHByb3RvLnBvdl9wbHVnaW4gPSB0aGlzLnBsdWdpbjtcclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgYWxsIGV4aXN0aW5nIG5vZGVzXHJcbiAgICAgICAgZm9yIChjb25zdCBub2RlIG9mIHZpZXcucmVuZGVyZXIubm9kZXMpIHtcclxuICAgICAgICAgIGlmIChub2RlLnRleHQpIHtcclxuICAgICAgICAgICAgbm9kZS50ZXh0LnRleHQgPSBub2RlLmdldERpc3BsYXlUZXh0KCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZpZXcucmVuZGVyZXIuY2hhbmdlZCgpO1xyXG4gICAgICAgIHRoaXMubW9kaWZpZWRQcm90b3R5cGVzLnB1c2gocHJvdG8pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlc3RvcmVQcm90b3R5cGVzKCkge1xyXG4gICAgZm9yIChjb25zdCBwcm90byBvZiB0aGlzLm1vZGlmaWVkUHJvdG90eXBlcykge1xyXG4gICAgICBpZiAodHlwZW9mIHByb3RvLnBvdl9vcmlnaW5hbEdldERpc3BsYXlUZXh0ID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgcHJvdG8uZ2V0RGlzcGxheVRleHQgPSBwcm90by5wb3Zfb3JpZ2luYWxHZXREaXNwbGF5VGV4dDtcclxuICAgICAgICBkZWxldGUgcHJvdG8ucG92X29yaWdpbmFsR2V0RGlzcGxheVRleHQ7XHJcbiAgICAgIH1cclxuICAgICAgZGVsZXRlIHByb3RvLnBvdl9wbHVnaW47XHJcbiAgICB9XHJcbiAgICB0aGlzLm1vZGlmaWVkUHJvdG90eXBlcyA9IFtdO1xyXG4gICAgdGhpcy5yZXdyaXRlTmFtZXMoKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmV3cml0ZU5hbWVzKCkge1xyXG4gICAgY29uc3QgbGVhdmVzID0gdGhpcy5nZXRHcmFwaExlYXZlcygpO1xyXG4gICAgZm9yIChjb25zdCBsZWFmIG9mIGxlYXZlcykge1xyXG4gICAgICBpZiAoIShsZWFmLnZpZXcgaW5zdGFuY2VvZiBWaWV3KSB8fCBsZWFmLmlzRGVmZXJyZWQpIGNvbnRpbnVlO1xyXG4gICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIHVua25vd24gYXMgR3JhcGhWaWV3IHwgTG9jYWxHcmFwaFZpZXc7XHJcbiAgICAgIGZvciAoY29uc3Qgbm9kZSBvZiB2aWV3LnJlbmRlcmVyLm5vZGVzKSB7XHJcbiAgICAgICAgaWYgKG5vZGUudGV4dCkge1xyXG4gICAgICAgICAgbm9kZS50ZXh0LnRleHQgPSBub2RlLmdldERpc3BsYXlUZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHZpZXcucmVuZGVyZXIuY2hhbmdlZCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb25MYXlvdXRDaGFuZ2UoKSB7XHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xyXG4gICAgICB0aGlzLnJlc3RvcmVQcm90b3R5cGVzKCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gQ2hlY2sgaWYgZ3JhcGggcGx1Z2luIGlzIGxvYWRlZFxyXG4gICAgY29uc3QgYXBwSW50ZXJuYWwgPSB0aGlzLnBsdWdpbi5hcHAgYXMgQXBwICYgeyBpbnRlcm5hbFBsdWdpbnM/OiB7IGdldFBsdWdpbkJ5SWQ/OiAoaWQ6IHN0cmluZykgPT4geyBfbG9hZGVkPzogYm9vbGVhbiB9IHwgbnVsbCB9IH07XHJcbiAgICBjb25zdCBncmFwaFBsdWdpbiA9IGFwcEludGVybmFsLmludGVybmFsUGx1Z2lucz8uZ2V0UGx1Z2luQnlJZD8uKCdncmFwaCcpO1xyXG4gICAgaWYgKCFncmFwaFBsdWdpbj8uX2xvYWRlZCkgcmV0dXJuO1xyXG4gICAgXHJcbiAgICB0aGlzLm92ZXJyaWRlUHJvdG90eXBlcygpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlR3JhcGhWaWV3KCkge1xyXG4gICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckdyYXBoVmlldykge1xyXG4gICAgICB0aGlzLm92ZXJyaWRlUHJvdG90eXBlcygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5yZXN0b3JlUHJvdG90eXBlcygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVmcmVzaEdyYXBoVmlldygpIHtcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JHcmFwaFZpZXcpIHtcclxuICAgICAgdGhpcy5yZXdyaXRlTmFtZXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIG9udW5sb2FkKCkge1xyXG4gICAgdGhpcy5yZXN0b3JlUHJvdG90eXBlcygpO1xyXG4gIH1cclxufVxyXG5cclxuIiwgImltcG9ydCB7IE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luIH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEJhY2tsaW5rIFNlcnZpY2VcclxuICogXHJcbiAqIEhhbmRsZXMgZGlzcGxheWluZyBwcm9wZXJ0eSB0aXRsZXMgaW5zdGVhZCBvZiBmaWxlIG5hbWVzIGluOlxyXG4gKiAtIEVtYmVkZGVkIGJhY2tsaW5rcyAoTGlua2VkIG1lbnRpb25zIGZvb3RlciBpbiBlYWNoIG5vdGUpXHJcbiAqIC0gRGVkaWNhdGVkIGJhY2tsaW5rcyBwYW5lbFxyXG4gKiAtIE91dGdvaW5nIGxpbmtzXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgQmFja2xpbmtTZXJ2aWNlIHtcclxuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbiAgcHJpdmF0ZSBvYnNlcnZlcj86IE11dGF0aW9uT2JzZXJ2ZXI7XHJcbiAgcHJpdmF0ZSBwcm9jZXNzZWRFbGVtZW50czogV2Vha1NldDxIVE1MRWxlbWVudD4gPSBuZXcgV2Vha1NldCgpO1xyXG4gIHByaXZhdGUgbW9kaWZpZWRFbGVtZW50czogV2Vha1NldDxIVE1MRWxlbWVudD4gPSBuZXcgV2Vha1NldCgpO1xyXG4gIHByaXZhdGUgb3JpZ2luYWxUZXh0Q29udGVudERlc2NyaXB0b3JzOiBNYXA8SFRNTEVsZW1lbnQsIFByb3BlcnR5RGVzY3JpcHRvcj4gPSBuZXcgTWFwKCk7XHJcblxyXG4gIGNvbnN0cnVjdG9yKHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW4pIHtcclxuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0IGRpc3BsYXkgbmFtZSBmcm9tIGZpbGUncyBmcm9udG1hdHRlciBwcm9wZXJ0eVxyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0RGlzcGxheU5hbWUoZmlsZTogVEZpbGUpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZpbGVDYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gZmlsZUNhY2hlPy5mcm9udG1hdHRlcjtcclxuICAgIFxyXG4gICAgaWYgKGZyb250bWF0dGVyICYmIGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gdW5kZWZpbmVkICYmIGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSAhPT0gbnVsbCkge1xyXG4gICAgICBjb25zdCBwcm9wZXJ0eVZhbHVlID0gU3RyaW5nKGZyb250bWF0dGVyW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSkudHJpbSgpO1xyXG4gICAgICBpZiAocHJvcGVydHlWYWx1ZSAhPT0gJycpIHtcclxuICAgICAgICByZXR1cm4gcHJvcGVydHlWYWx1ZTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGFsbCBiYWNrbGluayBkaXNwbGF5c1xyXG4gICAqL1xyXG4gIHVwZGF0ZUJhY2tsaW5rcygpOiB2b2lkIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHRoaXMuc3RvcE9ic2VydmluZygpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVXBkYXRlIGVtYmVkZGVkIGJhY2tsaW5rcyBpbiBhbGwgbWFya2Rvd24gdmlld3NcclxuICAgIHRoaXMudXBkYXRlRW1iZWRkZWRCYWNrbGlua3MoKTtcclxuICAgIFxyXG4gICAgLy8gVXBkYXRlIGRlZGljYXRlZCBiYWNrbGlua3MgcGFuZWxcclxuICAgIHZvaWQgdGhpcy51cGRhdGVEZWRpY2F0ZWRCYWNrbGlua3NQYW5lbCgpO1xyXG5cclxuICAgIC8vIFN0YXJ0IG9ic2VydmluZyBmb3IgZnV0dXJlIGNoYW5nZXNcclxuICAgIHRoaXMuc3RhcnRPYnNlcnZpbmcoKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBlbWJlZGRlZCBiYWNrbGlua3MgaW4gbWFya2Rvd24gdmlld3NcclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZUVtYmVkZGVkQmFja2xpbmtzKCk6IHZvaWQge1xyXG4gICAgZm9yIChjb25zdCBsZWFmIG9mIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpKSB7XHJcbiAgICAgIGlmICghKGxlYWYudmlldyBpbnN0YW5jZW9mIE1hcmtkb3duVmlldykpIHtcclxuICAgICAgICBjb250aW51ZTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc3QgZW1iZWRkZWRCYWNrbGlua3MgPSBsZWFmLnZpZXcuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLmVtYmVkZGVkLWJhY2tsaW5rcycpO1xyXG4gICAgICBpZiAoZW1iZWRkZWRCYWNrbGlua3MpIHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rQ29udGFpbmVyKGVtYmVkZGVkQmFja2xpbmtzIGFzIEhUTUxFbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGRlZGljYXRlZCBiYWNrbGlua3MgcGFuZWxcclxuICAgKi9cclxuICBwcml2YXRlIGFzeW5jIHVwZGF0ZURlZGljYXRlZEJhY2tsaW5rc1BhbmVsKCk6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgY29uc3QgYmFja2xpbmtzTGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2JhY2tsaW5rJyk7XHJcbiAgICBcclxuICAgIGZvciAoY29uc3QgbGVhZiBvZiBiYWNrbGlua3NMZWF2ZXMpIHtcclxuICAgICAgYXdhaXQgbGVhZi5sb2FkSWZEZWZlcnJlZCgpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGxlYWYudmlldykge1xyXG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IChsZWFmLnZpZXcgYXMgeyBjb250YWluZXJFbD86IEhUTUxFbGVtZW50IH0pLmNvbnRhaW5lckVsO1xyXG4gICAgICAgIGlmIChjb250YWluZXIpIHtcclxuICAgICAgICAgIC8vIEZpbmQgYmFja2xpbmtzIGFuZCBvdXRnb2luZyBsaW5rcyBzZWN0aW9uc1xyXG4gICAgICAgICAgY29uc3QgYmFja2xpbmtzQ29udGFpbmVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5iYWNrbGlua3MtcGFuZScpIHx8IGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCcuYmFja2xpbmstcGFuZScpO1xyXG4gICAgICAgICAgaWYgKGJhY2tsaW5rc0NvbnRhaW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rQ29udGFpbmVyKGJhY2tsaW5rc0NvbnRhaW5lciBhcyBIVE1MRWxlbWVudCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIEFsc28gY2hlY2sgZm9yIG91dGdvaW5nIGxpbmtzXHJcbiAgICAgICAgICBjb25zdCBvdXRnb2luZ0xpbmtzQ29udGFpbmVyID0gY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJy5vdXRnb2luZy1saW5rLXBhbmUnKSB8fCBjb250YWluZXIucXVlcnlTZWxlY3RvcignLm91dGdvaW5nLWxpbmtzJyk7XHJcbiAgICAgICAgICBpZiAob3V0Z29pbmdMaW5rc0NvbnRhaW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rQ29udGFpbmVyKG91dGdvaW5nTGlua3NDb250YWluZXIgYXMgSFRNTEVsZW1lbnQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRXh0cmFjdCBmaWxlIHBhdGggZnJvbSBhbiBlbGVtZW50IG9yIGl0cyBwYXJlbnQgbGlua1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZXh0cmFjdEZpbGVQYXRoRnJvbUVsZW1lbnQoZWxlbWVudDogSFRNTEVsZW1lbnQpOiBURmlsZSB8IG51bGwge1xyXG4gICAgLy8gVHJ5IGRhdGEtcGF0aCBhdHRyaWJ1dGUgZmlyc3RcclxuICAgIGNvbnN0IGRhdGFQYXRoID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcpO1xyXG4gICAgaWYgKGRhdGFQYXRoKSB7XHJcbiAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRhdGFQYXRoKTtcclxuICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgIHJldHVybiBmaWxlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVHJ5IHRvIGZpbmQgYSBsaW5rIGVsZW1lbnQgKHBhcmVudCBvciBjaGlsZClcclxuICAgIGNvbnN0IGxpbmsgPSBlbGVtZW50LmNsb3Nlc3QoJ2EnKSB8fCBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcclxuICAgIGlmIChsaW5rKSB7XHJcbiAgICAgIGNvbnN0IGhyZWYgPSBsaW5rIGluc3RhbmNlb2YgSFRNTEFuY2hvckVsZW1lbnQgPyBsaW5rLmhyZWYgOiAobGluayBhcyBFbGVtZW50KS5nZXRBdHRyaWJ1dGUoJ2hyZWYnKTtcclxuICAgICAgaWYgKGhyZWYpIHtcclxuICAgICAgICAvLyBUcnkgb2JzaWRpYW46Ly8gVVJMIGZvcm1hdFxyXG4gICAgICAgIGlmIChocmVmLnN0YXJ0c1dpdGgoJ29ic2lkaWFuOi8vJykpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoaHJlZik7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVQYXJhbSA9IHVybC5zZWFyY2hQYXJhbXMuZ2V0KCdmaWxlJyk7XHJcbiAgICAgICAgICAgIGlmIChmaWxlUGFyYW0pIHtcclxuICAgICAgICAgICAgICBjb25zdCBkZWNvZGVkUGF0aCA9IGRlY29kZVVSSUNvbXBvbmVudChmaWxlUGFyYW0pO1xyXG4gICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRlY29kZWRQYXRoICsgJy5tZCcpO1xyXG4gICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgIC8vIElnbm9yZSBVUkwgcGFyc2luZyBlcnJvcnNcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVHJ5IGludGVybmFsIGxpbmsgZm9ybWF0IChlLmcuLCAjZmlsZS9wYXRoL3RvL2ZpbGUpXHJcbiAgICAgICAgY29uc3QgaW50ZXJuYWxMaW5rTWF0Y2ggPSBocmVmLm1hdGNoKC8jZmlsZVxcLyguKykvKTtcclxuICAgICAgICBpZiAoaW50ZXJuYWxMaW5rTWF0Y2gpIHtcclxuICAgICAgICAgIGNvbnN0IGZpbGVQYXRoID0gZGVjb2RlVVJJQ29tcG9uZW50KGludGVybmFsTGlua01hdGNoWzFdKTtcclxuICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcclxuICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbGU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBUcnkgZGF0YS1ocmVmIGF0dHJpYnV0ZSAoT2JzaWRpYW4gc29tZXRpbWVzIHVzZXMgdGhpcylcclxuICAgICAgICBjb25zdCBkYXRhSHJlZiA9IGxpbmsuZ2V0QXR0cmlidXRlKCdkYXRhLWhyZWYnKTtcclxuICAgICAgICBpZiAoZGF0YUhyZWYpIHtcclxuICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGRhdGFIcmVmKTtcclxuICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZpbGU7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gVHJ5IHRvIG1hdGNoIHRleHQgY29udGVudCB0byBhIGZpbGUgYmFzZW5hbWVcclxuICAgIGNvbnN0IHRleHRDb250ZW50ID0gZWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpO1xyXG4gICAgaWYgKHRleHRDb250ZW50KSB7XHJcbiAgICAgIC8vIFRyeSB0byBmaW5kIGZpbGUgYnkgYmFzZW5hbWUgKHdpdGhvdXQgZXh0ZW5zaW9uKVxyXG4gICAgICBjb25zdCBhbGxGaWxlcyA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgIGNvbnN0IG1hdGNoaW5nRmlsZSA9IGFsbEZpbGVzLmZpbmQoZiA9PiBmLmJhc2VuYW1lID09PSB0ZXh0Q29udGVudCk7XHJcbiAgICAgIGlmIChtYXRjaGluZ0ZpbGUpIHtcclxuICAgICAgICByZXR1cm4gbWF0Y2hpbmdGaWxlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBVcGRhdGUgYSBiYWNrbGluayBjb250YWluZXIgYnkgcmVwbGFjaW5nIGZpbGUgbmFtZXMgd2l0aCBwcm9wZXJ0eSB0aXRsZXNcclxuICAgKi9cclxuICBwcml2YXRlIHVwZGF0ZUJhY2tsaW5rQ29udGFpbmVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIC8vIEZpbmQgYWxsIHBvdGVudGlhbCBmaWxlIG5hbWUgZWxlbWVudHMgaW4gdGhlIGNvbnRhaW5lclxyXG4gICAgLy8gT2JzaWRpYW4gdXNlcyB2YXJpb3VzIHNlbGVjdG9ycyBmb3IgYmFja2xpbmsgaXRlbXNcclxuICAgIGNvbnN0IHNlbGVjdG9ycyA9IFtcclxuICAgICAgJy50cmVlLWl0ZW0taW5uZXInLFxyXG4gICAgICAnLmJhY2tsaW5rLXRpdGxlJyxcclxuICAgICAgJy5iYWNrbGluay1maWxlLWxpbmsnLFxyXG4gICAgICAnLm91dGdvaW5nLWxpbmstZmlsZS1saW5rJyxcclxuICAgICAgJy50cmVlLWl0ZW0tc2VsZicsXHJcbiAgICAgICcubmF2LWZpbGUtdGl0bGUnLFxyXG4gICAgICAnW2RhdGEtcGF0aF0nLFxyXG4gICAgICAnYS5pbnRlcm5hbC1saW5rJ1xyXG4gICAgXTtcclxuXHJcbiAgICBjb25zdCBmaWxlRWxlbWVudHMgPSBuZXcgU2V0PEhUTUxFbGVtZW50PigpO1xyXG5cclxuICAgIC8vIENvbGxlY3QgYWxsIHBvdGVudGlhbCBlbGVtZW50c1xyXG4gICAgc2VsZWN0b3JzLmZvckVhY2goc2VsZWN0b3IgPT4ge1xyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKS5mb3JFYWNoKGVsID0+IHtcclxuICAgICAgICAgIGZpbGVFbGVtZW50cy5hZGQoZWwgYXMgSFRNTEVsZW1lbnQpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9IGNhdGNoIHtcclxuICAgICAgICAvLyBJZ25vcmUgaW52YWxpZCBzZWxlY3RvciBlcnJvcnNcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgZmlsZUVsZW1lbnRzLmZvckVhY2goKGVsZW1lbnQpID0+IHtcclxuICAgICAgLy8gU2tpcCBpZiBhbHJlYWR5IHByb2Nlc3NlZCBpbiB0aGlzIHVwZGF0ZSBjeWNsZVxyXG4gICAgICBpZiAodGhpcy5wcm9jZXNzZWRFbGVtZW50cy5oYXMoZWxlbWVudCkpIHtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIEV4dHJhY3QgZmlsZSBmcm9tIGVsZW1lbnRcclxuICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZXh0cmFjdEZpbGVQYXRoRnJvbUVsZW1lbnQoZWxlbWVudCk7XHJcbiAgICAgIGlmIChmaWxlICYmIGZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICAgIHRoaXMudXBkYXRlRWxlbWVudFdpdGhGaWxlKGVsZW1lbnQsIGZpbGUpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSBhbiBlbGVtZW50IHdpdGggZmlsZSdzIGRpc3BsYXkgbmFtZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlRWxlbWVudFdpdGhGaWxlKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBmaWxlOiBURmlsZSk6IHZvaWQge1xyXG4gICAgY29uc3QgZGlzcGxheU5hbWUgPSB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xyXG4gICAgXHJcbiAgICBpZiAoZGlzcGxheU5hbWUgPT09IG51bGwpIHtcclxuICAgICAgLy8gTm8gcHJvcGVydHksIHVzZSBkZWZhdWx0IGJlaGF2aW9yIChmaWxlIG5hbWUpXHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBNYXJrIGFzIHByb2Nlc3NlZFxyXG4gICAgdGhpcy5wcm9jZXNzZWRFbGVtZW50cy5hZGQoZWxlbWVudCk7XHJcbiAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1wb3YtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuXHJcbiAgICAvLyBGaW5kIHRoZSB0ZXh0IG5vZGUgb3IgZWxlbWVudCB0aGF0IGNvbnRhaW5zIHRoZSBmaWxlIG5hbWVcclxuICAgIGNvbnN0IGN1cnJlbnRUZXh0ID0gZWxlbWVudC50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgY29uc3QgYmFzZW5hbWUgPSBmaWxlLmJhc2VuYW1lO1xyXG5cclxuICAgIC8vIE9ubHkgdXBkYXRlIGlmIHRoZSBjdXJyZW50IHRleHQgbWF0Y2hlcyB0aGUgYmFzZW5hbWUgb3IgZmlsZSBuYW1lXHJcbiAgICAvLyBUaGlzIHByZXZlbnRzIG92ZXJ3cml0aW5nIGN1c3RvbSB0ZXh0IHRoYXQgbWlnaHQgYWxyZWFkeSBiZSBzZXRcclxuICAgIGlmIChjdXJyZW50VGV4dCA9PT0gYmFzZW5hbWUgfHwgY3VycmVudFRleHQgPT09IGZpbGUubmFtZSB8fCBjdXJyZW50VGV4dC5lbmRzV2l0aChiYXNlbmFtZSkpIHtcclxuICAgICAgLy8gRmluZCB0aGUgbGluayBlbGVtZW50IChpZiBhbnkpXHJcbiAgICAgIGNvbnN0IGxpbmsgPSBlbGVtZW50LmNsb3Nlc3QoJ2EnKSB8fCBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2EnKTtcclxuICAgICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IGxpbmsgfHwgZWxlbWVudDtcclxuXHJcbiAgICAgIC8vIFRyeSB0byBwcmVzZXJ2ZSB0aGUgc3RydWN0dXJlIHdoaWxlIHVwZGF0aW5nIHRleHRcclxuICAgICAgLy8gTG9vayBmb3IgdGV4dCBub2RlcyBvciBlbGVtZW50cyB0aGF0IGNvbnRhaW4gdGhlIGZpbGUgbmFtZVxyXG4gICAgICBjb25zdCB1cGRhdGVUZXh0SW5FbGVtZW50ID0gKGVsOiBIVE1MRWxlbWVudCkgPT4ge1xyXG4gICAgICAgIC8vIENoZWNrIGlmIGVsZW1lbnQgaGFzIGEgc2luZ2xlIHRleHQgbm9kZSBjaGlsZFxyXG4gICAgICAgIGlmIChlbC5jaGlsZE5vZGVzLmxlbmd0aCA9PT0gMSAmJiBlbC5jaGlsZE5vZGVzWzBdLm5vZGVUeXBlID09PSBOb2RlLlRFWFRfTk9ERSkge1xyXG4gICAgICAgICAgZWwudGV4dENvbnRlbnQgPSBkaXNwbGF5TmFtZTtcclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTG9vayBmb3IgdGV4dCBub2Rlc1xyXG4gICAgICAgIGNvbnN0IHRleHROb2RlcyA9IEFycmF5LmZyb20oZWwuY2hpbGROb2RlcykuZmlsdGVyKG5vZGUgPT4gbm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5URVhUX05PREUpO1xyXG4gICAgICAgIGlmICh0ZXh0Tm9kZXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgLy8gVXBkYXRlIHRoZSBmaXJzdCB0ZXh0IG5vZGVcclxuICAgICAgICAgIHRleHROb2Rlc1swXS50ZXh0Q29udGVudCA9IGRpc3BsYXlOYW1lO1xyXG4gICAgICAgICAgLy8gUmVtb3ZlIG90aGVyIHRleHQgbm9kZXMgdG8gYXZvaWQgZHVwbGljYXRpb25cclxuICAgICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgdGV4dE5vZGVzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIHRleHROb2Rlc1tpXS5yZW1vdmUoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gSWYgbm8gdGV4dCBub2RlcywgY2hlY2sgaWYgd2Ugc2hvdWxkIHJlcGxhY2UgYWxsIGNvbnRlbnRcclxuICAgICAgICAvLyBPbmx5IGRvIHRoaXMgaWYgdGhlIGVsZW1lbnQncyB0ZXh0IG1hdGNoZXMgdGhlIGZpbGUgbmFtZVxyXG4gICAgICAgIGlmIChlbC50ZXh0Q29udGVudD8udHJpbSgpID09PSBiYXNlbmFtZSB8fCBlbC50ZXh0Q29udGVudD8udHJpbSgpID09PSBmaWxlLm5hbWUpIHtcclxuICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gZGlzcGxheU5hbWU7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgfTtcclxuXHJcbiAgICAgIC8vIFRyeSB0byB1cGRhdGUgdGhlIGxpbmsgZmlyc3QsIHRoZW4gZmFsbCBiYWNrIHRvIGVsZW1lbnRcclxuICAgICAgaWYgKCF1cGRhdGVUZXh0SW5FbGVtZW50KHRhcmdldEVsZW1lbnQpKSB7XHJcbiAgICAgICAgLy8gSWYgbGluayB1cGRhdGUgZmFpbGVkLCB0cnkgdGhlIGVsZW1lbnQgaXRzZWxmXHJcbiAgICAgICAgdXBkYXRlVGV4dEluRWxlbWVudChlbGVtZW50KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogU3RhcnQgb2JzZXJ2aW5nIERPTSBjaGFuZ2VzIGZvciBiYWNrbGlua3NcclxuICAgKi9cclxuICBwcml2YXRlIHN0YXJ0T2JzZXJ2aW5nKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMub2JzZXJ2ZXIpIHtcclxuICAgICAgcmV0dXJuOyAvLyBBbHJlYWR5IG9ic2VydmluZ1xyXG4gICAgfVxyXG5cclxuICAgIC8vIE92ZXJyaWRlIHRleHRDb250ZW50IG9uIGJhY2tsaW5rIGVsZW1lbnRzIHRvIGludGVyY2VwdCBpbW1lZGlhdGVseVxyXG4gICAgdGhpcy5vdmVycmlkZUJhY2tsaW5rRWxlbWVudHMoKTtcclxuXHJcbiAgICBsZXQgdXBkYXRlVGltZW91dDogUmV0dXJuVHlwZTx0eXBlb2Ygc2V0VGltZW91dD4gfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICB0aGlzLm9ic2VydmVyID0gbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKG11dGF0aW9ucykgPT4ge1xyXG4gICAgICAvLyBDaGVjayBpZiBhbnkgbXV0YXRpb25zIGFmZmVjdCBiYWNrbGluayBjb250YWluZXJzXHJcbiAgICAgIGxldCBzaG91bGRVcGRhdGUgPSBmYWxzZTtcclxuICAgICAgY29uc3QgbmV3RWxlbWVudHM6IEhUTUxFbGVtZW50W10gPSBbXTtcclxuXHJcbiAgICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25zKSB7XHJcbiAgICAgICAgaWYgKG11dGF0aW9uLnR5cGUgPT09ICdjaGlsZExpc3QnKSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBmb3IgbmV3IGVsZW1lbnRzIHRoYXQgbWlnaHQgYmUgYmFja2xpbmtzXHJcbiAgICAgICAgICBmb3IgKGNvbnN0IG5vZGUgb2YgQXJyYXkuZnJvbShtdXRhdGlvbi5hZGRlZE5vZGVzKSkge1xyXG4gICAgICAgICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgZW1iZWRkZWRCYWNrbGlua3MgPSBub2RlLmNsb3Nlc3QoJy5lbWJlZGRlZC1iYWNrbGlua3MnKTtcclxuICAgICAgICAgICAgICBjb25zdCBiYWNrbGlua3NQYW5lbCA9IG5vZGUuY2xvc2VzdCgnLmJhY2tsaW5rcy1wYW5lLCAuYmFja2xpbmstcGFuZSwgLm91dGdvaW5nLWxpbmstcGFuZSwgLm91dGdvaW5nLWxpbmtzLCAuYmFja2xpbmstY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgaWYgKGVtYmVkZGVkQmFja2xpbmtzIHx8IGJhY2tsaW5rc1BhbmVsKSB7XHJcbiAgICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgLy8gRmluZCBwb3RlbnRpYWwgYmFja2xpbmsgZWxlbWVudHMgaW4gdGhlIG5ldyBub2RlXHJcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3RvcnMgPSBbJy50cmVlLWl0ZW0taW5uZXInLCAnLmJhY2tsaW5rLXRpdGxlJywgJy5iYWNrbGluay1maWxlLWxpbmsnLCAnLm91dGdvaW5nLWxpbmstZmlsZS1saW5rJywgJy50cmVlLWl0ZW0tc2VsZicsICcubmF2LWZpbGUtdGl0bGUnLCAnW2RhdGEtcGF0aF0nLCAnYS5pbnRlcm5hbC1saW5rJ107XHJcbiAgICAgICAgICAgICAgICBzZWxlY3RvcnMuZm9yRWFjaChzZWxlY3RvciA9PiB7XHJcbiAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBub2RlLnF1ZXJ5U2VsZWN0b3JBbGw/LihzZWxlY3Rvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHM/LmZvckVhY2goKGVsOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoZWwgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdFbGVtZW50cy5wdXNoKGVsKTtcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gSWdub3JlXHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoYXJhY3RlckRhdGEnKSB7XHJcbiAgICAgICAgICBjb25zdCB0YXJnZXQgPSBtdXRhdGlvbi50YXJnZXQ7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIENoZWNrIGlmIG11dGF0aW9uIGlzIGluIGEgYmFja2xpbmsgY29udGFpbmVyXHJcbiAgICAgICAgICBpZiAodGFyZ2V0IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgY29uc3QgZW1iZWRkZWRCYWNrbGlua3MgPSB0YXJnZXQuY2xvc2VzdCgnLmVtYmVkZGVkLWJhY2tsaW5rcycpO1xyXG4gICAgICAgICAgICBjb25zdCBiYWNrbGlua3NQYW5lbCA9IHRhcmdldC5jbG9zZXN0KCcuYmFja2xpbmtzLXBhbmUsIC5iYWNrbGluay1wYW5lLCAub3V0Z29pbmctbGluay1wYW5lLCAub3V0Z29pbmctbGlua3MsIC5iYWNrbGluay1jb250YWluZXInKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmIChlbWJlZGRlZEJhY2tsaW5rcyB8fCBiYWNrbGlua3NQYW5lbCkge1xyXG4gICAgICAgICAgICAgIHNob3VsZFVwZGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0gZWxzZSBpZiAodGFyZ2V0LnBhcmVudEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgLy8gQ2hlY2sgcGFyZW50IGVsZW1lbnRcclxuICAgICAgICAgICAgY29uc3QgZW1iZWRkZWRCYWNrbGlua3MgPSB0YXJnZXQucGFyZW50RWxlbWVudC5jbG9zZXN0KCcuZW1iZWRkZWQtYmFja2xpbmtzJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGJhY2tsaW5rc1BhbmVsID0gdGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xvc2VzdCgnLmJhY2tsaW5rcy1wYW5lLCAuYmFja2xpbmstcGFuZSwgLm91dGdvaW5nLWxpbmstcGFuZSwgLm91dGdvaW5nLWxpbmtzLCAuYmFja2xpbmstY29udGFpbmVyJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoZW1iZWRkZWRCYWNrbGlua3MgfHwgYmFja2xpbmtzUGFuZWwpIHtcclxuICAgICAgICAgICAgICBzaG91bGRVcGRhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBPdmVycmlkZSBuZXcgZWxlbWVudHMgaW1tZWRpYXRlbHkgYW5kIHVwZGF0ZSB0aGVtXHJcbiAgICAgIG5ld0VsZW1lbnRzLmZvckVhY2goZWwgPT4ge1xyXG4gICAgICAgIHRoaXMub3ZlcnJpZGVFbGVtZW50VGV4dENvbnRlbnQoZWwpO1xyXG4gICAgICAgIC8vIEFsc28gdHJ5IHRvIHVwZGF0ZSBpbW1lZGlhdGVseSBpZiB3ZSBjYW4gZXh0cmFjdCB0aGUgZmlsZVxyXG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmV4dHJhY3RGaWxlUGF0aEZyb21FbGVtZW50KGVsKTtcclxuICAgICAgICBpZiAoZmlsZSAmJiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcclxuICAgICAgICAgIGNvbnN0IGRpc3BsYXlOYW1lID0gdGhpcy5nZXREaXNwbGF5TmFtZShmaWxlKTtcclxuICAgICAgICAgIGlmIChkaXNwbGF5TmFtZSkge1xyXG4gICAgICAgICAgICAvLyBDaGVjayBjdXJyZW50IHRleHQgYW5kIHJlcGxhY2UgaWYgaXQncyB0aGUgZmlsZW5hbWVcclxuICAgICAgICAgICAgY29uc3QgY3VycmVudFRleHQgPSBlbC50ZXh0Q29udGVudD8udHJpbSgpIHx8ICcnO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudFRleHQgPT09IGZpbGUuYmFzZW5hbWUgfHwgY3VycmVudFRleHQgPT09IGZpbGUubmFtZSkge1xyXG4gICAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gZGlzcGxheU5hbWU7XHJcbiAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG4gICAgICAgICAgICAgIHRoaXMucHJvY2Vzc2VkRWxlbWVudHMuYWRkKGVsKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAoc2hvdWxkVXBkYXRlKSB7XHJcbiAgICAgICAgLy8gQ2xlYXIgcHJvY2Vzc2VkIGVsZW1lbnRzIGNhY2hlIHdoZW4gdXBkYXRpbmdcclxuICAgICAgICB0aGlzLnByb2Nlc3NlZEVsZW1lbnRzID0gbmV3IFdlYWtTZXQoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBEZWJvdW5jZSB1cGRhdGVzIHRvIGF2b2lkIGV4Y2Vzc2l2ZSBwcm9jZXNzaW5nXHJcbiAgICAgICAgaWYgKHVwZGF0ZVRpbWVvdXQpIHtcclxuICAgICAgICAgIGNsZWFyVGltZW91dCh1cGRhdGVUaW1lb3V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdXBkYXRlVGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVCYWNrbGlua3MoKTtcclxuICAgICAgICAgIHRoaXMub3ZlcnJpZGVCYWNrbGlua0VsZW1lbnRzKCk7IC8vIFJlLW92ZXJyaWRlIGluIGNhc2UgbmV3IGVsZW1lbnRzIHdlcmUgYWRkZWRcclxuICAgICAgICAgIHVwZGF0ZVRpbWVvdXQgPSBudWxsO1xyXG4gICAgICAgIH0sIDEwKTsgLy8gVmVyeSBzaG9ydCBkZWxheSBmb3IgZmFzdGVyIHVwZGF0ZXNcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gT2JzZXJ2ZSB0aGUgZW50aXJlIGRvY3VtZW50IGZvciBjaGFuZ2VzXHJcbiAgICB0aGlzLm9ic2VydmVyLm9ic2VydmUoZG9jdW1lbnQuYm9keSwge1xyXG4gICAgICBjaGlsZExpc3Q6IHRydWUsXHJcbiAgICAgIHN1YnRyZWU6IHRydWUsXHJcbiAgICAgIGNoYXJhY3RlckRhdGE6IHRydWUsXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE92ZXJyaWRlIHRleHRDb250ZW50IG9uIGFsbCBiYWNrbGluayBlbGVtZW50c1xyXG4gICAqL1xyXG4gIHByaXZhdGUgb3ZlcnJpZGVCYWNrbGlua0VsZW1lbnRzKCk6IHZvaWQge1xyXG4gICAgY29uc3Qgc2VsZWN0b3JzID0gW1xyXG4gICAgICAnLnRyZWUtaXRlbS1pbm5lcicsXHJcbiAgICAgICcuYmFja2xpbmstdGl0bGUnLFxyXG4gICAgICAnLmJhY2tsaW5rLWZpbGUtbGluaycsXHJcbiAgICAgICcub3V0Z29pbmctbGluay1maWxlLWxpbmsnLFxyXG4gICAgICAnLnRyZWUtaXRlbS1zZWxmJyxcclxuICAgICAgJy5uYXYtZmlsZS10aXRsZScsXHJcbiAgICAgICdbZGF0YS1wYXRoXScsXHJcbiAgICAgICdhLmludGVybmFsLWxpbmsnXHJcbiAgICBdO1xyXG5cclxuICAgIGNvbnN0IGNvbnRhaW5lcnMgPSBbXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmVtYmVkZGVkLWJhY2tsaW5rcycpKSxcclxuICAgICAgLi4uQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuYmFja2xpbmtzLXBhbmUnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tsaW5rLXBhbmUnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm91dGdvaW5nLWxpbmstcGFuZScpKSxcclxuICAgICAgLi4uQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcub3V0Z29pbmctbGlua3MnKSksXHJcbiAgICAgIC4uLkFycmF5LmZyb20oZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmJhY2tsaW5rLWNvbnRhaW5lcicpKVxyXG4gICAgXTtcclxuXHJcbiAgICBjb250YWluZXJzLmZvckVhY2goY29udGFpbmVyID0+IHtcclxuICAgICAgc2VsZWN0b3JzLmZvckVhY2goc2VsZWN0b3IgPT4ge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChzZWxlY3RvcikuZm9yRWFjaChlbCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlbCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5vdmVycmlkZUVsZW1lbnRUZXh0Q29udGVudChlbCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgICAgLy8gSWdub3JlIGludmFsaWQgc2VsZWN0b3IgZXJyb3JzXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogT3ZlcnJpZGUgdGV4dENvbnRlbnQgc2V0dGVyIG9uIGFuIGVsZW1lbnQgdG8gaW50ZXJjZXB0IE9ic2lkaWFuJ3MgdXBkYXRlc1xyXG4gICAqL1xyXG4gIHByaXZhdGUgb3ZlcnJpZGVFbGVtZW50VGV4dENvbnRlbnQoZWxlbWVudDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLm1vZGlmaWVkRWxlbWVudHMuaGFzKGVsZW1lbnQpKSB7XHJcbiAgICAgIHJldHVybjsgLy8gQWxyZWFkeSBvdmVycmlkZGVuXHJcbiAgICB9XHJcblxyXG4gICAgLy8gU3RvcmUgb3JpZ2luYWwgdGV4dENvbnRlbnQgZGVzY3JpcHRvciBpZiBpdCBleGlzdHNcclxuICAgIGNvbnN0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGVsZW1lbnQpIGFzIHsgdGV4dENvbnRlbnQ/OiBQcm9wZXJ0eURlc2NyaXB0b3IgfTtcclxuICAgIGNvbnN0IG9yaWdpbmFsRGVzY3JpcHRvciA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocHJvdG8sICd0ZXh0Q29udGVudCcpO1xyXG4gICAgXHJcbiAgICBpZiAob3JpZ2luYWxEZXNjcmlwdG9yICYmIG9yaWdpbmFsRGVzY3JpcHRvci5zZXQpIHtcclxuICAgICAgdGhpcy5vcmlnaW5hbFRleHRDb250ZW50RGVzY3JpcHRvcnMuc2V0KGVsZW1lbnQsIG9yaWdpbmFsRGVzY3JpcHRvcik7XHJcbiAgICAgIFxyXG4gICAgICAvLyBPdmVycmlkZSB0ZXh0Q29udGVudCBzZXR0ZXJcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxlbWVudCwgJ3RleHRDb250ZW50Jywge1xyXG4gICAgICAgICAgc2V0OiAodmFsdWU6IHN0cmluZykgPT4ge1xyXG4gICAgICAgICAgICAvLyBDaGVjayBpZiB0aGlzIGxvb2tzIGxpa2UgYSBmaWxlbmFtZSB0aGF0IHNob3VsZCBiZSByZXBsYWNlZFxyXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5leHRyYWN0RmlsZVBhdGhGcm9tRWxlbWVudChlbGVtZW50KTtcclxuICAgICAgICAgICAgaWYgKGZpbGUgJiYgZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgICAgICAgICAgY29uc3QgZGlzcGxheU5hbWUgPSB0aGlzLmdldERpc3BsYXlOYW1lKGZpbGUpO1xyXG4gICAgICAgICAgICAgIGlmIChkaXNwbGF5TmFtZSAmJiAodmFsdWUgPT09IGZpbGUuYmFzZW5hbWUgfHwgdmFsdWUgPT09IGZpbGUubmFtZSB8fCB2YWx1ZS5lbmRzV2l0aChmaWxlLmJhc2VuYW1lKSkpIHtcclxuICAgICAgICAgICAgICAgIC8vIFJlcGxhY2Ugd2l0aCBwcm9wZXJ0eSB2YWx1ZSB1c2luZyBvcmlnaW5hbCBzZXR0ZXJcclxuICAgICAgICAgICAgICAgIG9yaWdpbmFsRGVzY3JpcHRvci5zZXQhLmNhbGwoZWxlbWVudCwgZGlzcGxheU5hbWUpO1xyXG4gICAgICAgICAgICAgICAgLy8gTWFyayBhcyBwcm9jZXNzZWRcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcm9jZXNzZWRFbGVtZW50cy5hZGQoZWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBOb3QgYSBmaWxlbmFtZSBvciBubyBwcm9wZXJ0eSwgdXNlIG9yaWdpbmFsIGJlaGF2aW9yXHJcbiAgICAgICAgICAgIG9yaWdpbmFsRGVzY3JpcHRvci5zZXQhLmNhbGwoZWxlbWVudCwgdmFsdWUpO1xyXG4gICAgICAgICAgICAvLyBNYXJrIGFzIHByb2Nlc3NlZFxyXG4gICAgICAgICAgICBlbGVtZW50LnNldEF0dHJpYnV0ZSgnZGF0YS1wb3YtcHJvY2Vzc2VkJywgJ3RydWUnKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3VuYm91bmQtbWV0aG9kXHJcbiAgICAgICAgICBnZXQ6IG9yaWdpbmFsRGVzY3JpcHRvci5nZXQgfHwgKCgpID0+IHtcclxuICAgICAgICAgICAgLy8gRmFsbGJhY2s6IGFjY2VzcyB0aGUgbmF0aXZlIHRleHRDb250ZW50IHByb3BlcnR5IGRpcmVjdGx5XHJcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKEhUTUxFbGVtZW50LnByb3RvdHlwZSwgJ3RleHRDb250ZW50Jyk/LmdldD8uY2FsbChlbGVtZW50KSBhcyBzdHJpbmcgfHwgJyc7XHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgICAgICAgIGVudW1lcmFibGU6IHRydWVcclxuICAgICAgICB9KTtcclxuICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgLy8gSWYgb3ZlcnJpZGUgZmFpbHMgKGUuZy4sIHByb3BlcnR5IGlzIG5vdCBjb25maWd1cmFibGUpLCBmYWxsIGJhY2sgdG8gbW9uaXRvcmluZ1xyXG4gICAgICAgIGVsZW1lbnQuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi1wcm9jZXNzZWQnLCAndHJ1ZScpO1xyXG4gICAgICB9XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBGYWxsYmFjazogY2FuJ3Qgb3ZlcnJpZGUsIGJ1dCBtYXJrIGFzIHByb2Nlc3NlZCBzbyBDU1MgZG9lc24ndCBoaWRlIGl0XHJcbiAgICAgIC8vIFRoZSBtdXRhdGlvbiBvYnNlcnZlciB3aWxsIGNhdGNoIGFuZCB1cGRhdGUgaXRcclxuICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcG92LXByb2Nlc3NlZCcsICd0cnVlJyk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5tb2RpZmllZEVsZW1lbnRzLmFkZChlbGVtZW50KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFN0b3Agb2JzZXJ2aW5nIERPTSBjaGFuZ2VzXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdG9wT2JzZXJ2aW5nKCk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMub2JzZXJ2ZXIpIHtcclxuICAgICAgdGhpcy5vYnNlcnZlci5kaXNjb25uZWN0KCk7XHJcbiAgICAgIHRoaXMub2JzZXJ2ZXIgPSB1bmRlZmluZWQ7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgbGF5b3V0IGNoYW5nZXNcclxuICAgKi9cclxuICBvbkxheW91dENoYW5nZSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JCYWNrbGlua3MpIHtcclxuICAgICAgLy8gU21hbGwgZGVsYXkgdG8gbGV0IE9ic2lkaWFuIHJlbmRlciBmaXJzdFxyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgICB0aGlzLnVwZGF0ZUJhY2tsaW5rcygpO1xyXG4gICAgICB9LCAxMDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5zdG9wT2JzZXJ2aW5nKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBIYW5kbGUgZmlsZSBvcGVuIGV2ZW50c1xyXG4gICAqL1xyXG4gIG9uRmlsZU9wZW4oKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yQmFja2xpbmtzKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICAgIHRoaXMudXBkYXRlRW1iZWRkZWRCYWNrbGlua3MoKTtcclxuICAgICAgfSwgMjAwKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFuIHVwIG9uIHVubG9hZFxyXG4gICAqL1xyXG4gIG9udW5sb2FkKCk6IHZvaWQge1xyXG4gICAgdGhpcy5zdG9wT2JzZXJ2aW5nKCk7XHJcbiAgICBcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGV4dENvbnRlbnQgZGVzY3JpcHRvcnNcclxuICAgIHRoaXMub3JpZ2luYWxUZXh0Q29udGVudERlc2NyaXB0b3JzLmZvckVhY2goKGRlc2NyaXB0b3IsIGVsZW1lbnQpID0+IHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZWxlbWVudCwgJ3RleHRDb250ZW50JywgZGVzY3JpcHRvcik7XHJcbiAgICAgIH0gY2F0Y2gge1xyXG4gICAgICAgIC8vIElnbm9yZSBlcnJvcnMgd2hlbiByZXN0b3JpbmdcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgICB0aGlzLm9yaWdpbmFsVGV4dENvbnRlbnREZXNjcmlwdG9ycy5jbGVhcigpO1xyXG4gICAgdGhpcy5tb2RpZmllZEVsZW1lbnRzID0gbmV3IFdlYWtTZXQoKTtcclxuICB9XHJcbn1cclxuXHJcbiIsICIvKipcbiAqIFRhYiBTZXJ2aWNlXG4gKiBcbiAqIFRoaXMgZmlsZSBjb250YWlucyBjb2RlIGFkYXB0ZWQgZnJvbSB0aGUgVGl0bGUtb25seSBUYWIgcGx1Z2luIGJ5IHRyaXN0b25lMTN0aC5cbiAqIE9yaWdpbmFsIHNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3RyaXN0b25lMTN0aC9vYnNpZGlhbi10aXRsZS1vbmx5LXRhYlxuICogXG4gKiBUaGUgY29kZSBoYXMgYmVlbiBtb2RpZmllZCB0byBpbnRlZ3JhdGUgd2l0aCB0aGUgUHJvcGVydHkgT3ZlciBGaWxlIE5hbWUgcGx1Z2luXG4gKiBhbmQgdXNlIHRoZSBwbHVnaW4ncyBwcm9wZXJ0eSBrZXkgc2V0dGluZyBpbnN0ZWFkIG9mIGhhcmRjb2RlZCBcInRpdGxlXCIgcHJvcGVydHkuXG4gKiBcbiAqIE9yaWdpbmFsIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgTUlULiBUaGlzIGZpbGUgaXMgYWxzbyBsaWNlbnNlZCB1bmRlciBHUEx2My5cbiAqL1xuXG5pbXBvcnQgeyBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiB9IGZyb20gJy4uL3R5cGVzJztcblxuZXhwb3J0IGNsYXNzIFRhYlNlcnZpY2Uge1xuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XG5cbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xuICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbmFtZXMgYWxsIG1hcmtkb3duIHRhYnMgdG8gdXNlIHRoZSBjb25maWd1cmVkIHByb3BlcnR5IHZhbHVlXG4gICAqIEZhbGxzIGJhY2sgdG8gZmlsZSBiYXNlbmFtZSBpZiBwcm9wZXJ0eSBpcyBub3QgZm91bmRcbiAgICogRVhBQ1QgY29weSBvZiB0aGUgd29ya2luZyBpbXBsZW1lbnRhdGlvbiBmcm9tIG9ic2lkaWFuLXRpdGxlLW9ubHktdGFiXG4gICAqL1xuICBhc3luYyByZW5hbWVUYWJzKCkge1xuICAgIGNvbnN0IGxlYXZlcyA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xuICAgIGxlYXZlcy5mb3JFYWNoKChsZWFmKSA9PiB7XG4gICAgICAvKlxuICAgICAgICogV2hlbiBPYnNpZGlhbiBmaXJzdCBvcGVucywgZHVlIHRvIGxhenkgbG9hZGluZywgdGhlIHZpZXcgbWF5IG5vdCBoYXZlXG4gICAgICAgKiBhIGZpbGUgcHJvcGVydHkuIFdlIG5lZWQgdG8gbWFudWFsbHkgdHJpZ2dlciBhIHJlbG9hZC4gQnkgdXNpbmcgc2V0Vmlld1N0YXRlXG4gICAgICAgKiB0byByZWFwcGx5IHRoZSB2aWV3IHN0YXRlLCB3ZSBmb3JjZSB0aGUgdmlldyB0byByZWluaXRpYWxpemUgYW5kIGxvYWQgdGhlXG4gICAgICAgKiBjb3JyZXNwb25kaW5nIGZpbGUsIHRodXMgcG9wdWxhdGluZyB0aGUgZmlsZSBwcm9wZXJ0eS4gSWYgbWFueSB0YWJzIGFyZSBvcGVuLFxuICAgICAgICogdGhpcyBtYXkgc2xpZ2h0bHkgaW5jcmVhc2Ugc3RhcnR1cCB0aW1lLlxuICAgICAgICovXG4gICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIE1hcmtkb3duVmlldztcbiAgICAgIGNvbnN0IHN0YXRlID0gbGVhZi5nZXRWaWV3U3RhdGUoKTtcbiAgICAgIGlmIChzdGF0ZS5zdGF0ZT8uZmlsZSAmJiAhdmlldz8uZmlsZSkge1xuICAgICAgICB2b2lkIGxlYWYuc2V0Vmlld1N0YXRlKHsgdHlwZTogc3RhdGUudHlwZSwgc3RhdGU6IHN0YXRlLnN0YXRlIH0pO1xuICAgICAgfVxuXG4gICAgICBpZiAodmlldz8uZmlsZSkge1xuICAgICAgICBjb25zdCBmaWxlID0gdmlldy5maWxlO1xuICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IGNhY2hlPy5mcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XG4gICAgICAgIGNvbnN0IHRhYkhlYWRlckVsID0gKGxlYWYgYXMgeyB0YWJIZWFkZXJFbD86IEhUTUxFbGVtZW50IH0pLnRhYkhlYWRlckVsO1xuXG4gICAgICAgIGlmICh0YWJIZWFkZXJFbCkge1xuICAgICAgICAgIC8vIEFsd2F5cyBtYXJrIHRhYnMgYXMgcHJvY2Vzc2VkIHNvIHRoZXkncmUgbm90IGRpbW1lZCAoZXZlbiB3aGVuIGZlYXR1cmUgaXMgZGlzYWJsZWQpXG4gICAgICAgICAgdGFiSGVhZGVyRWwuc2V0QXR0cmlidXRlKCdkYXRhLXBvdi10aXRsZS1zZXQnLCAndHJ1ZScpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIE9ubHkgY2hhbmdlIHRoZSB0aXRsZSBpZiB0aGUgZmVhdHVyZSBpcyBlbmFibGVkXG4gICAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvclRhYnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHRpdGxlRWwgPSB0YWJIZWFkZXJFbC5xdWVyeVNlbGVjdG9yKCcud29ya3NwYWNlLXRhYi1oZWFkZXItaW5uZXItdGl0bGUnKTtcbiAgICAgICAgICAgIGNvbnN0IGRpc3BsYXlUZXh0ID0gcHJvcGVydHlWYWx1ZSA/IFN0cmluZyhwcm9wZXJ0eVZhbHVlKSA6IGZpbGUuYmFzZW5hbWU7XG4gICAgICAgICAgICBpZiAodGl0bGVFbCkge1xuICAgICAgICAgICAgICB0aXRsZUVsLnNldFRleHQoZGlzcGxheVRleHQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0YWJIZWFkZXJFbC5zZXRBdHRyaWJ1dGUoJ2FyaWEtbGFiZWwnLCBkaXNwbGF5VGV4dCk7XG4gICAgICAgICAgICB0YWJIZWFkZXJFbC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgZGlzcGxheVRleHQpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGV2ZW50IGxpc3RlbmVycyBmb3IgdGFiIHJlbmFtaW5nXG4gICAqIEVYQUNUIGNvcHkgb2YgdGhlIHdvcmtpbmcgaW1wbGVtZW50YXRpb24gZnJvbSBvYnNpZGlhbi10aXRsZS1vbmx5LXRhYlxuICAgKi9cbiAgYXN5bmMgcmVnaXN0ZXJFdmVudHMoKSB7XG4gICAgYXdhaXQgdGhpcy5yZW5hbWVUYWJzKCk7XG5cbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignbGF5b3V0LWNoYW5nZScsICgpID0+IHRoaXMucmVuYW1lVGFicygpKVxuICAgICk7XG5cbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuICAgICAgdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignYWN0aXZlLWxlYWYtY2hhbmdlJywgKCkgPT4gdGhpcy5yZW5hbWVUYWJzKCkpXG4gICAgKTtcblxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXG4gICAgICB0aGlzLnBsdWdpbi5hcHAud29ya3NwYWNlLm9uKCdmaWxlLW9wZW4nLCAoKSA9PiB0aGlzLnJlbmFtZVRhYnMoKSlcbiAgICApO1xuXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcbiAgICAgIHRoaXMucGx1Z2luLmFwcC52YXVsdC5vbigncmVuYW1lJywgKCkgPT4gdGhpcy5yZW5hbWVUYWJzKCkpXG4gICAgKTtcblxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXG4gICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsICgpID0+IHRoaXMucmVuYW1lVGFicygpKVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogVXBkYXRlIHRhYnMgKHB1YmxpYyBtZXRob2QgZm9yIG1hbnVhbCB1cGRhdGVzKVxuICAgKi9cbiAgdXBkYXRlVGFicygpIHtcbiAgICB2b2lkIHRoaXMucmVuYW1lVGFicygpO1xuICB9XG5cbiAgLyoqXG4gICAqIENsZWFudXAgb24gdW5sb2FkXG4gICAqL1xuICBvbnVubG9hZCgpIHtcbiAgICAvLyBObyBjbGVhbnVwIG5lZWRlZCAtIGV2ZW50cyBhcmUgYXV0b21hdGljYWxseSB1bnJlZ2lzdGVyZWQgYnkgT2JzaWRpYW5cbiAgfVxufVxuIiwgImltcG9ydCB7IFRGaWxlLCBURm9sZGVyIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbiwgVEZpbGVFeHBsb3Jlckl0ZW0sIFRGaWxlRXhwbG9yZXJWaWV3IH0gZnJvbSAnLi4vdHlwZXMnO1xyXG5cclxuLyoqXHJcbiAqIEV4cGxvcmVyIFNlcnZpY2VcclxuICogXHJcbiAqIEhhbmRsZXMgZGlzcGxheWluZyBwcm9wZXJ0eS1iYXNlZCB0aXRsZXMgaW4gdGhlIGZpbGUgZXhwbG9yZXIuXHJcbiAqIFN1cHBvcnRzIGZvbGRlciBub3RlczogaWYgYSBmb2xkZXIgY29udGFpbnMgYSBmaWxlIG1hdGNoaW5nIHRoZSBjb25maWd1cmVkXHJcbiAqIGZvbGRlciBub3RlIGZpbGVuYW1lIChlLmcuLCBcImluZGV4Lm1kXCIpIHdpdGggYSBmcm9udG1hdHRlciB0aXRsZSwgdGhlIGZvbGRlclxyXG4gKiB3aWxsIGRpc3BsYXkgdGhhdCB0aXRsZSBpbnN0ZWFkIG9mIHRoZSBmb2xkZXIgbmFtZS5cclxuICovXHJcbmV4cG9ydCBjbGFzcyBFeHBsb3JlclNlcnZpY2Uge1xyXG4gIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47IC8vIFB1YmxpYyBzbyBFeHBsb3JlckZpbGVJdGVtTXV0YXRvciBjYW4gYWNjZXNzIGl0XHJcbiAgcHJpdmF0ZSBleHBsb3JlclZpZXc6IFRGaWxlRXhwbG9yZXJWaWV3IHwgbnVsbCA9IG51bGw7XHJcbiAgcHJpdmF0ZSBtb2RpZmllZCA9IG5ldyBXZWFrTWFwPFRGaWxlRXhwbG9yZXJJdGVtLCBFeHBsb3JlckZpbGVJdGVtTXV0YXRvcj4oKTtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIGZpbGUgZXhwbG9yZXIgdmlld1xyXG4gICAqL1xyXG4gIHByaXZhdGUgZ2V0RXhwbG9yZXJWaWV3KCk6IFRGaWxlRXhwbG9yZXJWaWV3IHwgbnVsbCB7XHJcbiAgICBpZiAodGhpcy5leHBsb3JlclZpZXcgPT09IG51bGwpIHtcclxuICAgICAgY29uc3QgbGVhdmVzID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2ZpbGUtZXhwbG9yZXInKTtcclxuICAgICAgaWYgKGxlYXZlcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBsZWFmID0gbGVhdmVzWzBdO1xyXG4gICAgICBpZiAobGVhZiAmJiBsZWFmLnZpZXcpIHtcclxuICAgICAgICAvLyBUeXBlIGFzc2VydGlvbiB0aHJvdWdoIHVua25vd24gdG8gaGFuZGxlIHRoZSBpbnRlcmZhY2UgbWlzbWF0Y2hcclxuICAgICAgICB0aGlzLmV4cGxvcmVyVmlldyA9IGxlYWYudmlldyBhcyB1bmtub3duIGFzIFRGaWxlRXhwbG9yZXJWaWV3O1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICByZXR1cm4gdGhpcy5leHBsb3JlclZpZXc7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgZm9sZGVyIG5vdGUgdGl0bGUgZm9yIGEgZm9sZGVyXHJcbiAgICogUmV0dXJucyB0aGUgZnJvbnRtYXR0ZXIgdGl0bGUgcHJvcGVydHkgZnJvbSB0aGUgZm9sZGVyIG5vdGUgZmlsZSBpZiBpdCBleGlzdHNcclxuICAgKi9cclxuICBwcml2YXRlIGdldEZvbGRlck5vdGVUaXRsZShmb2xkZXI6IFRGb2xkZXIpOiBzdHJpbmcgfCBudWxsIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZm9sZGVyTm90ZUZpbGVuYW1lIHx8IFxyXG4gICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlck5vdGVGaWxlbmFtZS50cmltKCkgPT09ICcnKSB7XHJcbiAgICAgIHJldHVybiBudWxsO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZvbGRlck5vdGVGaWxlbmFtZSA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZvbGRlck5vdGVGaWxlbmFtZS50cmltKCk7XHJcbiAgICBjb25zdCBmb2xkZXJOb3RlUGF0aCA9IGAke2ZvbGRlci5wYXRofS8ke2ZvbGRlck5vdGVGaWxlbmFtZX0ubWRgO1xyXG4gICAgY29uc3QgZm9sZGVyTm90ZUZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlck5vdGVQYXRoKTtcclxuXHJcbiAgICBpZiAoZm9sZGVyTm90ZUZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICBjb25zdCBjYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmb2xkZXJOb3RlRmlsZSk7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBjYWNoZT8uZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gYXMgc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gICAgICBpZiAocHJvcGVydHlWYWx1ZSkge1xyXG4gICAgICAgIHJldHVybiBTdHJpbmcocHJvcGVydHlWYWx1ZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc29sdmUgdGl0bGUgZm9yIGEgZmlsZSBvciBmb2xkZXJcclxuICAgKiBQdWJsaWMgc28gRXhwbG9yZXJGaWxlSXRlbU11dGF0b3IgY2FuIGFjY2VzcyBpdFxyXG4gICAqL1xyXG4gIHJlc29sdmVUaXRsZShpdGVtOiBURmlsZUV4cGxvcmVySXRlbSk6IHN0cmluZyB8IG51bGwge1xyXG4gICAgaWYgKGl0ZW0uZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSB7XHJcbiAgICAgIC8vIEZvciBmaWxlcywgdXNlIHByb3BlcnR5LWJhc2VkIHRpdGxlXHJcbiAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGl0ZW0uZmlsZSk7XHJcbiAgICAgIGNvbnN0IHByb3BlcnR5VmFsdWUgPSBjYWNoZT8uZnJvbnRtYXR0ZXI/Llt0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcm9wZXJ0eUtleV0gYXMgc3RyaW5nIHwgdW5kZWZpbmVkO1xyXG4gICAgICByZXR1cm4gcHJvcGVydHlWYWx1ZSA/IFN0cmluZyhwcm9wZXJ0eVZhbHVlKSA6IG51bGw7XHJcbiAgICB9IGVsc2UgaWYgKGl0ZW0uZmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcclxuICAgICAgLy8gRm9yIGZvbGRlcnMsIGNoZWNrIGZvciBmb2xkZXIgbm90ZVxyXG4gICAgICByZXR1cm4gdGhpcy5nZXRGb2xkZXJOb3RlVGl0bGUoaXRlbS5maWxlKTtcclxuICAgIH1cclxuICAgIHJldHVybiBudWxsO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGFsbCBmaWxlIGV4cGxvcmVyIGl0ZW1zXHJcbiAgICovXHJcbiAgcHJpdmF0ZSB1cGRhdGVBbGxJdGVtcygpIHtcclxuICAgIGNvbnN0IHZpZXcgPSB0aGlzLmdldEV4cGxvcmVyVmlldygpO1xyXG4gICAgaWYgKCF2aWV3IHx8ICF2aWV3LmZpbGVJdGVtcykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXRlbXMgPSBPYmplY3QudmFsdWVzKHZpZXcuZmlsZUl0ZW1zKTtcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xyXG4gICAgICBpZiAoIXRoaXMubW9kaWZpZWQuaGFzKGl0ZW0pKSB7XHJcbiAgICAgICAgdGhpcy5tb2RpZmllZC5zZXQoaXRlbSwgbmV3IEV4cGxvcmVyRmlsZUl0ZW1NdXRhdG9yKGl0ZW0sIHRoaXMpKTtcclxuICAgICAgfVxyXG4gICAgICBpdGVtLnVwZGF0ZVRpdGxlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0b3JlIGFsbCBvcmlnaW5hbCB0aXRsZXNcclxuICAgKi9cclxuICBwcml2YXRlIHJlc3RvcmVBbGxJdGVtcygpIHtcclxuICAgIGNvbnN0IHZpZXcgPSB0aGlzLmdldEV4cGxvcmVyVmlldygpO1xyXG4gICAgaWYgKCF2aWV3IHx8ICF2aWV3LmZpbGVJdGVtcykge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgaXRlbXMgPSBPYmplY3QudmFsdWVzKHZpZXcuZmlsZUl0ZW1zKTtcclxuICAgIGZvciAoY29uc3QgaXRlbSBvZiBpdGVtcykge1xyXG4gICAgICBpZiAodGhpcy5tb2RpZmllZC5oYXMoaXRlbSkpIHtcclxuICAgICAgICBjb25zdCBtdXRhdG9yID0gdGhpcy5tb2RpZmllZC5nZXQoaXRlbSk7XHJcbiAgICAgICAgbXV0YXRvcj8uZGVzdHJveSgpO1xyXG4gICAgICAgIHRoaXMubW9kaWZpZWQuZGVsZXRlKGl0ZW0pO1xyXG4gICAgICAgIGl0ZW0udXBkYXRlVGl0bGUoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogUmVnaXN0ZXIgZXZlbnRzIGFuZCBpbml0aWFsaXplXHJcbiAgICovXHJcbiAgcmVnaXN0ZXJFdmVudHMoKSB7XHJcbiAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICAvLyBXYWl0IGZvciBsYXlvdXQgdG8gYmUgcmVhZHlcclxuICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub25MYXlvdXRSZWFkeSgoKSA9PiB7XHJcbiAgICAgIHRoaXMuZXhwbG9yZXJWaWV3ID0gbnVsbDsgLy8gUmVzZXQgdG8gZ2V0IGZyZXNoIHZpZXdcclxuICAgICAgdGhpcy51cGRhdGVBbGxJdGVtcygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHdoZW4gbGF5b3V0IGNoYW5nZXNcclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2xheW91dC1jaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5leHBsb3JlclZpZXcgPSBudWxsOyAvLyBSZXNldCB0byBnZXQgZnJlc2ggdmlld1xyXG4gICAgICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3Jlcikge1xyXG4gICAgICAgICAgdGhpcy51cGRhdGVBbGxJdGVtcygpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgLy8gVXBkYXRlIHdoZW4gbWV0YWRhdGEgY2hhbmdlc1xyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUub24oJ2NoYW5nZWQnLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZUFsbEl0ZW1zKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgd2hlbiBmaWxlcyBhcmUgcmVuYW1lZFxyXG4gICAgdGhpcy5wbHVnaW4ucmVnaXN0ZXJFdmVudChcclxuICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm9uKCdyZW5hbWUnLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmVuYWJsZUZvckV4cGxvcmVyKSB7XHJcbiAgICAgICAgICB0aGlzLmV4cGxvcmVyVmlldyA9IG51bGw7IC8vIFJlc2V0IHRvIGdldCBmcmVzaCB2aWV3XHJcbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMudXBkYXRlQWxsSXRlbXMoKSwgMTAwKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogVXBkYXRlIGV4cGxvcmVyIHdoZW4gc2V0dGluZ3MgY2hhbmdlXHJcbiAgICovXHJcbiAgdXBkYXRlRXhwbG9yZXIoKSB7XHJcbiAgICBpZiAodGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yRXhwbG9yZXIpIHtcclxuICAgICAgdGhpcy5leHBsb3JlclZpZXcgPSBudWxsOyAvLyBSZXNldCB0byBnZXQgZnJlc2ggdmlld1xyXG4gICAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy51cGRhdGVBbGxJdGVtcygpLCAxMDApO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5yZXN0b3JlQWxsSXRlbXMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFudXAgb24gdW5sb2FkXHJcbiAgICovXHJcbiAgb251bmxvYWQoKSB7XHJcbiAgICB0aGlzLnJlc3RvcmVBbGxJdGVtcygpO1xyXG4gICAgdGhpcy5leHBsb3JlclZpZXcgPSBudWxsO1xyXG4gIH1cclxufVxyXG5cclxuLyoqXHJcbiAqIE11dGF0b3IgZm9yIGluZGl2aWR1YWwgZmlsZSBleHBsb3JlciBpdGVtc1xyXG4gKiBIb29rcyBpbnRvIHVwZGF0ZVRpdGxlKCkgdG8gcmVwbGFjZSBkaXNwbGF5ZWQgdGV4dFxyXG4gKi9cclxuY2xhc3MgRXhwbG9yZXJGaWxlSXRlbU11dGF0b3Ige1xyXG4gIHByaXZhdGUgb3JpZ2luYWxVcGRhdGVUaXRsZTogKCkgPT4gdm9pZDtcclxuICBwcml2YXRlIG9yaWdpbmFsU3RhcnRSZW5hbWU6ICgoKSA9PiB2b2lkKSB8IHVuZGVmaW5lZDtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IGl0ZW06IFRGaWxlRXhwbG9yZXJJdGVtLFxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBzZXJ2aWNlOiBFeHBsb3JlclNlcnZpY2VcclxuICApIHtcclxuICAgIC8vIFN0b3JlIG9yaWdpbmFsIG1ldGhvZHNcclxuICAgIGNvbnN0IHByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKGl0ZW0pIGFzIHsgdXBkYXRlVGl0bGU6ICgpID0+IHZvaWQ7IHN0YXJ0UmVuYW1lPzogKCkgPT4gdm9pZCB9O1xyXG4gICAgdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlID0gcHJvdG8udXBkYXRlVGl0bGUuYmluZChpdGVtKTtcclxuICAgIHRoaXMub3JpZ2luYWxTdGFydFJlbmFtZSA9IHByb3RvLnN0YXJ0UmVuYW1lID8gcHJvdG8uc3RhcnRSZW5hbWUuYmluZChpdGVtKSA6IHVuZGVmaW5lZDtcclxuXHJcbiAgICAvLyBPdmVycmlkZSB1cGRhdGVUaXRsZVxyXG4gICAgaXRlbS51cGRhdGVUaXRsZSA9IHRoaXMudXBkYXRlVGl0bGUuYmluZCh0aGlzKTtcclxuICAgIFxyXG4gICAgLy8gT3ZlcnJpZGUgc3RhcnRSZW5hbWUgaWYgaXQgZXhpc3RzXHJcbiAgICBpZiAocHJvdG8uc3RhcnRSZW5hbWUpIHtcclxuICAgICAgaXRlbS5zdGFydFJlbmFtZSA9IHRoaXMuc3RhcnRSZW5hbWUuYmluZCh0aGlzKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByaXZhdGUgdXBkYXRlVGl0bGUoKSB7XHJcbiAgICAvLyBDYWxsIG9yaWdpbmFsIHRvIHNldCB1cCB0aGUgZWxlbWVudFxyXG4gICAgdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlKCk7XHJcbiAgICBcclxuICAgIC8vIFJlcGxhY2Ugd2l0aCBwcm9wZXJ0eS1iYXNlZCB0aXRsZSBpZiBlbmFibGVkXHJcbiAgICBpZiAodGhpcy5zZXJ2aWNlLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JFeHBsb3Jlcikge1xyXG4gICAgICBjb25zdCB0aXRsZSA9IHRoaXMuc2VydmljZS5yZXNvbHZlVGl0bGUodGhpcy5pdGVtKTtcclxuICAgICAgaWYgKHRpdGxlICYmIHRpdGxlLmxlbmd0aCA+IDApIHtcclxuICAgICAgICB0aGlzLml0ZW0uaW5uZXJFbC5zZXRUZXh0KHRpdGxlKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBzdGFydFJlbmFtZSgpIHtcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgdGl0bGUgZm9yIHJlbmFtaW5nXHJcbiAgICB0aGlzLml0ZW0uaW5uZXJFbC5zZXRUZXh0KHRoaXMuaXRlbS5nZXRUaXRsZSgpKTtcclxuICAgIHJldHVybiB0aGlzLm9yaWdpbmFsU3RhcnRSZW5hbWU/LigpO1xyXG4gIH1cclxuXHJcbiAgZGVzdHJveSgpIHtcclxuICAgIC8vIFJlc3RvcmUgb3JpZ2luYWwgbWV0aG9kc1xyXG4gICAgY29uc3QgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YodGhpcy5pdGVtKSBhcyB7IHN0YXJ0UmVuYW1lPzogKCkgPT4gdm9pZCB9O1xyXG4gICAgdGhpcy5pdGVtLnVwZGF0ZVRpdGxlID0gdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlO1xyXG4gICAgaWYgKHByb3RvLnN0YXJ0UmVuYW1lICYmIHRoaXMub3JpZ2luYWxTdGFydFJlbmFtZSkge1xyXG4gICAgICB0aGlzLml0ZW0uc3RhcnRSZW5hbWUgPSB0aGlzLm9yaWdpbmFsU3RhcnRSZW5hbWU7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4iLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IFByb3BlcnR5T3ZlckZpbGVOYW1lUGx1Z2luLCBXb3Jrc3BhY2VFeHQgfSBmcm9tICcuLi90eXBlcyc7XHJcblxyXG4vKipcclxuICogV2luZG93IEZyYW1lIFNlcnZpY2VcclxuICogXHJcbiAqIEhhbmRsZXMgZGlzcGxheWluZyBwcm9wZXJ0eS1iYXNlZCB0aXRsZSBpbiB0aGUgYnJvd3NlciB3aW5kb3cgdGl0bGUgYmFyLlxyXG4gKiBPdmVycmlkZXMgd29ya3NwYWNlLnVwZGF0ZVRpdGxlKCkgdG8gdXNlIHRoZSBmcm9udG1hdHRlciBwcm9wZXJ0eSBpbnN0ZWFkXHJcbiAqIG9mIHRoZSBmaWxlIG5hbWUuXHJcbiAqL1xyXG5leHBvcnQgY2xhc3MgV2luZG93RnJhbWVTZXJ2aWNlIHtcclxuICBwcml2YXRlIHBsdWdpbjogUHJvcGVydHlPdmVyRmlsZU5hbWVQbHVnaW47XHJcbiAgcHJpdmF0ZSBvcmlnaW5hbFVwZGF0ZVRpdGxlOiAoKCkgPT4gdm9pZCkgfCBudWxsID0gbnVsbDtcclxuICBwcml2YXRlIGVuYWJsZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuXHJcbiAgY29uc3RydWN0b3IocGx1Z2luOiBQcm9wZXJ0eU92ZXJGaWxlTmFtZVBsdWdpbikge1xyXG4gICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXQgdGhlIHRpdGxlIGZvciB0aGUgYWN0aXZlIGZpbGVcclxuICAgKi9cclxuICBwcml2YXRlIGdldEFjdGl2ZUZpbGVUaXRsZSgpOiBzdHJpbmcge1xyXG4gICAgY29uc3QgYWN0aXZlRmlsZSA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlRmlsZSgpO1xyXG4gICAgaWYgKGFjdGl2ZUZpbGUgaW5zdGFuY2VvZiBURmlsZSkge1xyXG4gICAgICBjb25zdCBjYWNoZSA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShhY3RpdmVGaWxlKTtcclxuICAgICAgY29uc3QgcHJvcGVydHlWYWx1ZSA9IGNhY2hlPy5mcm9udG1hdHRlcj8uW3RoaXMucGx1Z2luLnNldHRpbmdzLnByb3BlcnR5S2V5XSBhcyBzdHJpbmcgfCB1bmRlZmluZWQ7XHJcbiAgICAgIGlmIChwcm9wZXJ0eVZhbHVlKSB7XHJcbiAgICAgICAgcmV0dXJuIFN0cmluZyhwcm9wZXJ0eVZhbHVlKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gYWN0aXZlRmlsZS5iYXNlbmFtZTtcclxuICAgIH1cclxuICAgIHJldHVybiAnJztcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIE92ZXJyaWRlIHVwZGF0ZVRpdGxlIHRvIHVzZSBwcm9wZXJ0eS1iYXNlZCB0aXRsZVxyXG4gICAqL1xyXG4gIHByaXZhdGUgdXBkYXRlVGl0bGUoKSB7XHJcbiAgICBpZiAoIXRoaXMuZW5hYmxlZCkge1xyXG4gICAgICBpZiAodGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlKSB7XHJcbiAgICAgICAgdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlKCk7XHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHRpdGxlID0gdGhpcy5nZXRBY3RpdmVGaWxlVGl0bGUoKTtcclxuICAgIGlmICh0aXRsZSkge1xyXG4gICAgICAvLyBHZXQgdGhlIGFwcCB0aXRsZSBmb3JtYXQgKHVzdWFsbHkgXCJUaXRsZSAtIFZhdWx0IE5hbWVcIilcclxuICAgICAgLy8gVHJ5IHRvIHVzZSBPYnNpZGlhbidzIGdldEFwcFRpdGxlIG1ldGhvZCBpZiBhdmFpbGFibGVcclxuICAgICAgY29uc3QgYXBwID0gdGhpcy5wbHVnaW4uYXBwIGFzIHsgZ2V0QXBwVGl0bGU/OiAodGl0bGU6IHN0cmluZykgPT4gc3RyaW5nIH07XHJcbiAgICAgIGlmICh0eXBlb2YgYXBwLmdldEFwcFRpdGxlID09PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgZG9jdW1lbnQudGl0bGUgPSBhcHAuZ2V0QXBwVGl0bGUodGl0bGUpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZhbGxiYWNrOiBmb3JtYXQgbWFudWFsbHlcclxuICAgICAgICBjb25zdCB2YXVsdE5hbWUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0TmFtZSgpO1xyXG4gICAgICAgIGRvY3VtZW50LnRpdGxlID0gYCR7dGl0bGV9IC0gJHt2YXVsdE5hbWV9YDtcclxuICAgICAgfVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgLy8gRmFsbGJhY2sgdG8gb3JpZ2luYWwgYmVoYXZpb3JcclxuICAgICAgaWYgKHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSkge1xyXG4gICAgICAgIHRoaXMub3JpZ2luYWxVcGRhdGVUaXRsZSgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBFbmFibGUgdGhlIHdpbmRvdyBmcmFtZSBmZWF0dXJlXHJcbiAgICovXHJcbiAgZW5hYmxlKCkge1xyXG4gICAgaWYgKHRoaXMuZW5hYmxlZCkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgd29ya3NwYWNlID0gdGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZSBhcyBXb3Jrc3BhY2VFeHQ7XHJcbiAgICBpZiAod29ya3NwYWNlLnVwZGF0ZVRpdGxlKSB7XHJcbiAgICAgIC8vIFN0b3JlIG9yaWdpbmFsIG1ldGhvZFxyXG4gICAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUgPSB3b3Jrc3BhY2UudXBkYXRlVGl0bGUuYmluZCh3b3Jrc3BhY2UpO1xyXG4gICAgICBcclxuICAgICAgLy8gT3ZlcnJpZGUgd2l0aCBvdXIgbWV0aG9kXHJcbiAgICAgIHdvcmtzcGFjZS51cGRhdGVUaXRsZSA9IHRoaXMudXBkYXRlVGl0bGUuYmluZCh0aGlzKTtcclxuICAgICAgXHJcbiAgICAgIC8vIFVwZGF0ZSBpbW1lZGlhdGVseVxyXG4gICAgICB0aGlzLnVwZGF0ZVRpdGxlKCk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLmVuYWJsZWQgPSB0cnVlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRGlzYWJsZSB0aGUgd2luZG93IGZyYW1lIGZlYXR1cmVcclxuICAgKi9cclxuICBkaXNhYmxlKCkge1xyXG4gICAgaWYgKCF0aGlzLmVuYWJsZWQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHdvcmtzcGFjZSA9IHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2UgYXMgV29ya3NwYWNlRXh0O1xyXG4gICAgaWYgKHdvcmtzcGFjZS51cGRhdGVUaXRsZSAmJiB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUpIHtcclxuICAgICAgLy8gUmVzdG9yZSBvcmlnaW5hbCBtZXRob2RcclxuICAgICAgd29ya3NwYWNlLnVwZGF0ZVRpdGxlID0gdGhpcy5vcmlnaW5hbFVwZGF0ZVRpdGxlO1xyXG4gICAgICBcclxuICAgICAgLy8gVXBkYXRlIHRvIHJlc3RvcmUgb3JpZ2luYWwgdGl0bGVcclxuICAgICAgd29ya3NwYWNlLnVwZGF0ZVRpdGxlKCk7XHJcbiAgICAgIFxyXG4gICAgICB0aGlzLm9yaWdpbmFsVXBkYXRlVGl0bGUgPSBudWxsO1xyXG4gICAgICB0aGlzLmVuYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlZ2lzdGVyIGV2ZW50cyBmb3Igd2luZG93IGZyYW1lIHVwZGF0ZXNcclxuICAgKi9cclxuICByZWdpc3RlckV2ZW50cygpIHtcclxuICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MuZW5hYmxlRm9yV2luZG93RnJhbWUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFVwZGF0ZSB3aGVuIGFjdGl2ZSBmaWxlIGNoYW5nZXNcclxuICAgIHRoaXMucGx1Z2luLnJlZ2lzdGVyRXZlbnQoXHJcbiAgICAgIHRoaXMucGx1Z2luLmFwcC53b3Jrc3BhY2Uub24oJ2ZpbGUtb3BlbicsICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVkKSB7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRpdGxlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuXHJcbiAgICAvLyBVcGRhdGUgd2hlbiBtZXRhZGF0YSBjaGFuZ2VzXHJcbiAgICB0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxyXG4gICAgICB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5vbignY2hhbmdlZCcsICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5lbmFibGVkKSB7XHJcbiAgICAgICAgICB0aGlzLnVwZGF0ZVRpdGxlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFVwZGF0ZSB3aW5kb3cgZnJhbWUgd2hlbiBzZXR0aW5ncyBjaGFuZ2VcclxuICAgKi9cclxuICB1cGRhdGVXaW5kb3dGcmFtZSgpIHtcclxuICAgIGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5lbmFibGVGb3JXaW5kb3dGcmFtZSkge1xyXG4gICAgICB0aGlzLmVuYWJsZSgpO1xyXG4gICAgICB0aGlzLnJlZ2lzdGVyRXZlbnRzKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmRpc2FibGUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIENsZWFudXAgb24gdW5sb2FkXHJcbiAgICovXHJcbiAgb251bmxvYWQoKSB7XHJcbiAgICB0aGlzLmRpc2FibGUoKTtcclxuICB9XHJcbn1cclxuXHJcbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBNENPLFNBQVMsZUFDZCxPQUNBLGVBQ0EsYUFDNkI7QUFDN0IsUUFBTSxRQUFRLG9CQUFJLElBQTRCO0FBRTlDLFFBQU0sUUFBUSxDQUFDLFNBQVM7QUFDdEIsVUFBTSxZQUFZLGNBQWMsYUFBYSxJQUFJO0FBQ2pELFVBQU0sY0FBYyx1Q0FBVztBQUMvQixRQUFJLGNBQWMsS0FBSztBQUN2QixRQUFJLGtCQUFrQjtBQUN0QixRQUFJLFVBQW9CLENBQUM7QUFFekIsUUFBSSxlQUFlLFlBQVksV0FBVyxNQUFNLFVBQWEsWUFBWSxXQUFXLE1BQU0sTUFBTTtBQUM5RixZQUFNLGdCQUFnQixPQUFPLFlBQVksV0FBVyxDQUFDLEVBQUUsS0FBSztBQUM1RCxVQUFJLGtCQUFrQixJQUFJO0FBQ3hCLHNCQUFjO0FBQ2QsMEJBQWtCO0FBQUEsTUFDcEI7QUFBQSxJQUNGO0FBRUEsUUFBSSwyQ0FBYSxTQUFTO0FBQ3hCLFlBQU0sYUFBYSxZQUFZO0FBQy9CLGdCQUFVLE1BQU0sUUFBUSxVQUFVLElBQUksV0FBVyxJQUFJLE9BQUssT0FBTyxDQUFDLENBQUMsSUFBSSxDQUFDLE9BQU8s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QyxTQUFLLFdBQVcsT0FBTyxPQUFPLENBQUMsR0FBRyxrQkFBa0Isa0NBQWMsQ0FBQyxDQUFDO0FBQUEsRUFDdEU7QUFBQSxFQUVBLE1BQU0sYUFBYSx3QkFBa0MsY0FBd0I7QUFDM0UsVUFBTSxLQUFLLFNBQVMsS0FBSyxRQUFRO0FBRWpDLFFBQUksMkJBQTJCLFVBQWEsMkJBQTJCLEtBQUssU0FBUyx3QkFBd0I7QUFDM0csV0FBSyxvQkFBb0I7QUFBQSxJQUMzQjtBQUNBLFFBQUksaUJBQWlCLFVBQWEsaUJBQWlCLEtBQUssU0FBUyxlQUFlO0FBRzlFLFdBQUssS0FBSyxXQUFXLGVBQWU7QUFDcEMsV0FBSyxXQUFXO0FBQUEsSUFDbEI7QUFBQSxFQUNGO0FBQ0Y7IiwKICAibmFtZXMiOiBbImltcG9ydF9vYnNpZGlhbiIsICJzZWFyY2hRdWVyeSIsICJfYSIsICJpbXBvcnRfb2JzaWRpYW4iLCAic3VnZ2VzdGlvbnMiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiUXVpY2tTd2l0Y2hNb2RhbCIsICJRdWlja1N3aXRjaE1vZGFsIiwgImltcG9ydF9vYnNpZGlhbiIsICJhY3RpdmVWaWV3IiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiX2EiLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
