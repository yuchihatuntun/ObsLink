---
import { getCollection } from 'astro:content';
import { shouldShowContent } from '@/utils/markdown';
import { siteConfig } from '@/config';
import ProjectLayout from '@/layouts/ProjectLayout.astro';

export async function getStaticPaths() {
  // If projects are disabled, don't generate any paths
  if (!siteConfig.optionalContentTypes.projects) {
    return [];
  }
  
  const projects = await getCollection('projects');
  const isDev = import.meta.env.DEV;
  
  return projects
    .filter(project => shouldShowContent(project, isDev))
    .map(project => ({
      params: { slug: project.id },
      props: { project }
    }));
}

const { project } = Astro.props;
---

<ProjectLayout project={project} />
